function uG(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(r,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();function t2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fM={exports:{}},Fv={},mM={exports:{}},ct={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ag=Symbol.for("react.element"),cG=Symbol.for("react.portal"),dG=Symbol.for("react.fragment"),pG=Symbol.for("react.strict_mode"),hG=Symbol.for("react.profiler"),fG=Symbol.for("react.provider"),mG=Symbol.for("react.context"),gG=Symbol.for("react.forward_ref"),yG=Symbol.for("react.suspense"),bG=Symbol.for("react.memo"),vG=Symbol.for("react.lazy"),g$=Symbol.iterator;function xG(e){return e===null||typeof e!="object"?null:(e=g$&&e[g$]||e["@@iterator"],typeof e=="function"?e:null)}var gM={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},yM=Object.assign,bM={};function Np(e,t,n){this.props=e,this.context=t,this.refs=bM,this.updater=n||gM}Np.prototype.isReactComponent={};Np.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Np.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function vM(){}vM.prototype=Np.prototype;function n2(e,t,n){this.props=e,this.context=t,this.refs=bM,this.updater=n||gM}var r2=n2.prototype=new vM;r2.constructor=n2;yM(r2,Np.prototype);r2.isPureReactComponent=!0;var y$=Array.isArray,xM=Object.prototype.hasOwnProperty,a2={current:null},wM={key:!0,ref:!0,__self:!0,__source:!0};function kM(e,t,n){var r,a={},i=null,s=null;if(t!=null)for(r in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)xM.call(t,r)&&!wM.hasOwnProperty(r)&&(a[r]=t[r]);var o=arguments.length-2;if(o===1)a.children=n;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)a[r]===void 0&&(a[r]=o[r]);return{$$typeof:ag,type:e,key:i,ref:s,props:a,_owner:a2.current}}function wG(e,t){return{$$typeof:ag,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function i2(e){return typeof e=="object"&&e!==null&&e.$$typeof===ag}function kG(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var b$=/\/+/g;function uw(e,t){return typeof e=="object"&&e!==null&&e.key!=null?kG(""+e.key):t.toString(36)}function $0(e,t,n,r,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case ag:case cG:s=!0}}if(s)return s=e,a=a(s),e=r===""?"."+uw(s,0):r,y$(a)?(n="",e!=null&&(n=e.replace(b$,"$&/")+"/"),$0(a,t,n,"",function(c){return c})):a!=null&&(i2(a)&&(a=wG(a,n+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(b$,"$&/")+"/")+e)),t.push(a)),1;if(s=0,r=r===""?".":r+":",y$(e))for(var o=0;o<e.length;o++){i=e[o];var l=r+uw(i,o);s+=$0(i,t,n,l,a)}else if(l=xG(e),typeof l=="function")for(e=l.call(e),o=0;!(i=e.next()).done;)i=i.value,l=r+uw(i,o++),s+=$0(i,t,n,l,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function zy(e,t,n){if(e==null)return e;var r=[],a=0;return $0(e,r,"","",function(i){return t.call(n,i,a++)}),r}function SG(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var qr={current:null},A0={transition:null},IG={ReactCurrentDispatcher:qr,ReactCurrentBatchConfig:A0,ReactCurrentOwner:a2};ct.Children={map:zy,forEach:function(e,t,n){zy(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return zy(e,function(){t++}),t},toArray:function(e){return zy(e,function(t){return t})||[]},only:function(e){if(!i2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ct.Component=Np;ct.Fragment=dG;ct.Profiler=hG;ct.PureComponent=n2;ct.StrictMode=pG;ct.Suspense=yG;ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IG;ct.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=yM({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=a2.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)xM.call(t,l)&&!wM.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];r.children=o}return{$$typeof:ag,type:e.type,key:a,ref:i,props:r,_owner:s}};ct.createContext=function(e){return e={$$typeof:mG,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:fG,_context:e},e.Consumer=e};ct.createElement=kM;ct.createFactory=function(e){var t=kM.bind(null,e);return t.type=e,t};ct.createRef=function(){return{current:null}};ct.forwardRef=function(e){return{$$typeof:gG,render:e}};ct.isValidElement=i2;ct.lazy=function(e){return{$$typeof:vG,_payload:{_status:-1,_result:e},_init:SG}};ct.memo=function(e,t){return{$$typeof:bG,type:e,compare:t===void 0?null:t}};ct.startTransition=function(e){var t=A0.transition;A0.transition={};try{e()}finally{A0.transition=t}};ct.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ct.useCallback=function(e,t){return qr.current.useCallback(e,t)};ct.useContext=function(e){return qr.current.useContext(e)};ct.useDebugValue=function(){};ct.useDeferredValue=function(e){return qr.current.useDeferredValue(e)};ct.useEffect=function(e,t){return qr.current.useEffect(e,t)};ct.useId=function(){return qr.current.useId()};ct.useImperativeHandle=function(e,t,n){return qr.current.useImperativeHandle(e,t,n)};ct.useInsertionEffect=function(e,t){return qr.current.useInsertionEffect(e,t)};ct.useLayoutEffect=function(e,t){return qr.current.useLayoutEffect(e,t)};ct.useMemo=function(e,t){return qr.current.useMemo(e,t)};ct.useReducer=function(e,t,n){return qr.current.useReducer(e,t,n)};ct.useRef=function(e){return qr.current.useRef(e)};ct.useState=function(e){return qr.current.useState(e)};ct.useSyncExternalStore=function(e,t,n){return qr.current.useSyncExternalStore(e,t,n)};ct.useTransition=function(){return qr.current.useTransition()};ct.version="18.2.0";mM.exports=ct;var M=mM.exports;const Za=t2(M),v$=uG({__proto__:null,default:Za},[M]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CG=M,_G=Symbol.for("react.element"),TG=Symbol.for("react.fragment"),NG=Object.prototype.hasOwnProperty,EG=CG.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$G={key:!0,ref:!0,__self:!0,__source:!0};function SM(e,t,n){var r,a={},i=null,s=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)NG.call(t,r)&&!$G.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:_G,type:e,key:i,ref:s,props:a,_owner:EG.current}}Fv.Fragment=TG;Fv.jsx=SM;Fv.jsxs=SM;fM.exports=Fv;var z=fM.exports,Ss=e=>typeof e=="number",IM=e=>Object.prototype.toString.call(e)==="[object String]",Dv=e=>typeof e>"u"&&e===void 0,AG=e=>e===null,nr=e=>e!==null&&(typeof e=="object"||typeof e=="function")&&!lt(e),lt=e=>Array.isArray(e),Ql=e=>typeof e=="function",RG=e=>/[0-9].*[px|rem|em|%|vw|vh]$/.test(e);function Ml(e,t,n){return Math.min(Math.max(e,n),t)}class FG extends Error{constructor(t){super(`Failed to parse color: "${t}"`)}}var If=FG;function um(e){if(typeof e!="string")throw new If(e);if(e.trim().toLowerCase()==="transparent")return[0,0,0,0];let t=e.trim();t=WG.test(e)?OG(e):e;const n=PG.exec(t);if(n){const s=Array.from(n).slice(1);return[...s.slice(0,3).map(o=>parseInt(cm(o,2),16)),parseInt(cm(s[3]||"f",2),16)/255]}const r=zG.exec(t);if(r){const s=Array.from(r).slice(1);return[...s.slice(0,3).map(o=>parseInt(o,16)),parseInt(s[3]||"ff",16)/255]}const a=LG.exec(t);if(a){const s=Array.from(a).slice(1);return[...s.slice(0,3).map(o=>parseInt(o,10)),parseFloat(s[3]||"1")]}const i=BG.exec(t);if(i){const[s,o,l,c]=Array.from(i).slice(1).map(parseFloat);if(Ml(0,100,o)!==o)throw new If(e);if(Ml(0,100,l)!==l)throw new If(e);return[...VG(s,o,l),Number.isNaN(c)?1:c]}throw new If(e)}function DG(e){let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return(t>>>0)%2341}const x$=e=>parseInt(e.replace(/_/g,""),36),MG="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((e,t)=>{const n=x$(t.substring(0,3)),r=x$(t.substring(3)).toString(16);let a="";for(let i=0;i<6-r.length;i++)a+="0";return e[n]=`${a}${r}`,e},{});function OG(e){const t=e.toLowerCase().trim(),n=MG[DG(t)];if(!n)throw new If(e);return`#${n}`}const cm=(e,t)=>Array.from(Array(t)).map(()=>e).join(""),PG=new RegExp(`^#${cm("([a-f0-9])",3)}([a-f0-9])?$`,"i"),zG=new RegExp(`^#${cm("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),LG=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${cm(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),BG=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,WG=/^[a-z]+$/i,w$=e=>Math.round(e*255),VG=(e,t,n)=>{let r=n/100;if(t===0)return[r,r,r].map(w$);const a=(e%360+360)%360/60,i=(1-Math.abs(2*r-1))*(t/100),s=i*(1-Math.abs(a%2-1));let o=0,l=0,c=0;a>=0&&a<1?(o=i,l=s):a>=1&&a<2?(o=s,l=i):a>=2&&a<3?(l=i,c=s):a>=3&&a<4?(l=s,c=i):a>=4&&a<5?(o=s,c=i):a>=5&&a<6&&(o=i,c=s);const u=r-i/2,d=o+u,p=l+u,h=c+u;return[d,p,h].map(w$)};function CM(e,t,n,r){return`rgba(${Ml(0,255,e).toFixed()}, ${Ml(0,255,t).toFixed()}, ${Ml(0,255,n).toFixed()}, ${parseFloat(Ml(0,1,r).toFixed(3))})`}function _M(e,t,n){const r=(w,S)=>S===3?w:w/255,[a,i,s,o]=um(e).map(r),[l,c,u,d]=um(t).map(r),p=d-o,h=n*2-1,m=((h*p===-1?h:h+p/(1+h*p))+1)/2,g=1-m,y=(a*g+l*m)*255,b=(i*g+c*m)*255,v=(s*g+u*m)*255,x=d*n+o*(1-n);return CM(y,b,v,x)}function UG(e,t){const[n,r,a,i]=um(e);return CM(n,r,a,i-t)}function lb(e){const[t,n,r,a]=um(e);let i=s=>{const o=Ml(0,255,s).toString(16);return o.length===1?`0${o}`:o};return`#${i(t)}${i(n)}${i(r)}${a<1?i(Math.round(a*255)):""}`}var k$=()=>{},na=(e,...t)=>Ql(e)?e(...t):e,$o=(...e)=>t=>{e.some(n=>(n==null||n(t),t==null?void 0:t.defaultPrevented))},Iu=({strict:e=!0,errorMessage:t="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:n}={})=>{const r=M.createContext(void 0);r.displayName=n;const a=()=>{var i;const s=M.useContext(r);if(!s&&e){const o=new Error(t);throw o.name="ContextError",(i=Error.captureStackTrace)==null||i.call(Error,o,a),o}return s};return[r.Provider,a,r]},dm=globalThis!=null&&globalThis.document?M.useLayoutEffect:M.useEffect,TM=e=>M.Children.toArray(e).filter(t=>M.isValidElement(t)),jG=e=>M.isValidElement(e)||IM(e)||Ss(e),Od=(e,...t)=>e.find(n=>t.some(r=>n.type===r))?e.sort((n,r)=>t.some(a=>n.type===a)?-1:t.some(a=>r.type===a)?1:0):[void 0,...e],HG=(e,...t)=>e.filter(n=>t.every(r=>n.type!==r)),GG=(e,...t)=>e.filter(n=>t.every(r=>n.type===r)),ut=(...e)=>e.filter(Boolean).join(" "),Tl=(e,t)=>{if(e!=null){if(typeof e=="function"){e(t);return}try{e.current=t}catch{throw new Error(`Cannot assign value '${t}' to ref '${e}'`)}}},qG=(...e)=>t=>{e.forEach(n=>{Tl(n,t)})},KG=(...e)=>M.useMemo(()=>qG(...e),[e]),R0=(e,t=[])=>{const n=M.useRef(e);return M.useEffect(()=>{n.current=e}),M.useCallback((...r)=>{var a;return(a=n.current)==null?void 0:a.call(n,...r)},t)},Pd=(e,t)=>{const n=M.useRef(!1),r=M.useRef(!1);M.useEffect(()=>{if(n.current&&r.current)return e();r.current=!0},t),M.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[])},XG=e=>`${e}-${new Date().getTime()}`,YG=[50,100,200,300,400,500,600,700,800,900,950],Be=e=>e==="gray"||e==="neutral",Zn=e=>e==="yellow"||e==="cyan"||e==="lime",_e=(e,t)=>(n={},r)=>{var a,i,s;const[o,l]=e.split("."),[,c]=(s=Object.entries((i=(a=n.semantics)==null?void 0:a.colorSchemes)!=null?i:{}).find(([d])=>o===d))!=null?s:[];c&&(e=`${c}.${l}`);const u=Ue(n,`colors.${e}`,e);try{return lt(u)?lb(String(r!=="dark"?u[0]:u[1])):lb(String(u))}catch{return t??"#000000"}},vn=(e,t)=>(n,r)=>{const a=_e(e,e)(n,r);return lb(_M(a,"#fff",t/100))},ln=(e,t)=>(n,r)=>{const a=_e(e,e)(n,r);return lb(_M(a,"#000",t/100))},wa=(e,t)=>(n,r)=>{const a=_e(e,e)(n,r);return UG(a,1-t)},ZG=({string:e,colors:t}={})=>{const n=QG();return e&&t?e8(e,t):e&&!t?JG(e):t&&!e?t8(t):n},QG=()=>`#${Math.floor(Math.random()*16777215).toString(16).padEnd(6,"0")}`,JG=e=>{let t=0;if(e.length===0)return t.toString();for(let r=0;r<e.length;r+=1)t=e.charCodeAt(r)+((t<<5)-t),t=t&t;let n="#";for(let r=0;r<3;r+=1){const a=t>>r*8&255;n+=`00${a.toString(16)}`.substr(-2)}return n},e8=(e,t)=>{let n=0;if(e.length===0)return t[0];for(let r=0;r<e.length;r+=1)n=e.charCodeAt(r)+((n<<5)-n),n=n&n;return n=(n%t.length+t.length)%t.length,t[n]},t8=e=>e[Math.floor(Math.random()*e.length)],n8=e=>{const[t,n,r]=um(e);return(t*299+n*587+r*114)/1e3},r8=e=>(t,n)=>{const r=t?_e(e)(t,n):e;return n8(r)<128?"dark":"light"},a8=e=>(t,n)=>r8(e)(t,n)==="light",Xd=(e,t)=>{const n={};return Object.keys(e).forEach(r=>{t.includes(r)||(n[r]=e[r])}),n},ub=(e,t)=>{const n={};return t.forEach(r=>{r in e&&(n[r]=e[r])}),n},i8=(e,t)=>{const n={},r={};for(const[a,i]of Object.entries(e))t.includes(a)?n[a]=i:r[a]=i;return[n,r]},NM=(e,t)=>{const n={};return Object.entries(e).forEach(([r,a])=>{t(r,a,e)&&(n[r]=a)}),n},Mv=e=>NM(e,(t,n)=>n!=null),$n=(e,t,n=!1)=>{let r=Object.assign({},e);if(nr(t))if(nr(e))for(const[a,i]of Object.entries(t)){const s=e[a];n&&lt(i)&&lt(s)?r[a]=s.concat(...i):!Ql(i)&&nr(i)&&e.hasOwnProperty(a)?r[a]=$n(s,i,n):Object.assign(r,{[a]:i})}else r=t;return r},Ck=(e,t=1/0,n=[])=>!nr(e)&&!lt(e)||!t?e:Object.entries(e).reduce((r,[a,i])=>(nr(i)&&!Object.keys(i).some(s=>n.includes(s))?Object.entries(Ck(i,t-1,n)).forEach(([s,o])=>{r[`${a}.${s}`]=o}):r[a]=i,r),{}),s8=e=>e.reduce((t,[n,r])=>(t[n]=r,t),{}),_k=e=>Object.keys(e),o8=(e,t)=>lt(e)?e.map(t):nr(e)?Object.entries(e).reduce((n,[r,a])=>(n[r]=t(a),n),{}):t(e),l8=(e,t,n,r)=>{const a=typeof t=="string"?t.split("."):[t];for(r=0;r<a.length&&e;r+=1)e=e[a[r]];return e===void 0?n:e},u8=e=>{const t=new WeakMap;return(r,a,i,s)=>{if(typeof r>"u")return e(r,a,i);t.has(r)||t.set(r,new Map);const o=t.get(r);if(o.has(a))return o.get(a);const l=e(r,a,i,s);return o.set(a,l),l}},Ue=u8(l8),c8=(e,...t)=>{if(e==null)throw new TypeError("Cannot convert undefined or null to object");const n={...e};for(const r of t)if(r!=null)for(const a in r)Object.prototype.hasOwnProperty.call(r,a)&&(a in n&&delete n[a],n[a]=r[a]);return n},d8=e=>e.default||e,p8=(e,t="")=>e.replace(/\s+/g,t),Ov=(e,...t)=>t.join(` ${e} `).replace(/calc/g,""),S$=(...e)=>`calc(${Ov("+",...e)})`,I$=(...e)=>`calc(${Ov("-",...e)})`,Tk=(...e)=>`calc(${Ov("*",...e)})`,C$=(...e)=>`calc(${Ov("/",...e)})`,_$=e=>e!=null&&!isNaN(parseFloat(e.toString()))?String(e).startsWith("-")?String(e).slice(1):`-${e}`:Tk(e,-1),Nl=Object.assign(e=>({add:(...t)=>Nl(S$(e,...t)),subtract:(...t)=>Nl(I$(e,...t)),multiply:(...t)=>Nl(Tk(e,...t)),divide:(...t)=>Nl(C$(e,...t)),negate:()=>Nl(_$(e))}),{add:S$,subtract:I$,multiply:Tk,divide:C$,negate:_$}),s2=()=>!!(typeof window<"u"&&window.document&&window.document.createElement),ka=e=>e?"":void 0,Ly=e=>e?!0:void 0,h8={getDocument:()=>document,getWindow:()=>window},f8=M.createContext(h8),EM=({children:e,environment:t,disabled:n})=>{const r=M.useRef(null),a=M.useMemo(()=>t||{getDocument:()=>{var s,o;return(o=(s=r.current)==null?void 0:s.ownerDocument)!=null?o:document},getWindow:()=>{var s,o;return(o=(s=r.current)==null?void 0:s.ownerDocument.defaultView)!=null?o:window}},[t]),i=!n||!t;return z.jsxs(f8.Provider,{value:a,children:[e,i?z.jsx("span",{id:"__ui_dev",hidden:!0,ref:r}):null]})};EM.displayName="EnvironmentProvider";var m8=typeof Element<"u",g8=typeof Map=="function",y8=typeof Set=="function",b8=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function F0(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,r,a;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!F0(e[r],t[r]))return!1;return!0}var i;if(g8&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i=e.entries();!(r=i.next()).done;)if(!t.has(r.value[0]))return!1;for(i=e.entries();!(r=i.next()).done;)if(!F0(r.value[1],t.get(r.value[0])))return!1;return!0}if(y8&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i=e.entries();!(r=i.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(b8&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof t.valueOf=="function")return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof t.toString=="function")return e.toString()===t.toString();if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,a[r]))return!1;if(m8&&e instanceof Element)return!1;for(r=n;r--!==0;)if(!((a[r]==="_owner"||a[r]==="__v"||a[r]==="__o")&&e.$$typeof)&&!F0(e[a[r]],t[a[r]]))return!1;return!0}return e!==e&&t!==t}var v8=function(t,n){try{return F0(t,n)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}};const T$=t2(v8);function x8(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function w8(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var $M=function(){function e(n){var r=this;this._insertTag=function(a){var i;r.tags.length===0?r.insertionPoint?i=r.insertionPoint.nextSibling:r.prepend?i=r.container.firstChild:i=r.before:i=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(a,i),r.tags.push(a)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(r){r.forEach(this._insertTag)},t.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(w8(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var i=x8(a);try{i.insertRule(r,i.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(r));this.ctr++},t.flush=function(){this.tags.forEach(function(r){return r.parentNode&&r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},e}(),br="-ms-",cb="-moz-",wt="-webkit-",AM="comm",o2="rule",l2="decl",k8="@import",RM="@keyframes",S8="@layer",I8=Math.abs,Pv=String.fromCharCode,C8=Object.assign;function _8(e,t){return cr(e,0)^45?(((t<<2^cr(e,0))<<2^cr(e,1))<<2^cr(e,2))<<2^cr(e,3):0}function FM(e){return e.trim()}function T8(e,t){return(e=t.exec(e))?e[0]:e}function kt(e,t,n){return e.replace(t,n)}function Nk(e,t){return e.indexOf(t)}function cr(e,t){return e.charCodeAt(t)|0}function pm(e,t,n){return e.slice(t,n)}function Oi(e){return e.length}function u2(e){return e.length}function By(e,t){return t.push(e),e}function N8(e,t){return e.map(t).join("")}var zv=1,Yd=1,DM=0,ca=0,Nn=0,Ep="";function Lv(e,t,n,r,a,i,s){return{value:e,root:t,parent:n,type:r,props:a,children:i,line:zv,column:Yd,length:s,return:""}}function lf(e,t){return C8(Lv("",null,null,"",null,null,0),e,{length:-e.length},t)}function E8(){return Nn}function $8(){return Nn=ca>0?cr(Ep,--ca):0,Yd--,Nn===10&&(Yd=1,zv--),Nn}function Na(){return Nn=ca<DM?cr(Ep,ca++):0,Yd++,Nn===10&&(Yd=1,zv++),Nn}function ji(){return cr(Ep,ca)}function D0(){return ca}function ig(e,t){return pm(Ep,e,t)}function hm(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function MM(e){return zv=Yd=1,DM=Oi(Ep=e),ca=0,[]}function OM(e){return Ep="",e}function M0(e){return FM(ig(ca-1,Ek(e===91?e+2:e===40?e+1:e)))}function A8(e){for(;(Nn=ji())&&Nn<33;)Na();return hm(e)>2||hm(Nn)>3?"":" "}function R8(e,t){for(;--t&&Na()&&!(Nn<48||Nn>102||Nn>57&&Nn<65||Nn>70&&Nn<97););return ig(e,D0()+(t<6&&ji()==32&&Na()==32))}function Ek(e){for(;Na();)switch(Nn){case e:return ca;case 34:case 39:e!==34&&e!==39&&Ek(Nn);break;case 40:e===41&&Ek(e);break;case 92:Na();break}return ca}function F8(e,t){for(;Na()&&e+Nn!==47+10;)if(e+Nn===42+42&&ji()===47)break;return"/*"+ig(t,ca-1)+"*"+Pv(e===47?e:Na())}function D8(e){for(;!hm(ji());)Na();return ig(e,ca)}function M8(e){return OM(O0("",null,null,null,[""],e=MM(e),0,[0],e))}function O0(e,t,n,r,a,i,s,o,l){for(var c=0,u=0,d=s,p=0,h=0,f=0,m=1,g=1,y=1,b=0,v="",x=a,w=i,S=r,C=v;g;)switch(f=b,b=Na()){case 40:if(f!=108&&cr(C,d-1)==58){Nk(C+=kt(M0(b),"&","&\f"),"&\f")!=-1&&(y=-1);break}case 34:case 39:case 91:C+=M0(b);break;case 9:case 10:case 13:case 32:C+=A8(f);break;case 92:C+=R8(D0()-1,7);continue;case 47:switch(ji()){case 42:case 47:By(O8(F8(Na(),D0()),t,n),l);break;default:C+="/"}break;case 123*m:o[c++]=Oi(C)*y;case 125*m:case 59:case 0:switch(b){case 0:case 125:g=0;case 59+u:y==-1&&(C=kt(C,/\f/g,"")),h>0&&Oi(C)-d&&By(h>32?E$(C+";",r,n,d-1):E$(kt(C," ","")+";",r,n,d-2),l);break;case 59:C+=";";default:if(By(S=N$(C,t,n,c,u,a,o,v,x=[],w=[],d),i),b===123)if(u===0)O0(C,t,S,S,x,i,d,o,w);else switch(p===99&&cr(C,3)===110?100:p){case 100:case 108:case 109:case 115:O0(e,S,S,r&&By(N$(e,S,S,0,0,a,o,v,a,x=[],d),w),a,w,d,o,r?x:w);break;default:O0(C,S,S,S,[""],w,0,o,w)}}c=u=h=0,m=y=1,v=C="",d=s;break;case 58:d=1+Oi(C),h=f;default:if(m<1){if(b==123)--m;else if(b==125&&m++==0&&$8()==125)continue}switch(C+=Pv(b),b*m){case 38:y=u>0?1:(C+="\f",-1);break;case 44:o[c++]=(Oi(C)-1)*y,y=1;break;case 64:ji()===45&&(C+=M0(Na())),p=ji(),u=d=Oi(v=C+=D8(D0())),b++;break;case 45:f===45&&Oi(C)==2&&(m=0)}}return i}function N$(e,t,n,r,a,i,s,o,l,c,u){for(var d=a-1,p=a===0?i:[""],h=u2(p),f=0,m=0,g=0;f<r;++f)for(var y=0,b=pm(e,d+1,d=I8(m=s[f])),v=e;y<h;++y)(v=FM(m>0?p[y]+" "+b:kt(b,/&\f/g,p[y])))&&(l[g++]=v);return Lv(e,t,n,a===0?o2:o,l,c,u)}function O8(e,t,n){return Lv(e,t,n,AM,Pv(E8()),pm(e,2,-2),0)}function E$(e,t,n,r){return Lv(e,t,n,l2,pm(e,0,r),pm(e,r+1,-1),r)}function zd(e,t){for(var n="",r=u2(e),a=0;a<r;a++)n+=t(e[a],a,e,t)||"";return n}function P8(e,t,n,r){switch(e.type){case S8:if(e.children.length)break;case k8:case l2:return e.return=e.return||e.value;case AM:return"";case RM:return e.return=e.value+"{"+zd(e.children,r)+"}";case o2:e.value=e.props.join(",")}return Oi(n=zd(e.children,r))?e.return=e.value+"{"+n+"}":""}function z8(e){var t=u2(e);return function(n,r,a,i){for(var s="",o=0;o<t;o++)s+=e[o](n,r,a,i)||"";return s}}function L8(e){return function(t){t.root||(t=t.return)&&e(t)}}var $$=function(t){var n=new WeakMap;return function(r){if(n.has(r))return n.get(r);var a=t(r);return n.set(r,a),a}};function PM(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var B8=function(t,n,r){for(var a=0,i=0;a=i,i=ji(),a===38&&i===12&&(n[r]=1),!hm(i);)Na();return ig(t,ca)},W8=function(t,n){var r=-1,a=44;do switch(hm(a)){case 0:a===38&&ji()===12&&(n[r]=1),t[r]+=B8(ca-1,n,r);break;case 2:t[r]+=M0(a);break;case 4:if(a===44){t[++r]=ji()===58?"&\f":"",n[r]=t[r].length;break}default:t[r]+=Pv(a)}while(a=Na());return t},V8=function(t,n){return OM(W8(MM(t),n))},A$=new WeakMap,U8=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var n=t.value,r=t.parent,a=t.column===r.column&&t.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!A$.get(r))&&!a){A$.set(t,!0);for(var i=[],s=V8(n,i),o=r.props,l=0,c=0;l<s.length;l++)for(var u=0;u<o.length;u++,c++)t.props[c]=i[l]?s[l].replace(/&\f/g,o[u]):o[u]+" "+s[l]}}},j8=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}};function zM(e,t){switch(_8(e,t)){case 5103:return wt+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return wt+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return wt+e+cb+e+br+e+e;case 6828:case 4268:return wt+e+br+e+e;case 6165:return wt+e+br+"flex-"+e+e;case 5187:return wt+e+kt(e,/(\w+).+(:[^]+)/,wt+"box-$1$2"+br+"flex-$1$2")+e;case 5443:return wt+e+br+"flex-item-"+kt(e,/flex-|-self/,"")+e;case 4675:return wt+e+br+"flex-line-pack"+kt(e,/align-content|flex-|-self/,"")+e;case 5548:return wt+e+br+kt(e,"shrink","negative")+e;case 5292:return wt+e+br+kt(e,"basis","preferred-size")+e;case 6060:return wt+"box-"+kt(e,"-grow","")+wt+e+br+kt(e,"grow","positive")+e;case 4554:return wt+kt(e,/([^-])(transform)/g,"$1"+wt+"$2")+e;case 6187:return kt(kt(kt(e,/(zoom-|grab)/,wt+"$1"),/(image-set)/,wt+"$1"),e,"")+e;case 5495:case 3959:return kt(e,/(image-set\([^]*)/,wt+"$1$`$1");case 4968:return kt(kt(e,/(.+:)(flex-)?(.*)/,wt+"box-pack:$3"+br+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+wt+e+e;case 4095:case 3583:case 4068:case 2532:return kt(e,/(.+)-inline(.+)/,wt+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Oi(e)-1-t>6)switch(cr(e,t+1)){case 109:if(cr(e,t+4)!==45)break;case 102:return kt(e,/(.+:)(.+)-([^]+)/,"$1"+wt+"$2-$3$1"+cb+(cr(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~Nk(e,"stretch")?zM(kt(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(cr(e,t+1)!==115)break;case 6444:switch(cr(e,Oi(e)-3-(~Nk(e,"!important")&&10))){case 107:return kt(e,":",":"+wt)+e;case 101:return kt(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+wt+(cr(e,14)===45?"inline-":"")+"box$3$1"+wt+"$2$3$1"+br+"$2box$3")+e}break;case 5936:switch(cr(e,t+11)){case 114:return wt+e+br+kt(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return wt+e+br+kt(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return wt+e+br+kt(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return wt+e+br+e+e}return e}var H8=function(t,n,r,a){if(t.length>-1&&!t.return)switch(t.type){case l2:t.return=zM(t.value,t.length);break;case RM:return zd([lf(t,{value:kt(t.value,"@","@"+wt)})],a);case o2:if(t.length)return N8(t.props,function(i){switch(T8(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return zd([lf(t,{props:[kt(i,/:(read-\w+)/,":"+cb+"$1")]})],a);case"::placeholder":return zd([lf(t,{props:[kt(i,/:(plac\w+)/,":"+wt+"input-$1")]}),lf(t,{props:[kt(i,/:(plac\w+)/,":"+cb+"$1")]}),lf(t,{props:[kt(i,/:(plac\w+)/,br+"input-$1")]})],a)}return""})}},G8=[H8],q8=function(t){var n=t.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(m){var g=m.getAttribute("data-emotion");g.indexOf(" ")!==-1&&(document.head.appendChild(m),m.setAttribute("data-s",""))})}var a=t.stylisPlugins||G8,i={},s,o=[];s=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(m){for(var g=m.getAttribute("data-emotion").split(" "),y=1;y<g.length;y++)i[g[y]]=!0;o.push(m)});var l,c=[U8,j8];{var u,d=[P8,L8(function(m){u.insert(m)})],p=z8(c.concat(a,d)),h=function(g){return zd(M8(g),p)};l=function(g,y,b,v){u=b,h(g?g+"{"+y.styles+"}":y.styles),v&&(f.inserted[y.name]=!0)}}var f={key:n,sheet:new $M({key:n,container:s,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:i,registered:{},insert:l};return f.sheet.hydrate(o),f};function db(){return db=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},db.apply(this,arguments)}var LM={exports:{}},Rt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ir=typeof Symbol=="function"&&Symbol.for,c2=ir?Symbol.for("react.element"):60103,d2=ir?Symbol.for("react.portal"):60106,Bv=ir?Symbol.for("react.fragment"):60107,Wv=ir?Symbol.for("react.strict_mode"):60108,Vv=ir?Symbol.for("react.profiler"):60114,Uv=ir?Symbol.for("react.provider"):60109,jv=ir?Symbol.for("react.context"):60110,p2=ir?Symbol.for("react.async_mode"):60111,Hv=ir?Symbol.for("react.concurrent_mode"):60111,Gv=ir?Symbol.for("react.forward_ref"):60112,qv=ir?Symbol.for("react.suspense"):60113,K8=ir?Symbol.for("react.suspense_list"):60120,Kv=ir?Symbol.for("react.memo"):60115,Xv=ir?Symbol.for("react.lazy"):60116,X8=ir?Symbol.for("react.block"):60121,Y8=ir?Symbol.for("react.fundamental"):60117,Z8=ir?Symbol.for("react.responder"):60118,Q8=ir?Symbol.for("react.scope"):60119;function Ma(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case c2:switch(e=e.type,e){case p2:case Hv:case Bv:case Vv:case Wv:case qv:return e;default:switch(e=e&&e.$$typeof,e){case jv:case Gv:case Xv:case Kv:case Uv:return e;default:return t}}case d2:return t}}}function BM(e){return Ma(e)===Hv}Rt.AsyncMode=p2;Rt.ConcurrentMode=Hv;Rt.ContextConsumer=jv;Rt.ContextProvider=Uv;Rt.Element=c2;Rt.ForwardRef=Gv;Rt.Fragment=Bv;Rt.Lazy=Xv;Rt.Memo=Kv;Rt.Portal=d2;Rt.Profiler=Vv;Rt.StrictMode=Wv;Rt.Suspense=qv;Rt.isAsyncMode=function(e){return BM(e)||Ma(e)===p2};Rt.isConcurrentMode=BM;Rt.isContextConsumer=function(e){return Ma(e)===jv};Rt.isContextProvider=function(e){return Ma(e)===Uv};Rt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===c2};Rt.isForwardRef=function(e){return Ma(e)===Gv};Rt.isFragment=function(e){return Ma(e)===Bv};Rt.isLazy=function(e){return Ma(e)===Xv};Rt.isMemo=function(e){return Ma(e)===Kv};Rt.isPortal=function(e){return Ma(e)===d2};Rt.isProfiler=function(e){return Ma(e)===Vv};Rt.isStrictMode=function(e){return Ma(e)===Wv};Rt.isSuspense=function(e){return Ma(e)===qv};Rt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Bv||e===Hv||e===Vv||e===Wv||e===qv||e===K8||typeof e=="object"&&e!==null&&(e.$$typeof===Xv||e.$$typeof===Kv||e.$$typeof===Uv||e.$$typeof===jv||e.$$typeof===Gv||e.$$typeof===Y8||e.$$typeof===Z8||e.$$typeof===Q8||e.$$typeof===X8)};Rt.typeOf=Ma;LM.exports=Rt;var J8=LM.exports,WM=J8,e9={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},t9={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},VM={};VM[WM.ForwardRef]=e9;VM[WM.Memo]=t9;var n9=!0;function r9(e,t,n){var r="";return n.split(" ").forEach(function(a){e[a]!==void 0?t.push(e[a]+";"):r+=a+" "}),r}var UM=function(t,n,r){var a=t.key+"-"+n.name;(r===!1||n9===!1)&&t.registered[a]===void 0&&(t.registered[a]=n.styles)},jM=function(t,n,r){UM(t,n,r);var a=t.key+"-"+n.name;if(t.inserted[n.name]===void 0){var i=n;do t.insert(n===i?"."+a:"",i,t.sheet,!0),i=i.next;while(i!==void 0)}};function a9(e){for(var t=0,n,r=0,a=e.length;a>=4;++r,a-=4)n=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(a){case 3:t^=(e.charCodeAt(r+2)&255)<<16;case 2:t^=(e.charCodeAt(r+1)&255)<<8;case 1:t^=e.charCodeAt(r)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var i9={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},s9=/[A-Z]|^ms/g,o9=/_EMO_([^_]+?)_([^]*?)_EMO_/g,HM=function(t){return t.charCodeAt(1)===45},R$=function(t){return t!=null&&typeof t!="boolean"},cw=PM(function(e){return HM(e)?e:e.replace(s9,"-$&").toLowerCase()}),F$=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(o9,function(r,a,i){return Pi={name:a,styles:i,next:Pi},a})}return i9[t]!==1&&!HM(t)&&typeof n=="number"&&n!==0?n+"px":n};function fm(e,t,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return Pi={name:n.name,styles:n.styles,next:Pi},n.name;if(n.styles!==void 0){var r=n.next;if(r!==void 0)for(;r!==void 0;)Pi={name:r.name,styles:r.styles,next:Pi},r=r.next;var a=n.styles+";";return a}return l9(e,t,n)}case"function":{if(e!==void 0){var i=Pi,s=n(e);return Pi=i,fm(e,t,s)}break}}if(t==null)return n;var o=t[n];return o!==void 0?o:n}function l9(e,t,n){var r="";if(Array.isArray(n))for(var a=0;a<n.length;a++)r+=fm(e,t,n[a])+";";else for(var i in n){var s=n[i];if(typeof s!="object")t!=null&&t[s]!==void 0?r+=i+"{"+t[s]+"}":R$(s)&&(r+=cw(i)+":"+F$(i,s)+";");else if(Array.isArray(s)&&typeof s[0]=="string"&&(t==null||t[s[0]]===void 0))for(var o=0;o<s.length;o++)R$(s[o])&&(r+=cw(i)+":"+F$(i,s[o])+";");else{var l=fm(e,t,s);switch(i){case"animation":case"animationName":{r+=cw(i)+":"+l+";";break}default:r+=i+"{"+l+"}"}}}return r}var D$=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Pi,h2=function(t,n,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var a=!0,i="";Pi=void 0;var s=t[0];s==null||s.raw===void 0?(a=!1,i+=fm(r,n,s)):i+=s[0];for(var o=1;o<t.length;o++)i+=fm(r,n,t[o]),a&&(i+=s[o]);D$.lastIndex=0;for(var l="",c;(c=D$.exec(i))!==null;)l+="-"+c[1];var u=a9(i)+l;return{name:u,styles:i,next:Pi}},u9=function(t){return t()},GM=v$["useInsertionEffect"]?v$["useInsertionEffect"]:!1,c9=GM||u9,M$=GM||M.useLayoutEffect,qM=M.createContext(typeof HTMLElement<"u"?q8({key:"css"}):null);qM.Provider;var KM=function(t){return M.forwardRef(function(n,r){var a=M.useContext(qM);return t(n,a,r)})},mm=M.createContext({}),d9=function(t,n){if(typeof n=="function"){var r=n(t);return r}return db({},t,n)},p9=$$(function(e){return $$(function(t){return d9(e,t)})}),h9=function(t){var n=M.useContext(mm);return t.theme!==n&&(n=p9(n)(t.theme)),M.createElement(mm.Provider,{value:n},t.children)},f2=KM(function(e,t){var n=e.styles,r=h2([n],void 0,M.useContext(mm)),a=M.useRef();return M$(function(){var i=t.key+"-global",s=new t.sheet.constructor({key:i,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),o=!1,l=document.querySelector('style[data-emotion="'+i+" "+r.name+'"]');return t.sheet.tags.length&&(s.before=t.sheet.tags[0]),l!==null&&(o=!0,l.setAttribute("data-emotion",i),s.hydrate([l])),a.current=[s,o],function(){s.flush()}},[t]),M$(function(){var i=a.current,s=i[0],o=i[1];if(o){i[1]=!1;return}if(r.next!==void 0&&jM(t,r.next,!0),s.tags.length){var l=s.tags[s.tags.length-1].nextElementSibling;s.before=l,s.flush()}t.insert("",r,s,!1)},[t,r.name]),null});function f9(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return h2(t)}var m9=function(){var t=f9.apply(void 0,arguments),n="animation-"+t.name;return{name:n,styles:"@keyframes "+n+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},g9=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,y9=PM(function(e){return g9.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),b9=y9,v9=function(t){return t!=="theme"},O$=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?b9:v9},P$=function(t,n,r){var a;if(n){var i=n.shouldForwardProp;a=t.__emotion_forwardProp&&i?function(s){return t.__emotion_forwardProp(s)&&i(s)}:i}return typeof a!="function"&&r&&(a=t.__emotion_forwardProp),a},x9=function(t){var n=t.cache,r=t.serialized,a=t.isStringTag;return UM(n,r,a),c9(function(){return jM(n,r,a)}),null},w9=function e(t,n){var r=t.__emotion_real===t,a=r&&t.__emotion_base||t,i,s;n!==void 0&&(i=n.label,s=n.target);var o=P$(t,n,r),l=o||O$(a),c=!l("as");return function(){var u=arguments,d=r&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(i!==void 0&&d.push("label:"+i+";"),u[0]==null||u[0].raw===void 0)d.push.apply(d,u);else{d.push(u[0][0]);for(var p=u.length,h=1;h<p;h++)d.push(u[h],u[0][h])}var f=KM(function(m,g,y){var b=c&&m.as||a,v="",x=[],w=m;if(m.theme==null){w={};for(var S in m)w[S]=m[S];w.theme=M.useContext(mm)}typeof m.className=="string"?v=r9(g.registered,x,m.className):m.className!=null&&(v=m.className+" ");var C=h2(d.concat(x),g.registered,w);v+=g.key+"-"+C.name,s!==void 0&&(v+=" "+s);var T=c&&o===void 0?O$(b):l,E={};for(var R in m)c&&R==="as"||T(R)&&(E[R]=m[R]);return E.className=v,E.ref=y,M.createElement(M.Fragment,null,M.createElement(x9,{cache:g,serialized:C,isStringTag:typeof b=="string"}),M.createElement(b,E))});return f.displayName=i!==void 0?i:"Styled("+(typeof a=="string"?a:a.displayName||a.name||"Component")+")",f.defaultProps=t.defaultProps,f.__emotion_real=f,f.__emotion_base=a,f.__emotion_styles=d,f.__emotion_forwardProp=o,Object.defineProperty(f,"toString",{value:function(){return"."+s}}),f.withComponent=function(m,g){return e(m,db({},n,g,{shouldForwardProp:P$(f,g,!0)})).apply(void 0,d)},f}},k9=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],$k=w9.bind();k9.forEach(function(e){$k[e]=$k(e)});var dt=e=>M.forwardRef(e),dw=(e,t)=>{const n=["@media screen"];return e&&n.push("and",`(min-width: ${e}px)`),t&&n.push("and",`(max-width: ${t}px)`),n.length>1?n.join(" "):void 0},S9=e=>Object.entries(e).map(([t,n],r,a)=>{var i;let[,s]=(i=a[r-1])!=null?i:[];return n=t!=="base"?n:void 0,s&&(s+=1),{breakpoint:t,minW:s,maxW:n,maxWQuery:dw(void 0,n),minWQuery:dw(s),minMaxQuery:dw(s,n)}}),I9=e=>{const n=s2()?parseFloat(window.getComputedStyle(document.documentElement).fontSize):16;return Object.fromEntries(Object.entries(e).map(([r,a])=>a.includes("px")?(a=parseFloat(a),[r,a]):(a=parseFloat(a),a=a*n,[r,a])).sort((r,a)=>r[1]-a[1]))},C9=e=>{if(!e)return;e.base="9999px",e=I9(e);const t=_k(e),n=S9(e);return{keys:t,isResponsive:r=>{const a=Object.keys(r);return a.length>0&&a.every(i=>t.includes(i))},queries:n}},z$=s2()?new $M({key:"css",container:document.head}):void 0,Ak={"to-t":"to top","to-tr":"to top right","to-r":"to right","to-br":"to bottom right","to-b":"to bottom","to-bl":"to bottom left","to-l":"to left","to-tl":"to top left"},L$=["rotate(var(--ui-rotate, 0))","scaleX(var(--ui-scale-x, 1))","scaleY(var(--ui-scale-y, 1))","skewX(var(--ui-skew-x, 0))","skewY(var(--ui-skew-y, 0))"],_9=new Set(Object.values(Ak)),m2=new Set(["none","-moz-initial","inherit","initial","revert","unset"]),Rk=e=>IM(e)&&e.includes("(")&&e.includes(")"),T9=e=>/^var\(--.+\)$/.test(e),N9=e=>{let t=parseFloat(e.toString());const n=e.toString().replace(String(t),"");return{isUnitless:!n,value:e,unit:n}},Fk=(e,t)=>n=>{const r=`${e}.${t}`;return nr(n.__cssMap)&&r in n.__cssMap?n.__cssMap[r].ref:t},Dk=(e,t)=>{var n;if(e==null||m2.has(e))return e;if(!Rk(e))return`url('${e}')`;const a=/(^[a-z-A-Z]+)\((.*)\)/g,[,i,s]=(n=a.exec(e))!=null?n:[];if(!i||!s)return e;const o=i.includes("-gradient")?i:`${i}-gradient`,[l,...c]=s.split(",").map(p=>p.trim()).filter(Boolean);if(!c.length)return e;const u=l in Ak?Ak[l]:l;c.unshift(u);const d=c.map(p=>{if(_9.has(p))return p;const h=p.indexOf(" ");let[f,m]=h!==-1?[p.slice(0,h),p.slice(h+1)]:[p];const g=Rk(m)?m:m&&m.split(" "),y=`colors.${f}`;return f=y in t.__cssMap?t.__cssMap[y].ref:f,g?[f,...lt(g)?g:[g]].join(" "):f});return`${o}(${d.join(", ")})`},E9=e=>Object.entries(e).reduce((t,[n,r])=>(n==="duration"?t.animationDuration=r:n==="timingFunction"?t.animationTimingFunction=r:t[n]=r,t),{}),Mk=(e,t)=>{if(e==null||m2.has(e))return e;if(nr(e)){const{keyframes:n,animationDuration:r="0s",animationTimingFunction:a="ease",delay:i="0s",iterationCount:s="1",direction:o="normal",fillMode:l="none",playState:c="running"}=Yv(E9(e))(t),{name:u,styles:d}=m9(n);return z$==null||z$.insert(d),`${u} ${r} ${a} ${i} ${s} ${o} ${l} ${c}`}else return e.includes(",")?(e=e.split(",").map(n=>(n=n.trim(),n=Fk("animations",n)(t),n)).join(","),e):(e=Fk("animations",e)(t),e)},$9=e=>e==="auto"?["translateX(var(--ui-translate-x, 0))","translateY(var(--ui-translate-y, 0))",...L$].join(" "):e==="auto-3d"?["translate3d(var(--ui-translate-x, 0), var(--ui-translate-y, 0), 0)",...L$].join(" "):e,A9=(e="filter")=>t=>t!=="auto"?t:e==="filter"?["var(--ui-blur, /*!*/ /*!*/)","var(--ui-brightness, /*!*/ /*!*/)","var(--ui-contrast, /*!*/ /*!*/)","var(--ui-drop-shadow, /*!*/ /*!*/)","var(--ui-grayscale, /*!*/ /*!*/)","var(--ui-hue-rotate, /*!*/ /*!*/)","var(--ui-invert, /*!*/ /*!*/)","var(--ui-opacity, /*!*/ /*!*/)","var(--ui-saturate, /*!*/ /*!*/)","var(--ui-sepia, /*!*/ /*!*/)"].join(" "):["var(--ui-backdrop-blur, /*!*/ /*!*/)","var(--ui-backdrop-brightness, /*!*/ /*!*/)","var(--ui-backdrop-contrast, /*!*/ /*!*/)","var(--ui-backdrop-drop-shadow, /*!*/ /*!*/)","var(--ui-backdrop-grayscale, /*!*/ /*!*/)","var(--ui-backdrop-hue-rotate, /*!*/ /*!*/)","var(--ui-backdrop-invert, /*!*/ /*!*/)","var(--ui-backdrop-opacity, /*!*/ /*!*/)","var(--ui-backdrop-saturate, /*!*/ /*!*/)","var(--ui-backdrop-sepia, /*!*/ /*!*/)"].join(" "),sn=(e,t)=>(n="light")=>n==="light"?e:t,XM=({token:e,transform:t,compose:n})=>(r,a)=>{var i;r=Fk(e,r)(a);let s=(i=t==null?void 0:t(r,a))!=null?i:r;return n&&(s=n(s,a)),s},ds=(e,t)=>n=>({token:e,properties:n,transform:XM({token:e,transform:t})}),ht={px:e=>{if(e==null)return e;const{isUnitless:t}=N9(e);return t||Ss(e)?`${e}px`:e},deg:e=>T9(e)||e==null?e:typeof e=="string"&&!e.endsWith("deg")||Ss(e)?`${e}deg`:e,fraction:e=>Ss(e)&&e<=1?`${e*100}%`:e,isTruncated:e=>{if(e===!0)return{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},bgClip:e=>e==="text"?{color:"transparent",backgroundClip:"text"}:{backgroundClip:e},bgImage:e=>e==null?e:!Rk(e)&&!m2.has(e)?`url(${e})`:e,function:(e,t)=>(n,...r)=>(t&&(n=t(n,...r)),`${e}(${n})`),gradient:Dk,animation:Mk,transform:$9,filter:A9},ee={color:ds("colors"),space:ds("spaces",ht.px),radii:ds("radii",ht.px),shadow:ds("shadows"),border:ds("borders"),size:ds("sizes",ht.px),sizeTransform:ds("sizes",ht.fraction),prop:(e,t,n)=>t?{properties:e,token:t,transform:XM({token:t,transform:n})}:{properties:e,token:t},propTransform:(e,t)=>({properties:e,transform:t}),gradient:ds("gradients",ht.gradient),blur:ds("blurs",ht.function("blur"))},Ao={_hover:"&:hover, &[data-hover]",_nativeHover:"&:hover",_active:"&:active, &[data-active]",_nativeActive:"&:active",_focus:"&:focus, &[data-focus]",_nativeFocus:"&:focus",_focusVisible:"&:focus-visible, &[data-focus-visible]",_nativeFocusVisible:"&:focus-visible",_disabled:"&:disabled, &[disabled], &[aria-disabled=true], &[data-disabled]",_readOnly:"&[readonly], &[aria-readonly=true], &[data-readonly]",_indeterminate:"&:indeterminate, &[aria-checked=mixed], &[data-indeterminate]",_before:"&::before",_after:"&::after",_empty:"&:empty",_expanded:"&[aria-expanded=true], &[data-expanded]",_checked:"&:checked, &[data-checked], &[aria-checked=true]",_invalid:"&[data-invalid], &[aria-invalid=true]",_valid:"&:valid, &[data-valid], &[data-state=valid]",_selected:"&[aria-selected=true], &[data-selected]",_hidden:"&[hidden], &[data-hidden]",_visited:"&:visited",_placeholder:"&::placeholder, &[data-placeholder]",_placeholderShown:"&:placeholder-shown",_fullScreen:"&:fullscreen",_selection:"&::selection",_even:"&:nth-of-type(even)",_odd:"&:nth-of-type(odd)",_first:"&:first-of-type",_last:"&:last-of-type",_notFirst:"&:not(:first-of-type)",_notLast:"&:not(:last-of-type)",_autofill:"&:-webkit-autofill",_outside:"&[data-outside]",_weekend:"&[data-weekend]",_holiday:"&[data-holiday]",_today:"&[data-today]",_accept:"&[data-accept]",_reject:"&[data-reject]",_idle:"&[data-idle]",_loading:"&[data-loading]",_loaded:"&[data-loaded]",_ripple:"& .ui-ripple",_vertical:"&:vertical, &[data-orientation=vertical]",_horizontal:"&:horizontal, &[data-orientation=horizontal]",_scrollbar:"&::-webkit-scrollbar",_scrollbarTrack:"&::-webkit-scrollbar-track",_scrollbarTrackPiece:"&::-webkit-scrollbar-track-piece",_scrollbarThumb:"&::-webkit-scrollbar-thumb",_scrollbarButton:"&::-webkit-scrollbar-button",_scrollbarCorner:"&::-webkit-scrollbar-corner",_mediaDark:"@media (prefers-color-scheme: dark)",_mediaReduceMotion:"@media (prefers-reduced-motion: reduce)",_dark:".ui-dark &:not([data-mode]), [data-mode=dark] &:not([data-mode]), &[data-mode=dark]",_light:".ui-light &:not([data-mode]), [data-mode=light] &:not([data-mode]), &[data-mode=light]"},R9=Object.keys(Ao),P0={background:ee.color("background"),backgroundColor:ee.color("backgroundColor"),backgroundImage:ee.gradient("backgroundImage"),backgroundSize:!0,backgroundOrigin:!0,backgroundPosition:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0,backgroundAttachment:!0,backgroundClip:{transform:ht.bgClip},bgSize:ee.prop("backgroundSize"),bgOrigin:ee.prop("backgroundOrigin"),bgPosition:ee.prop("backgroundPosition"),bgPositionX:ee.prop("backgroundPositionX"),bgPositionY:ee.prop("backgroundPositionY"),bg:ee.color("background"),bgColor:ee.color("backgroundColor"),bgPos:ee.prop("backgroundPosition"),bgPosX:ee.prop("backgroundPositionX"),bgPosY:ee.prop("backgroundPositionY"),bgRepeat:ee.prop("backgroundRepeat"),bgAttachment:ee.prop("backgroundAttachment"),bgGradient:ee.gradient("backgroundImage"),bgClip:{transform:ht.bgClip}};Object.assign(P0,{bgImage:P0.backgroundImage,bgImg:P0.backgroundImage});var xt={border:ee.border("border"),borderWidth:!0,borderStyle:!0,borderColor:ee.color("borderColor"),borderTop:ee.border("borderTop"),borderTopWidth:!0,borderTopStyle:!0,borderTopColor:ee.color("borderTopColor"),borderLeft:ee.border("borderLeft"),borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:ee.color("borderLeftColor"),borderBottom:ee.border("borderBottom"),borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:ee.color("borderBottomColor"),borderRight:ee.border("borderRight"),borderRightWidth:!0,borderRightStyle:!0,borderRightColor:ee.color("borderRightColor"),borderY:ee.border(["borderTop","borderBottom"]),borderX:ee.border(["borderLeft","borderRight"]),borderInline:ee.border("borderInline"),borderInlineStart:ee.border("borderInlineStart"),borderInlineStartWidth:ee.prop("borderInlineStartWidth"),borderInlineStartStyle:ee.prop("borderInlineStartStyle"),borderInlineStartColor:ee.color("borderInlineStartColor"),borderInlineEnd:ee.border("borderInlineEnd"),borderInlineEndWidth:ee.prop("borderInlineEndWidth"),borderInlineEndStyle:ee.prop("borderInlineEndStyle"),borderInlineEndColor:ee.color("borderInlineEndColor"),borderInlineWidth:!0,borderInlineStyle:!0,borderInlineColor:ee.color("borderInlineColor"),borderBlock:ee.border("borderBlock"),borderBlockStart:ee.border("borderBlockStart"),borderBlockStartWidth:!0,borderBlockStartStyle:!0,borderBlockStartColor:ee.color("borderBlockStartColor"),borderBlockEnd:ee.border("borderBlockEnd"),borderBlockEndWidth:!0,borderBlockEndStyle:!0,borderBlockEndColor:ee.color("borderBlockEndColor"),borderBlockWidth:!0,borderBlockStyle:!0,borderBlockColor:ee.color("borderBlockColor"),borderRadius:ee.radii("borderRadius"),borderTopRightRadius:ee.radii("borderTopRightRadius"),borderTopLeftRadius:ee.radii("borderTopLeftRadius"),borderBottomLeftRadius:ee.radii("borderBottomLeftRadius"),borderBottomRightRadius:ee.radii("borderBottomRightRadius"),borderTopRadius:ee.radii(["borderTopLeftRadius","borderTopRightRadius"]),borderBottomRadius:ee.radii(["borderBottomLeftRadius","borderBottomRightRadius"]),borderRightRadius:ee.radii(["borderTopRightRadius","borderBottomRightRadius"]),borderLeftRadius:ee.radii(["borderTopLeftRadius","borderBottomLeftRadius"]),borderStartStartRadius:ee.radii("borderStartStartRadius"),borderStartEndRadius:ee.radii("borderStartEndRadius"),borderEndStartRadius:ee.radii("borderEndStartRadius"),borderEndEndRadius:ee.radii("borderEndEndRadius"),borderInlineStartRadius:ee.radii(["borderStartStartRadius","borderStartEndRadius"]),borderInlineEndRadius:ee.radii(["borderEndStartRadius","borderEndEndRadius"]),borderImage:!0,borderImageOutset:!0,borderImageRepeat:!0,borderImageSlice:!0,borderImageSource:!0,borderImageWidth:!0,borderCollapse:!0,borderSpacing:!0};Object.assign(xt,{borderStart:xt.borderInlineStart,borderStartWidth:xt.borderInlineStartWidth,borderStartStyle:xt.borderInlineStartStyle,borderStartColor:xt.borderInlineStartColor,borderEnd:xt.borderInlineEnd,borderEndWidth:xt.borderInlineEndWidth,borderEndStyle:xt.borderInlineEndStyle,borderEndColor:xt.borderInlineEndColor,borderTopStartRadius:xt.borderStartStartRadius,borderTopEndRadius:xt.borderStartEndRadius,borderBottomStartRadius:xt.borderEndStartRadius,borderBottomEndRadius:xt.borderEndEndRadius,borderStartRadius:xt.borderInlineStartRadius,borderEndRadius:xt.borderInlineEndRadius,rounded:xt.borderRadius,roundedTopRight:xt.borderTopRightRadius,roundedTopLeft:xt.borderTopLeftRadius,roundedBottomLeft:xt.borderBottomLeftRadius,roundedBottomRight:xt.borderBottomRightRadius,roundedTop:xt.borderTopRadius,roundedBottom:xt.borderBottomRadius,roundedRight:xt.borderRightRadius,roundedLeft:xt.borderLeftRadius,roundedTopStart:xt.borderStartStartRadius,roundedTopEnd:xt.borderStartEndRadius,roundedBottomStart:xt.borderEndStartRadius,roundedBottomEnd:xt.borderEndEndRadius,roundedStart:xt.borderInlineStartRadius,roundedEnd:xt.borderInlineEndRadius});var F9={color:ee.color("color"),textColor:ee.color("color"),fill:ee.color("fill"),stroke:ee.color("stroke")},Ok={boxShadow:ee.shadow("boxShadow"),mixBlendMode:!0,blendMode:ee.prop("mixBlendMode"),backgroundBlendMode:!0,bgBlendMode:ee.prop("backgroundBlendMode"),opacity:!0};Object.assign(Ok,{shadow:Ok.boxShadow});var D9={filter:{transform:ht.filter()},blur:ee.blur("--ui-blur"),brightness:{properties:"--ui-brightness",transform:ht.function("brightness")},contrast:{properties:"--ui-contrast",transform:ht.function("contrast")},dropShadow:ee.prop("--ui-drop-shadow","shadows",ht.function("drop-shadow")),grayscale:{properties:"--ui-grayscale",transform:ht.function("grayscale")},hueRotate:{properties:"--ui-hue-rotate",transform:ht.function("hue-rotate",ht.deg)},invert:{properties:"--ui-invert",transform:ht.function("invert")},saturate:{properties:"--ui-saturate",transform:ht.function("saturate")},sepia:{properties:"--ui-sepia",transform:ht.function("sepia")},backdropFilter:{transform:ht.filter("backdrop")},backdropBlur:ee.blur("--ui-backdrop-blur"),backdropBrightness:{properties:"--ui-backdrop-brightness",transform:ht.function("brightness")},backdropContrast:{properties:"--ui-backdrop-contrast",transform:ht.function("contrast")},backdropDropShadow:ee.prop("--ui-backdrop-drop-shadow","shadows",ht.function("drop-shadow")),backdropGrayscale:{properties:"--ui-backdrop-grayscale",transform:ht.function("grayscale")},backdropHueRotate:{properties:"--ui-backdrop-hue-rotate",transform:ht.function("hue-rotate",ht.deg)},backdropInvert:{properties:"--ui-backdrop-invert",transform:ht.function("invert")},backdropSaturate:{properties:"--ui-backdrop-saturate",transform:ht.function("saturate")},backdropSepia:{properties:"--ui-backdrop-sepia",transform:ht.function("sepia")}},YM={alignItems:!0,alignContent:!0,justifyItems:!0,justifyContent:!0,flexWrap:!0,flexDirection:!0,flexDir:{properties:"flexDirection"},flex:!0,flexFlow:!0,flexGrow:!0,flexShrink:!0,flexBasis:ee.size("flexBasis"),justifySelf:!0,alignSelf:!0,order:!0,placeItems:!0,placeContent:!0,placeSelf:!0,gap:ee.space("gap"),rowGap:ee.space("rowGap"),columnGap:ee.space("columnGap")},ZM={gridGap:ee.space("gridGap"),gridColumnGap:ee.space("gridColumnGap"),gridRowGap:ee.space("gridRowGap"),gridColumn:!0,gridRow:!0,gridAutoFlow:!0,gridAutoColumns:!0,gridColumnStart:!0,gridColumnEnd:!0,gridRowStart:!0,gridRowEnd:!0,gridAutoRows:!0,gridTemplate:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridArea:!0},M9={accentColor:ee.color("accentColor"),appearance:!0,cursor:!0,resize:!0,userSelect:!0,pointerEvents:!0,outline:!0,outlineOffset:!0,outlineColor:ee.color("outlineColor")},ps={width:ee.sizeTransform("width"),inlineSize:ee.sizeTransform("inlineSize"),height:ee.size("height"),backfaceVisibility:!0,blockSize:ee.size("blockSize"),boxSize:ee.size(["width","height"]),minWidth:ee.size("minWidth"),minInlineSize:ee.size("minInlineSize"),minHeight:ee.size("minHeight"),minBlockSize:ee.size("minBlockSize"),maxWidth:ee.size("maxWidth"),maxInlineSize:ee.size("maxInlineSize"),maxHeight:ee.size("maxHeight"),maxBlockSize:ee.size("maxBlockSize"),overflow:!0,overflowX:!0,overflowY:!0,overscrollBehavior:!0,overscroll:{properties:"overscrollBehavior"},overscrollX:!0,textDecor:{properties:"overscrollBehaviorX"},overscrollBehaviorY:!0,overscrollY:{properties:"overscrollBehaviorY"},display:!0,aspectRatio:!0,verticalAlign:!0,boxSizing:!0,boxDecorationBreak:!0,float:!0,objectFit:!0,objectPosition:!0,visibility:!0,isolation:!0,breakAfter:!0,breakBefore:!0,breakInside:!0};Object.assign(ps,{w:ps.width,h:ps.height,minW:ps.minWidth,maxW:ps.maxWidth,minH:ps.minHeight,maxH:ps.maxHeight});var O9={listStyleType:!0,listStylePosition:!0,listStylePos:ee.prop("listStylePosition"),listStyleImage:!0,listStyleImg:ee.prop("listStyleImage")},pw=(e,t,n={})=>{const r={},a=Ue(t,`styles.${e}`,{});for(const i in a)i in n&&n[i]!=null||(r[i]=a[i]);return r},P9={all:!0,layerStyle:{isProcessResult:!0,transform:(e,...t)=>pw(`layerStyles.${e}`,...t)},textStyle:{isProcessResult:!0,transform:(e,...t)=>pw(`textStyles.${e}`,...t)},apply:{isProcessResult:!0,transform:pw}},Wf={position:!0,pos:ee.prop("position"),zIndex:ee.prop("zIndex","zIndices"),inset:ee.space("inset"),insetX:ee.space(["left","right"]),insetInline:ee.space("insetInline"),insetY:ee.space(["top","bottom"]),insetBlock:ee.space("insetBlock"),top:ee.space("top"),insetBlockStart:ee.space("insetBlockStart"),bottom:ee.space("bottom"),insetBlockEnd:ee.space("insetBlockEnd"),left:ee.space("left"),insetInlineStart:ee.space("insetInlineStart"),right:ee.space("right"),insetInlineEnd:ee.space("insetInlineEnd")};Object.assign(Wf,{insetStart:Wf.insetInlineStart,insetEnd:Wf.insetInlineEnd});var z9={scrollBehavior:!0,scrollSnapAlign:!0,scrollSnapStop:!0,scrollSnapType:!0,scrollMargin:ee.space("scrollMargin"),scrollMarginTop:ee.space("scrollMarginTop"),scrollMarginBottom:ee.space("scrollMarginBottom"),scrollMarginLeft:ee.space("scrollMarginLeft"),scrollMarginRight:ee.space("scrollMarginRight"),scrollMarginX:ee.space(["scrollMarginLeft","scrollMarginRight"]),scrollMarginY:ee.space(["scrollMarginTop","scrollMarginBottom"]),scrollPadding:ee.space("scrollPadding"),scrollPaddingTop:ee.space("scrollPaddingTop"),scrollPaddingBottom:ee.space("scrollPaddingBottom"),scrollPaddingLeft:ee.space("scrollPaddingLeft"),scrollPaddingRight:ee.space("scrollPaddingRight"),scrollPaddingX:ee.space(["scrollPaddingLeft","scrollPaddingRight"]),scrollPaddingY:ee.space(["scrollPaddingTop","scrollPaddingBottom"])},Gt={margin:ee.space("margin"),marginTop:ee.space("marginTop"),marginBlockStart:ee.space("marginBlockStart"),marginRight:ee.space("marginRight"),marginInlineEnd:ee.space("marginInlineEnd"),marginBottom:ee.space("marginBottom"),marginBlockEnd:ee.space("marginBlockEnd"),marginLeft:ee.space("marginLeft"),marginInlineStart:ee.space("marginInlineStart"),marginX:ee.space(["marginInlineStart","marginInlineEnd"]),marginInline:ee.space("marginInline"),marginY:ee.space(["marginTop","marginBottom"]),marginBlock:ee.space("marginBlock"),padding:ee.space("padding"),paddingTop:ee.space("paddingTop"),paddingBlockStart:ee.space("paddingBlockStart"),paddingRight:ee.space("paddingRight"),paddingBottom:ee.space("paddingBottom"),paddingBlockEnd:ee.space("paddingBlockEnd"),paddingLeft:ee.space("paddingLeft"),paddingInlineStart:ee.space("paddingInlineStart"),paddingInlineEnd:ee.space("paddingInlineEnd"),paddingX:ee.space(["paddingInlineStart","paddingInlineEnd"]),paddingInline:ee.space("paddingInline"),paddingY:ee.space(["paddingTop","paddingBottom"]),paddingBlock:ee.space("paddingBlock")};Object.assign(Gt,{m:Gt.margin,mt:Gt.marginTop,mr:Gt.marginRight,me:Gt.marginInlineEnd,marginEnd:Gt.marginInlineEnd,mb:Gt.marginBottom,ml:Gt.marginLeft,ms:Gt.marginInlineStart,marginStart:Gt.marginInlineStart,mx:Gt.marginX,my:Gt.marginY,p:Gt.padding,pt:Gt.paddingTop,py:Gt.paddingY,px:Gt.paddingX,pb:Gt.paddingBottom,pl:Gt.paddingLeft,ps:Gt.paddingInlineStart,paddingStart:Gt.paddingInlineStart,pr:Gt.paddingRight,pe:Gt.paddingInlineEnd,paddingEnd:Gt.paddingInlineEnd});var L9={clipPath:!0,shapeOutside:!0,shapeMargin:!0,shapeImageThreshold:!0,transform:{transform:ht.transform},transformOrigin:!0,transformStyle:!0,perspective:!0,translateX:ee.space("--ui-translate-x"),translateY:ee.space("--ui-translate-y"),scale:ee.prop(["--ui-scale-x","--ui-scale-y"]),scaleX:ee.prop("--ui-scale-x"),scaleY:ee.prop("--ui-scale-y"),rotate:{properties:"--ui-rotate",transform:ht.deg},skewX:{properties:"--ui-skew-x",transform:ht.deg},skewY:{properties:"--ui-skew-y",transform:ht.deg}},B9={transitionDelay:!0,willChange:!0,transitionProperty:ee.prop("transitionProperty","transitions.property"),transitionDuration:ee.prop("transitionDuration","transitions.duration"),transitionTimingFunction:ee.prop("transitionTimingFunction","transitions.easing"),animation:ee.propTransform("animation",ht.animation),animationName:!0,animationDuration:ee.prop("animationDuration","transitions.duration"),animationTimingFunction:ee.prop("animationTimingFunction","transitions.easing"),animationDelay:!0,animationIterationCount:!0,animationDirection:!0,animationFillMode:!0,animationPlayState:!0},W9={fontFamily:ee.prop("fontFamily","fonts"),fontSize:ee.prop("fontSize","fontSizes",ht.px),fontWeight:ee.prop("fontWeight","fontWeights"),lineHeight:ee.prop("lineHeight","lineHeights"),letterSpacing:ee.prop("letterSpacing","letterSpacings"),textAlign:!0,fontStyle:!0,textIndent:!0,wordBreak:!0,overflowWrap:!0,textOverflow:!0,textTransform:!0,whiteSpace:!0,textDecorationColor:ee.color("textDecorationColor"),textDecoration:!0,textDecor:{properties:"textDecoration"},textDecorationLine:!0,textDecorationStyle:!0,textDecorationThickness:!0,textUnderlineOffset:!0,textShadow:ee.shadow("textShadow"),noOfLines:{static:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:"var(--ui-line-clamp)"},properties:"--ui-line-clamp"},isTruncated:{transform:ht.isTruncated}},g2={...ps,...F9,...ZM,...YM,...W9,...O9,...z9,...Wf,...P0,...Gt,...L9,...B9,...D9,...M9,...Ok,...xt,...P9},V9=Object.keys(g2),U9={...ps,...ZM,...YM,...Gt,...Wf},j9=Object.keys(U9),H9=(e,t)=>{const n=`--${[t,p8(e,"-")].filter(Boolean).join("-")}`,r=`var(${n})`;return{variable:n,reference:r}},B$=(e,t)=>(e=e.replace(/\./g,"-"),H9(e,t)),cd=(e,t="ui")=>({baseTokens:n,cssMap:r={},cssVars:a={}}={})=>{for(let[i,{isSemantic:s,value:o}]of Object.entries(e)){const l=(m="")=>{var g;const[y]=i.split("."),b=[y,m].join(".");if(!((g=e[b])!=null?g:n==null?void 0:n[b]))return[,m];const{variable:x,reference:w}=B$(b,t);return[x,w]},{variable:c,reference:u}=B$(i,t);let d,p;if(i.startsWith("animations."))lt(o)?d=o.map(m=>Mk(m,{__cssMap:r})).join(","):d=Mk(o,{__cssMap:r});else{let[m,g]=lt(o)?[...o]:[o];if(i.startsWith("gradients.")){const[y,b]=l(m),[v,x]=l(g);y?d=b:d=Dk(l(m)[1],{__cssMap:r}),v?p=x:p=Dk(g,{__cssMap:r})}else d=m,p=g}if(!s){if(i.startsWith("spaces")&&!Dv(d)){const m=i.split("."),[g,...y]=m,b=`${g}.-${y.join(".")}`,v=Nl.negate(d),x=Nl.negate(u);r[b]={value:v,var:c,ref:x}}a[c]=d,p&&(a=$n(a,{[Ao._dark]:{[c]:p}})),r[i]={value:d,var:c,ref:u};continue}const[h,f]=l(d);if(a=$n(a,{[c]:f}),p){const[,m]=l(p);a=$n(a,{[Ao._dark]:{[c]:m}})}r[i]={value:h??d,var:c,ref:u}}return{cssMap:r,cssVars:a}},G9=(e,t)=>({[e]:t[0],[Ao._dark]:{[e]:t[1]}}),q9=(e,t,n)=>Object.entries(t).reduce((r,[a,i])=>{var s;if(a==="base")r[e]=i;else{const o=(s=n.find(({breakpoint:l})=>l===a))==null?void 0:s.maxWQuery;o&&(r[o]={[e]:i})}return r},{}),K9=e=>t=>{if(!t.__breakpoints)return e;const{isResponsive:n,queries:r}=t.__breakpoints;let a={};for(let[i,s]of Object.entries(e))if(s=na(s,t),s!=null){if(lt(s)){a=$n(a,G9(i,s));continue}if(nr(s)&&n(s)){a=$n(a,q9(i,s,r));continue}a[i]=s}return a},X9=({theme:e,styles:t={},pseudos:n={}})=>{const r=(a,i=!1)=>{var s,o,l;const c=na(a,e),u=K9(c)(e);let d={};for(let[p,h]of Object.entries(u)){if(h=na(h,e),h==null)continue;p in n&&(p=n[p]);let f=t[p];if(f===!0&&(f={properties:p}),nr(h)){d[p]=(s=d[p])!=null?s:{},d[p]=$n(d[p],r(h,!0));continue}if(h=(l=(o=f==null?void 0:f.transform)==null?void 0:o.call(f,h,e))!=null?l:h,f!=null&&f.isProcessResult&&(h=r(h,!0)),!i&&(f!=null&&f.static)){const g=na(f.static,e);d=$n(d,g)}const m=na(f==null?void 0:f.properties,e);if(m)if(lt(m)){for(const g of m)d[g]=h;continue}else if(nr(h)){d=$n(d,h);continue}else{d[m]=h;continue}if(nr(h)){d=$n(d,h);continue}d[p]=h}return d};return r},Yv=e=>t=>X9({theme:t,styles:g2,pseudos:Ao})(e),W$=["blurs","borders","colors","fonts","fontSizes","fontWeights","letterSpacings","lineHeights","radii","shadows","sizes","spaces","transitions","zIndices"],V$=["gradients"],Y9=(e,t)=>{var n;e=Z9(e);const{breakpoints:r,themeSchemes:a}=e??{},i=(n=t==null?void 0:t.var)==null?void 0:n.prefix,s=dd(e),o=dd(e,"secondary"),l=dd(e,"animation");let{cssMap:c,cssVars:u}=U$(cd(s,i),cd(o,i),cd(l,i))();if(a)for(const[p,h]of Object.entries(a)){const f=dd(h),m=dd(h,"secondary"),g=dd(h,"animation");let{cssVars:y}=U$(cd(f,i),cd(m,i),cd(g,i))({...s,...o,...l});u={...u,[`[data-theme=${p}] &:not([data-theme]), &[data-theme=${p}]`]:y}}return Object.assign(e,{__config:t,__cssVars:{...{},...u},__cssMap:c,__breakpoints:C9(r)}),e},dd=(e,t="primary")=>{var n;let r=[],a=[],i=[];switch(t){case"primary":r=[...W$],a=[...W$,"colorSchemes"];break;case"secondary":r=[...V$],a=[...V$];break;case"animation":r=["animations"],a=["animations"],i=["keyframes"];break}const s=ub(e,r),o=ub((n=e.semantics)!=null?n:{},a),l=Object.entries(Ck(s,1/0,i)).map(([u,d])=>[u,{isSemantic:!1,value:d}]),c=Object.entries(Ck(o,1/0,i)).reduce((u,[d,p])=>{if(d.startsWith("colorSchemes.")){const[,h]=d.split(".");YG.forEach(f=>{const m={isSemantic:!0,value:`${p}.${f}`};u.push([`colors.${h}.${f}`,m])})}else{const h={isSemantic:!0,value:p};u.push([d,h])}return u},[]);return s8([...l,...c])},U$=(...e)=>t=>{let n={},r={};for(const a of e){const{cssMap:i,cssVars:s}=a({baseTokens:t,cssMap:n,cssVars:r});n={...n,...i},r={...r,...s}}return{cssMap:n,cssVars:r}},Z9=e=>Xd(e,["__cssMap","__cssVar","__breakpoints"]),Ls=e=>Xd(e,["size","variant","colorScheme"]),QM=(e,...t)=>({omit:n=[],pick:r=[]}={})=>t.reduce((a,i)=>pb(JM(a)({omit:n,pick:r}),i),e),Kr=(e,...t)=>({omit:n=[],pick:r=[]}={})=>t.reduce((a,i)=>pb(JM(a)({omit:n,pick:r,isMulti:!0}),i),e),pb=(e,t)=>{let n=Object.assign({},e);if(nr(t)&&nr(e))for(const[r,a]of Object.entries(t)){const i=e[r];e.hasOwnProperty(r)?!Ql(i)&&!Ql(a)?n[r]=pb(i,a):n[r]=s=>pb(na(i,s),na(a,s)):Object.assign(n,{[r]:a})}else n=t;return n},JM=e=>({omit:t,pick:n,isMulti:r=!1})=>(nr(e)&&(t.length&&(e=hb(e,t,r)(Xd)),n.length&&(e=hb(e,n,r)(ub))),e),hb=(e,t,n,r=[])=>a=>(nr(e)&&(e=a(e,t),Object.entries(e??{}).forEach(([i,s])=>{const o=t.filter(c=>c!==i),l=[...r,i];Q9(l,n)&&(Ql(s)?e[i]=c=>hb(s(c),o,n,l)(a):e[i]=hb(s,o,n,l)(a))})),e),Q9=(e,t)=>{switch(e[0]){case"baseStyle":return e.length<(t?2:1);case"variants":case"sizes":return e.length<(t?3:2);default:return!1}},J9=(e,t,n=!0)=>{const r={};return Object.entries(e).forEach(([a,i])=>{switch(a){case"baseStyle":Ql(i)?r[a]=s=>i(s)[t]:r[a]=i[t];break;case"variants":case"sizes":r[a]=Object.entries(i).reduce((s,[o,l])=>(Ql(l)?s[o]=c=>l(c)[t]:s[o]=l[t],s),{});break;case"defaultProps":n&&(r[a]=i);break}}),r},hw="ui-color-mode",eO=!!(globalThis!=null&&globalThis.document),j$=e=>({ssr:!1,type:"localStorage",get:(t="light")=>{if(!eO)return t;try{return localStorage.getItem(e)||t}catch{return t}},set:t=>{try{localStorage.setItem(e,t)}catch{}}}),H$=(e,t)=>{const n=e.match(new RegExp(`(^| )${t}=([^;]+)`));return n==null?void 0:n[2]},fw=(e,t)=>({ssr:!!t,type:"cookie",get:(n="light")=>t?H$(t,e)||n:eO&&H$(document.cookie,e)||n,set:n=>{document.cookie=`${e}=${n}; max-age=31536000; path=/`}}),eq={localStorage:j$(hw),cookieStorage:fw(hw),ssr:e=>fw(hw,e),createLocalStorage:j$,createCookieStorage:fw},Wy={light:"ui-light",dark:"ui-dark"},tq={light:"(prefers-color-scheme: light)",dark:"(prefers-color-scheme: dark)"},nq=({isPreventTransition:e=!0})=>{const t=o=>{const l=e?s():void 0;document.documentElement.dataset.mode=o,document.documentElement.style.colorScheme=o,l==null||l()},n=o=>{document.body.classList.add(o?Wy.dark:Wy.light),document.body.classList.remove(o?Wy.light:Wy.dark)},r=()=>window.matchMedia(tq.dark),a=o=>{var l;return((l=r().matches)!=null?l:o==="dark")?"dark":"light"},i=o=>{const l=r(),c=u=>{o(u.matches?"dark":"light")};return typeof l.addListener=="function"?l.addListener(c):l.addEventListener("change",c),()=>{typeof l.removeListener=="function"?l.removeListener(c):l.removeEventListener("change",c)}},s=()=>{const o=document.createElement("style"),l=document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}");return o.appendChild(l),document.head.appendChild(o),()=>{window.getComputedStyle(document.body),requestAnimationFrame(()=>{requestAnimationFrame(()=>{document.head.removeChild(o)})})}};return{setDataset:t,setClassName:n,query:r,getSystemColorMode:a,addListener:i,preventTransition:s}},{localStorage:rq}=eq,aq=(e,t)=>e.type==="cookie"&&e.ssr?e.get(t):t,tO=M.createContext({}),iq=({colorMode:e,colorModeManager:t=rq,config:{initialColorMode:n="light",disableTransitionOnChange:r=!0}={},children:a})=>{const[i,s]=M.useState(()=>aq(t,n)),[o,l]=M.useState(void 0),u=i==="system"?o||(n==="dark"?"dark":"light"):i,{getSystemColorMode:d,setClassName:p,setDataset:h,addListener:f}=M.useMemo(()=>nq({isPreventTransition:r}),[r]),m=M.useCallback(v=>{const x=v==="system"?d():v;s(v),p(x==="dark"),h(x),t.set(v)},[t,d,p,h]),g=M.useCallback(v=>{l(v),i==="system"&&(p(v==="dark"),h(v))},[i,p,h]),y=M.useCallback(()=>{m(u==="dark"?"light":"dark")},[m,u]);dm(()=>{l(d())},[n,f,m]),M.useEffect(()=>{const v=t.get();v&&m(v)},[m,t]),M.useEffect(()=>f(g),[f,g]);const b=M.useMemo(()=>({colorMode:e??u,internalColorMode:i,changeColorMode:e?k$:m,toggleColorMode:e?k$:y,forced:e!==void 0}),[e,u,i,m,y]);return z.jsx(tO.Provider,{value:b,children:a})},$p=()=>{const e=M.useContext(tO);if(e===void 0)throw new Error("useColorMode must be used within a ColorModeProvider");return e},nO=(e,t)=>{const{colorMode:n}=$p();return n==="light"?e:t},mw="ui-theme-scheme",rO=!!(globalThis!=null&&globalThis.document),G$=e=>({ssr:!1,type:"localStorage",get:(t="base")=>{if(!rO)return t;try{return localStorage.getItem(e)||t}catch{return t}},set:t=>{try{localStorage.setItem(e,String(t))}catch{}}}),q$=(e,t)=>{const n=e.match(new RegExp(`(^| )${t}=([^;]+)`));return n==null?void 0:n[2]},gw=(e,t)=>({ssr:!!t,type:"cookie",get:(n="base")=>t?q$(t,e)||n:rO&&q$(document.cookie,e)||n,set:n=>{document.cookie=`${e}=${n}; max-age=31536000; path=/`}}),sq={localStorage:G$(mw),cookieStorage:gw(mw),ssr:e=>gw(mw,e),createLocalStorage:G$,createCookieStorage:gw},{localStorage:oq}=sq,lq=({theme:e={},config:t,themeSchemeManager:n=oq,children:r})=>{const[a,i]=M.useState(n.get(t==null?void 0:t.initialThemeScheme)),s=M.useCallback(l=>{const c=t!=null&&t.disableTransitionOnChange?pq():void 0;document.documentElement.dataset.theme=l,c==null||c(),i(l),n.set(l)},[t,n]),o=M.useMemo(()=>Y9(e,t),[e,t]);return M.useEffect(()=>{const l=n.get();l&&s(l)},[s,n]),z.jsxs(h9,{theme:{themeScheme:a,changeThemeScheme:s,...o},children:[z.jsx(uq,{}),r]})},uq=()=>z.jsx(f2,{styles:({__cssVars:e})=>({":host, :root, [data-mode]":e})}),cq=()=>{const{colorMode:e}=$p();return z.jsx(f2,{styles:t=>{const{themeScheme:n}=t;let r=Ue(t,"styles.resetStyle",{});const a=na(r,{theme:t,colorMode:e,themeScheme:n});if(a)return Yv(a)(t)}})},dq=()=>{const{colorMode:e}=$p();return z.jsx(f2,{styles:t=>{const{themeScheme:n}=t;let r=Ue(t,"styles.globalStyle",{});const a=na(r,{theme:t,colorMode:e,themeScheme:n});if(a)return Yv(a)(t)}})},Ap=()=>{const{themeScheme:e,changeThemeScheme:t,...n}=M.useContext(mm);if(!n)throw Error("useTheme: `theme` is undefined. Seems you forgot to wrap your app in `<UIProvider />`");const r=M.useMemo(()=>{var i;if(Dv(e)||e==="base")return n;const s=(i=n.themeSchemes)==null?void 0:i[e];return s?$n(n,s):n},[e,n]);return M.useMemo(()=>({themeScheme:e,changeThemeScheme:t,theme:r,internalTheme:n}),[e,t,r,n])},pq=()=>{const e=document.createElement("style"),t=document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}");return e.appendChild(t),document.head.appendChild(e),()=>{window.getComputedStyle(document.body),requestAnimationFrame(()=>{requestAnimationFrame(()=>{document.head.removeChild(e)})})}},K$=(e,t,n)=>({isMulti:r})=>{var a;let i={};if(lt(e)){const[s,o]=e,l=xl(t[s],n)({isMulti:r,query:Ao._light}),c=xl(t[o],n)({isMulti:r,query:Ao._dark});i=$n(l,c)}else if(nr(e))if(_k(e).length===1&&"base"in e)i=xl(t[e.base],n)({isMulti:r});else{const{queries:s=[]}=(a=n.theme.__breakpoints)!=null?a:{},o=s.filter(({breakpoint:d})=>d!=="base"&&_k(e).includes(d)),l=o.sort((d,p)=>{var h,f;return((h=d.minW)!=null?h:0)-((f=p.minW)!=null?f:0)})[0],c=o.sort((d,p)=>{var h,f;return((h=p.minW)!=null?h:0)-((f=d.minW)!=null?f:0)})[0],u=s.filter(({minW:d})=>{var p;return(d??0)>((p=c==null?void 0:c.minW)!=null?p:0)}).sort((d,p)=>{var h,f;return((h=d.minW)!=null?h:0)-((f=p.minW)!=null?f:0)})[0];i=Object.entries(e).reduce((d,[p,h=""])=>{var f;if(p==="base"){const m=u.minWQuery,g=xl(t[h],n)({isMulti:r,query:m});d=$n(d,g)}else{const m=p===l.breakpoint,g=(f=s==null?void 0:s.find(({breakpoint:b})=>b===p))==null?void 0:f[m?"maxWQuery":"minMaxQuery"],y=xl(t[h],n)({isMulti:r,query:g});d=$n(d,y)}return d},{})}else i=xl(t[e],n)({isMulti:r});return i},xl=(e,t)=>({isMulti:n,query:r})=>{let a=na(e,t);if(n)for(const[i,s]of Object.entries(a??{})){const o=na(s,t);r?a=$n(a,{[i]:{[r]:o}}):a=$n(a,{[i]:o})}else if(r)return{[r]:a};return a},aO=(e,t,n=!1)=>{var r,a,i,s;const{theme:o,themeScheme:l}=Ap(),{colorMode:c}=$p(),u=Ue(o,`components.${e}`),d=M.useRef({}),p=M.useRef({});if(t=$n((r=u==null?void 0:u.defaultProps)!=null?r:{},Mv(t)),u){const f=Xd(t,["children"]);let m=xl((a=u.baseStyle)!=null?a:{},{theme:o,colorMode:c,themeScheme:l,...f})({isMulti:n});const g=K$(t.variant,(i=u.variants)!=null?i:{},{theme:o,colorMode:c,themeScheme:l,...f})({isMulti:n}),y=K$(t.size,(s=u.sizes)!=null?s:{},{theme:o,colorMode:c,themeScheme:l,...f})({isMulti:n});m=$n(m,y),m=$n(m,g),T$(p.current,m)||(p.current=m)}return T$(d.current,t)||(d.current=t),[p.current,d.current]},sg=(e,t)=>aO(e,t),Zv=(e,t)=>aO(e,t,!0),hq=new Set([...V9,...R9,"textStyle","layerStyle","apply","noOfLines","focusBorderColor","errorBorderColor","as","__css","css","sx"]),fq=new Set(["htmlWidth","htmlHeight","htmlSize","htmlTranslate"]),mq=e=>fq.has(e)||!hq.has(e),gq=d8($k),yq={...g2,...Ao},bq=({baseStyle:e})=>t=>{const{theme:n,css:r,__css:a,sx:i,...s}=t,o=NM(s,u=>u in yq),l=na(e,t),c=Yv(c8({},a,l,Mv(o),i))(n);return r?[c,r]:c},yw=(e,{baseStyle:t,...n}={})=>{n.shouldForwardProp||(n.shouldForwardProp=mq);const r=bq({baseStyle:t}),a=gq(e,n)(r),i=M.forwardRef((s,o)=>{const{colorMode:l,forced:c}=$p();return M.createElement(a,{ref:o,"data-mode":c?l:void 0,...s})});return i.displayName="UIComponent",i},vq=()=>{const e=new Map;return new Proxy(yw,{apply:(t,n,[r,a])=>yw(r,a),get:(t,n)=>(e.has(n)||e.set(n,yw(n)),e.get(n))})},at=vq(),gm=(e,t)=>{var n,r,a;const{theme:i}=Ap(),{colorMode:s}=$p();e==="layerStyles"&&(e="styles.layerStyles"),e==="textStyles"&&(e="styles.textStyles"),e==="transitionProperty"&&(e="transitions.property"),e==="transitionDuration"&&(e="transitions.duration"),e==="transitionEasing"&&(e="transitions.easing");let o=Ue(i,`${e}.${t}`);if(Dv(o))if(o=Ue(i,`semantics.${e}.${t}`),lt(o)?o=[(n=Ue(i,`${e}.${o[0]}`))!=null?n:o[0],(r=Ue(i,`${e}.${o[1]}`))!=null?r:o[1]]:o=(a=Ue(i,`${e}.${o}`))!=null?a:o,lt(o)){const[l,c]=o;if(o=s==="light"?l:c,lt(o)){const[u,d]=o;return s==="light"?u:d}else return o}else return o;else if(lt(o)){const[l,c]=o;return s==="light"?l:c}else return o},ii=dt(({as:e,viewBox:t,size:n,className:r,__css:a,...i},s)=>{const o=o8(n,c=>RG(c)?c:gm("fontSizes",c)),l={w:"1em",h:"1em",display:"inline-block",lineHeight:"1em",flexShrink:0,color:"currentColor",...a};return e&&typeof e!="string"?z.jsx(at.svg,{as:e,className:ut("ui-icon",r),__css:l,boxSize:o,...i}):z.jsx(at.svg,{ref:s,verticalAlign:"middle",viewBox:t,className:ut("ui-icon",r),__css:l,boxSize:o,...i})}),xq=e=>z.jsx(ii,{viewBox:"0 0 24 24",...e,children:z.jsx("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"})}),wq=e=>z.jsx(ii,{viewBox:"0 0 24 24",...e,children:z.jsx("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm.25,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,12.25,5ZM14.5,18.5h-4a1,1,0,0,1,0-2h.75a.25.25,0,0,0,.25-.25v-4.5a.25.25,0,0,0-.25-.25H10.5a1,1,0,0,1,0-2h1a2,2,0,0,1,2,2v4.75a.25.25,0,0,0,.25.25h.75a1,1,0,1,1,0,2Z"})}),X$=e=>z.jsx(ii,{viewBox:"0 0 24 24",...e,children:z.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})}),kq=e=>z.jsx(ii,{focusable:"false","aria-hidden":!0,viewBox:"0 0 24 24",...e,children:z.jsx("path",{fill:"currentColor",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"})}),iO=e=>z.jsx(ii,{focusable:"false","aria-hidden":!0,viewBox:"0 0 24 24",...e,children:z.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),Sq=dt(({color:e,duration:t="1.8s",...n},r)=>z.jsx(ii,{ref:r,viewBox:"0 0 44 44",stroke:e,...n,children:z.jsxs("g",{fill:"none",fillRule:"evenodd",strokeWidth:"2",children:[z.jsxs("circle",{cx:"22",cy:"22",r:"1",children:[z.jsx("animate",{attributeName:"r",begin:"0s",dur:t,values:"1; 20",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.165, 0.84, 0.44, 1",repeatCount:"indefinite"}),z.jsx("animate",{attributeName:"stroke-opacity",begin:"0s",dur:t,values:"1; 0",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.3, 0.61, 0.355, 1",repeatCount:"indefinite"})]}),z.jsxs("circle",{cx:"22",cy:"22",r:"1",children:[z.jsx("animate",{attributeName:"r",begin:"-0.9s",dur:t,values:"1; 20",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.165, 0.84, 0.44, 1",repeatCount:"indefinite"}),z.jsx("animate",{attributeName:"stroke-opacity",begin:"-0.9s",dur:t,values:"1; 0",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.3, 0.61, 0.355, 1",repeatCount:"indefinite"})]})]})})),Iq=dt(({color:e,duration:t="3s",...n},r)=>{const a=typeof t=="string"?parseFloat(t):t;return z.jsx(ii,{ref:r,viewBox:"0 0 45 45",stroke:e,...n,children:z.jsxs("g",{fill:"none",fillRule:"evenodd",transform:"translate(1 1)",strokeWidth:"2",children:[z.jsxs("circle",{cx:"22",cy:"22",r:"6",strokeOpacity:"0",children:[z.jsx("animate",{attributeName:"r",begin:"1.5s",dur:`${a}s`,values:"6;22",calcMode:"linear",repeatCount:"indefinite"}),z.jsx("animate",{attributeName:"stroke-opacity",begin:"1.5s",dur:`${a}s`,values:"1;0",calcMode:"linear",repeatCount:"indefinite"}),z.jsx("animate",{attributeName:"stroke-width",begin:"1.5s",dur:`${a}s`,values:"2;0",calcMode:"linear",repeatCount:"indefinite"})]}),z.jsxs("circle",{cx:"22",cy:"22",r:"6",strokeOpacity:"0",children:[z.jsx("animate",{attributeName:"r",begin:"3s",dur:`${a}s`,values:"6;22",calcMode:"linear",repeatCount:"indefinite"}),z.jsx("animate",{attributeName:"stroke-opacity",begin:"3s",dur:`${a}s`,values:"1;0",calcMode:"linear",repeatCount:"indefinite"}),z.jsx("animate",{attributeName:"stroke-width",begin:"3s",dur:`${a}s`,values:"2;0",calcMode:"linear",repeatCount:"indefinite"})]}),z.jsx("circle",{cx:"22",cy:"22",r:"8",children:z.jsx("animate",{attributeName:"r",begin:"0s",dur:`${a/2}s`,values:"6;1;2;3;4;5;6",calcMode:"linear",repeatCount:"indefinite"})})]})})}),Cq=dt(({color:e,duration:t="1.4s",...n},r)=>{const a=typeof t=="string"?parseFloat(t):t;return z.jsx(ii,{ref:r,viewBox:"0 0 55 80",fill:e,...n,children:z.jsxs("g",{transform:"matrix(1 0 0 -1 0 80)",children:[z.jsx("rect",{width:"10",height:"20",rx:"3",children:z.jsx("animate",{attributeName:"height",begin:"0s",dur:`${a*3}s`,values:"20;45;57;80;64;32;66;45;64;23;66;13;64;56;34;34;2;23;76;79;20",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("rect",{x:"15",width:"10",height:"80",rx:"3",children:z.jsx("animate",{attributeName:"height",begin:"0s",dur:`${a*1.4}s`,values:"80;55;33;5;75;23;73;33;12;14;60;80",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("rect",{x:"30",width:"10",height:"50",rx:"3",children:z.jsx("animate",{attributeName:"height",begin:"0s",dur:`${a}s`,values:"50;34;78;23;56;23;34;76;80;54;21;50",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("rect",{x:"45",width:"10",height:"30",rx:"3",children:z.jsx("animate",{attributeName:"height",begin:"0s",dur:`${a*1.4}s`,values:"30;45;13;80;56;72;45;76;34;23;67;30",calcMode:"linear",repeatCount:"indefinite"})})]})})}),_q=dt(({color:e,duration:t="3s",...n},r)=>z.jsx(ii,{ref:r,viewBox:"0 0 58 58",stroke:e,...n,children:z.jsx("g",{fill:"none",fillRule:"evenodd",children:z.jsxs("g",{transform:"translate(2 1)",stroke:e,strokeWidth:"1.5",children:[z.jsx("circle",{cx:"42.601",cy:"11.462",r:"5",fillOpacity:"1",fill:e,children:z.jsx("animate",{attributeName:"fill-opacity",begin:"0s",dur:t,values:"1;0;0;0;0;0;0;0",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"49.063",cy:"27.063",r:"5",fillOpacity:"0",fill:e,children:z.jsx("animate",{attributeName:"fill-opacity",begin:"0s",dur:t,values:"0;1;0;0;0;0;0;0",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"42.601",cy:"42.663",r:"5",fillOpacity:"0",fill:e,children:z.jsx("animate",{attributeName:"fill-opacity",begin:"0s",dur:t,values:"0;0;1;0;0;0;0;0",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"27",cy:"49.125",r:"5",fillOpacity:"0",fill:e,children:z.jsx("animate",{attributeName:"fill-opacity",begin:"0s",dur:t,values:"0;0;0;1;0;0;0;0",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"11.399",cy:"42.663",r:"5",fillOpacity:"0",fill:e,children:z.jsx("animate",{attributeName:"fill-opacity",begin:"0s",dur:t,values:"0;0;0;0;1;0;0;0",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"4.938",cy:"27.063",r:"5",fillOpacity:"0",fill:e,children:z.jsx("animate",{attributeName:"fill-opacity",begin:"0s",dur:t,values:"0;0;0;0;0;1;0;0",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"11.399",cy:"11.462",r:"5",fillOpacity:"0",fill:e,children:z.jsx("animate",{attributeName:"fill-opacity",begin:"0s",dur:t,values:"0;0;0;0;0;0;1;0",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"27",cy:"5",r:"5",fillOpacity:"0",fill:e,children:z.jsx("animate",{attributeName:"fill-opacity",begin:"0s",dur:t,values:"0;0;0;0;0;0;0;1",calcMode:"linear",repeatCount:"indefinite"})})]})})})),Tq=dt(({color:e,duration:t="1s",...n},r)=>z.jsxs(ii,{ref:r,viewBox:"0 0 120 30",fill:e,...n,children:[z.jsxs("circle",{cx:"15",cy:"15",r:"15",children:[z.jsx("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:t,values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),z.jsx("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:t,values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]}),z.jsxs("circle",{cx:"60",cy:"15",r:"9",fillOpacity:"0.3",children:[z.jsx("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:t,values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),z.jsx("animate",{attributeName:"fill-opacity",from:"0.5",to:"0.5",begin:"0s",dur:t,values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})]}),z.jsxs("circle",{cx:"105",cy:"15",r:"15",children:[z.jsx("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:t,values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),z.jsx("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:t,values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]})]})),Nq=dt(({color:e,duration:t="1s",...n},r)=>z.jsxs(ii,{ref:r,viewBox:"0 0 105 105",fill:e,...n,children:[z.jsx("circle",{cx:"12.5",cy:"12.5",r:"12.5",children:z.jsx("animate",{attributeName:"fill-opacity",begin:"0s",dur:t,values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"12.5",cy:"52.5",r:"12.5",fillOpacity:".5",children:z.jsx("animate",{attributeName:"fill-opacity",begin:"100ms",dur:t,values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"52.5",cy:"12.5",r:"12.5",children:z.jsx("animate",{attributeName:"fill-opacity",begin:"300ms",dur:t,values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"52.5",cy:"52.5",r:"12.5",children:z.jsx("animate",{attributeName:"fill-opacity",begin:"600ms",dur:t,values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"92.5",cy:"12.5",r:"12.5",children:z.jsx("animate",{attributeName:"fill-opacity",begin:"800ms",dur:t,values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"92.5",cy:"52.5",r:"12.5",children:z.jsx("animate",{attributeName:"fill-opacity",begin:"400ms",dur:t,values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"12.5",cy:"92.5",r:"12.5",children:z.jsx("animate",{attributeName:"fill-opacity",begin:"700ms",dur:t,values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"52.5",cy:"92.5",r:"12.5",children:z.jsx("animate",{attributeName:"fill-opacity",begin:"500ms",dur:t,values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})}),z.jsx("circle",{cx:"92.5",cy:"92.5",r:"12.5",children:z.jsx("animate",{attributeName:"fill-opacity",begin:"200ms",dur:t,values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})})]})),Eq=dt(({color:e,secondaryColor:t,duration:n="1s",...r},a)=>z.jsx(ii,{ref:a,viewBox:"0 0 38 38",stroke:e,...r,children:z.jsx("g",{fill:"none",fillRule:"evenodd",children:z.jsxs("g",{transform:"translate(1 1)",strokeWidth:"2",children:[z.jsx("circle",{...t?{stroke:t}:{strokeOpacity:".5"},cx:"18",cy:"18",r:"18"}),z.jsx("path",{d:"M36 18c0-9.94-8.06-18-18-18",children:z.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:n,repeatCount:"indefinite"})})]})})})),$q=()=>{const{theme:e}=Ap();if(!e)throw Error("useBreakpoint: `theme` is undefined. Seems you forgot to wrap your app in `<UIProvider />`");const t=e.__breakpoints;if(!t)throw Error("useBreakpoint: `breakpoints` is undefined. Seems you forgot to put theme in `breakpoints`");const n=M.useMemo(()=>t.queries.map(({breakpoint:i,minMaxQuery:s})=>{var o;return{breakpoint:i,query:(o=s==null?void 0:s.replace("@media screen and ",""))!=null?o:""}}),[t]),[r,a]=M.useState(()=>{if(!s2())return"base";for(const{breakpoint:s,query:o}of n)if(window.matchMedia(o).matches)return s});return M.useEffect(()=>{const i=n.map(({breakpoint:s,query:o})=>{const l=window.matchMedia(o),c=u=>{u.matches&&a(s)};return typeof l.addEventListener=="function"&&l.addEventListener("change",c),()=>{typeof l.removeEventListener=="function"&&l.removeEventListener("change",c)}});return()=>{i.forEach(s=>s())}},[n]),r},Aq=e=>{var t;const{theme:n}=Ap();if(!n)throw Error("useBreakpoint: `theme` is undefined. Seems you forgot to wrap your app in `<UIProvider />`");const r=(t=n.__breakpoints)==null?void 0:t.keys;if(!r)throw Error("useBreakpoint: `breakpoints` is undefined. Seems you forgot to put theme in `breakpoints`");const a=$q(),i=r.reduce((s,o)=>(s===a||o===a)&&(s==="base"||!e.hasOwnProperty(s)&&e.hasOwnProperty(o))?o:s,"base");return e[i]},pn=e=>nr(e)?Aq(e):lt(e)?nO(...e):e,Jl=dt(({className:e,variant:t="oval",color:n="primary",secondaryColor:r,size:a="1em",duration:i,...s},o)=>{var l,c;const u=(l=gm("colors",pn(n)))!=null?l:n,d=(c=gm("colors",pn(r)))!=null?c:r,p=M.useMemo(()=>({className:ut("ui-loading",e),size:a,color:u,duration:i,...s}),[e,u,i,s,a]);switch(t){case"grid":return z.jsx(Nq,{ref:o,...p});case"audio":return z.jsx(Cq,{ref:o,...p});case"dots":return z.jsx(Tq,{ref:o,...p});case"puff":return z.jsx(Sq,{ref:o,...p});case"rings":return z.jsx(Iq,{ref:o,...p});case"circles":return z.jsx(_q,{ref:o,...p});default:return z.jsx(Eq,{ref:o,...p,secondaryColor:d})}});const sO=M.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),Qv=M.createContext({});function Rq(){return M.useContext(Qv).visualElement}const og=M.createContext(null),Jv=typeof document<"u",fb=Jv?M.useLayoutEffect:M.useEffect,oO=M.createContext({strict:!1});function Fq(e,t,n,r){const a=Rq(),i=M.useContext(oO),s=M.useContext(og),o=M.useContext(sO).reducedMotion,l=M.useRef();r=r||i.renderer,!l.current&&r&&(l.current=r(e,{visualState:t,parent:a,props:n,presenceContext:s,blockInitialAnimation:s?s.initial===!1:!1,reducedMotionConfig:o}));const c=l.current;return M.useInsertionEffect(()=>{c&&c.update(n,s)}),fb(()=>{c&&c.render()}),M.useEffect(()=>{c&&c.updateFeatures()}),(window.HandoffAppearAnimations?fb:M.useEffect)(()=>{c&&c.animationState&&c.animationState.animateChanges()}),c}function wd(e){return typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Dq(e,t,n){return M.useCallback(r=>{r&&e.mount&&e.mount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):wd(n)&&(n.current=r))},[t])}function ym(e){return typeof e=="string"||Array.isArray(e)}function ex(e){return typeof e=="object"&&typeof e.start=="function"}const y2=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],b2=["initial",...y2];function tx(e){return ex(e.animate)||b2.some(t=>ym(e[t]))}function lO(e){return!!(tx(e)||e.variants)}function Mq(e,t){if(tx(e)){const{initial:n,animate:r}=e;return{initial:n===!1||ym(n)?n:void 0,animate:ym(r)?r:void 0}}return e.inherit!==!1?t:{}}function Oq(e){const{initial:t,animate:n}=Mq(e,M.useContext(Qv));return M.useMemo(()=>({initial:t,animate:n}),[Y$(t),Y$(n)])}function Y$(e){return Array.isArray(e)?e.join(" "):e}const Z$={animation:["animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag","whileInView"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},bm={};for(const e in Z$)bm[e]={isEnabled:t=>Z$[e].some(n=>!!t[n])};function Pq(e){for(const t in e)bm[t]={...bm[t],...e[t]}}function v2(e){const t=M.useRef(null);return t.current===null&&(t.current=e()),t.current}const Vf={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let zq=1;function Lq(){return v2(()=>{if(Vf.hasEverUpdated)return zq++})}const x2=M.createContext({}),uO=M.createContext({}),Bq=Symbol.for("motionComponentSymbol");function Wq({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:a}){e&&Pq(e);function i(o,l){let c;const u={...M.useContext(sO),...o,layoutId:Vq(o)},{isStatic:d}=u,p=Oq(o),h=d?void 0:Lq(),f=r(o,d);if(!d&&Jv){p.visualElement=Fq(a,f,u,t);const m=M.useContext(uO),g=M.useContext(oO).strict;p.visualElement&&(c=p.visualElement.loadFeatures(u,g,e,h,m))}return M.createElement(Qv.Provider,{value:p},c&&p.visualElement?M.createElement(c,{visualElement:p.visualElement,...u}):null,n(a,o,h,Dq(f,p.visualElement,l),f,d,p.visualElement))}const s=M.forwardRef(i);return s[Bq]=a,s}function Vq({layoutId:e}){const t=M.useContext(x2).id;return t&&e!==void 0?t+"-"+e:e}function Uq(e){function t(r,a={}){return Wq(e(r,a))}if(typeof Proxy>"u")return t;const n=new Map;return new Proxy(t,{get:(r,a)=>(n.has(a)||n.set(a,t(a)),n.get(a))})}const jq=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function w2(e){return typeof e!="string"||e.includes("-")?!1:!!(jq.indexOf(e)>-1||/[A-Z]/.test(e))}const mb={};function Hq(e){Object.assign(mb,e)}const nx=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Cu=new Set(nx);function cO(e,{layout:t,layoutId:n}){return Cu.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!mb[e]||e==="opacity")}const da=e=>!!(e&&e.getVelocity),Gq={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},qq=nx.length;function Kq(e,{enableHardwareAcceleration:t=!0,allowTransformNone:n=!0},r,a){let i="";for(let s=0;s<qq;s++){const o=nx[s];if(e[o]!==void 0){const l=Gq[o]||o;i+=`${l}(${e[o]}) `}}return t&&!e.z&&(i+="translateZ(0)"),i=i.trim(),a?i=a(e,r?"":i):n&&r&&(i="none"),i}const dO=e=>t=>typeof t=="string"&&t.startsWith(e),pO=dO("--"),Pk=dO("var(--"),Xq=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Zd=(e,t,n)=>Math.min(Math.max(n,e),t),_u={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Uf={..._u,transform:e=>Zd(0,1,e)},Vy={..._u,default:1},jf=e=>Math.round(e*1e5)/1e5,vm=/(-)?([\d]*\.?[\d])+/g,zk=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Yq=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function lg(e){return typeof e=="string"}const ug=e=>({test:t=>lg(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Qs=ug("deg"),Hi=ug("%"),Ve=ug("px"),Zq=ug("vh"),Qq=ug("vw"),Q$={...Hi,parse:e=>Hi.parse(e)/100,transform:e=>Hi.transform(e*100)},J$={..._u,transform:Math.round},hO={borderWidth:Ve,borderTopWidth:Ve,borderRightWidth:Ve,borderBottomWidth:Ve,borderLeftWidth:Ve,borderRadius:Ve,radius:Ve,borderTopLeftRadius:Ve,borderTopRightRadius:Ve,borderBottomRightRadius:Ve,borderBottomLeftRadius:Ve,width:Ve,maxWidth:Ve,height:Ve,maxHeight:Ve,size:Ve,top:Ve,right:Ve,bottom:Ve,left:Ve,padding:Ve,paddingTop:Ve,paddingRight:Ve,paddingBottom:Ve,paddingLeft:Ve,margin:Ve,marginTop:Ve,marginRight:Ve,marginBottom:Ve,marginLeft:Ve,rotate:Qs,rotateX:Qs,rotateY:Qs,rotateZ:Qs,scale:Vy,scaleX:Vy,scaleY:Vy,scaleZ:Vy,skew:Qs,skewX:Qs,skewY:Qs,distance:Ve,translateX:Ve,translateY:Ve,translateZ:Ve,x:Ve,y:Ve,z:Ve,perspective:Ve,transformPerspective:Ve,opacity:Uf,originX:Q$,originY:Q$,originZ:Ve,zIndex:J$,fillOpacity:Uf,strokeOpacity:Uf,numOctaves:J$};function k2(e,t,n,r){const{style:a,vars:i,transform:s,transformOrigin:o}=e;let l=!1,c=!1,u=!0;for(const d in t){const p=t[d];if(pO(d)){i[d]=p;continue}const h=hO[d],f=Xq(p,h);if(Cu.has(d)){if(l=!0,s[d]=f,!u)continue;p!==(h.default||0)&&(u=!1)}else d.startsWith("origin")?(c=!0,o[d]=f):a[d]=f}if(t.transform||(l||r?a.transform=Kq(e.transform,n,u,r):a.transform&&(a.transform="none")),c){const{originX:d="50%",originY:p="50%",originZ:h=0}=o;a.transformOrigin=`${d} ${p} ${h}`}}const S2=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function fO(e,t,n){for(const r in t)!da(t[r])&&!cO(r,n)&&(e[r]=t[r])}function Jq({transformTemplate:e},t,n){return M.useMemo(()=>{const r=S2();return k2(r,t,{enableHardwareAcceleration:!n},e),Object.assign({},r.vars,r.style)},[t])}function e7(e,t,n){const r=e.style||{},a={};return fO(a,r,e),Object.assign(a,Jq(e,t,n)),e.transformValues?e.transformValues(a):a}function t7(e,t,n){const r={},a=e7(e,t,n);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=a,r}const n7=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","ignoreStrict","viewport"]);function gb(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||n7.has(e)}let mO=e=>!gb(e);function r7(e){e&&(mO=t=>t.startsWith("on")?!gb(t):e(t))}try{r7(require("@emotion/is-prop-valid").default)}catch{}function a7(e,t,n){const r={};for(const a in e)a==="values"&&typeof e.values=="object"||(mO(a)||n===!0&&gb(a)||!t&&!gb(a)||e.draggable&&a.startsWith("onDrag"))&&(r[a]=e[a]);return r}function eA(e,t,n){return typeof e=="string"?e:Ve.transform(t+n*e)}function i7(e,t,n){const r=eA(t,e.x,e.width),a=eA(n,e.y,e.height);return`${r} ${a}`}const s7={offset:"stroke-dashoffset",array:"stroke-dasharray"},o7={offset:"strokeDashoffset",array:"strokeDasharray"};function l7(e,t,n=1,r=0,a=!0){e.pathLength=1;const i=a?s7:o7;e[i.offset]=Ve.transform(-r);const s=Ve.transform(t),o=Ve.transform(n);e[i.array]=`${s} ${o}`}function I2(e,{attrX:t,attrY:n,originX:r,originY:a,pathLength:i,pathSpacing:s=1,pathOffset:o=0,...l},c,u,d){if(k2(e,l,c,d),u){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:p,style:h,dimensions:f}=e;p.transform&&(f&&(h.transform=p.transform),delete p.transform),f&&(r!==void 0||a!==void 0||h.transform)&&(h.transformOrigin=i7(f,r!==void 0?r:.5,a!==void 0?a:.5)),t!==void 0&&(p.x=t),n!==void 0&&(p.y=n),i!==void 0&&l7(p,i,s,o,!1)}const gO=()=>({...S2(),attrs:{}}),C2=e=>typeof e=="string"&&e.toLowerCase()==="svg";function u7(e,t,n,r){const a=M.useMemo(()=>{const i=gO();return I2(i,t,{enableHardwareAcceleration:!1},C2(r),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};fO(i,e.style,e),a.style={...i,...a.style}}return a}function c7(e=!1){return(n,r,a,i,{latestValues:s},o)=>{const c=(w2(n)?u7:t7)(r,s,o,n),d={...a7(r,typeof n=="string",e),...c,ref:i},{children:p}=r,h=M.useMemo(()=>da(p)?p.get():p,[p]);return a&&(d["data-projection-id"]=a),M.createElement(n,{...d,children:h})}}const _2=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();function yO(e,{style:t,vars:n},r,a){Object.assign(e.style,t,a&&a.getProjectionStyles(r));for(const i in n)e.style.setProperty(i,n[i])}const bO=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function vO(e,t,n,r){yO(e,t,void 0,r);for(const a in t.attrs)e.setAttribute(bO.has(a)?a:_2(a),t.attrs[a])}function T2(e,t){const{style:n}=e,r={};for(const a in n)(da(n[a])||t.style&&da(t.style[a])||cO(a,e))&&(r[a]=n[a]);return r}function xO(e,t){const n=T2(e,t);for(const r in e)if(da(e[r])||da(t[r])){const a=r==="x"||r==="y"?"attr"+r.toUpperCase():r;n[a]=e[r]}return n}function N2(e,t,n,r={},a={}){return typeof t=="function"&&(t=t(n!==void 0?n:e.custom,r,a)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(n!==void 0?n:e.custom,r,a)),t}const yb=e=>Array.isArray(e),d7=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),p7=e=>yb(e)?e[e.length-1]||0:e;function z0(e){const t=da(e)?e.get():e;return d7(t)?t.toValue():t}function h7({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:n},r,a,i){const s={latestValues:f7(r,a,i,e),renderState:t()};return n&&(s.mount=o=>n(r,o,s)),s}const wO=e=>(t,n)=>{const r=M.useContext(Qv),a=M.useContext(og),i=()=>h7(e,t,r,a);return n?i():v2(i)};function f7(e,t,n,r){const a={},i=r(e,{});for(const p in i)a[p]=z0(i[p]);let{initial:s,animate:o}=e;const l=tx(e),c=lO(e);t&&c&&!l&&e.inherit!==!1&&(s===void 0&&(s=t.initial),o===void 0&&(o=t.animate));let u=n?n.initial===!1:!1;u=u||s===!1;const d=u?o:s;return d&&typeof d!="boolean"&&!ex(d)&&(Array.isArray(d)?d:[d]).forEach(h=>{const f=N2(e,h);if(!f)return;const{transitionEnd:m,transition:g,...y}=f;for(const b in y){let v=y[b];if(Array.isArray(v)){const x=u?v.length-1:0;v=v[x]}v!==null&&(a[b]=v)}for(const b in m)a[b]=m[b]}),a}const m7={useVisualState:wO({scrapeMotionValuesFromProps:xO,createRenderState:gO,onMount:(e,t,{renderState:n,latestValues:r})=>{try{n.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}I2(n,r,{enableHardwareAcceleration:!1},C2(t.tagName),e.transformTemplate),vO(t,n)}})},g7={useVisualState:wO({scrapeMotionValuesFromProps:T2,createRenderState:S2})};function y7(e,{forwardMotionProps:t=!1},n,r){return{...w2(e)?m7:g7,preloadedFeatures:n,useRender:c7(t),createVisualElement:r,Component:e}}function xs(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const kO=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function rx(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const b7=e=>t=>kO(t)&&e(t,rx(t));function Is(e,t,n,r){return xs(e,t,b7(n),r)}const v7=(e,t)=>n=>t(e(n)),go=(...e)=>e.reduce(v7);function SO(e){let t=null;return()=>{const n=()=>{t=null};return t===null?(t=e,n):!1}}const tA=SO("dragHorizontal"),nA=SO("dragVertical");function IO(e){let t=!1;if(e==="y")t=nA();else if(e==="x")t=tA();else{const n=tA(),r=nA();n&&r?t=()=>{n(),r()}:(n&&n(),r&&r())}return t}function CO(){const e=IO(!0);return e?(e(),!1):!0}class Ko{constructor(t){this.isMounted=!1,this.node=t}update(){}}function rA(e,t){const n="pointer"+(t?"enter":"leave"),r="onHover"+(t?"Start":"End"),a=(i,s)=>{if(i.type==="touch"||CO())return;const o=e.getProps();e.animationState&&o.whileHover&&e.animationState.setActive("whileHover",t),o[r]&&o[r](i,s)};return Is(e.current,n,a,{passive:!e.getProps()[r]})}class x7 extends Ko{mount(){this.unmount=go(rA(this.node,!0),rA(this.node,!1))}unmount(){}}class w7 extends Ko{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=go(xs(this.node.current,"focus",()=>this.onFocus()),xs(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const _O=(e,t)=>t?e===t?!0:_O(e,t.parentElement):!1,Qa=e=>e;function bw(e,t){if(!t)return;const n=new PointerEvent("pointer"+e);t(n,rx(n))}class k7 extends Ko{constructor(){super(...arguments),this.removeStartListeners=Qa,this.removeEndListeners=Qa,this.removeAccessibleListeners=Qa,this.startPointerPress=(t,n)=>{if(this.removeEndListeners(),this.isPressing)return;const r=this.node.getProps(),i=Is(window,"pointerup",(o,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:u}=this.node.getProps();_O(this.node.current,o.target)?c&&c(o,l):u&&u(o,l)},{passive:!(r.onTap||r.onPointerUp)}),s=Is(window,"pointercancel",(o,l)=>this.cancelPress(o,l),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=go(i,s),this.startPress(t,n)},this.startAccessiblePress=()=>{const t=i=>{if(i.key!=="Enter"||this.isPressing)return;const s=o=>{o.key!=="Enter"||!this.checkPressEnd()||bw("up",this.node.getProps().onTap)};this.removeEndListeners(),this.removeEndListeners=xs(this.node.current,"keyup",s),bw("down",(o,l)=>{this.startPress(o,l)})},n=xs(this.node.current,"keydown",t),r=()=>{this.isPressing&&bw("cancel",(i,s)=>this.cancelPress(i,s))},a=xs(this.node.current,"blur",r);this.removeAccessibleListeners=go(n,a)}}startPress(t,n){this.isPressing=!0;const{onTapStart:r,whileTap:a}=this.node.getProps();a&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&r(t,n)}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!CO()}cancelPress(t,n){if(!this.checkPressEnd())return;const{onTapCancel:r}=this.node.getProps();r&&r(t,n)}mount(){const t=this.node.getProps(),n=Is(this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),r=xs(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=go(n,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Lk=new WeakMap,vw=new WeakMap,S7=e=>{const t=Lk.get(e.target);t&&t(e)},I7=e=>{e.forEach(S7)};function C7({root:e,...t}){const n=e||document;vw.has(n)||vw.set(n,{});const r=vw.get(n),a=JSON.stringify(t);return r[a]||(r[a]=new IntersectionObserver(I7,{root:e,...t})),r[a]}function _7(e,t,n){const r=C7(t);return Lk.set(e,n),r.observe(e),()=>{Lk.delete(e),r.unobserve(e)}}const T7={some:0,all:1};class N7 extends Ko{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}viewportFallback(){requestAnimationFrame(()=>{this.hasEnteredView=!0;const{onViewportEnter:t}=this.node.getProps();t&&t(null),this.node.animationState&&this.node.animationState.setActive("whileInView",!0)})}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:a="some",once:i,fallback:s=!0}=t;if(typeof IntersectionObserver>"u"){s&&this.viewportFallback();return}const o={root:n?n.current:void 0,rootMargin:r,threshold:typeof a=="number"?a:T7[a]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:p}=this.node.getProps(),h=u?d:p;h&&h(c)};return _7(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(E7(t,n))&&this.startObserver()}unmount(){}}function E7({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const $7={inView:{Feature:N7},tap:{Feature:k7},focus:{Feature:w7},hover:{Feature:x7}};function TO(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const A7=e=>/^\-?\d*\.?\d+$/.test(e),R7=e=>/^0[^.\s]+$/.test(e),Cs={delta:0,timestamp:0},NO=1/60*1e3,F7=typeof performance<"u"?()=>performance.now():()=>Date.now(),EO=typeof window<"u"?e=>window.requestAnimationFrame(e):e=>setTimeout(()=>e(F7()),NO);function D7(e){let t=[],n=[],r=0,a=!1,i=!1;const s=new WeakSet,o={schedule:(l,c=!1,u=!1)=>{const d=u&&a,p=d?t:n;return c&&s.add(l),p.indexOf(l)===-1&&(p.push(l),d&&a&&(r=t.length)),l},cancel:l=>{const c=n.indexOf(l);c!==-1&&n.splice(c,1),s.delete(l)},process:l=>{if(a){i=!0;return}if(a=!0,[t,n]=[n,t],n.length=0,r=t.length,r)for(let c=0;c<r;c++){const u=t[c];u(l),s.has(u)&&(o.schedule(u),e())}a=!1,i&&(i=!1,o.process(l))}};return o}const M7=40;let Bk=!0,xm=!1,Wk=!1;const cg=["read","update","preRender","render","postRender"],ax=cg.reduce((e,t)=>(e[t]=D7(()=>xm=!0),e),{}),Sr=cg.reduce((e,t)=>{const n=ax[t];return e[t]=(r,a=!1,i=!1)=>(xm||P7(),n.schedule(r,a,i)),e},{}),Ro=cg.reduce((e,t)=>(e[t]=ax[t].cancel,e),{}),xw=cg.reduce((e,t)=>(e[t]=()=>ax[t].process(Cs),e),{}),O7=e=>ax[e].process(Cs),$O=e=>{xm=!1,Cs.delta=Bk?NO:Math.max(Math.min(e-Cs.timestamp,M7),1),Cs.timestamp=e,Wk=!0,cg.forEach(O7),Wk=!1,xm&&(Bk=!1,EO($O))},P7=()=>{xm=!0,Bk=!0,Wk||EO($O)};function E2(e,t){e.indexOf(t)===-1&&e.push(t)}function $2(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class A2{constructor(){this.subscriptions=[]}add(t){return E2(this.subscriptions,t),()=>$2(this.subscriptions,t)}notify(t,n,r){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,n,r);else for(let i=0;i<a;i++){const s=this.subscriptions[i];s&&s(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function R2(e,t){return t?e*(1e3/t):0}const z7=e=>!isNaN(parseFloat(e));class L7{constructor(t,n={}){this.version="9.1.7",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(r,a=!0)=>{this.prev=this.current,this.current=r;const{delta:i,timestamp:s}=Cs;this.lastUpdated!==s&&(this.timeDelta=i,this.lastUpdated=s,Sr.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),a&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Sr.postRender(this.velocityCheck),this.velocityCheck=({timestamp:r})=>{r!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=z7(this.current),this.owner=n.owner}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new A2);const r=this.events[t].add(n);return t==="change"?()=>{r(),Sr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=t,this.timeDelta=r}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?R2(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n)||null,this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){this.animation=null}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Qd(e,t){return new L7(e,t)}const F2=(e,t)=>n=>!!(lg(n)&&Yq.test(n)&&n.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(n,t)),AO=(e,t,n)=>r=>{if(!lg(r))return r;const[a,i,s,o]=r.match(vm);return{[e]:parseFloat(a),[t]:parseFloat(i),[n]:parseFloat(s),alpha:o!==void 0?parseFloat(o):1}},B7=e=>Zd(0,255,e),ww={..._u,transform:e=>Math.round(B7(e))},Ol={test:F2("rgb","red"),parse:AO("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+ww.transform(e)+", "+ww.transform(t)+", "+ww.transform(n)+", "+jf(Uf.transform(r))+")"};function W7(e){let t="",n="",r="",a="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),a=e.substring(4,5),t+=t,n+=n,r+=r,a+=a),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:a?parseInt(a,16)/255:1}}const Vk={test:F2("#"),parse:W7,transform:Ol.transform},kd={test:F2("hsl","hue"),parse:AO("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Hi.transform(jf(t))+", "+Hi.transform(jf(n))+", "+jf(Uf.transform(r))+")"},Mr={test:e=>Ol.test(e)||Vk.test(e)||kd.test(e),parse:e=>Ol.test(e)?Ol.parse(e):kd.test(e)?kd.parse(e):Vk.parse(e),transform:e=>lg(e)?e:e.hasOwnProperty("red")?Ol.transform(e):kd.transform(e)},RO="${c}",FO="${n}";function V7(e){var t,n;return isNaN(e)&&lg(e)&&(((t=e.match(vm))===null||t===void 0?void 0:t.length)||0)+(((n=e.match(zk))===null||n===void 0?void 0:n.length)||0)>0}function bb(e){typeof e=="number"&&(e=`${e}`);const t=[];let n=0,r=0;const a=e.match(zk);a&&(n=a.length,e=e.replace(zk,RO),t.push(...a.map(Mr.parse)));const i=e.match(vm);return i&&(r=i.length,e=e.replace(vm,FO),t.push(...i.map(_u.parse))),{values:t,numColors:n,numNumbers:r,tokenised:e}}function DO(e){return bb(e).values}function MO(e){const{values:t,numColors:n,tokenised:r}=bb(e),a=t.length;return i=>{let s=r;for(let o=0;o<a;o++)s=s.replace(o<n?RO:FO,o<n?Mr.transform(i[o]):jf(i[o]));return s}}const U7=e=>typeof e=="number"?0:e;function j7(e){const t=DO(e);return MO(e)(t.map(U7))}const Fo={test:V7,parse:DO,createTransformer:MO,getAnimatableNone:j7},H7=new Set(["brightness","contrast","saturate","opacity"]);function G7(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(vm)||[];if(!r)return e;const a=n.replace(r,"");let i=H7.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+a+")"}const q7=/([a-z-]*)\(.*?\)/g,Uk={...Fo,getAnimatableNone:e=>{const t=e.match(q7);return t?t.map(G7).join(" "):e}},K7={...hO,color:Mr,backgroundColor:Mr,outlineColor:Mr,fill:Mr,stroke:Mr,borderColor:Mr,borderTopColor:Mr,borderRightColor:Mr,borderBottomColor:Mr,borderLeftColor:Mr,filter:Uk,WebkitFilter:Uk},D2=e=>K7[e];function M2(e,t){let n=D2(e);return n!==Uk&&(n=Fo),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const OO=e=>t=>t.test(e),X7={test:e=>e==="auto",parse:e=>e},PO=[_u,Ve,Hi,Qs,Qq,Zq,X7],uf=e=>PO.find(OO(e)),Y7=[...PO,Mr,Fo],Z7=e=>Y7.find(OO(e));function Q7(e){const t={};return e.values.forEach((n,r)=>t[r]=n.get()),t}function J7(e){const t={};return e.values.forEach((n,r)=>t[r]=n.getVelocity()),t}function ix(e,t,n){const r=e.getProps();return N2(r,t,n!==void 0?n:r.custom,Q7(e),J7(e))}function eK(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Qd(n))}function tK(e,t){const n=ix(e,t);let{transitionEnd:r={},transition:a={},...i}=n?e.makeTargetAnimatable(n,!1):{};i={...i,...r};for(const s in i){const o=p7(i[s]);eK(e,s,o)}}function nK(e,t,n){var r,a;const i=Object.keys(t).filter(o=>!e.hasValue(o)),s=i.length;if(s)for(let o=0;o<s;o++){const l=i[o],c=t[l];let u=null;Array.isArray(c)&&(u=c[0]),u===null&&(u=(a=(r=n[l])!==null&&r!==void 0?r:e.readValue(l))!==null&&a!==void 0?a:t[l]),u!=null&&(typeof u=="string"&&(A7(u)||R7(u))?u=parseFloat(u):!Z7(u)&&Fo.test(c)&&(u=M2(l,c)),e.addValue(l,Qd(u,{owner:e})),n[l]===void 0&&(n[l]=u),u!==null&&e.setBaseTarget(l,u))}}function rK(e,t){return t?(t[e]||t.default||t).from:void 0}function aK(e,t,n){const r={};for(const a in e){const i=rK(a,t);if(i!==void 0)r[a]=i;else{const s=n.getValue(a);s&&(r[a]=s.get())}}return r}function vb(e){return!!(da(e)&&e.add)}const iK="framerAppearId",sK="data-"+_2(iK);let oK=Qa,xb=Qa;const L0=e=>e*1e3,lK={current:!1},O2=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,P2=e=>t=>1-e(1-t),z2=e=>e*e,uK=P2(z2),L2=O2(z2),on=(e,t,n)=>-n*e+n*t+e;function kw(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function cK({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let a=0,i=0,s=0;if(!t)a=i=s=n;else{const o=n<.5?n*(1+t):n+t-n*t,l=2*n-o;a=kw(l,o,e+1/3),i=kw(l,o,e),s=kw(l,o,e-1/3)}return{red:Math.round(a*255),green:Math.round(i*255),blue:Math.round(s*255),alpha:r}}const Sw=(e,t,n)=>{const r=e*e;return Math.sqrt(Math.max(0,n*(t*t-r)+r))},dK=[Vk,Ol,kd],pK=e=>dK.find(t=>t.test(e));function aA(e){const t=pK(e);let n=t.parse(e);return t===kd&&(n=cK(n)),n}const zO=(e,t)=>{const n=aA(e),r=aA(t),a={...n};return i=>(a.red=Sw(n.red,r.red,i),a.green=Sw(n.green,r.green,i),a.blue=Sw(n.blue,r.blue,i),a.alpha=on(n.alpha,r.alpha,i),Ol.transform(a))};function LO(e,t){return typeof e=="number"?n=>on(e,t,n):Mr.test(e)?zO(e,t):WO(e,t)}const BO=(e,t)=>{const n=[...e],r=n.length,a=e.map((i,s)=>LO(i,t[s]));return i=>{for(let s=0;s<r;s++)n[s]=a[s](i);return n}},hK=(e,t)=>{const n={...e,...t},r={};for(const a in n)e[a]!==void 0&&t[a]!==void 0&&(r[a]=LO(e[a],t[a]));return a=>{for(const i in r)n[i]=r[i](a);return n}},WO=(e,t)=>{const n=Fo.createTransformer(t),r=bb(e),a=bb(t);return r.numColors===a.numColors&&r.numNumbers>=a.numNumbers?go(BO(r.values,a.values),n):s=>`${s>0?t:e}`},wm=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r},iA=(e,t)=>n=>on(e,t,n);function fK(e){return typeof e=="number"?iA:typeof e=="string"?Mr.test(e)?zO:WO:Array.isArray(e)?BO:typeof e=="object"?hK:iA}function mK(e,t,n){const r=[],a=n||fK(e[0]),i=e.length-1;for(let s=0;s<i;s++){let o=a(e[s],e[s+1]);if(t){const l=Array.isArray(t)?t[s]:t;o=go(l,o)}r.push(o)}return r}function VO(e,t,{clamp:n=!0,ease:r,mixer:a}={}){const i=e.length;xb(i===t.length),xb(!r||!Array.isArray(r)||r.length===i-1),e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const s=mK(t,r,a),o=s.length,l=c=>{let u=0;if(o>1)for(;u<e.length-2&&!(c<e[u+1]);u++);const d=wm(e[u],e[u+1],c);return s[u](d)};return n?c=>l(Zd(e[0],e[i-1],c)):l}function gK(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const a=wm(0,t,r);e.push(on(n,1,a))}}function yK(e){const t=[0];return gK(t,e.length-1),t}function bK(e,t){return e.map(n=>n*t)}const UO=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,vK=1e-7,xK=12;function wK(e,t,n,r,a){let i,s,o=0;do s=t+(n-t)/2,i=UO(s,r,a)-e,i>0?n=s:t=s;while(Math.abs(i)>vK&&++o<xK);return s}function jO(e,t,n,r){if(e===t&&n===r)return Qa;const a=i=>wK(i,0,1,e,n);return i=>i===0||i===1?i:UO(a(i),t,r)}const HO=e=>1-Math.sin(Math.acos(e)),B2=P2(HO),kK=O2(B2),GO=jO(.33,1.53,.69,.99),W2=P2(GO),SK=O2(W2),IK=e=>(e*=2)<1?.5*W2(e):.5*(2-Math.pow(2,-10*(e-1))),CK={linear:Qa,easeIn:z2,easeInOut:L2,easeOut:uK,circIn:HO,circInOut:kK,circOut:B2,backIn:W2,backInOut:SK,backOut:GO,anticipate:IK},sA=e=>{if(Array.isArray(e)){xb(e.length===4);const[t,n,r,a]=e;return jO(t,n,r,a)}else if(typeof e=="string")return CK[e];return e},_K=e=>Array.isArray(e)&&typeof e[0]!="number";function TK(e,t){return e.map(()=>t||L2).splice(0,e.length-1)}function jk({keyframes:e,ease:t=L2,times:n,duration:r=300}){e=[...e];const a=_K(t)?t.map(sA):sA(t),i={done:!1,value:e[0]},s=bK(n&&n.length===e.length?n:yK(e),r);function o(){return VO(s,e,{ease:Array.isArray(a)?a:TK(e,a)})}let l=o();return{next:c=>(i.value=l(c),i.done=c>=r,i),flipTarget:()=>{e.reverse(),l=o()}}}const Iw=.001,NK=.01,oA=10,EK=.05,$K=1;function AK({duration:e=800,bounce:t=.25,velocity:n=0,mass:r=1}){let a,i;oK(e<=oA*1e3);let s=1-t;s=Zd(EK,$K,s),e=Zd(NK,oA,e/1e3),s<1?(a=c=>{const u=c*s,d=u*e,p=u-n,h=Hk(c,s),f=Math.exp(-d);return Iw-p/h*f},i=c=>{const d=c*s*e,p=d*n+n,h=Math.pow(s,2)*Math.pow(c,2)*e,f=Math.exp(-d),m=Hk(Math.pow(c,2),s);return(-a(c)+Iw>0?-1:1)*((p-h)*f)/m}):(a=c=>{const u=Math.exp(-c*e),d=(c-n)*e+1;return-Iw+u*d},i=c=>{const u=Math.exp(-c*e),d=(n-c)*(e*e);return u*d});const o=5/e,l=FK(a,i,o);if(e=e*1e3,isNaN(l))return{stiffness:100,damping:10,duration:e};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:s*2*Math.sqrt(r*c),duration:e}}}const RK=12;function FK(e,t,n){let r=n;for(let a=1;a<RK;a++)r=r-e(r)/t(r);return r}function Hk(e,t){return e*Math.sqrt(1-t*t)}const DK=["duration","bounce"],MK=["stiffness","damping","mass"];function lA(e,t){return t.some(n=>e[n]!==void 0)}function OK(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!lA(e,MK)&&lA(e,DK)){const n=AK(e);t={...t,...n,velocity:0,mass:1},t.isResolvedFromDuration=!0}return t}const PK=5;function qO({keyframes:e,restDelta:t,restSpeed:n,...r}){let a=e[0],i=e[e.length-1];const s={done:!1,value:a},{stiffness:o,damping:l,mass:c,velocity:u,duration:d,isResolvedFromDuration:p}=OK(r);let h=zK,f=u?-(u/1e3):0;const m=l/(2*Math.sqrt(o*c));function g(){const y=i-a,b=Math.sqrt(o/c)/1e3,v=Math.abs(y)<5;if(n||(n=v?.01:2),t||(t=v?.005:.5),m<1){const x=Hk(b,m);h=w=>{const S=Math.exp(-m*b*w);return i-S*((f+m*b*y)/x*Math.sin(x*w)+y*Math.cos(x*w))}}else if(m===1)h=x=>i-Math.exp(-b*x)*(y+(f+b*y)*x);else{const x=b*Math.sqrt(m*m-1);h=w=>{const S=Math.exp(-m*b*w),C=Math.min(x*w,300);return i-S*((f+m*b*y)*Math.sinh(C)+x*y*Math.cosh(C))/x}}}return g(),{next:y=>{const b=h(y);if(p)s.done=y>=d;else{let v=f;if(y!==0)if(m<1){const S=Math.max(0,y-PK);v=R2(b-h(S),y-S)}else v=0;const x=Math.abs(v)<=n,w=Math.abs(i-b)<=t;s.done=x&&w}return s.value=s.done?i:b,s},flipTarget:()=>{f=-f,[a,i]=[i,a],g()}}}qO.needsInterpolation=(e,t)=>typeof e=="string"||typeof t=="string";const zK=e=>0;function LK({keyframes:e=[0],velocity:t=0,power:n=.8,timeConstant:r=350,restDelta:a=.5,modifyTarget:i}){const s=e[0],o={done:!1,value:s};let l=n*t;const c=s+l,u=i===void 0?c:i(c);return u!==c&&(l=u-s),{next:d=>{const p=-l*Math.exp(-d/r);return o.done=!(p>a||p<-a),o.value=o.done?u:u+p,o},flipTarget:()=>{}}}const BK={decay:LK,keyframes:jk,tween:jk,spring:qO};function KO(e,t,n=0){return e-t-n}function WK(e,t=0,n=0,r=!0){return r?KO(t+-e,t,n):t-(e-t)+n}function VK(e,t,n,r){return r?e>=t+n:e<=-n}const UK=e=>{const t=({delta:n})=>e(n);return{start:()=>Sr.update(t,!0),stop:()=>Ro.update(t)}};function wb({duration:e,driver:t=UK,elapsed:n=0,repeat:r=0,repeatType:a="loop",repeatDelay:i=0,keyframes:s,autoplay:o=!0,onPlay:l,onStop:c,onComplete:u,onRepeat:d,onUpdate:p,type:h="keyframes",...f}){const m=n;let g,y=0,b=e,v=!1,x=!0,w;const S=BK[s.length>2?"keyframes":h]||jk,C=s[0],T=s[s.length-1];let E={done:!1,value:C};const{needsInterpolation:R}=S;R&&R(C,T)&&(w=VO([0,100],[C,T],{clamp:!1}),s=[0,100]);const $=S({...f,duration:e,keyframes:s});function _(){y++,a==="reverse"?(x=y%2===0,n=WK(n,b,i,x)):(n=KO(n,b,i),a==="mirror"&&$.flipTarget()),v=!1,d&&d()}function D(){g&&g.stop(),u&&u()}function P(W){x||(W=-W),n+=W,v||(E=$.next(Math.max(0,n)),w&&(E.value=w(E.value)),v=x?E.done:n<=0),p&&p(E.value),v&&(y===0&&(b=b!==void 0?b:n),y<r?VK(n,b,i,x)&&_():D())}function B(){l&&l(),g=t(P),g.start()}return o&&B(),{stop:()=>{c&&c(),g&&g.stop()},set currentTime(W){n=m,P(W)},sample:W=>{n=m;const Y=e&&typeof e=="number"?Math.max(e*.5,50):50;let O=0;for(P(0);O<=W;){const q=W-O;P(Math.min(q,Y)),O+=Y}return E}}}function jK(e){return!e||Array.isArray(e)||typeof e=="string"&&XO[e]}const Cf=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,XO={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Cf([0,.65,.55,1]),circOut:Cf([.55,0,1,.45]),backIn:Cf([.31,.01,.66,-.59]),backOut:Cf([.33,1.53,.69,.99])};function HK(e){if(e)return Array.isArray(e)?Cf(e):XO[e]}function GK(e,t,n,{delay:r=0,duration:a,repeat:i=0,repeatType:s="loop",ease:o,times:l}={}){return e.animate({[t]:n,offset:l},{delay:r,duration:a,easing:HK(o),fill:"both",iterations:i+1,direction:s==="reverse"?"alternate":"normal"})}const uA={waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate")},Cw={},YO={};for(const e in uA)YO[e]=()=>(Cw[e]===void 0&&(Cw[e]=uA[e]()),Cw[e]);function qK(e,{repeat:t,repeatType:n="loop"}){const r=t&&n!=="loop"&&t%2===1?0:e.length-1;return e[r]}const KK=new Set(["opacity","clipPath","filter","transform"]),Uy=10;function XK(e,t,{onUpdate:n,onComplete:r,...a}){if(!(YO.waapi()&&KK.has(t)&&!a.repeatDelay&&a.repeatType!=="mirror"&&a.damping!==0))return!1;let{keyframes:s,duration:o=300,elapsed:l=0,ease:c}=a;if(a.type==="spring"||!jK(a.ease)){if(a.repeat===1/0)return;const d=wb({...a,elapsed:0});let p={done:!1,value:s[0]};const h=[];let f=0;for(;!p.done&&f<2e4;)p=d.sample(f),h.push(p.value),f+=Uy;s=h,o=f-Uy,c="linear"}const u=GK(e.owner.current,t,s,{...a,delay:-l,duration:o,ease:c});return u.onfinish=()=>{e.set(qK(s,a)),Sr.update(()=>u.cancel()),r&&r()},{get currentTime(){return u.currentTime||0},set currentTime(d){u.currentTime=d},stop:()=>{const{currentTime:d}=u;if(d){const p=wb({...a,autoplay:!1});e.setWithVelocity(p.sample(d-Uy).value,p.sample(d).value,Uy)}Sr.update(()=>u.cancel())}}}function ZO(e,t){const n=performance.now(),r=({timestamp:a})=>{const i=a-n;i>=t&&(Ro.read(r),e(i-t))};return Sr.read(r,!0),()=>Ro.read(r)}function YK({keyframes:e,elapsed:t,onUpdate:n,onComplete:r}){const a=()=>{n&&n(e[e.length-1]),r&&r()};return t?{stop:ZO(a,-t)}:a()}function ZK({keyframes:e,velocity:t=0,min:n,max:r,power:a=.8,timeConstant:i=750,bounceStiffness:s=500,bounceDamping:o=10,restDelta:l=1,modifyTarget:c,driver:u,onUpdate:d,onComplete:p,onStop:h}){const f=e[0];let m;function g(x){return n!==void 0&&x<n||r!==void 0&&x>r}function y(x){return n===void 0?r:r===void 0||Math.abs(n-x)<Math.abs(r-x)?n:r}function b(x){m&&m.stop(),m=wb({keyframes:[0,1],velocity:0,...x,driver:u,onUpdate:w=>{d&&d(w),x.onUpdate&&x.onUpdate(w)},onComplete:p,onStop:h})}function v(x){b({type:"spring",stiffness:s,damping:o,restDelta:l,...x})}if(g(f))v({velocity:t,keyframes:[f,y(f)]});else{let x=a*t+f;typeof c<"u"&&(x=c(x));const w=y(x),S=w===n?-1:1;let C,T;const E=R=>{C=T,T=R,t=R2(R-C,Cs.delta),(S===1&&R>w||S===-1&&R<w)&&v({keyframes:[R,w],velocity:t})};b({type:"decay",keyframes:[f,0],velocity:t,timeConstant:i,power:a,restDelta:l,modifyTarget:c,onUpdate:g(x)?E:void 0})}return{stop:()=>m&&m.stop()}}const QK={type:"spring",stiffness:500,damping:25,restSpeed:10},JK=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),eX={type:"keyframes",duration:.8},tX={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},nX=(e,{keyframes:t})=>t.length>2?eX:Cu.has(e)?e.startsWith("scale")?JK(t[1]):QK:tX,Gk=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&Fo.test(t)&&!t.startsWith("url("));function rX({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:a,repeat:i,repeatType:s,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function cA(e){return e===0||typeof e=="string"&&parseFloat(e)===0&&e.indexOf(" ")===-1}function dA(e){return typeof e=="number"?0:M2("",e)}function QO(e,t){return e[t]||e.default||e}function aX(e,t,n,r){const a=Gk(t,n);let i=r.from!==void 0?r.from:e.get();return i==="none"&&a&&typeof n=="string"?i=M2(t,n):cA(i)&&typeof n=="string"?i=dA(n):!Array.isArray(n)&&cA(n)&&typeof i=="string"&&(n=dA(i)),Array.isArray(n)?(n[0]===null&&(n[0]=i),n):[i,n]}const V2=(e,t,n,r={})=>a=>{const i=QO(r,e)||{},s=i.delay||r.delay||0;let{elapsed:o=0}=r;o=o-L0(s);const l=aX(t,e,n,i),c=l[0],u=l[l.length-1],d=Gk(e,c),p=Gk(e,u);let h={keyframes:l,velocity:t.getVelocity(),...i,elapsed:o,onUpdate:f=>{t.set(f),i.onUpdate&&i.onUpdate(f)},onComplete:()=>{a(),i.onComplete&&i.onComplete()}};if(!d||!p||lK.current||i.type===!1)return YK(h);if(i.type==="inertia")return ZK(h);if(rX(i)||(h={...h,...nX(e,h)}),h.duration&&(h.duration=L0(h.duration)),h.repeatDelay&&(h.repeatDelay=L0(h.repeatDelay)),t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const f=XK(t,e,h);if(f)return f}return wb(h)};function iX(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const a=t.map(i=>qk(e,i,n));r=Promise.all(a)}else if(typeof t=="string")r=qk(e,t,n);else{const a=typeof t=="function"?ix(e,t,n.custom):t;r=JO(e,a,n)}return r.then(()=>e.notify("AnimationComplete",t))}function qk(e,t,n={}){const r=ix(e,t,n.custom);let{transition:a=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(a=n.transitionOverride);const i=r?()=>JO(e,r,n):()=>Promise.resolve(),s=e.variantChildren&&e.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:u,staggerDirection:d}=a;return sX(e,t,c+l,u,d,n)}:()=>Promise.resolve(),{when:o}=a;if(o){const[l,c]=o==="beforeChildren"?[i,s]:[s,i];return l().then(c)}else return Promise.all([i(),s(n.delay)])}function JO(e,t,{delay:n=0,transitionOverride:r,type:a}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:s,...o}=e.makeTargetAnimatable(t);const l=e.getValue("willChange");r&&(i=r);const c=[],u=a&&e.animationState&&e.animationState.getState()[a];for(const d in o){const p=e.getValue(d),h=o[d];if(!p||h===void 0||u&&lX(u,d))continue;const f={delay:n,elapsed:0,...i};if(window.HandoffAppearAnimations&&!p.hasAnimated){const g=e.getProps()[sK];g&&(f.elapsed=window.HandoffAppearAnimations(g,d,p,Sr))}let m=p.start(V2(d,p,h,e.shouldReduceMotion&&Cu.has(d)?{type:!1}:f));vb(l)&&(l.add(d),m=m.then(()=>l.remove(d))),c.push(m)}return Promise.all(c).then(()=>{s&&tK(e,s)})}function sX(e,t,n=0,r=0,a=1,i){const s=[],o=(e.variantChildren.size-1)*r,l=a===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(e.variantChildren).sort(oX).forEach((c,u)=>{c.notify("AnimationStart",t),s.push(qk(c,t,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(s)}function oX(e,t){return e.sortNodePosition(t)}function lX({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}const uX=[...y2].reverse(),cX=y2.length;function dX(e){return t=>Promise.all(t.map(({animation:n,options:r})=>iX(e,n,r)))}function pX(e){let t=dX(e);const n=fX();let r=!0;const a=(l,c)=>{const u=ix(e,c);if(u){const{transition:d,transitionEnd:p,...h}=u;l={...l,...h,...p}}return l};function i(l){t=l(e)}function s(l,c){const u=e.getProps(),d=e.getVariantContext(!0)||{},p=[],h=new Set;let f={},m=1/0;for(let y=0;y<cX;y++){const b=uX[y],v=n[b],x=u[b]!==void 0?u[b]:d[b],w=ym(x),S=b===c?v.isActive:null;S===!1&&(m=y);let C=x===d[b]&&x!==u[b]&&w;if(C&&r&&e.manuallyAnimateOnMount&&(C=!1),v.protectedKeys={...f},!v.isActive&&S===null||!x&&!v.prevProp||ex(x)||typeof x=="boolean")continue;const T=hX(v.prevProp,x);let E=T||b===c&&v.isActive&&!C&&w||y>m&&w;const R=Array.isArray(x)?x:[x];let $=R.reduce(a,{});S===!1&&($={});const{prevResolvedValues:_={}}=v,D={..._,...$},P=B=>{E=!0,h.delete(B),v.needsAnimating[B]=!0};for(const B in D){const W=$[B],Y=_[B];f.hasOwnProperty(B)||(W!==Y?yb(W)&&yb(Y)?!TO(W,Y)||T?P(B):v.protectedKeys[B]=!0:W!==void 0?P(B):h.add(B):W!==void 0&&h.has(B)?P(B):v.protectedKeys[B]=!0)}v.prevProp=x,v.prevResolvedValues=$,v.isActive&&(f={...f,...$}),r&&e.blockInitialAnimation&&(E=!1),E&&!C&&p.push(...R.map(B=>({animation:B,options:{type:b,...l}})))}if(h.size){const y={};h.forEach(b=>{const v=e.getBaseTarget(b);v!==void 0&&(y[b]=v)}),p.push({animation:y})}let g=!!p.length;return r&&u.initial===!1&&!e.manuallyAnimateOnMount&&(g=!1),r=!1,g?t(p):Promise.resolve()}function o(l,c,u){var d;if(n[l].isActive===c)return Promise.resolve();(d=e.variantChildren)===null||d===void 0||d.forEach(h=>{var f;return(f=h.animationState)===null||f===void 0?void 0:f.setActive(l,c)}),n[l].isActive=c;const p=s(u,l);for(const h in n)n[h].protectedKeys={};return p}return{animateChanges:s,setActive:o,setAnimateFunction:i,getState:()=>n}}function hX(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!TO(t,e):!1}function yl(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function fX(){return{animate:yl(!0),whileInView:yl(),whileHover:yl(),whileTap:yl(),whileDrag:yl(),whileFocus:yl(),exit:yl()}}class mX extends Ko{constructor(t){super(t),t.animationState||(t.animationState=pX(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),ex(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let gX=0;class yX extends Ko{constructor(){super(...arguments),this.id=gX++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n,custom:r}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const i=this.node.animationState.setActive("exit",!t,{custom:r??this.node.getProps().custom});n&&!t&&i.then(()=>n(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const bX={animation:{Feature:mX},exit:{Feature:yX}},pA=(e,t)=>Math.abs(e-t);function vX(e,t){const n=pA(e.x,t.x),r=pA(e.y,t.y);return Math.sqrt(n**2+r**2)}class e3{constructor(t,n,{transformPagePoint:r}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const c=Tw(this.lastMoveEventInfo,this.history),u=this.startEvent!==null,d=vX(c.offset,{x:0,y:0})>=3;if(!u&&!d)return;const{point:p}=c,{timestamp:h}=Cs;this.history.push({...p,timestamp:h});const{onStart:f,onMove:m}=this.handlers;u||(f&&f(this.lastMoveEvent,c),this.startEvent=this.lastMoveEvent),m&&m(this.lastMoveEvent,c)},this.handlePointerMove=(c,u)=>{this.lastMoveEvent=c,this.lastMoveEventInfo=_w(u,this.transformPagePoint),Sr.update(this.updatePoint,!0)},this.handlePointerUp=(c,u)=>{if(this.end(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const{onEnd:d,onSessionEnd:p}=this.handlers,h=Tw(c.type==="pointercancel"?this.lastMoveEventInfo:_w(u,this.transformPagePoint),this.history);this.startEvent&&d&&d(c,h),p&&p(c,h)},!kO(t))return;this.handlers=n,this.transformPagePoint=r;const a=rx(t),i=_w(a,this.transformPagePoint),{point:s}=i,{timestamp:o}=Cs;this.history=[{...s,timestamp:o}];const{onSessionStart:l}=n;l&&l(t,Tw(i,this.history)),this.removeListeners=go(Is(window,"pointermove",this.handlePointerMove),Is(window,"pointerup",this.handlePointerUp),Is(window,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Ro.update(this.updatePoint)}}function _w(e,t){return t?{point:t(e.point)}:e}function hA(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Tw({point:e},t){return{point:e,delta:hA(e,t3(t)),offset:hA(e,xX(t)),velocity:wX(t,.1)}}function xX(e){return e[0]}function t3(e){return e[e.length-1]}function wX(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const a=t3(e);for(;n>=0&&(r=e[n],!(a.timestamp-r.timestamp>L0(t)));)n--;if(!r)return{x:0,y:0};const i=(a.timestamp-r.timestamp)/1e3;if(i===0)return{x:0,y:0};const s={x:(a.x-r.x)/i,y:(a.y-r.y)/i};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}function Aa(e){return e.max-e.min}function Kk(e,t=0,n=.01){return Math.abs(e-t)<=n}function fA(e,t,n,r=.5){e.origin=r,e.originPoint=on(t.min,t.max,e.origin),e.scale=Aa(n)/Aa(t),(Kk(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=on(n.min,n.max,e.origin)-e.originPoint,(Kk(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Hf(e,t,n,r){fA(e.x,t.x,n.x,r?r.originX:void 0),fA(e.y,t.y,n.y,r?r.originY:void 0)}function mA(e,t,n){e.min=n.min+t.min,e.max=e.min+Aa(t)}function kX(e,t,n){mA(e.x,t.x,n.x),mA(e.y,t.y,n.y)}function gA(e,t,n){e.min=t.min-n.min,e.max=e.min+Aa(t)}function Gf(e,t,n){gA(e.x,t.x,n.x),gA(e.y,t.y,n.y)}function SX(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?on(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?on(n,e,r.max):Math.min(e,n)),e}function yA(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function IX(e,{top:t,left:n,bottom:r,right:a}){return{x:yA(e.x,n,a),y:yA(e.y,t,r)}}function bA(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function CX(e,t){return{x:bA(e.x,t.x),y:bA(e.y,t.y)}}function _X(e,t){let n=.5;const r=Aa(e),a=Aa(t);return a>r?n=wm(t.min,t.max-r,e.min):r>a&&(n=wm(e.min,e.max-a,t.min)),Zd(0,1,n)}function TX(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const Xk=.35;function NX(e=Xk){return e===!1?e=0:e===!0&&(e=Xk),{x:vA(e,"left","right"),y:vA(e,"top","bottom")}}function vA(e,t,n){return{min:xA(e,t),max:xA(e,n)}}function xA(e,t){return typeof e=="number"?e:e[t]||0}const wA=()=>({translate:0,scale:1,origin:0,originPoint:0}),qf=()=>({x:wA(),y:wA()}),kA=()=>({min:0,max:0}),Tn=()=>({x:kA(),y:kA()});function Fi(e){return[e("x"),e("y")]}function n3({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function EX({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function $X(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function Nw(e){return e===void 0||e===1}function Yk({scale:e,scaleX:t,scaleY:n}){return!Nw(e)||!Nw(t)||!Nw(n)}function wl(e){return Yk(e)||r3(e)||e.z||e.rotate||e.rotateX||e.rotateY}function r3(e){return SA(e.x)||SA(e.y)}function SA(e){return e&&e!=="0%"}function kb(e,t,n){const r=e-n,a=t*r;return n+a}function IA(e,t,n,r,a){return a!==void 0&&(e=kb(e,a,r)),kb(e,n,r)+t}function Zk(e,t=0,n=1,r,a){e.min=IA(e.min,t,n,r,a),e.max=IA(e.max,t,n,r,a)}function a3(e,{x:t,y:n}){Zk(e.x,t.translate,t.scale,t.originPoint),Zk(e.y,n.translate,n.scale,n.originPoint)}function AX(e,t,n,r=!1){const a=n.length;if(!a)return;t.x=t.y=1;let i,s;for(let o=0;o<a;o++){i=n[o],s=i.projectionDelta;const l=i.instance;l&&l.style&&l.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Sd(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),s&&(t.x*=s.x.scale,t.y*=s.y.scale,a3(e,s)),r&&wl(i.latestValues)&&Sd(e,i.latestValues))}t.x=CA(t.x),t.y=CA(t.y)}function CA(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function to(e,t){e.min=e.min+t,e.max=e.max+t}function _A(e,t,[n,r,a]){const i=t[a]!==void 0?t[a]:.5,s=on(e.min,e.max,i);Zk(e,t[n],t[r],s,t.scale)}const RX=["x","scaleX","originX"],FX=["y","scaleY","originY"];function Sd(e,t){_A(e.x,t,RX),_A(e.y,t,FX)}function i3(e,t){return n3($X(e.getBoundingClientRect(),t))}function DX(e,t,n){const r=i3(e,n),{scroll:a}=t;return a&&(to(r.x,a.offset.x),to(r.y,a.offset.y)),r}const MX=new WeakMap;class OX{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Tn(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const a=l=>{this.stopAnimation(),n&&this.snapToCursor(rx(l,"page").point)},i=(l,c)=>{const{drag:u,dragPropagation:d,onDragStart:p}=this.getProps();if(u&&!d&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=IO(u),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Fi(f=>{let m=this.getAxisMotionValue(f).get()||0;if(Hi.test(m)){const{projection:g}=this.visualElement;if(g&&g.layout){const y=g.layout.layoutBox[f];y&&(m=Aa(y)*(parseFloat(m)/100))}}this.originPoint[f]=m}),p&&p(l,c);const{animationState:h}=this.visualElement;h&&h.setActive("whileDrag",!0)},s=(l,c)=>{const{dragPropagation:u,dragDirectionLock:d,onDirectionLock:p,onDrag:h}=this.getProps();if(!u&&!this.openGlobalLock)return;const{offset:f}=c;if(d&&this.currentDirection===null){this.currentDirection=PX(f),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",c.point,f),this.updateAxis("y",c.point,f),this.visualElement.render(),h&&h(l,c)},o=(l,c)=>this.stop(l,c);this.panSession=new e3(t,{onSessionStart:a,onStart:i,onMove:s,onSessionEnd:o},{transformPagePoint:this.visualElement.getTransformPagePoint()})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:a}=n;this.startAnimation(a);const{onDragEnd:i}=this.getProps();i&&i(t,n)}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:a}=this.getProps();if(!r||!jy(t,a,this.currentDirection))return;const i=this.getAxisMotionValue(t);let s=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(s=SX(s,this.constraints[t],this.elastic[t])),i.set(s)}resolveConstraints(){const{dragConstraints:t,dragElastic:n}=this.getProps(),{layout:r}=this.visualElement.projection||{},a=this.constraints;t&&wd(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=IX(r.layoutBox,t):this.constraints=!1,this.elastic=NX(n),a!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Fi(i=>{this.getAxisMotionValue(i)&&(this.constraints[i]=TX(r.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!wd(t))return!1;const r=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const i=DX(r,a.root,this.visualElement.getTransformPagePoint());let s=CX(a.layout.layoutBox,i);if(n){const o=n(EX(s));this.hasMutatedConstraints=!!o,o&&(s=n3(o))}return s}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:a,dragTransition:i,dragSnapToOrigin:s,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Fi(u=>{if(!jy(u,n,this.currentDirection))return;let d=l&&l[u]||{};s&&(d={min:0,max:0});const p=a?200:1e6,h=a?40:1e7,f={type:"inertia",velocity:r?t[u]:0,bounceStiffness:p,bounceDamping:h,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(u,f)});return Promise.all(c).then(o)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return r.start(V2(t,r,0,n))}stopAnimation(){Fi(t=>this.getAxisMotionValue(t).stop())}getAxisMotionValue(t){const n="_drag"+t.toUpperCase(),r=this.visualElement.getProps(),a=r[n];return a||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Fi(n=>{const{drag:r}=this.getProps();if(!jy(n,r,this.currentDirection))return;const{projection:a}=this.visualElement,i=this.getAxisMotionValue(n);if(a&&a.layout){const{min:s,max:o}=a.layout.layoutBox[n];i.set(t[n]-on(s,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!wd(n)||!r||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};Fi(s=>{const o=this.getAxisMotionValue(s);if(o){const l=o.get();a[s]=_X({min:l,max:l},this.constraints[s])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Fi(s=>{if(!jy(s,t,null))return;const o=this.getAxisMotionValue(s),{min:l,max:c}=this.constraints[s];o.set(on(l,c,a[s]))})}addListeners(){if(!this.visualElement.current)return;MX.set(this.visualElement,this);const t=this.visualElement.current,n=Is(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();wd(l)&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,i=a.addEventListener("measure",r);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),r();const s=xs(window,"resize",()=>this.scalePositionWithinConstraints()),o=a.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Fi(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{s(),n(),i(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:a=!1,dragConstraints:i=!1,dragElastic:s=Xk,dragMomentum:o=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:a,dragConstraints:i,dragElastic:s,dragMomentum:o}}}function jy(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function PX(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class zX extends Ko{constructor(t){super(t),this.removeGroupControls=Qa,this.removeListeners=Qa,this.controls=new OX(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Qa}unmount(){this.removeGroupControls(),this.removeListeners()}}class LX extends Ko{constructor(){super(...arguments),this.removePointerDownListener=Qa}onPointerDown(t){this.session=new e3(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:a}=this.node.getProps();return{onSessionStart:t,onStart:n,onMove:r,onEnd:(i,s)=>{delete this.session,a&&a(i,s)}}}mount(){this.removePointerDownListener=Is(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function BX(){const e=M.useContext(og);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:n,register:r}=e,a=M.useId();return M.useEffect(()=>r(a),[]),!t&&n?[!1,()=>n&&n(a)]:[!0]}function WX(){return VX(M.useContext(og))}function VX(e){return e===null?!0:e.isPresent}function TA(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const cf={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Ve.test(e))e=parseFloat(e);else return e;const n=TA(e,t.target.x),r=TA(e,t.target.y);return`${n}% ${r}%`}},s3=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function UX(e){const t=s3.exec(e);if(!t)return[,];const[,n,r]=t;return[n,r]}function Qk(e,t,n=1){const[r,a]=UX(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);return i?i.trim():Pk(a)?Qk(a,t,n+1):a}function jX(e,{...t},n){const r=e.current;if(!(r instanceof Element))return{target:t,transitionEnd:n};n&&(n={...n}),e.values.forEach(a=>{const i=a.get();if(!Pk(i))return;const s=Qk(i,r);s&&a.set(s)});for(const a in t){const i=t[a];if(!Pk(i))continue;const s=Qk(i,r);s&&(t[a]=s,n&&n[a]===void 0&&(n[a]=i))}return{target:t,transitionEnd:n}}const NA="_$css",HX={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,a=e.includes("var("),i=[];a&&(e=e.replace(s3,h=>(i.push(h),NA)));const s=Fo.parse(e);if(s.length>5)return r;const o=Fo.createTransformer(e),l=typeof s[0]!="number"?1:0,c=n.x.scale*t.x,u=n.y.scale*t.y;s[0+l]/=c,s[1+l]/=u;const d=on(c,u,.5);typeof s[2+l]=="number"&&(s[2+l]/=d),typeof s[3+l]=="number"&&(s[3+l]/=d);let p=o(s);if(a){let h=0;p=p.replace(NA,()=>{const f=i[h];return h++,f})}return p}};class GX extends Za.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:a}=this.props,{projection:i}=t;Hq(qX),i&&(n.group&&n.group.add(i),r&&r.register&&a&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Vf.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:a,isPresent:i}=this.props,s=r.projection;return s&&(s.isPresent=i,a||t.layoutDependency!==n||n===void 0?s.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?s.promote():s.relegate()||Sr.postRender(()=>{const o=s.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),!t.currentAnimation&&t.isLead()&&this.safeToRemove())}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:a}=t;a&&(a.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(a),r&&r.deregister&&r.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function o3(e){const[t,n]=BX(),r=M.useContext(x2);return Za.createElement(GX,{...e,layoutGroup:r,switchLayoutGroup:M.useContext(uO),isPresent:t,safeToRemove:n})}const qX={borderRadius:{...cf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:cf,borderTopRightRadius:cf,borderBottomLeftRadius:cf,borderBottomRightRadius:cf,boxShadow:HX};function KX(e,t,n={}){const r=da(e)?e:Qd(e);return r.start(V2("",r,t,n)),{stop:()=>r.stop(),isAnimating:()=>r.isAnimating()}}const l3=["TopLeft","TopRight","BottomLeft","BottomRight"],XX=l3.length,EA=e=>typeof e=="string"?parseFloat(e):e,$A=e=>typeof e=="number"||Ve.test(e);function YX(e,t,n,r,a,i){a?(e.opacity=on(0,n.opacity!==void 0?n.opacity:1,ZX(r)),e.opacityExit=on(t.opacity!==void 0?t.opacity:1,0,QX(r))):i&&(e.opacity=on(t.opacity!==void 0?t.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let s=0;s<XX;s++){const o=`border${l3[s]}Radius`;let l=AA(t,o),c=AA(n,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||$A(l)===$A(c)?(e[o]=Math.max(on(EA(l),EA(c),r),0),(Hi.test(c)||Hi.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||n.rotate)&&(e.rotate=on(t.rotate||0,n.rotate||0,r))}function AA(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const ZX=u3(0,.5,B2),QX=u3(.5,.95,Qa);function u3(e,t,n){return r=>r<e?0:r>t?1:n(wm(e,t,r))}function RA(e,t){e.min=t.min,e.max=t.max}function Wa(e,t){RA(e.x,t.x),RA(e.y,t.y)}function FA(e,t,n,r,a){return e-=t,e=kb(e,1/n,r),a!==void 0&&(e=kb(e,1/a,r)),e}function JX(e,t=0,n=1,r=.5,a,i=e,s=e){if(Hi.test(t)&&(t=parseFloat(t),t=on(s.min,s.max,t/100)-s.min),typeof t!="number")return;let o=on(i.min,i.max,r);e===i&&(o-=t),e.min=FA(e.min,t,n,o,a),e.max=FA(e.max,t,n,o,a)}function DA(e,t,[n,r,a],i,s){JX(e,t[n],t[r],t[a],t.scale,i,s)}const eY=["x","scaleX","originX"],tY=["y","scaleY","originY"];function MA(e,t,n,r){DA(e.x,t,eY,n?n.x:void 0,r?r.x:void 0),DA(e.y,t,tY,n?n.y:void 0,r?r.y:void 0)}function OA(e){return e.translate===0&&e.scale===1}function c3(e){return OA(e.x)&&OA(e.y)}function Jk(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function PA(e){return Aa(e.x)/Aa(e.y)}class nY{constructor(){this.members=[]}add(t){E2(this.members,t),t.scheduleRender()}remove(t){if($2(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(a=>t===a);if(n===0)return!1;let r;for(let a=n;a>=0;a--){const i=this.members[a];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function zA(e,t,n){let r="";const a=e.x.translate/t.x,i=e.y.translate/t.y;if((a||i)&&(r=`translate3d(${a}px, ${i}px, 0) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{rotate:l,rotateX:c,rotateY:u}=n;l&&(r+=`rotate(${l}deg) `),c&&(r+=`rotateX(${c}deg) `),u&&(r+=`rotateY(${u}deg) `)}const s=e.x.scale*t.x,o=e.y.scale*t.y;return(s!==1||o!==1)&&(r+=`scale(${s}, ${o})`),r||"none"}const rY=(e,t)=>e.depth-t.depth;class aY{constructor(){this.children=[],this.isDirty=!1}add(t){E2(this.children,t),this.isDirty=!0}remove(t){$2(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(rY),this.isDirty=!1,this.children.forEach(t)}}function iY(e){window.MotionDebug&&window.MotionDebug.record(e)}const LA=["","X","Y","Z"],BA=1e3;let sY=0;const kl={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function d3({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:a}){return class{constructor(s,o={},l=t==null?void 0:t()){this.id=sY++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.potentialNodes=new Map,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{kl.totalNodes=kl.resolvedTargetDeltas=kl.recalculatedProjection=0,this.nodes.forEach(uY),this.nodes.forEach(hY),this.nodes.forEach(fY),this.nodes.forEach(cY),iY(kl)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.elementId=s,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0,s&&this.root.registerPotentialNode(s,this);for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new aY)}addEventListener(s,o){return this.eventHandlers.has(s)||this.eventHandlers.set(s,new A2),this.eventHandlers.get(s).add(o)}notifyListeners(s,...o){const l=this.eventHandlers.get(s);l&&l.notify(...o)}hasListeners(s){return this.eventHandlers.has(s)}registerPotentialNode(s,o){this.potentialNodes.set(s,o)}mount(s,o=!1){if(this.instance)return;this.isSVG=s instanceof SVGElement&&s.tagName!=="svg",this.instance=s;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(s),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.elementId&&this.root.potentialNodes.delete(this.elementId),o&&(c||l)&&(this.isLayoutDirty=!0),e){let d;const p=()=>this.root.updateBlockedByResize=!1;e(s,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=ZO(p,250),Vf.hasAnimatedSinceResize&&(Vf.hasAnimatedSinceResize=!1,this.nodes.forEach(VA))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:p,hasRelativeTargetChanged:h,layout:f})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||u.getDefaultTransition()||vY,{onLayoutAnimationStart:g,onLayoutAnimationComplete:y}=u.getProps(),b=!this.targetLayout||!Jk(this.targetLayout,f)||h,v=!p&&h;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||v||p&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(d,v);const x={...QO(m,"layout"),onPlay:g,onComplete:y};(u.shouldReduceMotion||this.options.layoutRoot)&&(x.delay=0,x.type=!1),this.startAnimation(x)}else!p&&this.animationProgress===0&&VA(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=f})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const s=this.getStack();s&&s.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ro.preRender(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(mY),this.animationId++)}getTransformTemplate(){const{visualElement:s}=this.options;return s&&s.getProps().transformTemplate}willUpdate(s=!0){if(this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),s&&this.notifyListeners("willUpdate")}didUpdate(){if(this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(WA);return}this.isUpdating&&(this.isUpdating=!1,this.potentialNodes.size&&(this.potentialNodes.forEach(xY),this.potentialNodes.clear()),this.nodes.forEach(pY),this.nodes.forEach(oY),this.nodes.forEach(lY),this.clearAllSnapshots(),xw.update(),xw.preRender(),xw.render())}clearAllSnapshots(){this.nodes.forEach(dY),this.sharedNodes.forEach(gY)}scheduleUpdateProjection(){Sr.preRender(this.updateProjection,!1,!0)}scheduleCheckAfterUnmount(){Sr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const s=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Tn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,s?s.layoutBox:void 0)}updateScroll(s="measure"){let o=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===s&&(o=!1),o&&(this.scroll={animationId:this.root.animationId,phase:s,isRoot:r(this.instance),offset:n(this.instance)})}resetTransform(){if(!a)return;const s=this.isLayoutDirty||this.shouldResetTransform,o=this.projectionDelta&&!c3(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;s&&(o||wl(this.latestValues)||u)&&(a(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(s=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return s&&(l=this.removeTransform(l)),wY(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:s}=this.options;if(!s)return Tn();const o=s.measureViewportBox(),{scroll:l}=this.root;return l&&(to(o.x,l.offset.x),to(o.y,l.offset.y)),o}removeElementScroll(s){const o=Tn();Wa(o,s);for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:u,options:d}=c;if(c!==this.root&&u&&d.layoutScroll){if(u.isRoot){Wa(o,s);const{scroll:p}=this.root;p&&(to(o.x,-p.offset.x),to(o.y,-p.offset.y))}to(o.x,u.offset.x),to(o.y,u.offset.y)}}return o}applyTransform(s,o=!1){const l=Tn();Wa(l,s);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Sd(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),wl(u.latestValues)&&Sd(l,u.latestValues)}return wl(this.latestValues)&&Sd(l,this.latestValues),l}removeTransform(s){const o=Tn();Wa(o,s);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!wl(c.latestValues))continue;Yk(c.latestValues)&&c.updateSnapshot();const u=Tn(),d=c.measurePageBox();Wa(u,d),MA(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return wl(this.latestValues)&&MA(o,this.latestValues),o}setTargetDelta(s){this.targetDelta=s,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(s){this.options={...this.options,...s,crossfade:s.crossfade!==void 0?s.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}resolveTargetDelta(){var s;const o=this.getLead();if(this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty),!((!!this.resumingFrom||this!==o)&&this.isSharedProjectionDirty||this.isProjectionDirty||!((s=this.parent)===null||s===void 0)&&s.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout?(this.relativeParent=p,this.relativeTarget=Tn(),this.relativeTargetOrigin=Tn(),Gf(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),Wa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Tn(),this.targetWithTransforms=Tn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?kX(this.target,this.relativeTarget,this.relativeParent.target):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Wa(this.target,this.layout.layoutBox),a3(this.target,this.targetDelta)):Wa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target?(this.relativeParent=p,this.relativeTarget=Tn(),this.relativeTargetOrigin=Tn(),Gf(this.relativeTargetOrigin,this.target,p.target),Wa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}kl.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Yk(this.parent.latestValues)||r3(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var s;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||!((s=this.parent)===null||s===void 0)&&s.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;Wa(this.layoutCorrected,this.layout.layoutBox),AX(this.layoutCorrected,this.treeScale,this.path,l);const{target:p}=o;if(!p)return;this.projectionDelta||(this.projectionDelta=qf(),this.projectionDeltaWithTransform=qf());const h=this.treeScale.x,f=this.treeScale.y,m=this.projectionTransform;Hf(this.projectionDelta,this.layoutCorrected,p,this.latestValues),this.projectionTransform=zA(this.projectionDelta,this.treeScale),(this.projectionTransform!==m||this.treeScale.x!==h||this.treeScale.y!==f)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p)),kl.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(s=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),s){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(s,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=qf();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const p=Tn(),h=l?l.source:void 0,f=this.layout?this.layout.source:void 0,m=h!==f,g=this.getStack(),y=!g||g.members.length<=1,b=!!(m&&!y&&this.options.crossfade===!0&&!this.path.some(bY));this.animationProgress=0;let v;this.mixTargetDelta=x=>{const w=x/1e3;UA(d.x,s.x,w),UA(d.y,s.y,w),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Gf(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),yY(this.relativeTarget,this.relativeTargetOrigin,p,w),v&&Jk(this.relativeTarget,v)&&(this.isProjectionDirty=!1),v||(v=Tn()),Wa(v,this.relativeTarget)),m&&(this.animationValues=u,YX(u,c,this.latestValues,w,b,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=w},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(s){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ro.update(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Sr.update(()=>{Vf.hasAnimatedSinceResize=!0,this.currentAnimation=KX(0,BA,{...s,onUpdate:o=>{this.mixTargetDelta(o),s.onUpdate&&s.onUpdate(o)},onComplete:()=>{s.onComplete&&s.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const s=this.getStack();s&&s.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(BA),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const s=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=s;if(!(!o||!l||!c)){if(this!==s&&this.layout&&c&&p3(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Tn();const d=Aa(this.layout.layoutBox.x);l.x.min=s.target.x.min,l.x.max=l.x.min+d;const p=Aa(this.layout.layoutBox.y);l.y.min=s.target.y.min,l.y.max=l.y.min+p}Wa(o,l),Sd(o,u),Hf(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(s,o){this.sharedNodes.has(s)||this.sharedNodes.set(s,new nY),this.sharedNodes.get(s).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const s=this.getStack();return s?s.lead===this:!0}getLead(){var s;const{layoutId:o}=this.options;return o?((s=this.getStack())===null||s===void 0?void 0:s.lead)||this:this}getPrevLead(){var s;const{layoutId:o}=this.options;return o?(s=this.getStack())===null||s===void 0?void 0:s.prevLead:void 0}getStack(){const{layoutId:s}=this.options;if(s)return this.root.sharedNodes.get(s)}promote({needsReset:s,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),s&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const s=this.getStack();return s?s.relegate(this):!1}resetRotation(){const{visualElement:s}=this.options;if(!s)return;let o=!1;const{latestValues:l}=s;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(o=!0),!o)return;const c={};for(let u=0;u<LA.length;u++){const d="rotate"+LA[u];l[d]&&(c[d]=l[d],s.setStaticValue(d,0))}s.render();for(const u in c)s.setStaticValue(u,c[u]);s.scheduleRender()}getProjectionStyles(s={}){var o,l;const c={};if(!this.instance||this.isSVG)return c;if(this.isVisible)c.visibility="";else return{visibility:"hidden"};const u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=z0(s.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=z0(s.pointerEvents)||""),this.hasProjected&&!wl(this.latestValues)&&(m.transform=u?u({},""):"none",this.hasProjected=!1),m}const p=d.animationValues||d.latestValues;this.applyTransformsToTarget(),c.transform=zA(this.projectionDeltaWithTransform,this.treeScale,p),u&&(c.transform=u(p,c.transform));const{x:h,y:f}=this.projectionDelta;c.transformOrigin=`${h.origin*100}% ${f.origin*100}% 0`,d.animationValues?c.opacity=d===this?(l=(o=p.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:c.opacity=d===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const m in mb){if(p[m]===void 0)continue;const{correct:g,applyTo:y}=mb[m],b=c.transform==="none"?p[m]:g(p[m],d);if(y){const v=y.length;for(let x=0;x<v;x++)c[y[x]]=b}else c[m]=b}return this.options.layoutId&&(c.pointerEvents=d===this?z0(s.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(s=>{var o;return(o=s.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(WA),this.root.sharedNodes.clear()}}}function oY(e){e.updateLayout()}function lY(e){var t;const n=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:a}=e.layout,{animationType:i}=e.options,s=n.source!==e.layout.source;i==="size"?Fi(d=>{const p=s?n.measuredBox[d]:n.layoutBox[d],h=Aa(p);p.min=r[d].min,p.max=p.min+h}):p3(i,n.layoutBox,r)&&Fi(d=>{const p=s?n.measuredBox[d]:n.layoutBox[d],h=Aa(r[d]);p.max=p.min+h});const o=qf();Hf(o,r,n.layoutBox);const l=qf();s?Hf(l,e.applyTransform(a,!0),n.measuredBox):Hf(l,r,n.layoutBox);const c=!c3(o);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:p,layout:h}=d;if(p&&h){const f=Tn();Gf(f,n.layoutBox,p.layoutBox);const m=Tn();Gf(m,r,h.layoutBox),Jk(f,m)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=m,e.relativeTargetOrigin=f,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function uY(e){kl.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function cY(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function dY(e){e.clearSnapshot()}function WA(e){e.clearMeasurements()}function pY(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function VA(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0}function hY(e){e.resolveTargetDelta()}function fY(e){e.calcProjection()}function mY(e){e.resetRotation()}function gY(e){e.removeLeadSnapshot()}function UA(e,t,n){e.translate=on(t.translate,0,n),e.scale=on(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function jA(e,t,n,r){e.min=on(t.min,n.min,r),e.max=on(t.max,n.max,r)}function yY(e,t,n,r){jA(e.x,t.x,n.x,r),jA(e.y,t.y,n.y,r)}function bY(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const vY={duration:.45,ease:[.4,0,.1,1]};function xY(e,t){let n=e.root;for(let i=e.path.length-1;i>=0;i--)if(e.path[i].instance){n=e.path[i];break}const a=(n&&n!==e.root?n.instance:document).querySelector(`[data-projection-id="${t}"]`);a&&e.mount(a,!0)}function HA(e){e.min=Math.round(e.min),e.max=Math.round(e.max)}function wY(e){HA(e.x),HA(e.y)}function p3(e,t,n){return e==="position"||e==="preserve-aspect"&&!Kk(PA(t),PA(n),.2)}const kY=d3({attachResizeListener:(e,t)=>xs(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ew={current:void 0},h3=d3({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Ew.current){const e=new kY(0,{});e.mount(window),e.setOptions({layoutScroll:!0}),Ew.current=e}return Ew.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),SY={pan:{Feature:LX},drag:{Feature:zX,ProjectionNode:h3,MeasureLayout:o3}},IY=new Set(["width","height","top","left","right","bottom","x","y"]),f3=e=>IY.has(e),CY=e=>Object.keys(e).some(f3),GA=e=>e===_u||e===Ve,qA=(e,t)=>parseFloat(e.split(", ")[t]),KA=(e,t)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const a=r.match(/^matrix3d\((.+)\)$/);if(a)return qA(a[1],t);{const i=r.match(/^matrix\((.+)\)$/);return i?qA(i[1],e):0}},_Y=new Set(["x","y","z"]),TY=nx.filter(e=>!_Y.has(e));function NY(e){const t=[];return TY.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t.length&&e.render(),t}const XA={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:KA(4,13),y:KA(5,14)},EY=(e,t,n)=>{const r=t.measureViewportBox(),a=t.current,i=getComputedStyle(a),{display:s}=i,o={};s==="none"&&t.setStaticValue("display",e.display||"block"),n.forEach(c=>{o[c]=XA[c](r,i)}),t.render();const l=t.measureViewportBox();return n.forEach(c=>{const u=t.getValue(c);u&&u.jump(o[c]),e[c]=XA[c](l,i)}),e},$Y=(e,t,n={},r={})=>{t={...t},r={...r};const a=Object.keys(t).filter(f3);let i=[],s=!1;const o=[];if(a.forEach(l=>{const c=e.getValue(l);if(!e.hasValue(l))return;let u=n[l],d=uf(u);const p=t[l];let h;if(yb(p)){const f=p.length,m=p[0]===null?1:0;u=p[m],d=uf(u);for(let g=m;g<f;g++)h?xb(uf(p[g])===h):h=uf(p[g])}else h=uf(p);if(d!==h)if(GA(d)&&GA(h)){const f=c.get();typeof f=="string"&&c.set(parseFloat(f)),typeof p=="string"?t[l]=parseFloat(p):Array.isArray(p)&&h===Ve&&(t[l]=p.map(parseFloat))}else d!=null&&d.transform&&(h!=null&&h.transform)&&(u===0||p===0)?u===0?c.set(h.transform(u)):t[l]=d.transform(p):(s||(i=NY(e),s=!0),o.push(l),r[l]=r[l]!==void 0?r[l]:t[l],c.jump(p))}),o.length){const l=o.indexOf("height")>=0?window.pageYOffset:null,c=EY(t,e,o);return i.length&&i.forEach(([u,d])=>{e.getValue(u).set(d)}),e.render(),Jv&&l!==null&&window.scrollTo({top:l}),{target:c,transitionEnd:r}}else return{target:t,transitionEnd:r}};function AY(e,t,n,r){return CY(t)?$Y(e,t,n,r):{target:t,transitionEnd:r}}const RY=(e,t,n,r)=>{const a=jX(e,t,r);return t=a.target,r=a.transitionEnd,AY(e,t,n,r)},eS={current:null},m3={current:!1};function FY(){if(m3.current=!0,!!Jv)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>eS.current=e.matches;e.addListener(t),t()}else eS.current=!1}function DY(e,t,n){const{willChange:r}=t;for(const a in t){const i=t[a],s=n[a];if(da(i))e.addValue(a,i),vb(r)&&r.add(a);else if(da(s))e.addValue(a,Qd(i,{owner:e})),vb(r)&&r.remove(a);else if(s!==i)if(e.hasValue(a)){const o=e.getValue(a);!o.hasAnimated&&o.set(i)}else{const o=e.getStaticValue(a);e.addValue(a,Qd(o!==void 0?o:i,{owner:e}))}}for(const a in n)t[a]===void 0&&e.removeValue(a);return t}const g3=Object.keys(bm),MY=g3.length,YA=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],OY=b2.length;class PY{constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:a,visualState:i},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Sr.render(this.render,!1,!0);const{latestValues:o,renderState:l}=i;this.latestValues=o,this.baseTarget={...o},this.initialValues=n.initial?{...o}:{},this.renderState=l,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=s,this.isControllingVariants=tx(n),this.isVariantNode=lO(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:c,...u}=this.scrapeMotionValuesFromProps(n,{});for(const d in u){const p=u[d];o[d]!==void 0&&da(p)&&(p.set(o[d],!1),vb(c)&&c.add(d))}}scrapeMotionValuesFromProps(t,n){return{}}mount(t){this.current=t,this.projection&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),m3.current||FY(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:eS.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Ro.update(this.notifyUpdate),Ro.render(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,n){const r=Cu.has(t),a=n.on("change",s=>{this.latestValues[t]=s,this.props.onUpdate&&Sr.update(this.notifyUpdate,!1,!0),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{a(),i()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...n},r,a,i,s){let o,l;for(let c=0;c<MY;c++){const u=g3[c],{isEnabled:d,Feature:p,ProjectionNode:h,MeasureLayout:f}=bm[u];h&&(o=h),d(n)&&(!this.features[u]&&p&&(this.features[u]=new p(this)),f&&(l=f))}if(!this.projection&&o){this.projection=new o(i,this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:u,drag:d,dragConstraints:p,layoutScroll:h,layoutRoot:f}=n;this.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!d||p&&wd(p),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:s,layoutScroll:h,layoutRoot:f})}return l}updateFeatures(){for(const t in this.features){const n=this.features[t];n.isMounted?n.update(this.props,this.prevProps):(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Tn()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}makeTargetAnimatable(t,n=!0){return this.makeTargetAnimatableFromInstance(t,this.props,n)}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<YA.length;r++){const a=YA[r];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const i=t["on"+a];i&&(this.propEventSubscriptions[a]=this.on(a,i))}this.prevMotionValues=DY(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const r=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(r.initial=this.props.initial),r}const n={};for(let r=0;r<OY;r++){const a=b2[r],i=this.props[a];(ym(i)||i===!1)&&(n[a]=i)}return n}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){n!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,n)),this.values.set(t,n),this.latestValues[t]=n.get()}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=Qd(n,{owner:this}),this.addValue(t,r)),r}readValue(t){return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var n;const{initial:r}=this.props,a=typeof r=="string"||typeof r=="object"?(n=N2(this.props,r))===null||n===void 0?void 0:n[t]:void 0;if(r&&a!==void 0)return a;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!da(i)?i:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new A2),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}class y3 extends PY{sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:n,...r},{transformValues:a},i){let s=aK(r,t||{},this);if(a&&(n&&(n=a(n)),r&&(r=a(r)),s&&(s=a(s))),i){nK(this,r,s);const o=RY(this,r,s,n);n=o.transitionEnd,r=o.target}return{transition:t,transitionEnd:n,...r}}}function zY(e){return window.getComputedStyle(e)}class LY extends y3{readValueFromInstance(t,n){if(Cu.has(n)){const r=D2(n);return r&&r.default||0}else{const r=zY(t),a=(pO(n)?r.getPropertyValue(n):r[n])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:n}){return i3(t,n)}build(t,n,r,a){k2(t,n,r,a.transformTemplate)}scrapeMotionValuesFromProps(t,n){return T2(t,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;da(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(t,n,r,a){yO(t,n,r,a)}}class BY extends y3{constructor(){super(...arguments),this.isSVGTag=!1}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Cu.has(n)){const r=D2(n);return r&&r.default||0}return n=bO.has(n)?n:_2(n),t.getAttribute(n)}measureInstanceViewportBox(){return Tn()}scrapeMotionValuesFromProps(t,n){return xO(t,n)}build(t,n,r,a){I2(t,n,r,this.isSVGTag,a.transformTemplate)}renderInstance(t,n,r,a){vO(t,n,r,a)}mount(t){this.isSVGTag=C2(t.tagName),super.mount(t)}}const WY=(e,t)=>w2(e)?new BY(t,{enableHardwareAcceleration:!1}):new LY(t,{enableHardwareAcceleration:!0}),VY={layout:{ProjectionNode:h3,MeasureLayout:o3}},UY={...bX,...$7,...SY,...VY},sx=Uq((e,t)=>y7(e,t,UY,WY));function b3(){const e=M.useRef(!1);return fb(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function jY(){const e=b3(),[t,n]=M.useState(0),r=M.useCallback(()=>{e.current&&n(t+1)},[t]);return[M.useCallback(()=>Sr.postRender(r),[r]),t]}class HY extends M.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function GY({children:e,isPresent:t}){const n=M.useId(),r=M.useRef(null),a=M.useRef({width:0,height:0,top:0,left:0});return M.useInsertionEffect(()=>{const{width:i,height:s,top:o,left:l}=a.current;if(t||!r.current||!i||!s)return;r.current.dataset.motionPopId=n;const c=document.createElement("style");return document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${s}px !important;
            top: ${o}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[t]),M.createElement(HY,{isPresent:t,childRef:r,sizeRef:a},M.cloneElement(e,{ref:r}))}const $w=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:a,presenceAffectsLayout:i,mode:s})=>{const o=v2(qY),l=M.useId(),c=M.useMemo(()=>({id:l,initial:t,isPresent:n,custom:a,onExitComplete:u=>{o.set(u,!0);for(const d of o.values())if(!d)return;r&&r()},register:u=>(o.set(u,!1),()=>o.delete(u))}),i?void 0:[n]);return M.useMemo(()=>{o.forEach((u,d)=>o.set(d,!1))},[n]),M.useEffect(()=>{!n&&!o.size&&r&&r()},[n]),s==="popLayout"&&(e=M.createElement(GY,{isPresent:n},e)),M.createElement(og.Provider,{value:c},e)};function qY(){return new Map}function KY(e){return M.useEffect(()=>()=>e(),[])}const bd=e=>e.key||"";function XY(e,t){e.forEach(n=>{const r=bd(n);t.set(r,n)})}function YY(e){const t=[];return M.Children.forEach(e,n=>{M.isValidElement(n)&&t.push(n)}),t}const ox=({children:e,custom:t,initial:n=!0,onExitComplete:r,exitBeforeEnter:a,presenceAffectsLayout:i=!0,mode:s="sync"})=>{a&&(s="wait");let[o]=jY();const l=M.useContext(x2).forceRender;l&&(o=l);const c=b3(),u=YY(e);let d=u;const p=new Set,h=M.useRef(d),f=M.useRef(new Map).current,m=M.useRef(!0);if(fb(()=>{m.current=!1,XY(u,f),h.current=d}),KY(()=>{m.current=!0,f.clear(),p.clear()}),m.current)return M.createElement(M.Fragment,null,d.map(v=>M.createElement($w,{key:bd(v),isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:i,mode:s},v)));d=[...d];const g=h.current.map(bd),y=u.map(bd),b=g.length;for(let v=0;v<b;v++){const x=g[v];y.indexOf(x)===-1&&p.add(x)}return s==="wait"&&p.size&&(d=[]),p.forEach(v=>{if(y.indexOf(v)!==-1)return;const x=f.get(v);if(!x)return;const w=g.indexOf(v),S=()=>{f.delete(v),p.delete(v);const C=h.current.findIndex(T=>T.key===v);if(h.current.splice(C,1),!p.size){if(h.current=u,c.current===!1)return;o(),r&&r()}};d.splice(w,0,M.createElement($w,{key:bd(x),isPresent:!1,onExitComplete:S,custom:t,presenceAffectsLayout:i,mode:s},x))}),d=d.map(v=>{const x=v.key;return p.has(x)?v:M.createElement($w,{key:bd(v),isPresent:!0,presenceAffectsLayout:i,mode:s},v)}),M.createElement(M.Fragment,null,p.size?d:d.map(v=>M.cloneElement(v)))};var lx=dt(({as:e="div",className:t,...n},r)=>z.jsx(at.div,{as:sx[e],ref:r,className:ut("ui-motion",t),...n})),ZA={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},v3={enter:{duration:.25,ease:ZA.easeOut},exit:{duration:.2,ease:ZA.easeIn}},ZY=e=>(t,n)=>({...e??v3.enter,...n?{duration:Ss(n)?n:n==null?void 0:n.enter}:{},delay:Ss(t)?t:t==null?void 0:t.enter}),QY=e=>(t,n)=>({...e??v3.exit,...n?{duration:Ss(n)?n:n==null?void 0:n.exit}:{},delay:Ss(t)?t:t==null?void 0:t.exit}),[x3,JY]=Iu({strict:!1,name:"PortalContext"}),w3={exports:{}},Oa={},k3={exports:{}},S3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(O,q){var Z=O.length;O.push(q);e:for(;0<Z;){var X=Z-1>>>1,ne=O[X];if(0<a(ne,q))O[X]=q,O[Z]=ne,Z=X;else break e}}function n(O){return O.length===0?null:O[0]}function r(O){if(O.length===0)return null;var q=O[0],Z=O.pop();if(Z!==q){O[0]=Z;e:for(var X=0,ne=O.length,te=ne>>>1;X<te;){var se=2*(X+1)-1,oe=O[se],fe=se+1,ce=O[fe];if(0>a(oe,Z))fe<ne&&0>a(ce,oe)?(O[X]=ce,O[fe]=Z,X=fe):(O[X]=oe,O[se]=Z,X=se);else if(fe<ne&&0>a(ce,Z))O[X]=ce,O[fe]=Z,X=fe;else break e}}return q}function a(O,q){var Z=O.sortIndex-q.sortIndex;return Z!==0?Z:O.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],c=[],u=1,d=null,p=3,h=!1,f=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(O){for(var q=n(c);q!==null;){if(q.callback===null)r(c);else if(q.startTime<=O)r(c),q.sortIndex=q.expirationTime,t(l,q);else break;q=n(c)}}function x(O){if(m=!1,v(O),!f)if(n(l)!==null)f=!0,W(w);else{var q=n(c);q!==null&&Y(x,q.startTime-O)}}function w(O,q){f=!1,m&&(m=!1,y(T),T=-1),h=!0;var Z=p;try{for(v(q),d=n(l);d!==null&&(!(d.expirationTime>q)||O&&!$());){var X=d.callback;if(typeof X=="function"){d.callback=null,p=d.priorityLevel;var ne=X(d.expirationTime<=q);q=e.unstable_now(),typeof ne=="function"?d.callback=ne:d===n(l)&&r(l),v(q)}else r(l);d=n(l)}if(d!==null)var te=!0;else{var se=n(c);se!==null&&Y(x,se.startTime-q),te=!1}return te}finally{d=null,p=Z,h=!1}}var S=!1,C=null,T=-1,E=5,R=-1;function $(){return!(e.unstable_now()-R<E)}function _(){if(C!==null){var O=e.unstable_now();R=O;var q=!0;try{q=C(!0,O)}finally{q?D():(S=!1,C=null)}}else S=!1}var D;if(typeof b=="function")D=function(){b(_)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,B=P.port2;P.port1.onmessage=_,D=function(){B.postMessage(null)}}else D=function(){g(_,0)};function W(O){C=O,S||(S=!0,D())}function Y(O,q){T=g(function(){O(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_continueExecution=function(){f||h||(f=!0,W(w))},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(O){switch(p){case 1:case 2:case 3:var q=3;break;default:q=p}var Z=p;p=q;try{return O()}finally{p=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(O,q){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var Z=p;p=O;try{return q()}finally{p=Z}},e.unstable_scheduleCallback=function(O,q,Z){var X=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?X+Z:X):Z=X,O){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=Z+ne,O={id:u++,callback:q,priorityLevel:O,startTime:Z,expirationTime:ne,sortIndex:-1},Z>X?(O.sortIndex=Z,t(c,O),n(l)===null&&O===n(c)&&(m?(y(T),T=-1):m=!0,Y(x,Z-X))):(O.sortIndex=ne,t(l,O),f||h||(f=!0,W(w))),O},e.unstable_shouldYield=$,e.unstable_wrapCallback=function(O){var q=p;return function(){var Z=p;p=q;try{return O.apply(this,arguments)}finally{p=Z}}}})(S3);k3.exports=S3;var eZ=k3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I3=M,Ra=eZ;function pe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var C3=new Set,km={};function Tu(e,t){Jd(e,t),Jd(e+"Capture",t)}function Jd(e,t){for(km[e]=t,e=0;e<t.length;e++)C3.add(t[e])}var Rs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tS=Object.prototype.hasOwnProperty,tZ=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,QA={},JA={};function nZ(e){return tS.call(JA,e)?!0:tS.call(QA,e)?!1:tZ.test(e)?JA[e]=!0:(QA[e]=!0,!1)}function rZ(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function aZ(e,t,n,r){if(t===null||typeof t>"u"||rZ(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Xr(e,t,n,r,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var pr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){pr[e]=new Xr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];pr[t]=new Xr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){pr[e]=new Xr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){pr[e]=new Xr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){pr[e]=new Xr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){pr[e]=new Xr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){pr[e]=new Xr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){pr[e]=new Xr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){pr[e]=new Xr(e,5,!1,e.toLowerCase(),null,!1,!1)});var U2=/[\-:]([a-z])/g;function j2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(U2,j2);pr[t]=new Xr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(U2,j2);pr[t]=new Xr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(U2,j2);pr[t]=new Xr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){pr[e]=new Xr(e,1,!1,e.toLowerCase(),null,!1,!1)});pr.xlinkHref=new Xr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){pr[e]=new Xr(e,1,!1,e.toLowerCase(),null,!0,!0)});function H2(e,t,n,r){var a=pr.hasOwnProperty(t)?pr[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(aZ(t,n,a,r)&&(n=null),r||a===null?nZ(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Bs=I3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Hy=Symbol.for("react.element"),Id=Symbol.for("react.portal"),Cd=Symbol.for("react.fragment"),G2=Symbol.for("react.strict_mode"),nS=Symbol.for("react.profiler"),_3=Symbol.for("react.provider"),T3=Symbol.for("react.context"),q2=Symbol.for("react.forward_ref"),rS=Symbol.for("react.suspense"),aS=Symbol.for("react.suspense_list"),K2=Symbol.for("react.memo"),no=Symbol.for("react.lazy"),N3=Symbol.for("react.offscreen"),eR=Symbol.iterator;function df(e){return e===null||typeof e!="object"?null:(e=eR&&e[eR]||e["@@iterator"],typeof e=="function"?e:null)}var cn=Object.assign,Aw;function _f(e){if(Aw===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Aw=t&&t[1]||""}return`
`+Aw+e}var Rw=!1;function Fw(e,t){if(!e||Rw)return"";Rw=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),i=r.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var l=`
`+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{Rw=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?_f(e):""}function iZ(e){switch(e.tag){case 5:return _f(e.type);case 16:return _f("Lazy");case 13:return _f("Suspense");case 19:return _f("SuspenseList");case 0:case 2:case 15:return e=Fw(e.type,!1),e;case 11:return e=Fw(e.type.render,!1),e;case 1:return e=Fw(e.type,!0),e;default:return""}}function iS(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Cd:return"Fragment";case Id:return"Portal";case nS:return"Profiler";case G2:return"StrictMode";case rS:return"Suspense";case aS:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case T3:return(e.displayName||"Context")+".Consumer";case _3:return(e._context.displayName||"Context")+".Provider";case q2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case K2:return t=e.displayName||null,t!==null?t:iS(e.type)||"Memo";case no:t=e._payload,e=e._init;try{return iS(e(t))}catch{}}return null}function sZ(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return iS(t);case 8:return t===G2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Do(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function E3(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function oZ(e){var t=E3(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){r=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Gy(e){e._valueTracker||(e._valueTracker=oZ(e))}function $3(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=E3(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Sb(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function sS(e,t){var n=t.checked;return cn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function tR(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Do(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function A3(e,t){t=t.checked,t!=null&&H2(e,"checked",t,!1)}function oS(e,t){A3(e,t);var n=Do(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?lS(e,t.type,n):t.hasOwnProperty("defaultValue")&&lS(e,t.type,Do(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function nR(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function lS(e,t,n){(t!=="number"||Sb(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Tf=Array.isArray;function Ld(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Do(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function uS(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(pe(91));return cn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function rR(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(pe(92));if(Tf(n)){if(1<n.length)throw Error(pe(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Do(n)}}function R3(e,t){var n=Do(t.value),r=Do(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function aR(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function F3(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cS(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?F3(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var qy,D3=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(qy=qy||document.createElement("div"),qy.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=qy.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Sm(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Kf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lZ=["Webkit","ms","Moz","O"];Object.keys(Kf).forEach(function(e){lZ.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Kf[t]=Kf[e]})});function M3(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Kf.hasOwnProperty(e)&&Kf[e]?(""+t).trim():t+"px"}function O3(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=M3(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var uZ=cn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dS(e,t){if(t){if(uZ[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(pe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(pe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(pe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(pe(62))}}function pS(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hS=null;function X2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var fS=null,Bd=null,Wd=null;function iR(e){if(e=hg(e)){if(typeof fS!="function")throw Error(pe(280));var t=e.stateNode;t&&(t=hx(t),fS(e.stateNode,e.type,t))}}function P3(e){Bd?Wd?Wd.push(e):Wd=[e]:Bd=e}function z3(){if(Bd){var e=Bd,t=Wd;if(Wd=Bd=null,iR(e),t)for(e=0;e<t.length;e++)iR(t[e])}}function L3(e,t){return e(t)}function B3(){}var Dw=!1;function W3(e,t,n){if(Dw)return e(t,n);Dw=!0;try{return L3(e,t,n)}finally{Dw=!1,(Bd!==null||Wd!==null)&&(B3(),z3())}}function Im(e,t){var n=e.stateNode;if(n===null)return null;var r=hx(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(pe(231,t,typeof n));return n}var mS=!1;if(Rs)try{var pf={};Object.defineProperty(pf,"passive",{get:function(){mS=!0}}),window.addEventListener("test",pf,pf),window.removeEventListener("test",pf,pf)}catch{mS=!1}function cZ(e,t,n,r,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Xf=!1,Ib=null,Cb=!1,gS=null,dZ={onError:function(e){Xf=!0,Ib=e}};function pZ(e,t,n,r,a,i,s,o,l){Xf=!1,Ib=null,cZ.apply(dZ,arguments)}function hZ(e,t,n,r,a,i,s,o,l){if(pZ.apply(this,arguments),Xf){if(Xf){var c=Ib;Xf=!1,Ib=null}else throw Error(pe(198));Cb||(Cb=!0,gS=c)}}function Nu(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function V3(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function sR(e){if(Nu(e)!==e)throw Error(pe(188))}function fZ(e){var t=e.alternate;if(!t){if(t=Nu(e),t===null)throw Error(pe(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return sR(a),e;if(i===r)return sR(a),t;i=i.sibling}throw Error(pe(188))}if(n.return!==r.return)n=a,r=i;else{for(var s=!1,o=a.child;o;){if(o===n){s=!0,n=a,r=i;break}if(o===r){s=!0,r=a,n=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===n){s=!0,n=i,r=a;break}if(o===r){s=!0,r=i,n=a;break}o=o.sibling}if(!s)throw Error(pe(189))}}if(n.alternate!==r)throw Error(pe(190))}if(n.tag!==3)throw Error(pe(188));return n.stateNode.current===n?e:t}function U3(e){return e=fZ(e),e!==null?j3(e):null}function j3(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=j3(e);if(t!==null)return t;e=e.sibling}return null}var H3=Ra.unstable_scheduleCallback,oR=Ra.unstable_cancelCallback,mZ=Ra.unstable_shouldYield,gZ=Ra.unstable_requestPaint,wn=Ra.unstable_now,yZ=Ra.unstable_getCurrentPriorityLevel,Y2=Ra.unstable_ImmediatePriority,G3=Ra.unstable_UserBlockingPriority,_b=Ra.unstable_NormalPriority,bZ=Ra.unstable_LowPriority,q3=Ra.unstable_IdlePriority,ux=null,Gi=null;function vZ(e){if(Gi&&typeof Gi.onCommitFiberRoot=="function")try{Gi.onCommitFiberRoot(ux,e,void 0,(e.current.flags&128)===128)}catch{}}var bi=Math.clz32?Math.clz32:kZ,xZ=Math.log,wZ=Math.LN2;function kZ(e){return e>>>=0,e===0?32:31-(xZ(e)/wZ|0)|0}var Ky=64,Xy=4194304;function Nf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Tb(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,s=n&268435455;if(s!==0){var o=s&~a;o!==0?r=Nf(o):(i&=s,i!==0&&(r=Nf(i)))}else s=n&~a,s!==0?r=Nf(s):i!==0&&(r=Nf(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-bi(t),a=1<<n,r|=e[n],t&=~a;return r}function SZ(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function IZ(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-bi(i),o=1<<s,l=a[s];l===-1?(!(o&n)||o&r)&&(a[s]=SZ(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}function yS(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function K3(){var e=Ky;return Ky<<=1,!(Ky&4194240)&&(Ky=64),e}function Mw(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function dg(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-bi(t),e[t]=n}function CZ(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-bi(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}function Z2(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-bi(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var Nt=0;function X3(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Y3,Q2,Z3,Q3,J3,bS=!1,Yy=[],yo=null,bo=null,vo=null,Cm=new Map,_m=new Map,so=[],_Z="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function lR(e,t){switch(e){case"focusin":case"focusout":yo=null;break;case"dragenter":case"dragleave":bo=null;break;case"mouseover":case"mouseout":vo=null;break;case"pointerover":case"pointerout":Cm.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":_m.delete(t.pointerId)}}function hf(e,t,n,r,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},t!==null&&(t=hg(t),t!==null&&Q2(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function TZ(e,t,n,r,a){switch(t){case"focusin":return yo=hf(yo,e,t,n,r,a),!0;case"dragenter":return bo=hf(bo,e,t,n,r,a),!0;case"mouseover":return vo=hf(vo,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Cm.set(i,hf(Cm.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,_m.set(i,hf(_m.get(i)||null,e,t,n,r,a)),!0}return!1}function eP(e){var t=Pl(e.target);if(t!==null){var n=Nu(t);if(n!==null){if(t=n.tag,t===13){if(t=V3(n),t!==null){e.blockedOn=t,J3(e.priority,function(){Z3(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function B0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=vS(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);hS=r,n.target.dispatchEvent(r),hS=null}else return t=hg(n),t!==null&&Q2(t),e.blockedOn=n,!1;t.shift()}return!0}function uR(e,t,n){B0(e)&&n.delete(t)}function NZ(){bS=!1,yo!==null&&B0(yo)&&(yo=null),bo!==null&&B0(bo)&&(bo=null),vo!==null&&B0(vo)&&(vo=null),Cm.forEach(uR),_m.forEach(uR)}function ff(e,t){e.blockedOn===t&&(e.blockedOn=null,bS||(bS=!0,Ra.unstable_scheduleCallback(Ra.unstable_NormalPriority,NZ)))}function Tm(e){function t(a){return ff(a,e)}if(0<Yy.length){ff(Yy[0],e);for(var n=1;n<Yy.length;n++){var r=Yy[n];r.blockedOn===e&&(r.blockedOn=null)}}for(yo!==null&&ff(yo,e),bo!==null&&ff(bo,e),vo!==null&&ff(vo,e),Cm.forEach(t),_m.forEach(t),n=0;n<so.length;n++)r=so[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<so.length&&(n=so[0],n.blockedOn===null);)eP(n),n.blockedOn===null&&so.shift()}var Vd=Bs.ReactCurrentBatchConfig,Nb=!0;function EZ(e,t,n,r){var a=Nt,i=Vd.transition;Vd.transition=null;try{Nt=1,J2(e,t,n,r)}finally{Nt=a,Vd.transition=i}}function $Z(e,t,n,r){var a=Nt,i=Vd.transition;Vd.transition=null;try{Nt=4,J2(e,t,n,r)}finally{Nt=a,Vd.transition=i}}function J2(e,t,n,r){if(Nb){var a=vS(e,t,n,r);if(a===null)Hw(e,t,r,Eb,n),lR(e,r);else if(TZ(a,e,t,n,r))r.stopPropagation();else if(lR(e,r),t&4&&-1<_Z.indexOf(e)){for(;a!==null;){var i=hg(a);if(i!==null&&Y3(i),i=vS(e,t,n,r),i===null&&Hw(e,t,r,Eb,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else Hw(e,t,r,null,n)}}var Eb=null;function vS(e,t,n,r){if(Eb=null,e=X2(r),e=Pl(e),e!==null)if(t=Nu(e),t===null)e=null;else if(n=t.tag,n===13){if(e=V3(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Eb=e,null}function tP(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yZ()){case Y2:return 1;case G3:return 4;case _b:case bZ:return 16;case q3:return 536870912;default:return 16}default:return 16}}var uo=null,eC=null,W0=null;function nP(){if(W0)return W0;var e,t=eC,n=t.length,r,a="value"in uo?uo.value:uo.textContent,i=a.length;for(e=0;e<n&&t[e]===a[e];e++);var s=n-e;for(r=1;r<=s&&t[n-r]===a[i-r];r++);return W0=a.slice(e,1<r?1-r:void 0)}function V0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Zy(){return!0}function cR(){return!1}function Pa(e){function t(n,r,a,i,s){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Zy:cR,this.isPropagationStopped=cR,this}return cn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Zy)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Zy)},persist:function(){},isPersistent:Zy}),t}var Rp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tC=Pa(Rp),pg=cn({},Rp,{view:0,detail:0}),AZ=Pa(pg),Ow,Pw,mf,cx=cn({},pg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nC,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==mf&&(mf&&e.type==="mousemove"?(Ow=e.screenX-mf.screenX,Pw=e.screenY-mf.screenY):Pw=Ow=0,mf=e),Ow)},movementY:function(e){return"movementY"in e?e.movementY:Pw}}),dR=Pa(cx),RZ=cn({},cx,{dataTransfer:0}),FZ=Pa(RZ),DZ=cn({},pg,{relatedTarget:0}),zw=Pa(DZ),MZ=cn({},Rp,{animationName:0,elapsedTime:0,pseudoElement:0}),OZ=Pa(MZ),PZ=cn({},Rp,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),zZ=Pa(PZ),LZ=cn({},Rp,{data:0}),pR=Pa(LZ),BZ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},WZ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},VZ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UZ(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=VZ[e])?!!t[e]:!1}function nC(){return UZ}var jZ=cn({},pg,{key:function(e){if(e.key){var t=BZ[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=V0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?WZ[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nC,charCode:function(e){return e.type==="keypress"?V0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?V0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),HZ=Pa(jZ),GZ=cn({},cx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hR=Pa(GZ),qZ=cn({},pg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nC}),KZ=Pa(qZ),XZ=cn({},Rp,{propertyName:0,elapsedTime:0,pseudoElement:0}),YZ=Pa(XZ),ZZ=cn({},cx,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),QZ=Pa(ZZ),JZ=[9,13,27,32],rC=Rs&&"CompositionEvent"in window,Yf=null;Rs&&"documentMode"in document&&(Yf=document.documentMode);var eQ=Rs&&"TextEvent"in window&&!Yf,rP=Rs&&(!rC||Yf&&8<Yf&&11>=Yf),fR=String.fromCharCode(32),mR=!1;function aP(e,t){switch(e){case"keyup":return JZ.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function iP(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var _d=!1;function tQ(e,t){switch(e){case"compositionend":return iP(t);case"keypress":return t.which!==32?null:(mR=!0,fR);case"textInput":return e=t.data,e===fR&&mR?null:e;default:return null}}function nQ(e,t){if(_d)return e==="compositionend"||!rC&&aP(e,t)?(e=nP(),W0=eC=uo=null,_d=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return rP&&t.locale!=="ko"?null:t.data;default:return null}}var rQ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gR(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!rQ[e.type]:t==="textarea"}function sP(e,t,n,r){P3(r),t=$b(t,"onChange"),0<t.length&&(n=new tC("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Zf=null,Nm=null;function aQ(e){yP(e,0)}function dx(e){var t=Ed(e);if($3(t))return e}function iQ(e,t){if(e==="change")return t}var oP=!1;if(Rs){var Lw;if(Rs){var Bw="oninput"in document;if(!Bw){var yR=document.createElement("div");yR.setAttribute("oninput","return;"),Bw=typeof yR.oninput=="function"}Lw=Bw}else Lw=!1;oP=Lw&&(!document.documentMode||9<document.documentMode)}function bR(){Zf&&(Zf.detachEvent("onpropertychange",lP),Nm=Zf=null)}function lP(e){if(e.propertyName==="value"&&dx(Nm)){var t=[];sP(t,Nm,e,X2(e)),W3(aQ,t)}}function sQ(e,t,n){e==="focusin"?(bR(),Zf=t,Nm=n,Zf.attachEvent("onpropertychange",lP)):e==="focusout"&&bR()}function oQ(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return dx(Nm)}function lQ(e,t){if(e==="click")return dx(t)}function uQ(e,t){if(e==="input"||e==="change")return dx(t)}function cQ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Si=typeof Object.is=="function"?Object.is:cQ;function Em(e,t){if(Si(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!tS.call(t,a)||!Si(e[a],t[a]))return!1}return!0}function vR(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function xR(e,t){var n=vR(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=vR(n)}}function uP(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?uP(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function cP(){for(var e=window,t=Sb();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Sb(e.document)}return t}function aC(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function dQ(e){var t=cP(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&uP(n.ownerDocument.documentElement,n)){if(r!==null&&aC(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=xR(n,i);var s=xR(n,r);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pQ=Rs&&"documentMode"in document&&11>=document.documentMode,Td=null,xS=null,Qf=null,wS=!1;function wR(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;wS||Td==null||Td!==Sb(r)||(r=Td,"selectionStart"in r&&aC(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Qf&&Em(Qf,r)||(Qf=r,r=$b(xS,"onSelect"),0<r.length&&(t=new tC("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Td)))}function Qy(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Nd={animationend:Qy("Animation","AnimationEnd"),animationiteration:Qy("Animation","AnimationIteration"),animationstart:Qy("Animation","AnimationStart"),transitionend:Qy("Transition","TransitionEnd")},Ww={},dP={};Rs&&(dP=document.createElement("div").style,"AnimationEvent"in window||(delete Nd.animationend.animation,delete Nd.animationiteration.animation,delete Nd.animationstart.animation),"TransitionEvent"in window||delete Nd.transitionend.transition);function px(e){if(Ww[e])return Ww[e];if(!Nd[e])return e;var t=Nd[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in dP)return Ww[e]=t[n];return e}var pP=px("animationend"),hP=px("animationiteration"),fP=px("animationstart"),mP=px("transitionend"),gP=new Map,kR="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xo(e,t){gP.set(e,t),Tu(t,[e])}for(var Vw=0;Vw<kR.length;Vw++){var Uw=kR[Vw],hQ=Uw.toLowerCase(),fQ=Uw[0].toUpperCase()+Uw.slice(1);Xo(hQ,"on"+fQ)}Xo(pP,"onAnimationEnd");Xo(hP,"onAnimationIteration");Xo(fP,"onAnimationStart");Xo("dblclick","onDoubleClick");Xo("focusin","onFocus");Xo("focusout","onBlur");Xo(mP,"onTransitionEnd");Jd("onMouseEnter",["mouseout","mouseover"]);Jd("onMouseLeave",["mouseout","mouseover"]);Jd("onPointerEnter",["pointerout","pointerover"]);Jd("onPointerLeave",["pointerout","pointerover"]);Tu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Tu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Tu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Tu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Tu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Tu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ef="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mQ=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ef));function SR(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,hZ(r,t,void 0,e),e.currentTarget=null}function yP(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;SR(a,o,c),i=l}else for(s=0;s<r.length;s++){if(o=r[s],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;SR(a,o,c),i=l}}}if(Cb)throw e=gS,Cb=!1,gS=null,e}function Ht(e,t){var n=t[_S];n===void 0&&(n=t[_S]=new Set);var r=e+"__bubble";n.has(r)||(bP(t,e,2,!1),n.add(r))}function jw(e,t,n){var r=0;t&&(r|=4),bP(n,e,r,t)}var Jy="_reactListening"+Math.random().toString(36).slice(2);function $m(e){if(!e[Jy]){e[Jy]=!0,C3.forEach(function(n){n!=="selectionchange"&&(mQ.has(n)||jw(n,!1,e),jw(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Jy]||(t[Jy]=!0,jw("selectionchange",!1,t))}}function bP(e,t,n,r){switch(tP(t)){case 1:var a=EZ;break;case 4:a=$Z;break;default:a=J2}n=a.bind(null,t,n,e),a=void 0,!mS||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Hw(e,t,n,r,a){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var o=r.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;s=s.return}for(;o!==null;){if(s=Pl(o),s===null)return;if(l=s.tag,l===5||l===6){r=i=s;continue e}o=o.parentNode}}r=r.return}W3(function(){var c=i,u=X2(n),d=[];e:{var p=gP.get(e);if(p!==void 0){var h=tC,f=e;switch(e){case"keypress":if(V0(n)===0)break e;case"keydown":case"keyup":h=HZ;break;case"focusin":f="focus",h=zw;break;case"focusout":f="blur",h=zw;break;case"beforeblur":case"afterblur":h=zw;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=dR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=FZ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=KZ;break;case pP:case hP:case fP:h=OZ;break;case mP:h=YZ;break;case"scroll":h=AZ;break;case"wheel":h=QZ;break;case"copy":case"cut":case"paste":h=zZ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=hR}var m=(t&4)!==0,g=!m&&e==="scroll",y=m?p!==null?p+"Capture":null:p;m=[];for(var b=c,v;b!==null;){v=b;var x=v.stateNode;if(v.tag===5&&x!==null&&(v=x,y!==null&&(x=Im(b,y),x!=null&&m.push(Am(b,x,v)))),g)break;b=b.return}0<m.length&&(p=new h(p,f,null,n,u),d.push({event:p,listeners:m}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&n!==hS&&(f=n.relatedTarget||n.fromElement)&&(Pl(f)||f[Fs]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(f=n.relatedTarget||n.toElement,h=c,f=f?Pl(f):null,f!==null&&(g=Nu(f),f!==g||f.tag!==5&&f.tag!==6)&&(f=null)):(h=null,f=c),h!==f)){if(m=dR,x="onMouseLeave",y="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(m=hR,x="onPointerLeave",y="onPointerEnter",b="pointer"),g=h==null?p:Ed(h),v=f==null?p:Ed(f),p=new m(x,b+"leave",h,n,u),p.target=g,p.relatedTarget=v,x=null,Pl(u)===c&&(m=new m(y,b+"enter",f,n,u),m.target=v,m.relatedTarget=g,x=m),g=x,h&&f)t:{for(m=h,y=f,b=0,v=m;v;v=pd(v))b++;for(v=0,x=y;x;x=pd(x))v++;for(;0<b-v;)m=pd(m),b--;for(;0<v-b;)y=pd(y),v--;for(;b--;){if(m===y||y!==null&&m===y.alternate)break t;m=pd(m),y=pd(y)}m=null}else m=null;h!==null&&IR(d,p,h,m,!1),f!==null&&g!==null&&IR(d,g,f,m,!0)}}e:{if(p=c?Ed(c):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var w=iQ;else if(gR(p))if(oP)w=uQ;else{w=oQ;var S=sQ}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(w=lQ);if(w&&(w=w(e,c))){sP(d,w,n,u);break e}S&&S(e,p,c),e==="focusout"&&(S=p._wrapperState)&&S.controlled&&p.type==="number"&&lS(p,"number",p.value)}switch(S=c?Ed(c):window,e){case"focusin":(gR(S)||S.contentEditable==="true")&&(Td=S,xS=c,Qf=null);break;case"focusout":Qf=xS=Td=null;break;case"mousedown":wS=!0;break;case"contextmenu":case"mouseup":case"dragend":wS=!1,wR(d,n,u);break;case"selectionchange":if(pQ)break;case"keydown":case"keyup":wR(d,n,u)}var C;if(rC)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else _d?aP(e,n)&&(T="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(rP&&n.locale!=="ko"&&(_d||T!=="onCompositionStart"?T==="onCompositionEnd"&&_d&&(C=nP()):(uo=u,eC="value"in uo?uo.value:uo.textContent,_d=!0)),S=$b(c,T),0<S.length&&(T=new pR(T,e,null,n,u),d.push({event:T,listeners:S}),C?T.data=C:(C=iP(n),C!==null&&(T.data=C)))),(C=eQ?tQ(e,n):nQ(e,n))&&(c=$b(c,"onBeforeInput"),0<c.length&&(u=new pR("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=C))}yP(d,t)})}function Am(e,t,n){return{instance:e,listener:t,currentTarget:n}}function $b(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Im(e,n),i!=null&&r.unshift(Am(e,i,a)),i=Im(e,t),i!=null&&r.push(Am(e,i,a))),e=e.return}return r}function pd(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function IR(e,t,n,r,a){for(var i=t._reactName,s=[];n!==null&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&c!==null&&(o=c,a?(l=Im(n,i),l!=null&&s.unshift(Am(n,l,o))):a||(l=Im(n,i),l!=null&&s.push(Am(n,l,o)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var gQ=/\r\n?/g,yQ=/\u0000|\uFFFD/g;function CR(e){return(typeof e=="string"?e:""+e).replace(gQ,`
`).replace(yQ,"")}function e0(e,t,n){if(t=CR(t),CR(e)!==t&&n)throw Error(pe(425))}function Ab(){}var kS=null,SS=null;function IS(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var CS=typeof setTimeout=="function"?setTimeout:void 0,bQ=typeof clearTimeout=="function"?clearTimeout:void 0,_R=typeof Promise=="function"?Promise:void 0,vQ=typeof queueMicrotask=="function"?queueMicrotask:typeof _R<"u"?function(e){return _R.resolve(null).then(e).catch(xQ)}:CS;function xQ(e){setTimeout(function(){throw e})}function Gw(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),Tm(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Tm(t)}function xo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function TR(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Fp=Math.random().toString(36).slice(2),Wi="__reactFiber$"+Fp,Rm="__reactProps$"+Fp,Fs="__reactContainer$"+Fp,_S="__reactEvents$"+Fp,wQ="__reactListeners$"+Fp,kQ="__reactHandles$"+Fp;function Pl(e){var t=e[Wi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Fs]||n[Wi]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=TR(e);e!==null;){if(n=e[Wi])return n;e=TR(e)}return t}e=n,n=e.parentNode}return null}function hg(e){return e=e[Wi]||e[Fs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ed(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(pe(33))}function hx(e){return e[Rm]||null}var TS=[],$d=-1;function Yo(e){return{current:e}}function qt(e){0>$d||(e.current=TS[$d],TS[$d]=null,$d--)}function Ut(e,t){$d++,TS[$d]=e.current,e.current=t}var Mo={},Cr=Yo(Mo),sa=Yo(!1),eu=Mo;function ep(e,t){var n=e.type.contextTypes;if(!n)return Mo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function oa(e){return e=e.childContextTypes,e!=null}function Rb(){qt(sa),qt(Cr)}function NR(e,t,n){if(Cr.current!==Mo)throw Error(pe(168));Ut(Cr,t),Ut(sa,n)}function vP(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(pe(108,sZ(e)||"Unknown",a));return cn({},n,r)}function Fb(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Mo,eu=Cr.current,Ut(Cr,e),Ut(sa,sa.current),!0}function ER(e,t,n){var r=e.stateNode;if(!r)throw Error(pe(169));n?(e=vP(e,t,eu),r.__reactInternalMemoizedMergedChildContext=e,qt(sa),qt(Cr),Ut(Cr,e)):qt(sa),Ut(sa,n)}var fs=null,fx=!1,qw=!1;function xP(e){fs===null?fs=[e]:fs.push(e)}function SQ(e){fx=!0,xP(e)}function Zo(){if(!qw&&fs!==null){qw=!0;var e=0,t=Nt;try{var n=fs;for(Nt=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}fs=null,fx=!1}catch(a){throw fs!==null&&(fs=fs.slice(e+1)),H3(Y2,Zo),a}finally{Nt=t,qw=!1}}return null}var Ad=[],Rd=0,Db=null,Mb=0,Ka=[],Xa=0,tu=null,ws=1,ks="";function Sl(e,t){Ad[Rd++]=Mb,Ad[Rd++]=Db,Db=e,Mb=t}function wP(e,t,n){Ka[Xa++]=ws,Ka[Xa++]=ks,Ka[Xa++]=tu,tu=e;var r=ws;e=ks;var a=32-bi(r)-1;r&=~(1<<a),n+=1;var i=32-bi(t)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,ws=1<<32-bi(t)+a|n<<a|r,ks=i+e}else ws=1<<i|n<<a|r,ks=e}function iC(e){e.return!==null&&(Sl(e,1),wP(e,1,0))}function sC(e){for(;e===Db;)Db=Ad[--Rd],Ad[Rd]=null,Mb=Ad[--Rd],Ad[Rd]=null;for(;e===tu;)tu=Ka[--Xa],Ka[Xa]=null,ks=Ka[--Xa],Ka[Xa]=null,ws=Ka[--Xa],Ka[Xa]=null}var Ea=null,Sa=null,Qt=!1,fi=null;function kP(e,t){var n=Ya(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function $R(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ea=e,Sa=xo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ea=e,Sa=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=tu!==null?{id:ws,overflow:ks}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Ya(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ea=e,Sa=null,!0):!1;default:return!1}}function NS(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ES(e){if(Qt){var t=Sa;if(t){var n=t;if(!$R(e,t)){if(NS(e))throw Error(pe(418));t=xo(n.nextSibling);var r=Ea;t&&$R(e,t)?kP(r,n):(e.flags=e.flags&-4097|2,Qt=!1,Ea=e)}}else{if(NS(e))throw Error(pe(418));e.flags=e.flags&-4097|2,Qt=!1,Ea=e}}}function AR(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ea=e}function t0(e){if(e!==Ea)return!1;if(!Qt)return AR(e),Qt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!IS(e.type,e.memoizedProps)),t&&(t=Sa)){if(NS(e))throw SP(),Error(pe(418));for(;t;)kP(e,t),t=xo(t.nextSibling)}if(AR(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(pe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Sa=xo(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Sa=null}}else Sa=Ea?xo(e.stateNode.nextSibling):null;return!0}function SP(){for(var e=Sa;e;)e=xo(e.nextSibling)}function tp(){Sa=Ea=null,Qt=!1}function oC(e){fi===null?fi=[e]:fi.push(e)}var IQ=Bs.ReactCurrentBatchConfig;function pi(e,t){if(e&&e.defaultProps){t=cn({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}var Ob=Yo(null),Pb=null,Fd=null,lC=null;function uC(){lC=Fd=Pb=null}function cC(e){var t=Ob.current;qt(Ob),e._currentValue=t}function $S(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ud(e,t){Pb=e,lC=Fd=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ra=!0),e.firstContext=null)}function ti(e){var t=e._currentValue;if(lC!==e)if(e={context:e,memoizedValue:t,next:null},Fd===null){if(Pb===null)throw Error(pe(308));Fd=e,Pb.dependencies={lanes:0,firstContext:e}}else Fd=Fd.next=e;return t}var zl=null;function dC(e){zl===null?zl=[e]:zl.push(e)}function IP(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,dC(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ds(e,r)}function Ds(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ro=!1;function pC(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function CP(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function _s(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function wo(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,bt&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ds(e,n)}return a=r.interleaved,a===null?(t.next=t,dC(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ds(e,n)}function U0(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Z2(e,n)}}function RR(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=s:i=i.next=s,n=n.next}while(n!==null);i===null?a=i=t:i=i.next=t}else a=i=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function zb(e,t,n,r){var a=e.updateQueue;ro=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,s===null?i=c:s.next=c,s=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==s&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=a.baseState;s=0,u=c=l=null,o=i;do{var p=o.lane,h=o.eventTime;if((r&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(p=t,h=n,m.tag){case 1:if(f=m.payload,typeof f=="function"){d=f.call(h,d,p);break e}d=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=m.payload,p=typeof f=="function"?f.call(h,d,p):f,p==null)break e;d=cn({},d,p);break e;case 2:ro=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[o]:p.push(o))}else h={eventTime:h,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=h,l=d):u=u.next=h,s|=p;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;p=o,o=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(1);if(u===null&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);ru|=s,e.lanes=s,e.memoizedState=d}}function FR(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(pe(191,a));a.call(r)}}}var _P=new I3.Component().refs;function AS(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:cn({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var mx={isMounted:function(e){return(e=e._reactInternals)?Nu(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Br(),a=So(e),i=_s(r,a);i.payload=t,n!=null&&(i.callback=n),t=wo(e,i,a),t!==null&&(vi(t,e,a,r),U0(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Br(),a=So(e),i=_s(r,a);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=wo(e,i,a),t!==null&&(vi(t,e,a,r),U0(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Br(),r=So(e),a=_s(n,r);a.tag=2,t!=null&&(a.callback=t),t=wo(e,a,r),t!==null&&(vi(t,e,r,n),U0(t,e,r))}};function DR(e,t,n,r,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,s):t.prototype&&t.prototype.isPureReactComponent?!Em(n,r)||!Em(a,i):!0}function TP(e,t,n){var r=!1,a=Mo,i=t.contextType;return typeof i=="object"&&i!==null?i=ti(i):(a=oa(t)?eu:Cr.current,r=t.contextTypes,i=(r=r!=null)?ep(e,a):Mo),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=mx,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function MR(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&mx.enqueueReplaceState(t,t.state,null)}function RS(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=_P,pC(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=ti(i):(i=oa(t)?eu:Cr.current,a.context=ep(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(AS(e,t,i,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&mx.enqueueReplaceState(a,a.state,null),zb(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function gf(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(pe(309));var r=n.stateNode}if(!r)throw Error(pe(147,e));var a=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;o===_P&&(o=a.refs={}),s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(pe(284));if(!n._owner)throw Error(pe(290,e))}return e}function n0(e,t){throw e=Object.prototype.toString.call(t),Error(pe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function OR(e){var t=e._init;return t(e._payload)}function NP(e){function t(y,b){if(e){var v=y.deletions;v===null?(y.deletions=[b],y.flags|=16):v.push(b)}}function n(y,b){if(!e)return null;for(;b!==null;)t(y,b),b=b.sibling;return null}function r(y,b){for(y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function a(y,b){return y=Io(y,b),y.index=0,y.sibling=null,y}function i(y,b,v){return y.index=v,e?(v=y.alternate,v!==null?(v=v.index,v<b?(y.flags|=2,b):v):(y.flags|=2,b)):(y.flags|=1048576,b)}function s(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,b,v,x){return b===null||b.tag!==6?(b=ek(v,y.mode,x),b.return=y,b):(b=a(b,v),b.return=y,b)}function l(y,b,v,x){var w=v.type;return w===Cd?u(y,b,v.props.children,x,v.key):b!==null&&(b.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===no&&OR(w)===b.type)?(x=a(b,v.props),x.ref=gf(y,b,v),x.return=y,x):(x=X0(v.type,v.key,v.props,null,y.mode,x),x.ref=gf(y,b,v),x.return=y,x)}function c(y,b,v,x){return b===null||b.tag!==4||b.stateNode.containerInfo!==v.containerInfo||b.stateNode.implementation!==v.implementation?(b=tk(v,y.mode,x),b.return=y,b):(b=a(b,v.children||[]),b.return=y,b)}function u(y,b,v,x,w){return b===null||b.tag!==7?(b=jl(v,y.mode,x,w),b.return=y,b):(b=a(b,v),b.return=y,b)}function d(y,b,v){if(typeof b=="string"&&b!==""||typeof b=="number")return b=ek(""+b,y.mode,v),b.return=y,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Hy:return v=X0(b.type,b.key,b.props,null,y.mode,v),v.ref=gf(y,null,b),v.return=y,v;case Id:return b=tk(b,y.mode,v),b.return=y,b;case no:var x=b._init;return d(y,x(b._payload),v)}if(Tf(b)||df(b))return b=jl(b,y.mode,v,null),b.return=y,b;n0(y,b)}return null}function p(y,b,v,x){var w=b!==null?b.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return w!==null?null:o(y,b,""+v,x);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Hy:return v.key===w?l(y,b,v,x):null;case Id:return v.key===w?c(y,b,v,x):null;case no:return w=v._init,p(y,b,w(v._payload),x)}if(Tf(v)||df(v))return w!==null?null:u(y,b,v,x,null);n0(y,v)}return null}function h(y,b,v,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return y=y.get(v)||null,o(b,y,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Hy:return y=y.get(x.key===null?v:x.key)||null,l(b,y,x,w);case Id:return y=y.get(x.key===null?v:x.key)||null,c(b,y,x,w);case no:var S=x._init;return h(y,b,v,S(x._payload),w)}if(Tf(x)||df(x))return y=y.get(v)||null,u(b,y,x,w,null);n0(b,x)}return null}function f(y,b,v,x){for(var w=null,S=null,C=b,T=b=0,E=null;C!==null&&T<v.length;T++){C.index>T?(E=C,C=null):E=C.sibling;var R=p(y,C,v[T],x);if(R===null){C===null&&(C=E);break}e&&C&&R.alternate===null&&t(y,C),b=i(R,b,T),S===null?w=R:S.sibling=R,S=R,C=E}if(T===v.length)return n(y,C),Qt&&Sl(y,T),w;if(C===null){for(;T<v.length;T++)C=d(y,v[T],x),C!==null&&(b=i(C,b,T),S===null?w=C:S.sibling=C,S=C);return Qt&&Sl(y,T),w}for(C=r(y,C);T<v.length;T++)E=h(C,y,T,v[T],x),E!==null&&(e&&E.alternate!==null&&C.delete(E.key===null?T:E.key),b=i(E,b,T),S===null?w=E:S.sibling=E,S=E);return e&&C.forEach(function($){return t(y,$)}),Qt&&Sl(y,T),w}function m(y,b,v,x){var w=df(v);if(typeof w!="function")throw Error(pe(150));if(v=w.call(v),v==null)throw Error(pe(151));for(var S=w=null,C=b,T=b=0,E=null,R=v.next();C!==null&&!R.done;T++,R=v.next()){C.index>T?(E=C,C=null):E=C.sibling;var $=p(y,C,R.value,x);if($===null){C===null&&(C=E);break}e&&C&&$.alternate===null&&t(y,C),b=i($,b,T),S===null?w=$:S.sibling=$,S=$,C=E}if(R.done)return n(y,C),Qt&&Sl(y,T),w;if(C===null){for(;!R.done;T++,R=v.next())R=d(y,R.value,x),R!==null&&(b=i(R,b,T),S===null?w=R:S.sibling=R,S=R);return Qt&&Sl(y,T),w}for(C=r(y,C);!R.done;T++,R=v.next())R=h(C,y,T,R.value,x),R!==null&&(e&&R.alternate!==null&&C.delete(R.key===null?T:R.key),b=i(R,b,T),S===null?w=R:S.sibling=R,S=R);return e&&C.forEach(function(_){return t(y,_)}),Qt&&Sl(y,T),w}function g(y,b,v,x){if(typeof v=="object"&&v!==null&&v.type===Cd&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Hy:e:{for(var w=v.key,S=b;S!==null;){if(S.key===w){if(w=v.type,w===Cd){if(S.tag===7){n(y,S.sibling),b=a(S,v.props.children),b.return=y,y=b;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===no&&OR(w)===S.type){n(y,S.sibling),b=a(S,v.props),b.ref=gf(y,S,v),b.return=y,y=b;break e}n(y,S);break}else t(y,S);S=S.sibling}v.type===Cd?(b=jl(v.props.children,y.mode,x,v.key),b.return=y,y=b):(x=X0(v.type,v.key,v.props,null,y.mode,x),x.ref=gf(y,b,v),x.return=y,y=x)}return s(y);case Id:e:{for(S=v.key;b!==null;){if(b.key===S)if(b.tag===4&&b.stateNode.containerInfo===v.containerInfo&&b.stateNode.implementation===v.implementation){n(y,b.sibling),b=a(b,v.children||[]),b.return=y,y=b;break e}else{n(y,b);break}else t(y,b);b=b.sibling}b=tk(v,y.mode,x),b.return=y,y=b}return s(y);case no:return S=v._init,g(y,b,S(v._payload),x)}if(Tf(v))return f(y,b,v,x);if(df(v))return m(y,b,v,x);n0(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,b!==null&&b.tag===6?(n(y,b.sibling),b=a(b,v),b.return=y,y=b):(n(y,b),b=ek(v,y.mode,x),b.return=y,y=b),s(y)):n(y,b)}return g}var np=NP(!0),EP=NP(!1),fg={},qi=Yo(fg),Fm=Yo(fg),Dm=Yo(fg);function Ll(e){if(e===fg)throw Error(pe(174));return e}function hC(e,t){switch(Ut(Dm,t),Ut(Fm,e),Ut(qi,fg),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:cS(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=cS(t,e)}qt(qi),Ut(qi,t)}function rp(){qt(qi),qt(Fm),qt(Dm)}function $P(e){Ll(Dm.current);var t=Ll(qi.current),n=cS(t,e.type);t!==n&&(Ut(Fm,e),Ut(qi,n))}function fC(e){Fm.current===e&&(qt(qi),qt(Fm))}var an=Yo(0);function Lb(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Kw=[];function mC(){for(var e=0;e<Kw.length;e++)Kw[e]._workInProgressVersionPrimary=null;Kw.length=0}var j0=Bs.ReactCurrentDispatcher,Xw=Bs.ReactCurrentBatchConfig,nu=0,un=null,Bn=null,Yn=null,Bb=!1,Jf=!1,Mm=0,CQ=0;function gr(){throw Error(pe(321))}function gC(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Si(e[n],t[n]))return!1;return!0}function yC(e,t,n,r,a,i){if(nu=i,un=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,j0.current=e===null||e.memoizedState===null?EQ:$Q,e=n(r,a),Jf){i=0;do{if(Jf=!1,Mm=0,25<=i)throw Error(pe(301));i+=1,Yn=Bn=null,t.updateQueue=null,j0.current=AQ,e=n(r,a)}while(Jf)}if(j0.current=Wb,t=Bn!==null&&Bn.next!==null,nu=0,Yn=Bn=un=null,Bb=!1,t)throw Error(pe(300));return e}function bC(){var e=Mm!==0;return Mm=0,e}function Di(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yn===null?un.memoizedState=Yn=e:Yn=Yn.next=e,Yn}function ni(){if(Bn===null){var e=un.alternate;e=e!==null?e.memoizedState:null}else e=Bn.next;var t=Yn===null?un.memoizedState:Yn.next;if(t!==null)Yn=t,Bn=e;else{if(e===null)throw Error(pe(310));Bn=e,e={memoizedState:Bn.memoizedState,baseState:Bn.baseState,baseQueue:Bn.baseQueue,queue:Bn.queue,next:null},Yn===null?un.memoizedState=Yn=e:Yn=Yn.next=e}return Yn}function Om(e,t){return typeof t=="function"?t(e):t}function Yw(e){var t=ni(),n=t.queue;if(n===null)throw Error(pe(311));n.lastRenderedReducer=e;var r=Bn,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var o=s=null,l=null,c=i;do{var u=c.lane;if((nu&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,s=r):l=l.next=d,un.lanes|=u,ru|=u}c=c.next}while(c!==null&&c!==i);l===null?s=r:l.next=o,Si(r,t.memoizedState)||(ra=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do i=a.lane,un.lanes|=i,ru|=i,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Zw(e){var t=ni(),n=t.queue;if(n===null)throw Error(pe(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(a!==null){n.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);Si(i,t.memoizedState)||(ra=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function AP(){}function RP(e,t){var n=un,r=ni(),a=t(),i=!Si(r.memoizedState,a);if(i&&(r.memoizedState=a,ra=!0),r=r.queue,vC(MP.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||Yn!==null&&Yn.memoizedState.tag&1){if(n.flags|=2048,Pm(9,DP.bind(null,n,r,a,t),void 0,null),rr===null)throw Error(pe(349));nu&30||FP(n,t,a)}return a}function FP(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=un.updateQueue,t===null?(t={lastEffect:null,stores:null},un.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function DP(e,t,n,r){t.value=n,t.getSnapshot=r,OP(t)&&PP(e)}function MP(e,t,n){return n(function(){OP(t)&&PP(e)})}function OP(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Si(e,n)}catch{return!0}}function PP(e){var t=Ds(e,1);t!==null&&vi(t,e,1,-1)}function PR(e){var t=Di();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Om,lastRenderedState:e},t.queue=e,e=e.dispatch=NQ.bind(null,un,e),[t.memoizedState,e]}function Pm(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=un.updateQueue,t===null?(t={lastEffect:null,stores:null},un.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function zP(){return ni().memoizedState}function H0(e,t,n,r){var a=Di();un.flags|=e,a.memoizedState=Pm(1|t,n,void 0,r===void 0?null:r)}function gx(e,t,n,r){var a=ni();r=r===void 0?null:r;var i=void 0;if(Bn!==null){var s=Bn.memoizedState;if(i=s.destroy,r!==null&&gC(r,s.deps)){a.memoizedState=Pm(t,n,i,r);return}}un.flags|=e,a.memoizedState=Pm(1|t,n,i,r)}function zR(e,t){return H0(8390656,8,e,t)}function vC(e,t){return gx(2048,8,e,t)}function LP(e,t){return gx(4,2,e,t)}function BP(e,t){return gx(4,4,e,t)}function WP(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function VP(e,t,n){return n=n!=null?n.concat([e]):null,gx(4,4,WP.bind(null,t,e),n)}function xC(){}function UP(e,t){var n=ni();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&gC(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function jP(e,t){var n=ni();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&gC(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function HP(e,t,n){return nu&21?(Si(n,t)||(n=K3(),un.lanes|=n,ru|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ra=!0),e.memoizedState=n)}function _Q(e,t){var n=Nt;Nt=n!==0&&4>n?n:4,e(!0);var r=Xw.transition;Xw.transition={};try{e(!1),t()}finally{Nt=n,Xw.transition=r}}function GP(){return ni().memoizedState}function TQ(e,t,n){var r=So(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},qP(e))KP(t,n);else if(n=IP(e,t,n,r),n!==null){var a=Br();vi(n,e,r,a),XP(n,t,r)}}function NQ(e,t,n){var r=So(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(qP(e))KP(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,n);if(a.hasEagerState=!0,a.eagerState=o,Si(o,s)){var l=t.interleaved;l===null?(a.next=a,dC(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}n=IP(e,t,a,r),n!==null&&(a=Br(),vi(n,e,r,a),XP(n,t,r))}}function qP(e){var t=e.alternate;return e===un||t!==null&&t===un}function KP(e,t){Jf=Bb=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function XP(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Z2(e,n)}}var Wb={readContext:ti,useCallback:gr,useContext:gr,useEffect:gr,useImperativeHandle:gr,useInsertionEffect:gr,useLayoutEffect:gr,useMemo:gr,useReducer:gr,useRef:gr,useState:gr,useDebugValue:gr,useDeferredValue:gr,useTransition:gr,useMutableSource:gr,useSyncExternalStore:gr,useId:gr,unstable_isNewReconciler:!1},EQ={readContext:ti,useCallback:function(e,t){return Di().memoizedState=[e,t===void 0?null:t],e},useContext:ti,useEffect:zR,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,H0(4194308,4,WP.bind(null,t,e),n)},useLayoutEffect:function(e,t){return H0(4194308,4,e,t)},useInsertionEffect:function(e,t){return H0(4,2,e,t)},useMemo:function(e,t){var n=Di();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Di();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=TQ.bind(null,un,e),[r.memoizedState,e]},useRef:function(e){var t=Di();return e={current:e},t.memoizedState=e},useState:PR,useDebugValue:xC,useDeferredValue:function(e){return Di().memoizedState=e},useTransition:function(){var e=PR(!1),t=e[0];return e=_Q.bind(null,e[1]),Di().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=un,a=Di();if(Qt){if(n===void 0)throw Error(pe(407));n=n()}else{if(n=t(),rr===null)throw Error(pe(349));nu&30||FP(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,zR(MP.bind(null,r,i,e),[e]),r.flags|=2048,Pm(9,DP.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Di(),t=rr.identifierPrefix;if(Qt){var n=ks,r=ws;n=(r&~(1<<32-bi(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Mm++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=CQ++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$Q={readContext:ti,useCallback:UP,useContext:ti,useEffect:vC,useImperativeHandle:VP,useInsertionEffect:LP,useLayoutEffect:BP,useMemo:jP,useReducer:Yw,useRef:zP,useState:function(){return Yw(Om)},useDebugValue:xC,useDeferredValue:function(e){var t=ni();return HP(t,Bn.memoizedState,e)},useTransition:function(){var e=Yw(Om)[0],t=ni().memoizedState;return[e,t]},useMutableSource:AP,useSyncExternalStore:RP,useId:GP,unstable_isNewReconciler:!1},AQ={readContext:ti,useCallback:UP,useContext:ti,useEffect:vC,useImperativeHandle:VP,useInsertionEffect:LP,useLayoutEffect:BP,useMemo:jP,useReducer:Zw,useRef:zP,useState:function(){return Zw(Om)},useDebugValue:xC,useDeferredValue:function(e){var t=ni();return Bn===null?t.memoizedState=e:HP(t,Bn.memoizedState,e)},useTransition:function(){var e=Zw(Om)[0],t=ni().memoizedState;return[e,t]},useMutableSource:AP,useSyncExternalStore:RP,useId:GP,unstable_isNewReconciler:!1};function ap(e,t){try{var n="",r=t;do n+=iZ(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function Qw(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function FS(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var RQ=typeof WeakMap=="function"?WeakMap:Map;function YP(e,t,n){n=_s(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ub||(Ub=!0,US=r),FS(e,t)},n}function ZP(e,t,n){n=_s(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){FS(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){FS(e,t),typeof r!="function"&&(ko===null?ko=new Set([this]):ko.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),n}function LR(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new RQ;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=GQ.bind(null,e,t,n),t.then(e,e))}function BR(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function WR(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=_s(-1,1),t.tag=2,wo(n,t,1))),n.lanes|=1),e)}var FQ=Bs.ReactCurrentOwner,ra=!1;function Or(e,t,n,r){t.child=e===null?EP(t,null,n,r):np(t,e.child,n,r)}function VR(e,t,n,r,a){n=n.render;var i=t.ref;return Ud(t,a),r=yC(e,t,n,r,i,a),n=bC(),e!==null&&!ra?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ms(e,t,a)):(Qt&&n&&iC(t),t.flags|=1,Or(e,t,r,a),t.child)}function UR(e,t,n,r,a){if(e===null){var i=n.type;return typeof i=="function"&&!NC(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,QP(e,t,i,r,a)):(e=X0(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(n=n.compare,n=n!==null?n:Em,n(s,r)&&e.ref===t.ref)return Ms(e,t,a)}return t.flags|=1,e=Io(i,r),e.ref=t.ref,e.return=t,t.child=e}function QP(e,t,n,r,a){if(e!==null){var i=e.memoizedProps;if(Em(i,r)&&e.ref===t.ref)if(ra=!1,t.pendingProps=r=i,(e.lanes&a)!==0)e.flags&131072&&(ra=!0);else return t.lanes=e.lanes,Ms(e,t,a)}return DS(e,t,n,r,a)}function JP(e,t,n){var r=t.pendingProps,a=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ut(Md,xa),xa|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ut(Md,xa),xa|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ut(Md,xa),xa|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ut(Md,xa),xa|=r;return Or(e,t,a,n),t.child}function ez(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function DS(e,t,n,r,a){var i=oa(n)?eu:Cr.current;return i=ep(t,i),Ud(t,a),n=yC(e,t,n,r,i,a),r=bC(),e!==null&&!ra?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ms(e,t,a)):(Qt&&r&&iC(t),t.flags|=1,Or(e,t,n,a),t.child)}function jR(e,t,n,r,a){if(oa(n)){var i=!0;Fb(t)}else i=!1;if(Ud(t,a),t.stateNode===null)G0(e,t),TP(t,n,r),RS(t,n,r,a),r=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=n.contextType;typeof c=="object"&&c!==null?c=ti(c):(c=oa(n)?eu:Cr.current,c=ep(t,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==r||l!==c)&&MR(t,s,r,c),ro=!1;var p=t.memoizedState;s.state=p,zb(t,r,s,a),l=t.memoizedState,o!==r||p!==l||sa.current||ro?(typeof u=="function"&&(AS(t,n,u,r),l=t.memoizedState),(o=ro||DR(t,n,o,r,p,l,c))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,CP(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:pi(t.type,o),s.props=c,d=t.pendingProps,p=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=ti(l):(l=oa(n)?eu:Cr.current,l=ep(t,l));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==d||p!==l)&&MR(t,s,r,l),ro=!1,p=t.memoizedState,s.state=p,zb(t,r,s,a);var f=t.memoizedState;o!==d||p!==f||sa.current||ro?(typeof h=="function"&&(AS(t,n,h,r),f=t.memoizedState),(c=ro||DR(t,n,c,r,p,f,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,f,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,f,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return MS(e,t,n,r,i,a)}function MS(e,t,n,r,a,i){ez(e,t);var s=(t.flags&128)!==0;if(!r&&!s)return a&&ER(t,n,!1),Ms(e,t,i);r=t.stateNode,FQ.current=t;var o=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&s?(t.child=np(t,e.child,null,i),t.child=np(t,null,o,i)):Or(e,t,o,i),t.memoizedState=r.state,a&&ER(t,n,!0),t.child}function tz(e){var t=e.stateNode;t.pendingContext?NR(e,t.pendingContext,t.pendingContext!==t.context):t.context&&NR(e,t.context,!1),hC(e,t.containerInfo)}function HR(e,t,n,r,a){return tp(),oC(a),t.flags|=256,Or(e,t,n,r),t.child}var OS={dehydrated:null,treeContext:null,retryLane:0};function PS(e){return{baseLanes:e,cachePool:null,transitions:null}}function nz(e,t,n){var r=t.pendingProps,a=an.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Ut(an,a&1),e===null)return ES(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=r.children,e=r.fallback,i?(r=t.mode,i=t.child,s={mode:"hidden",children:s},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=vx(s,r,0,null),e=jl(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=PS(n),t.memoizedState=OS,e):wC(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return DQ(e,t,s,r,o,a,n);if(i){i=r.fallback,s=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=Io(a,l),r.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=Io(o,i):(i=jl(i,s,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,s=e.child.memoizedState,s=s===null?PS(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~n,t.memoizedState=OS,r}return i=e.child,e=i.sibling,r=Io(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function wC(e,t){return t=vx({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function r0(e,t,n,r){return r!==null&&oC(r),np(t,e.child,null,n),e=wC(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function DQ(e,t,n,r,a,i,s){if(n)return t.flags&256?(t.flags&=-257,r=Qw(Error(pe(422))),r0(e,t,s,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,a=t.mode,r=vx({mode:"visible",children:r.children},a,0,null),i=jl(i,a,s,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&np(t,e.child,null,s),t.child.memoizedState=PS(s),t.memoizedState=OS,i);if(!(t.mode&1))return r0(e,t,s,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var o=r.dgst;return r=o,i=Error(pe(419)),r=Qw(i,r,void 0),r0(e,t,s,r)}if(o=(s&e.childLanes)!==0,ra||o){if(r=rr,r!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Ds(e,a),vi(r,e,a,-1))}return TC(),r=Qw(Error(pe(421))),r0(e,t,s,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=qQ.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Sa=xo(a.nextSibling),Ea=t,Qt=!0,fi=null,e!==null&&(Ka[Xa++]=ws,Ka[Xa++]=ks,Ka[Xa++]=tu,ws=e.id,ks=e.overflow,tu=t),t=wC(t,r.children),t.flags|=4096,t)}function GR(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),$S(e.return,t,n)}function Jw(e,t,n,r,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function rz(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(Or(e,t,r.children,n),r=an.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&GR(e,n,t);else if(e.tag===19)GR(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ut(an,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&Lb(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Jw(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Lb(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Jw(t,!0,n,null,i);break;case"together":Jw(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function G0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ms(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ru|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(pe(153));if(t.child!==null){for(e=t.child,n=Io(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Io(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function MQ(e,t,n){switch(t.tag){case 3:tz(t),tp();break;case 5:$P(t);break;case 1:oa(t.type)&&Fb(t);break;case 4:hC(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ut(Ob,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ut(an,an.current&1),t.flags|=128,null):n&t.child.childLanes?nz(e,t,n):(Ut(an,an.current&1),e=Ms(e,t,n),e!==null?e.sibling:null);Ut(an,an.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return rz(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ut(an,an.current),r)break;return null;case 22:case 23:return t.lanes=0,JP(e,t,n)}return Ms(e,t,n)}var az,zS,iz,sz;az=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};zS=function(){};iz=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Ll(qi.current);var i=null;switch(n){case"input":a=sS(e,a),r=sS(e,r),i=[];break;case"select":a=cn({},a,{value:void 0}),r=cn({},r,{value:void 0}),i=[];break;case"textarea":a=uS(e,a),r=uS(e,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Ab)}dS(n,r);var s;n=null;for(c in a)if(!r.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(s in o)o.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(km.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(o=a!=null?a[c]:void 0,r.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(km.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ht("scroll",e),i||o===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};sz=function(e,t,n,r){n!==r&&(t.flags|=4)};function yf(e,t){if(!Qt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function yr(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function OQ(e,t,n){var r=t.pendingProps;switch(sC(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yr(t),null;case 1:return oa(t.type)&&Rb(),yr(t),null;case 3:return r=t.stateNode,rp(),qt(sa),qt(Cr),mC(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(t0(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,fi!==null&&(GS(fi),fi=null))),zS(e,t),yr(t),null;case 5:fC(t);var a=Ll(Dm.current);if(n=t.type,e!==null&&t.stateNode!=null)iz(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(pe(166));return yr(t),null}if(e=Ll(qi.current),t0(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Wi]=t,r[Rm]=i,e=(t.mode&1)!==0,n){case"dialog":Ht("cancel",r),Ht("close",r);break;case"iframe":case"object":case"embed":Ht("load",r);break;case"video":case"audio":for(a=0;a<Ef.length;a++)Ht(Ef[a],r);break;case"source":Ht("error",r);break;case"img":case"image":case"link":Ht("error",r),Ht("load",r);break;case"details":Ht("toggle",r);break;case"input":tR(r,i),Ht("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ht("invalid",r);break;case"textarea":rR(r,i),Ht("invalid",r)}dS(n,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?r.textContent!==o&&(i.suppressHydrationWarning!==!0&&e0(r.textContent,o,e),a=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&e0(r.textContent,o,e),a=["children",""+o]):km.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&Ht("scroll",r)}switch(n){case"input":Gy(r),nR(r,i,!0);break;case"textarea":Gy(r),aR(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ab)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=F3(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),n==="select"&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[Wi]=t,e[Rm]=r,az(e,t,!1,!1),t.stateNode=e;e:{switch(s=pS(n,r),n){case"dialog":Ht("cancel",e),Ht("close",e),a=r;break;case"iframe":case"object":case"embed":Ht("load",e),a=r;break;case"video":case"audio":for(a=0;a<Ef.length;a++)Ht(Ef[a],e);a=r;break;case"source":Ht("error",e),a=r;break;case"img":case"image":case"link":Ht("error",e),Ht("load",e),a=r;break;case"details":Ht("toggle",e),a=r;break;case"input":tR(e,r),a=sS(e,r),Ht("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=cn({},r,{value:void 0}),Ht("invalid",e);break;case"textarea":rR(e,r),a=uS(e,r),Ht("invalid",e);break;default:a=r}dS(n,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?O3(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&D3(e,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Sm(e,l):typeof l=="number"&&Sm(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(km.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ht("scroll",e):l!=null&&H2(e,i,l,s))}switch(n){case"input":Gy(e),nR(e,r,!1);break;case"textarea":Gy(e),aR(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Do(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Ld(e,!!r.multiple,i,!1):r.defaultValue!=null&&Ld(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Ab)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return yr(t),null;case 6:if(e&&t.stateNode!=null)sz(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(pe(166));if(n=Ll(Dm.current),Ll(qi.current),t0(t)){if(r=t.stateNode,n=t.memoizedProps,r[Wi]=t,(i=r.nodeValue!==n)&&(e=Ea,e!==null))switch(e.tag){case 3:e0(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&e0(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Wi]=t,t.stateNode=r}return yr(t),null;case 13:if(qt(an),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Qt&&Sa!==null&&t.mode&1&&!(t.flags&128))SP(),tp(),t.flags|=98560,i=!1;else if(i=t0(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(pe(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(pe(317));i[Wi]=t}else tp(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;yr(t),i=!1}else fi!==null&&(GS(fi),fi=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||an.current&1?Un===0&&(Un=3):TC())),t.updateQueue!==null&&(t.flags|=4),yr(t),null);case 4:return rp(),zS(e,t),e===null&&$m(t.stateNode.containerInfo),yr(t),null;case 10:return cC(t.type._context),yr(t),null;case 17:return oa(t.type)&&Rb(),yr(t),null;case 19:if(qt(an),i=t.memoizedState,i===null)return yr(t),null;if(r=(t.flags&128)!==0,s=i.rendering,s===null)if(r)yf(i,!1);else{if(Un!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Lb(e),s!==null){for(t.flags|=128,yf(i,!1),r=s.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ut(an,an.current&1|2),t.child}e=e.sibling}i.tail!==null&&wn()>ip&&(t.flags|=128,r=!0,yf(i,!1),t.lanes=4194304)}else{if(!r)if(e=Lb(s),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),yf(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!Qt)return yr(t),null}else 2*wn()-i.renderingStartTime>ip&&n!==1073741824&&(t.flags|=128,r=!0,yf(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(n=i.last,n!==null?n.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=wn(),t.sibling=null,n=an.current,Ut(an,r?n&1|2:n&1),t):(yr(t),null);case 22:case 23:return _C(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?xa&1073741824&&(yr(t),t.subtreeFlags&6&&(t.flags|=8192)):yr(t),null;case 24:return null;case 25:return null}throw Error(pe(156,t.tag))}function PQ(e,t){switch(sC(t),t.tag){case 1:return oa(t.type)&&Rb(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return rp(),qt(sa),qt(Cr),mC(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return fC(t),null;case 13:if(qt(an),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(pe(340));tp()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return qt(an),null;case 4:return rp(),null;case 10:return cC(t.type._context),null;case 22:case 23:return _C(),null;case 24:return null;default:return null}}var a0=!1,vr=!1,zQ=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function Dd(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){hn(e,t,r)}else n.current=null}function LS(e,t,n){try{n()}catch(r){hn(e,t,r)}}var qR=!1;function LQ(e,t){if(kS=Nb,e=cP(),aC(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var s=0,o=-1,l=-1,c=0,u=0,d=e,p=null;t:for(;;){for(var h;d!==n||a!==0&&d.nodeType!==3||(o=s+a),d!==i||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(h=d.firstChild)!==null;)p=d,d=h;for(;;){if(d===e)break t;if(p===n&&++c===a&&(o=s),p===i&&++u===r&&(l=s),(h=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=h}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(SS={focusedElem:e,selectionRange:n},Nb=!1,Ne=t;Ne!==null;)if(t=Ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ne=e;else for(;Ne!==null;){t=Ne;try{var f=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var m=f.memoizedProps,g=f.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:pi(t.type,m),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pe(163))}}catch(x){hn(t,t.return,x)}if(e=t.sibling,e!==null){e.return=t.return,Ne=e;break}Ne=t.return}return f=qR,qR=!1,f}function em(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&LS(t,n,i)}a=a.next}while(a!==r)}}function yx(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function BS(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function oz(e){var t=e.alternate;t!==null&&(e.alternate=null,oz(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Wi],delete t[Rm],delete t[_S],delete t[wQ],delete t[kQ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function lz(e){return e.tag===5||e.tag===3||e.tag===4}function KR(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||lz(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function WS(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ab));else if(r!==4&&(e=e.child,e!==null))for(WS(e,t,n),e=e.sibling;e!==null;)WS(e,t,n),e=e.sibling}function VS(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(VS(e,t,n),e=e.sibling;e!==null;)VS(e,t,n),e=e.sibling}var lr=null,hi=!1;function Xs(e,t,n){for(n=n.child;n!==null;)uz(e,t,n),n=n.sibling}function uz(e,t,n){if(Gi&&typeof Gi.onCommitFiberUnmount=="function")try{Gi.onCommitFiberUnmount(ux,n)}catch{}switch(n.tag){case 5:vr||Dd(n,t);case 6:var r=lr,a=hi;lr=null,Xs(e,t,n),lr=r,hi=a,lr!==null&&(hi?(e=lr,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):lr.removeChild(n.stateNode));break;case 18:lr!==null&&(hi?(e=lr,n=n.stateNode,e.nodeType===8?Gw(e.parentNode,n):e.nodeType===1&&Gw(e,n),Tm(e)):Gw(lr,n.stateNode));break;case 4:r=lr,a=hi,lr=n.stateNode.containerInfo,hi=!0,Xs(e,t,n),lr=r,hi=a;break;case 0:case 11:case 14:case 15:if(!vr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&LS(n,t,s),a=a.next}while(a!==r)}Xs(e,t,n);break;case 1:if(!vr&&(Dd(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){hn(n,t,o)}Xs(e,t,n);break;case 21:Xs(e,t,n);break;case 22:n.mode&1?(vr=(r=vr)||n.memoizedState!==null,Xs(e,t,n),vr=r):Xs(e,t,n);break;default:Xs(e,t,n)}}function XR(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new zQ),t.forEach(function(r){var a=KQ.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function ci(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:lr=o.stateNode,hi=!1;break e;case 3:lr=o.stateNode.containerInfo,hi=!0;break e;case 4:lr=o.stateNode.containerInfo,hi=!0;break e}o=o.return}if(lr===null)throw Error(pe(160));uz(i,s,a),lr=null,hi=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){hn(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)cz(t,e),t=t.sibling}function cz(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ci(t,e),Ei(e),r&4){try{em(3,e,e.return),yx(3,e)}catch(m){hn(e,e.return,m)}try{em(5,e,e.return)}catch(m){hn(e,e.return,m)}}break;case 1:ci(t,e),Ei(e),r&512&&n!==null&&Dd(n,n.return);break;case 5:if(ci(t,e),Ei(e),r&512&&n!==null&&Dd(n,n.return),e.flags&32){var a=e.stateNode;try{Sm(a,"")}catch(m){hn(e,e.return,m)}}if(r&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=n!==null?n.memoizedProps:i,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&A3(a,i),pS(o,s);var c=pS(o,i);for(s=0;s<l.length;s+=2){var u=l[s],d=l[s+1];u==="style"?O3(a,d):u==="dangerouslySetInnerHTML"?D3(a,d):u==="children"?Sm(a,d):H2(a,u,d,c)}switch(o){case"input":oS(a,i);break;case"textarea":R3(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?Ld(a,!!i.multiple,h,!1):p!==!!i.multiple&&(i.defaultValue!=null?Ld(a,!!i.multiple,i.defaultValue,!0):Ld(a,!!i.multiple,i.multiple?[]:"",!1))}a[Rm]=i}catch(m){hn(e,e.return,m)}}break;case 6:if(ci(t,e),Ei(e),r&4){if(e.stateNode===null)throw Error(pe(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(m){hn(e,e.return,m)}}break;case 3:if(ci(t,e),Ei(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Tm(t.containerInfo)}catch(m){hn(e,e.return,m)}break;case 4:ci(t,e),Ei(e);break;case 13:ci(t,e),Ei(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(IC=wn())),r&4&&XR(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(vr=(c=vr)||u,ci(t,e),vr=c):ci(t,e),Ei(e),r&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Ne=e,u=e.child;u!==null;){for(d=Ne=u;Ne!==null;){switch(p=Ne,h=p.child,p.tag){case 0:case 11:case 14:case 15:em(4,p,p.return);break;case 1:Dd(p,p.return);var f=p.stateNode;if(typeof f.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(m){hn(r,n,m)}}break;case 5:Dd(p,p.return);break;case 22:if(p.memoizedState!==null){ZR(d);continue}}h!==null?(h.return=p,Ne=h):ZR(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{a=d.stateNode,c?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=M3("display",s))}catch(m){hn(e,e.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){hn(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ci(t,e),Ei(e),r&4&&XR(e);break;case 21:break;default:ci(t,e),Ei(e)}}function Ei(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(lz(n)){var r=n;break e}n=n.return}throw Error(pe(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(Sm(a,""),r.flags&=-33);var i=KR(e);VS(e,i,a);break;case 3:case 4:var s=r.stateNode.containerInfo,o=KR(e);WS(e,o,s);break;default:throw Error(pe(161))}}catch(l){hn(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function BQ(e,t,n){Ne=e,dz(e)}function dz(e,t,n){for(var r=(e.mode&1)!==0;Ne!==null;){var a=Ne,i=a.child;if(a.tag===22&&r){var s=a.memoizedState!==null||a0;if(!s){var o=a.alternate,l=o!==null&&o.memoizedState!==null||vr;o=a0;var c=vr;if(a0=s,(vr=l)&&!c)for(Ne=a;Ne!==null;)s=Ne,l=s.child,s.tag===22&&s.memoizedState!==null?QR(a):l!==null?(l.return=s,Ne=l):QR(a);for(;i!==null;)Ne=i,dz(i),i=i.sibling;Ne=a,a0=o,vr=c}YR(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Ne=i):YR(e)}}function YR(e){for(;Ne!==null;){var t=Ne;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:vr||yx(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!vr)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:pi(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&FR(t,i,r);break;case 3:var s=t.updateQueue;if(s!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}FR(t,s,n)}break;case 5:var o=t.stateNode;if(n===null&&t.flags&4){n=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Tm(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pe(163))}vr||t.flags&512&&BS(t)}catch(p){hn(t,t.return,p)}}if(t===e){Ne=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ne=n;break}Ne=t.return}}function ZR(e){for(;Ne!==null;){var t=Ne;if(t===e){Ne=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ne=n;break}Ne=t.return}}function QR(e){for(;Ne!==null;){var t=Ne;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{yx(4,t)}catch(l){hn(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(l){hn(t,a,l)}}var i=t.return;try{BS(t)}catch(l){hn(t,i,l)}break;case 5:var s=t.return;try{BS(t)}catch(l){hn(t,s,l)}}}catch(l){hn(t,t.return,l)}if(t===e){Ne=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ne=o;break}Ne=t.return}}var WQ=Math.ceil,Vb=Bs.ReactCurrentDispatcher,kC=Bs.ReactCurrentOwner,Ja=Bs.ReactCurrentBatchConfig,bt=0,rr=null,En=null,dr=0,xa=0,Md=Yo(0),Un=0,zm=null,ru=0,bx=0,SC=0,tm=null,ea=null,IC=0,ip=1/0,hs=null,Ub=!1,US=null,ko=null,i0=!1,co=null,jb=0,nm=0,jS=null,q0=-1,K0=0;function Br(){return bt&6?wn():q0!==-1?q0:q0=wn()}function So(e){return e.mode&1?bt&2&&dr!==0?dr&-dr:IQ.transition!==null?(K0===0&&(K0=K3()),K0):(e=Nt,e!==0||(e=window.event,e=e===void 0?16:tP(e.type)),e):1}function vi(e,t,n,r){if(50<nm)throw nm=0,jS=null,Error(pe(185));dg(e,n,r),(!(bt&2)||e!==rr)&&(e===rr&&(!(bt&2)&&(bx|=n),Un===4&&oo(e,dr)),la(e,r),n===1&&bt===0&&!(t.mode&1)&&(ip=wn()+500,fx&&Zo()))}function la(e,t){var n=e.callbackNode;IZ(e,t);var r=Tb(e,e===rr?dr:0);if(r===0)n!==null&&oR(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&oR(n),t===1)e.tag===0?SQ(JR.bind(null,e)):xP(JR.bind(null,e)),vQ(function(){!(bt&6)&&Zo()}),n=null;else{switch(X3(r)){case 1:n=Y2;break;case 4:n=G3;break;case 16:n=_b;break;case 536870912:n=q3;break;default:n=_b}n=vz(n,pz.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function pz(e,t){if(q0=-1,K0=0,bt&6)throw Error(pe(327));var n=e.callbackNode;if(jd()&&e.callbackNode!==n)return null;var r=Tb(e,e===rr?dr:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Hb(e,r);else{t=r;var a=bt;bt|=2;var i=fz();(rr!==e||dr!==t)&&(hs=null,ip=wn()+500,Ul(e,t));do try{jQ();break}catch(o){hz(e,o)}while(1);uC(),Vb.current=i,bt=a,En!==null?t=0:(rr=null,dr=0,t=Un)}if(t!==0){if(t===2&&(a=yS(e),a!==0&&(r=a,t=HS(e,a))),t===1)throw n=zm,Ul(e,0),oo(e,r),la(e,wn()),n;if(t===6)oo(e,r);else{if(a=e.current.alternate,!(r&30)&&!VQ(a)&&(t=Hb(e,r),t===2&&(i=yS(e),i!==0&&(r=i,t=HS(e,i))),t===1))throw n=zm,Ul(e,0),oo(e,r),la(e,wn()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(pe(345));case 2:Il(e,ea,hs);break;case 3:if(oo(e,r),(r&130023424)===r&&(t=IC+500-wn(),10<t)){if(Tb(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){Br(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=CS(Il.bind(null,e,ea,hs),t);break}Il(e,ea,hs);break;case 4:if(oo(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-bi(r);i=1<<s,s=t[s],s>a&&(a=s),r&=~i}if(r=a,r=wn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*WQ(r/1960))-r,10<r){e.timeoutHandle=CS(Il.bind(null,e,ea,hs),r);break}Il(e,ea,hs);break;case 5:Il(e,ea,hs);break;default:throw Error(pe(329))}}}return la(e,wn()),e.callbackNode===n?pz.bind(null,e):null}function HS(e,t){var n=tm;return e.current.memoizedState.isDehydrated&&(Ul(e,t).flags|=256),e=Hb(e,t),e!==2&&(t=ea,ea=n,t!==null&&GS(t)),e}function GS(e){ea===null?ea=e:ea.push.apply(ea,e)}function VQ(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!Si(i(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function oo(e,t){for(t&=~SC,t&=~bx,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-bi(t),r=1<<n;e[n]=-1,t&=~r}}function JR(e){if(bt&6)throw Error(pe(327));jd();var t=Tb(e,0);if(!(t&1))return la(e,wn()),null;var n=Hb(e,t);if(e.tag!==0&&n===2){var r=yS(e);r!==0&&(t=r,n=HS(e,r))}if(n===1)throw n=zm,Ul(e,0),oo(e,t),la(e,wn()),n;if(n===6)throw Error(pe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Il(e,ea,hs),la(e,wn()),null}function CC(e,t){var n=bt;bt|=1;try{return e(t)}finally{bt=n,bt===0&&(ip=wn()+500,fx&&Zo())}}function au(e){co!==null&&co.tag===0&&!(bt&6)&&jd();var t=bt;bt|=1;var n=Ja.transition,r=Nt;try{if(Ja.transition=null,Nt=1,e)return e()}finally{Nt=r,Ja.transition=n,bt=t,!(bt&6)&&Zo()}}function _C(){xa=Md.current,qt(Md)}function Ul(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,bQ(n)),En!==null)for(n=En.return;n!==null;){var r=n;switch(sC(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Rb();break;case 3:rp(),qt(sa),qt(Cr),mC();break;case 5:fC(r);break;case 4:rp();break;case 13:qt(an);break;case 19:qt(an);break;case 10:cC(r.type._context);break;case 22:case 23:_C()}n=n.return}if(rr=e,En=e=Io(e.current,null),dr=xa=t,Un=0,zm=null,SC=bx=ru=0,ea=tm=null,zl!==null){for(t=0;t<zl.length;t++)if(n=zl[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var s=i.next;i.next=a,r.next=s}n.pending=r}zl=null}return e}function hz(e,t){do{var n=En;try{if(uC(),j0.current=Wb,Bb){for(var r=un.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Bb=!1}if(nu=0,Yn=Bn=un=null,Jf=!1,Mm=0,kC.current=null,n===null||n.return===null){Un=1,zm=t,En=null;break}e:{var i=e,s=n.return,o=n,l=t;if(t=dr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=BR(s);if(h!==null){h.flags&=-257,WR(h,s,o,i,t),h.mode&1&&LR(i,c,t),t=h,l=c;var f=t.updateQueue;if(f===null){var m=new Set;m.add(l),t.updateQueue=m}else f.add(l);break e}else{if(!(t&1)){LR(i,c,t),TC();break e}l=Error(pe(426))}}else if(Qt&&o.mode&1){var g=BR(s);if(g!==null){!(g.flags&65536)&&(g.flags|=256),WR(g,s,o,i,t),oC(ap(l,o));break e}}i=l=ap(l,o),Un!==4&&(Un=2),tm===null?tm=[i]:tm.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var y=YP(i,l,t);RR(i,y);break e;case 1:o=l;var b=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ko===null||!ko.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var x=ZP(i,o,t);RR(i,x);break e}}i=i.return}while(i!==null)}gz(n)}catch(w){t=w,En===n&&n!==null&&(En=n=n.return);continue}break}while(1)}function fz(){var e=Vb.current;return Vb.current=Wb,e===null?Wb:e}function TC(){(Un===0||Un===3||Un===2)&&(Un=4),rr===null||!(ru&268435455)&&!(bx&268435455)||oo(rr,dr)}function Hb(e,t){var n=bt;bt|=2;var r=fz();(rr!==e||dr!==t)&&(hs=null,Ul(e,t));do try{UQ();break}catch(a){hz(e,a)}while(1);if(uC(),bt=n,Vb.current=r,En!==null)throw Error(pe(261));return rr=null,dr=0,Un}function UQ(){for(;En!==null;)mz(En)}function jQ(){for(;En!==null&&!mZ();)mz(En)}function mz(e){var t=bz(e.alternate,e,xa);e.memoizedProps=e.pendingProps,t===null?gz(e):En=t,kC.current=null}function gz(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=PQ(n,t),n!==null){n.flags&=32767,En=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Un=6,En=null;return}}else if(n=OQ(n,t,xa),n!==null){En=n;return}if(t=t.sibling,t!==null){En=t;return}En=t=e}while(t!==null);Un===0&&(Un=5)}function Il(e,t,n){var r=Nt,a=Ja.transition;try{Ja.transition=null,Nt=1,HQ(e,t,n,r)}finally{Ja.transition=a,Nt=r}return null}function HQ(e,t,n,r){do jd();while(co!==null);if(bt&6)throw Error(pe(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(pe(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(CZ(e,i),e===rr&&(En=rr=null,dr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||i0||(i0=!0,vz(_b,function(){return jd(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Ja.transition,Ja.transition=null;var s=Nt;Nt=1;var o=bt;bt|=4,kC.current=null,LQ(e,n),cz(n,e),dQ(SS),Nb=!!kS,SS=kS=null,e.current=n,BQ(n),gZ(),bt=o,Nt=s,Ja.transition=i}else e.current=n;if(i0&&(i0=!1,co=e,jb=a),i=e.pendingLanes,i===0&&(ko=null),vZ(n.stateNode),la(e,wn()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Ub)throw Ub=!1,e=US,US=null,e;return jb&1&&e.tag!==0&&jd(),i=e.pendingLanes,i&1?e===jS?nm++:(nm=0,jS=e):nm=0,Zo(),null}function jd(){if(co!==null){var e=X3(jb),t=Ja.transition,n=Nt;try{if(Ja.transition=null,Nt=16>e?16:e,co===null)var r=!1;else{if(e=co,co=null,jb=0,bt&6)throw Error(pe(331));var a=bt;for(bt|=4,Ne=e.current;Ne!==null;){var i=Ne,s=i.child;if(Ne.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ne=c;Ne!==null;){var u=Ne;switch(u.tag){case 0:case 11:case 15:em(8,u,i)}var d=u.child;if(d!==null)d.return=u,Ne=d;else for(;Ne!==null;){u=Ne;var p=u.sibling,h=u.return;if(oz(u),u===c){Ne=null;break}if(p!==null){p.return=h,Ne=p;break}Ne=h}}}var f=i.alternate;if(f!==null){var m=f.child;if(m!==null){f.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Ne=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,Ne=s;else e:for(;Ne!==null;){if(i=Ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:em(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,Ne=y;break e}Ne=i.return}}var b=e.current;for(Ne=b;Ne!==null;){s=Ne;var v=s.child;if(s.subtreeFlags&2064&&v!==null)v.return=s,Ne=v;else e:for(s=b;Ne!==null;){if(o=Ne,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:yx(9,o)}}catch(w){hn(o,o.return,w)}if(o===s){Ne=null;break e}var x=o.sibling;if(x!==null){x.return=o.return,Ne=x;break e}Ne=o.return}}if(bt=a,Zo(),Gi&&typeof Gi.onPostCommitFiberRoot=="function")try{Gi.onPostCommitFiberRoot(ux,e)}catch{}r=!0}return r}finally{Nt=n,Ja.transition=t}}return!1}function eF(e,t,n){t=ap(n,t),t=YP(e,t,1),e=wo(e,t,1),t=Br(),e!==null&&(dg(e,1,t),la(e,t))}function hn(e,t,n){if(e.tag===3)eF(e,e,n);else for(;t!==null;){if(t.tag===3){eF(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ko===null||!ko.has(r))){e=ap(n,e),e=ZP(t,e,1),t=wo(t,e,1),e=Br(),t!==null&&(dg(t,1,e),la(t,e));break}}t=t.return}}function GQ(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Br(),e.pingedLanes|=e.suspendedLanes&n,rr===e&&(dr&n)===n&&(Un===4||Un===3&&(dr&130023424)===dr&&500>wn()-IC?Ul(e,0):SC|=n),la(e,t)}function yz(e,t){t===0&&(e.mode&1?(t=Xy,Xy<<=1,!(Xy&130023424)&&(Xy=4194304)):t=1);var n=Br();e=Ds(e,t),e!==null&&(dg(e,t,n),la(e,n))}function qQ(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),yz(e,n)}function KQ(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(pe(314))}r!==null&&r.delete(t),yz(e,n)}var bz;bz=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||sa.current)ra=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return ra=!1,MQ(e,t,n);ra=!!(e.flags&131072)}else ra=!1,Qt&&t.flags&1048576&&wP(t,Mb,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;G0(e,t),e=t.pendingProps;var a=ep(t,Cr.current);Ud(t,n),a=yC(null,t,r,e,a,n);var i=bC();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,oa(r)?(i=!0,Fb(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,pC(t),a.updater=mx,t.stateNode=a,a._reactInternals=t,RS(t,r,e,n),t=MS(null,t,r,!0,i,n)):(t.tag=0,Qt&&i&&iC(t),Or(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(G0(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=YQ(r),e=pi(r,e),a){case 0:t=DS(null,t,r,e,n);break e;case 1:t=jR(null,t,r,e,n);break e;case 11:t=VR(null,t,r,e,n);break e;case 14:t=UR(null,t,r,pi(r.type,e),n);break e}throw Error(pe(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:pi(r,a),DS(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:pi(r,a),jR(e,t,r,a,n);case 3:e:{if(tz(t),e===null)throw Error(pe(387));r=t.pendingProps,i=t.memoizedState,a=i.element,CP(e,t),zb(t,r,null,n);var s=t.memoizedState;if(r=s.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=ap(Error(pe(423)),t),t=HR(e,t,r,n,a);break e}else if(r!==a){a=ap(Error(pe(424)),t),t=HR(e,t,r,n,a);break e}else for(Sa=xo(t.stateNode.containerInfo.firstChild),Ea=t,Qt=!0,fi=null,n=EP(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(tp(),r===a){t=Ms(e,t,n);break e}Or(e,t,r,n)}t=t.child}return t;case 5:return $P(t),e===null&&ES(t),r=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,IS(r,a)?s=null:i!==null&&IS(r,i)&&(t.flags|=32),ez(e,t),Or(e,t,s,n),t.child;case 6:return e===null&&ES(t),null;case 13:return nz(e,t,n);case 4:return hC(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=np(t,null,r,n):Or(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:pi(r,a),VR(e,t,r,a,n);case 7:return Or(e,t,t.pendingProps,n),t.child;case 8:return Or(e,t,t.pendingProps.children,n),t.child;case 12:return Or(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,Ut(Ob,r._currentValue),r._currentValue=s,i!==null)if(Si(i.value,s)){if(i.children===a.children&&!sa.current){t=Ms(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=_s(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),$S(i.return,n,t),o.lanes|=n;break}l=l.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(pe(341));s.lanes|=n,o=s.alternate,o!==null&&(o.lanes|=n),$S(s,n,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Or(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ud(t,n),a=ti(a),r=r(a),t.flags|=1,Or(e,t,r,n),t.child;case 14:return r=t.type,a=pi(r,t.pendingProps),a=pi(r.type,a),UR(e,t,r,a,n);case 15:return QP(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:pi(r,a),G0(e,t),t.tag=1,oa(r)?(e=!0,Fb(t)):e=!1,Ud(t,n),TP(t,r,a),RS(t,r,a,n),MS(null,t,r,!0,e,n);case 19:return rz(e,t,n);case 22:return JP(e,t,n)}throw Error(pe(156,t.tag))};function vz(e,t){return H3(e,t)}function XQ(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ya(e,t,n,r){return new XQ(e,t,n,r)}function NC(e){return e=e.prototype,!(!e||!e.isReactComponent)}function YQ(e){if(typeof e=="function")return NC(e)?1:0;if(e!=null){if(e=e.$$typeof,e===q2)return 11;if(e===K2)return 14}return 2}function Io(e,t){var n=e.alternate;return n===null?(n=Ya(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function X0(e,t,n,r,a,i){var s=2;if(r=e,typeof e=="function")NC(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Cd:return jl(n.children,a,i,t);case G2:s=8,a|=8;break;case nS:return e=Ya(12,n,t,a|2),e.elementType=nS,e.lanes=i,e;case rS:return e=Ya(13,n,t,a),e.elementType=rS,e.lanes=i,e;case aS:return e=Ya(19,n,t,a),e.elementType=aS,e.lanes=i,e;case N3:return vx(n,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case _3:s=10;break e;case T3:s=9;break e;case q2:s=11;break e;case K2:s=14;break e;case no:s=16,r=null;break e}throw Error(pe(130,e==null?e:typeof e,""))}return t=Ya(s,n,t,a),t.elementType=e,t.type=r,t.lanes=i,t}function jl(e,t,n,r){return e=Ya(7,e,r,t),e.lanes=n,e}function vx(e,t,n,r){return e=Ya(22,e,r,t),e.elementType=N3,e.lanes=n,e.stateNode={isHidden:!1},e}function ek(e,t,n){return e=Ya(6,e,null,t),e.lanes=n,e}function tk(e,t,n){return t=Ya(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ZQ(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mw(0),this.expirationTimes=Mw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mw(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function EC(e,t,n,r,a,i,s,o,l){return e=new ZQ(e,t,n,o,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Ya(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},pC(i),e}function QQ(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Id,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function xz(e){if(!e)return Mo;e=e._reactInternals;e:{if(Nu(e)!==e||e.tag!==1)throw Error(pe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(oa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(pe(171))}if(e.tag===1){var n=e.type;if(oa(n))return vP(e,n,t)}return t}function wz(e,t,n,r,a,i,s,o,l){return e=EC(n,r,!0,e,a,i,s,o,l),e.context=xz(null),n=e.current,r=Br(),a=So(n),i=_s(r,a),i.callback=t??null,wo(n,i,a),e.current.lanes=a,dg(e,a,r),la(e,r),e}function xx(e,t,n,r){var a=t.current,i=Br(),s=So(a);return n=xz(n),t.context===null?t.context=n:t.pendingContext=n,t=_s(i,s),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=wo(a,t,s),e!==null&&(vi(e,a,s,i),U0(e,a,s)),s}function Gb(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function tF(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function $C(e,t){tF(e,t),(e=e.alternate)&&tF(e,t)}function JQ(){return null}var kz=typeof reportError=="function"?reportError:function(e){console.error(e)};function AC(e){this._internalRoot=e}wx.prototype.render=AC.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(pe(409));xx(e,t,null,null)};wx.prototype.unmount=AC.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;au(function(){xx(null,e,null,null)}),t[Fs]=null}};function wx(e){this._internalRoot=e}wx.prototype.unstable_scheduleHydration=function(e){if(e){var t=Q3();e={blockedOn:null,target:e,priority:t};for(var n=0;n<so.length&&t!==0&&t<so[n].priority;n++);so.splice(n,0,e),n===0&&eP(e)}};function RC(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function kx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function nF(){}function eJ(e,t,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var c=Gb(s);i.call(c)}}var s=wz(t,r,e,0,null,!1,!1,"",nF);return e._reactRootContainer=s,e[Fs]=s.current,$m(e.nodeType===8?e.parentNode:e),au(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var o=r;r=function(){var c=Gb(l);o.call(c)}}var l=EC(e,0,!1,null,null,!1,!1,"",nF);return e._reactRootContainer=l,e[Fs]=l.current,$m(e.nodeType===8?e.parentNode:e),au(function(){xx(t,l,n,r)}),l}function Sx(e,t,n,r,a){var i=n._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var l=Gb(s);o.call(l)}}xx(t,s,e,a)}else s=eJ(n,t,e,a,r);return Gb(s)}Y3=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Nf(t.pendingLanes);n!==0&&(Z2(t,n|1),la(t,wn()),!(bt&6)&&(ip=wn()+500,Zo()))}break;case 13:au(function(){var r=Ds(e,1);if(r!==null){var a=Br();vi(r,e,1,a)}}),$C(e,1)}};Q2=function(e){if(e.tag===13){var t=Ds(e,134217728);if(t!==null){var n=Br();vi(t,e,134217728,n)}$C(e,134217728)}};Z3=function(e){if(e.tag===13){var t=So(e),n=Ds(e,t);if(n!==null){var r=Br();vi(n,e,t,r)}$C(e,t)}};Q3=function(){return Nt};J3=function(e,t){var n=Nt;try{return Nt=e,t()}finally{Nt=n}};fS=function(e,t,n){switch(t){case"input":if(oS(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=hx(r);if(!a)throw Error(pe(90));$3(r),oS(r,a)}}}break;case"textarea":R3(e,n);break;case"select":t=n.value,t!=null&&Ld(e,!!n.multiple,t,!1)}};L3=CC;B3=au;var tJ={usingClientEntryPoint:!1,Events:[hg,Ed,hx,P3,z3,CC]},bf={findFiberByHostInstance:Pl,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nJ={bundleType:bf.bundleType,version:bf.version,rendererPackageName:bf.rendererPackageName,rendererConfig:bf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Bs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=U3(e),e===null?null:e.stateNode},findFiberByHostInstance:bf.findFiberByHostInstance||JQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var s0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!s0.isDisabled&&s0.supportsFiber)try{ux=s0.inject(nJ),Gi=s0}catch{}}Oa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tJ;Oa.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!RC(t))throw Error(pe(200));return QQ(e,t,null,n)};Oa.createRoot=function(e,t){if(!RC(e))throw Error(pe(299));var n=!1,r="",a=kz;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=EC(e,1,!1,null,null,n,!1,r,a),e[Fs]=t.current,$m(e.nodeType===8?e.parentNode:e),new AC(t)};Oa.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(pe(188)):(e=Object.keys(e).join(","),Error(pe(268,e)));return e=U3(t),e=e===null?null:e.stateNode,e};Oa.flushSync=function(e){return au(e)};Oa.hydrate=function(e,t,n){if(!kx(t))throw Error(pe(200));return Sx(null,e,t,!0,n)};Oa.hydrateRoot=function(e,t,n){if(!RC(e))throw Error(pe(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",s=kz;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),t=wz(t,null,e,1,n??null,a,!1,i,s),e[Fs]=t.current,$m(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new wx(t)};Oa.render=function(e,t,n){if(!kx(t))throw Error(pe(200));return Sx(null,e,t,!1,n)};Oa.unmountComponentAtNode=function(e){if(!kx(e))throw Error(pe(40));return e._reactRootContainer?(au(function(){Sx(null,null,e,!1,function(){e._reactRootContainer=null,e[Fs]=null})}),!0):!1};Oa.unstable_batchedUpdates=CC;Oa.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!kx(n))throw Error(pe(200));if(e==null||e._reactInternals===void 0)throw Error(pe(38));return Sx(e,t,n,!1,r)};Oa.version="18.2.0-next-9e3b772b8-20220608";function Sz(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Sz)}catch(e){console.error(e)}}Sz(),w3.exports=Oa;var FC=w3.exports,rJ=({children:e,containerRef:t,appendToParentPortal:n})=>{const r=t.current,a=r??(typeof window<"u"?document.body:void 0),i=M.useMemo(()=>{if(!r)return;const{ownerDocument:o}=r,l=o.createElement("div");return l&&(l.className="ui-portal"),l},[r]),[,s]=M.useState({});return dm(()=>s({}),[]),dm(()=>{if(!(!i||!a))return a.appendChild(i),()=>{a.removeChild(i)}},[i,a]),a&&i?FC.createPortal(z.jsx(x3,{value:n?i:null,children:e}),i):null},aJ=({appendToParentPortal:e,children:t})=>{const[n,r]=M.useState(null),a=M.useRef(null),[,i]=M.useState({});M.useEffect(()=>i({}),[]);const s=JY();return dm(()=>{if(!n)return;const{ownerDocument:o}=n,l=e?s??o.body:o.body;if(!l)return;a.current=o.createElement("div"),a.current.className="ui-portal",l.appendChild(a.current),i({});const c=a.current;return()=>{l.contains(c)&&l.removeChild(c)}},[n]),a.current?FC.createPortal(z.jsx(x3,{value:a.current,children:t}),a.current):z.jsx("span",{ref:o=>o?r(o):void 0})},Ix=({containerRef:e,appendToParentPortal:t=!0,isDisabled:n,children:r})=>n?r:e?z.jsx(rJ,{containerRef:e,children:r}):z.jsx(aJ,{appendToParentPortal:t,children:r});Ix.className="ui-portal";Ix.selector=".ui-portal";function Cx(e,t){const n=R0(e);M.useEffect(()=>{if(t==null)return;let r=null;return r=window.setTimeout(n,t),()=>{r&&window.clearTimeout(r)}},[t,n])}var Vi=function(){return Vi=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Vi.apply(this,arguments)};function Iz(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function iJ(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,i;r<a;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var Y0="right-scroll-bar-position",Z0="width-before-scroll-bar",sJ="with-scroll-bars-hidden",oJ="--removed-body-scroll-bar-size";function lJ(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function uJ(e,t){var n=M.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}function cJ(e,t){return uJ(t||null,function(n){return e.forEach(function(r){return lJ(r,n)})})}function dJ(e){return e}function pJ(e,t){t===void 0&&(t=dJ);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var s=t(i,r);return n.push(s),function(){n=n.filter(function(o){return o!==s})}},assignSyncMedium:function(i){for(r=!0;n.length;){var s=n;n=[],s.forEach(i)}n={push:function(o){return i(o)},filter:function(){return n}}},assignMedium:function(i){r=!0;var s=[];if(n.length){var o=n;n=[],o.forEach(i),s=n}var l=function(){var u=s;s=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){s.push(u),c()},filter:function(u){return s=s.filter(u),n}}}};return a}function hJ(e){e===void 0&&(e={});var t=pJ(null);return t.options=Vi({async:!0,ssr:!1},e),t}var Cz=function(e){var t=e.sideCar,n=Iz(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return M.createElement(r,Vi({},n))};Cz.isSideCarExport=!0;function fJ(e,t){return e.useMedium(t),Cz}var _z=hJ(),nk=function(){},_x=M.forwardRef(function(e,t){var n=M.useRef(null),r=M.useState({onScrollCapture:nk,onWheelCapture:nk,onTouchMoveCapture:nk}),a=r[0],i=r[1],s=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,p=e.sideCar,h=e.noIsolation,f=e.inert,m=e.allowPinchZoom,g=e.as,y=g===void 0?"div":g,b=e.gapMode,v=Iz(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=p,w=cJ([n,t]),S=Vi(Vi({},v),a);return M.createElement(M.Fragment,null,u&&M.createElement(x,{sideCar:_z,removeScrollBar:c,shards:d,noIsolation:h,inert:f,setCallbacks:i,allowPinchZoom:!!m,lockRef:n,gapMode:b}),s?M.cloneElement(M.Children.only(o),Vi(Vi({},S),{ref:w})):M.createElement(y,Vi({},S,{className:l,ref:w}),o))});_x.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};_x.classNames={fullWidth:Z0,zeroRight:Y0};var rF,mJ=function(){if(rF)return rF;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function gJ(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=mJ();return t&&e.setAttribute("nonce",t),e}function yJ(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function bJ(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var vJ=function(){var e=0,t=null;return{add:function(n){e==0&&(t=gJ())&&(yJ(t,n),bJ(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},xJ=function(){var e=vJ();return function(t,n){M.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Tz=function(){var e=xJ(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},wJ={left:0,top:0,right:0,gap:0},rk=function(e){return parseInt(e||"",10)||0},kJ=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[rk(n),rk(r),rk(a)]},SJ=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return wJ;var t=kJ(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},IJ=Tz(),CJ=function(e,t,n,r){var a=e.left,i=e.top,s=e.right,o=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(sJ,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Y0,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(Z0,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(Y0," .").concat(Y0,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Z0," .").concat(Z0,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body {
    `).concat(oJ,": ").concat(o,`px;
  }
`)},_J=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r,i=M.useMemo(function(){return SJ(a)},[a]);return M.createElement(IJ,{styles:CJ(i,!t,a,n?"":"!important")})},qS=!1;if(typeof window<"u")try{var o0=Object.defineProperty({},"passive",{get:function(){return qS=!0,!0}});window.addEventListener("test",o0,o0),window.removeEventListener("test",o0,o0)}catch{qS=!1}var hd=qS?{passive:!1}:!1,TJ=function(e){return e.tagName==="TEXTAREA"},Nz=function(e,t){var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!TJ(e)&&n[t]==="visible")},NJ=function(e){return Nz(e,"overflowY")},EJ=function(e){return Nz(e,"overflowX")},aF=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=Ez(e,r);if(a){var i=$z(e,r),s=i[1],o=i[2];if(s>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},$J=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},AJ=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Ez=function(e,t){return e==="v"?NJ(t):EJ(t)},$z=function(e,t){return e==="v"?$J(t):AJ(t)},RJ=function(e,t){return e==="h"&&t==="rtl"?-1:1},FJ=function(e,t,n,r,a){var i=RJ(e,window.getComputedStyle(t).direction),s=i*r,o=n.target,l=t.contains(o),c=!1,u=s>0,d=0,p=0;do{var h=$z(e,o),f=h[0],m=h[1],g=h[2],y=m-g-i*f;(f||y)&&Ez(e,o)&&(d+=y,p+=f),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&(a&&Math.abs(d)<1||!a&&s>d)||!u&&(a&&Math.abs(p)<1||!a&&-s>p))&&(c=!0),c},l0=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},iF=function(e){return[e.deltaX,e.deltaY]},sF=function(e){return e&&"current"in e?e.current:e},DJ=function(e,t){return e[0]===t[0]&&e[1]===t[1]},MJ=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},OJ=0,fd=[];function PJ(e){var t=M.useRef([]),n=M.useRef([0,0]),r=M.useRef(),a=M.useState(OJ++)[0],i=M.useState(Tz)[0],s=M.useRef(e);M.useEffect(function(){s.current=e},[e]),M.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var m=iJ([e.lockRef.current],(e.shards||[]).map(sF),!0).filter(Boolean);return m.forEach(function(g){return g.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),m.forEach(function(g){return g.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var o=M.useCallback(function(m,g){if("touches"in m&&m.touches.length===2)return!s.current.allowPinchZoom;var y=l0(m),b=n.current,v="deltaX"in m?m.deltaX:b[0]-y[0],x="deltaY"in m?m.deltaY:b[1]-y[1],w,S=m.target,C=Math.abs(v)>Math.abs(x)?"h":"v";if("touches"in m&&C==="h"&&S.type==="range")return!1;var T=aF(C,S);if(!T)return!0;if(T?w=C:(w=C==="v"?"h":"v",T=aF(C,S)),!T)return!1;if(!r.current&&"changedTouches"in m&&(v||x)&&(r.current=w),!w)return!0;var E=r.current||w;return FJ(E,g,m,E==="h"?v:x,!0)},[]),l=M.useCallback(function(m){var g=m;if(!(!fd.length||fd[fd.length-1]!==i)){var y="deltaY"in g?iF(g):l0(g),b=t.current.filter(function(w){return w.name===g.type&&(w.target===g.target||g.target===w.shadowParent)&&DJ(w.delta,y)})[0];if(b&&b.should){g.cancelable&&g.preventDefault();return}if(!b){var v=(s.current.shards||[]).map(sF).filter(Boolean).filter(function(w){return w.contains(g.target)}),x=v.length>0?o(g,v[0]):!s.current.noIsolation;x&&g.cancelable&&g.preventDefault()}}},[]),c=M.useCallback(function(m,g,y,b){var v={name:m,delta:g,target:y,should:b,shadowParent:zJ(y)};t.current.push(v),setTimeout(function(){t.current=t.current.filter(function(x){return x!==v})},1)},[]),u=M.useCallback(function(m){n.current=l0(m),r.current=void 0},[]),d=M.useCallback(function(m){c(m.type,iF(m),m.target,o(m,e.lockRef.current))},[]),p=M.useCallback(function(m){c(m.type,l0(m),m.target,o(m,e.lockRef.current))},[]);M.useEffect(function(){return fd.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:p}),document.addEventListener("wheel",l,hd),document.addEventListener("touchmove",l,hd),document.addEventListener("touchstart",u,hd),function(){fd=fd.filter(function(m){return m!==i}),document.removeEventListener("wheel",l,hd),document.removeEventListener("touchmove",l,hd),document.removeEventListener("touchstart",u,hd)}},[]);var h=e.removeScrollBar,f=e.inert;return M.createElement(M.Fragment,null,f?M.createElement(i,{styles:MJ(a)}):null,h?M.createElement(_J,{gapMode:e.gapMode}):null)}function zJ(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const LJ=fJ(_z,PJ);var Az=M.forwardRef(function(e,t){return M.createElement(_x,Vi({},e,{ref:t,sideCar:LJ}))});Az.classNames=_x.classNames;const BJ=Az;var WJ=M.createContext({}),u0=()=>({isLoading:M.createRef(),start:M.createRef(),finish:M.createRef(),update:M.createRef(),force:M.createRef()}),c0=e=>({isLoading:()=>{var t,n,r;return(r=(n=(t=e.current.isLoading).current)==null?void 0:n.call(t))!=null?r:!1},start:t=>{var n,r;return(r=(n=e.current.start).current)==null?void 0:r.call(n,t)},finish:()=>{var t,n;return(n=(t=e.current.finish).current)==null?void 0:n.call(t)},update:t=>{var n,r;return(r=(n=e.current.update).current)==null?void 0:r.call(n,t)},force:t=>{var n,r;return(r=(n=e.current.force).current)==null?void 0:r.call(n,t)}}),VJ=e=>e+1,UJ=e=>e===0?e:e-1,jJ=({screen:e,page:t,background:n,custom:r,children:a})=>{var i,s,o,l,c;const u=M.useRef(u0()),d=M.useRef(u0()),p=M.useRef(u0()),h=M.useRef(u0()),f=c0(u),m=c0(d),g=c0(p),y=c0(h),b={screen:f,page:m,background:g,custom:y};return z.jsxs(WJ.Provider,{value:b,children:[a,z.jsx(d0,{controlRefs:u,...e,component:(i=e==null?void 0:e.component)!=null?i:v=>z.jsx(Fz,{...v})}),z.jsx(d0,{controlRefs:d,...t,component:(s=t==null?void 0:t.component)!=null?s:v=>z.jsx(Dz,{...v})}),z.jsx(d0,{controlRefs:p,...n,blockScrollOnMount:(o=n==null?void 0:n.blockScrollOnMount)!=null?o:!1,component:(l=n==null?void 0:n.component)!=null?l:v=>z.jsx(Mz,{...v})}),z.jsx(d0,{controlRefs:h,blockScrollOnMount:(c=n==null?void 0:n.blockScrollOnMount)!=null?c:!1,...r,component:r==null?void 0:r.component})]})},d0=({controlRefs:e,appendToParentPortal:t,containerRef:n,allowPinchZoom:r=!1,blockScrollOnMount:a=!0,initialState:i,duration:s=null,icon:o,text:l,component:c})=>{const u=M.useRef(!1),[{loadingCount:d,message:p,duration:h},f]=M.useState({loadingCount:i?1:0,message:void 0,duration:s}),{isLoading:m,start:g,finish:y,update:b,force:v}=M.useMemo(()=>({isLoading:()=>u.current,start:({message:w,duration:S=s}={})=>{u.current=!0,f(({loadingCount:C})=>({loadingCount:VJ(C),message:w,duration:S}))},update:w=>f(S=>({...S,...w})),finish:()=>{u.current=!1,f(({loadingCount:w})=>({loadingCount:UJ(w),message:void 0,duration:s}))},force:({loadingCount:w=0,message:S,duration:C=s})=>{u.current=!!w,f({loadingCount:w,message:S,duration:C})}}),[s]);Tl(e.current.isLoading,m),Tl(e.current.start,g),Tl(e.current.finish,y),Tl(e.current.update,b),Tl(e.current.force,v);const x={initialState:i,icon:o,text:l,message:p,duration:h,onFinish:y};return Pd(()=>{(i||Ss(s))&&f({loadingCount:i?1:0,message:void 0,duration:s})},[i,s]),z.jsx(ox,{initial:!1,children:d?z.jsx(Ix,{appendToParentPortal:t,containerRef:n,children:z.jsx(BJ,{allowPinchZoom:r,enabled:a,forwardProps:!0,children:z.jsx(M.Fragment,{children:z.jsx(HJ,{component:c,...x})})})}):null})},HJ=({component:e,...t})=>typeof e=="function"?e(t):z.jsx(z.Fragment,{}),DC=({message:e,...t})=>e?jG(e)?e:z.jsx(at.p,{...t,children:e}):null,GJ=(e="fade")=>({initial:{opacity:0,scale:e==="scaleFade"?.95:void 0},animate:{opacity:1,scale:e==="scaleFade"?1:void 0,transition:{duration:.4,ease:[.4,0,.2,1]}},exit:{opacity:0,scale:e==="scaleFade"?.95:void 0,transition:{duration:.4,ease:[.4,0,1,1]}}}),Rz=(e="fill")=>({position:"fixed",top:0,right:0,bottom:0,left:0,zIndex:"beerus",bg:e==="fill"?["white","black"]:"blackAlpha.600",w:"100vw",h:"100dvh",p:"md",display:"flex",justifyContent:"center",alignItems:"center"}),qb=(e,t="fade")=>({initial:e?!1:"initial",animate:"animate",exit:"exit",variants:GJ(t)}),Fz=M.memo(({initialState:e,icon:t,text:n,message:r,duration:a,onFinish:i})=>{const s={maxW:"md",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"sm"};return Cx(i,a),z.jsx(lx,{className:"ui-loading-screen",...qb(e),__css:Rz(),children:z.jsxs(at.div,{__css:s,children:[z.jsx(Jl,{size:"6xl",...t}),z.jsx(DC,{message:r,noOfLines:3,...n})]})})});Fz.displayName="ScreenComponent";var Dz=M.memo(({initialState:e,icon:t,text:n,message:r,duration:a,onFinish:i})=>{const s={bg:["white","black"],maxW:"md",p:"md",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"sm",rounded:"md",boxShadow:["lg","dark-lg"]};return Cx(i,a),z.jsx(lx,{className:"ui-loading-page",...qb(e),__css:Rz("transparent"),children:z.jsxs(at.div,{as:sx.div,className:"ui-loading-page__inner",...qb(e,"scaleFade"),__css:s,children:[z.jsx(Jl,{size:"6xl",...t}),z.jsx(DC,{message:r,noOfLines:3,...n})]})})});Dz.displayName="PageComponent";var Mz=M.memo(({initialState:e,icon:t,text:n,message:r,duration:a,onFinish:i})=>{const s={position:"fixed",right:"md",bottom:"md",zIndex:"beerus",bg:["white","black"],maxW:"sm",p:"sm",display:"flex",justifyContent:"center",alignItems:"center",gap:"sm",rounded:"md",boxShadow:["3xl","dark-lg"]};return Cx(i,a),z.jsxs(lx,{className:"ui-loading-background",...qb(e,"scaleFade"),__css:s,children:[z.jsx(Jl,{size:"xl",...t}),z.jsx(DC,{message:r,fontSize:"sm",noOfLines:1,...n})]})});Mz.displayName="BackgroundComponent";var Oz={info:{icon:wq,colorScheme:"info"},success:{icon:xq,colorScheme:"success"},warning:{icon:X$,colorScheme:"warning"},error:{icon:X$,colorScheme:"danger"},loading:{icon:Jl,colorScheme:"primary"}},[qJ,MC]=Iu({name:"AlertStylesContext",errorMessage:`useAlert returned is 'undefined'. Seems you forgot to wrap the components in "<Alert />" `}),KJ=(e,t)=>{var n,r;return(r=(n=t==null?void 0:t[e])==null?void 0:n.colorScheme)!=null?r:Oz[e].colorScheme},XJ=(e,t)=>{var n,r;return(r=(n=t==null?void 0:t[e])==null?void 0:n.icon)!=null?r:Oz[e].icon},YJ=dt(({status:e="info",colorScheme:t,...n},r)=>{var a,i,s;const{theme:o}=Ap(),l=(s=(i=(a=o.__config)==null?void 0:a.alert)==null?void 0:i.statuses)!=null?s:{};t??(t=KJ(e,l));const[c,u]=Zv("Alert",{...n,colorScheme:t}),{className:d,children:p,...h}=Ls(u),f={w:"100%",display:"flex",alignItems:"center",position:"relative",overflow:"hidden",...c.container};return z.jsx(qJ,{value:{status:e,styles:c},children:z.jsx(at.div,{ref:r,className:ut("ui-alert",d),role:"alert",__css:f,...h,children:p})})}),ZJ=({className:e,children:t,variant:n="oval",...r})=>{var a,i,s;const{status:o,styles:l}=MC(),{theme:c}=Ap(),u=(s=(i=(a=c.__config)==null?void 0:a.alert)==null?void 0:i.statuses)!=null?s:{},d=XJ(o,u),p={...l.icon,...o==="loading"?l.loading:{}};return z.jsx(at.span,{display:"inherit",className:ut("ui-alert__icon",e),__css:p,...r,children:t||z.jsx(d,{...o==="loading"?{variant:n,color:"currentcolor"}:{boxSize:"100%"}})})},QJ=dt(({className:e,...t},n)=>{const{styles:r}=MC(),a={display:"block",...r.title};return z.jsx(at.p,{ref:n,className:ut("ui-alert__title",e),__css:a,...t})}),JJ=dt(({className:e,...t},n)=>{const{styles:r}=MC(),a={...r.description};return z.jsx(at.span,{ref:n,className:ut("ui-alert__desc",e),__css:a,...t})}),eee=(e,t,n)=>Math.min(Math.max(e,t),n),Pz=({className:e,ripples:t,onAnimationComplete:n,onClear:r,color:a="currentColor",style:i,isDisabled:s,...o})=>s?null:z.jsx(z.Fragment,{children:t.map(({key:l,x:c,y:u,size:d})=>{const p=eee(.01*d,.2,d>100?.75:.5);return z.jsx(ox,{mode:"popLayout",children:z.jsx(lx,{as:"span",className:ut("ui-ripple",e),initial:{transform:"scale(0)",opacity:.35},animate:{transform:"scale(2)",opacity:0},exit:{opacity:0},transition:{duration:p},style:{position:"absolute",backgroundColor:a,borderRadius:"100%",transformOrigin:"center",pointerEvents:"none",zIndex:10,left:c,top:u,width:`${d}px`,height:`${d}px`,...i},...o,onAnimationComplete:$o(n,()=>r(l))})},l)})}),zz=e=>{const[t,n]=M.useState([]),r=M.useCallback(i=>{const s=i.currentTarget,o=Math.max(s.clientWidth,s.clientHeight),l=s.getBoundingClientRect();n(c=>[...c,{key:XG(c.length.toString()),size:o,x:i.clientX-l.x-o/2,y:i.clientY-l.y-o/2}])},[]),a=M.useCallback(i=>{n(s=>s.filter(o=>o.key!==i))},[]);return{ripples:t,onPointerDown:$o(r,e.onPointerDown),onClear:a}},tee=dt((e,t)=>{const[n,r]=sg("CloseButton",e),{className:a,children:i,isDisabled:s,__css:o,disableRipple:l,...c}=Ls(r),{onPointerDown:u,...d}=zz(c),p={position:"relative",overflow:"hidden",outline:0,display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0,...n,...o};return z.jsxs(at.button,{ref:t,type:"button","aria-label":"Close",className:ut("ui-close-button",a),disabled:s,__css:p,...c,onPointerDown:u,children:[i||z.jsx(kq,{width:"1em",height:"1em"}),z.jsx(Pz,{isDisabled:l||s,...d})]})}),nee=(e,t)=>e.find(n=>n.id===t),oF=(e,t)=>{const n=Lz(e,t),r=n?e[n].findIndex(a=>a.id===t):-1;return{placement:n,index:r}},Lz=(e,t)=>{for(const[n,r]of Object.entries(e))if(nee(r,t))return n},lF=0,ree=(e,{id:t,placement:n="top",duration:r,onCloseComplete:a,status:i,style:s})=>(lF+=1,t??(t=lF),{id:t,placement:n,status:i,duration:r,message:e,onDelete:()=>rm.remove(String(t),n),isDelete:!1,onCloseComplete:a,style:s}),aee=e=>{const{component:t}=e;return r=>typeof t=="function"?t({...r,...e}):z.jsx(oee,{...r,...e})},iee={top:[],"top-left":[],"top-right":[],bottom:[],"bottom-left":[],"bottom-right":[]},see=e=>{let t=e;const n=new Set,r=a=>{t=a(t),n.forEach(i=>i())};return{getSnapshot:()=>t,subscribe:a=>(n.add(a),()=>{r(()=>e),n.delete(a)}),remove:(a,i)=>{r(s=>({...s,[i]:s[i].filter(o=>o.id!=a)}))},create:(a,i)=>{var s;const o=((s=i.limit)!=null?s:0)-1,l=ree(a,i),{placement:c,id:u}=l;return r(d=>{var p;let h=(p=d[c])!=null?p:[];if(o>0&&h.length>o){const m=h.length-o,y=(c.includes("top")?h.slice(m*-1):h.slice(0,m)).map(({id:b})=>b);h=h.map(b=>y.includes(b.id)?{...b,isDelete:!0}:b)}const f=c.includes("top")?[l,...h]:[...h,l];return{...d,[c]:f}}),u},update:(a,i)=>{r(s=>{const o={...s},{placement:l,index:c}=oF(o,a);return l&&c!==-1&&(o[l][c]={...o[l][c],...i,message:aee(i)}),o})},closeAll:({placement:a}={})=>{r(i=>{let s=["bottom","bottom-right","bottom-left","top","top-left","top-right"];return a&&(s=a),s.reduce((o,l)=>(o[l]=i[l].map(c=>({...c,isDelete:!0})),o),{...i})})},close:a=>{r(i=>{const s=Lz(i,a);return s?{...i,[s]:i[s].map(o=>o.id==a?{...o,isDelete:!0}:o)}:i})},isActive:a=>!!oF(rm.getSnapshot(),a).placement}},rm=see(iee),oee=({variant:e="basic",colorScheme:t,status:n,icon:r,title:a,description:i,isClosable:s,className:o,onClose:l})=>z.jsxs(YJ,{status:n,variant:e,colorScheme:t,alignItems:"start",boxShadow:"lg",className:ut("ui-notice",o),pe:s?8:void 0,children:[z.jsx(ZJ,{variant:r==null?void 0:r.variant,className:"ui-notice__icon",...r!=null&&r.color?{color:r.color}:{},children:r==null?void 0:r.children}),z.jsxs(at.div,{flex:"1",children:[a?z.jsx(QJ,{className:"ui-notice__title",noOfLines:1,children:a}):null,i?z.jsx(JJ,{className:"ui-notice__desc",noOfLines:3,children:i}):null]}),s?z.jsx(tee,{className:"ui-notice__close-button",size:"sm",onClick:l,position:"absolute",top:2,right:2}):null]}),lee=({variants:e,gap:t="md",appendToParentPortal:n,containerRef:r})=>{const a=M.useSyncExternalStore(rm.subscribe,rm.getSnapshot,rm.getSnapshot),i=Object.entries(a).map(([s,o])=>{const l=s.includes("top")?"env(safe-area-inset-top, 0px)":void 0,c=s.includes("bottom")?"env(safe-area-inset-bottom, 0px)":void 0,u=s.includes("left")?void 0:"env(safe-area-inset-right, 0px)",d=s.includes("right")?void 0:"env(safe-area-inset-left, 0px)",p={position:"fixed",zIndex:"zarbon",pointerEvents:"none",display:"flex",flexDirection:"column",margin:t,gap:t,top:l,bottom:c,right:u,left:d};return z.jsx(at.ul,{className:ut("ui-notice__list",`ui-notice__list--${s}`),__css:p,children:z.jsx(ox,{initial:!1,children:o.map(h=>z.jsx(Bz,{variants:e,...h},h.id))})},s)});return z.jsx(Ix,{appendToParentPortal:n,containerRef:r,children:i})},uee={initial:({placement:e})=>({opacity:0,[["top","bottom"].includes(e)?"y":"x"]:(e==="bottom"||e.includes("right")?1:-1)*24}),animate:{opacity:1,y:0,x:0,scale:1,transition:{duration:.4,ease:[.4,0,.2,1]}},exit:{opacity:0,scale:.95,transition:{duration:.2,ease:[.4,0,1,1]}}},Bz=M.memo(({variants:e=uee,placement:t,duration:n=5e3,message:r,onCloseComplete:a,isDelete:i=!1,onDelete:s,style:o})=>{const[l,c]=M.useState(n),u=WX();Pd(()=>{u||a==null||a()},[u]),Pd(()=>{c(n)},[n]);const d=()=>c(null),p=()=>c(n),h=()=>{u&&s()};M.useEffect(()=>{u&&i&&s()},[u,i,s]),Cx(h,l);const f={pointerEvents:"auto",maxW:"2xl",minW:"sm",...o};return z.jsx(sx.li,{layout:!0,className:"ui-notice__list__item",variants:e,initial:"initial",animate:"animate",exit:"exit",onHoverStart:d,onHoverEnd:p,custom:{placement:t},style:{display:"flex",justifyContent:t.includes("left")?"flex-start":t.includes("right")?"flex-end":"center"},children:z.jsx(at.div,{className:"ui-notice__list__item__inner",__css:f,children:na(r,{onClose:h})})})});Bz.displayName="NoticeComponent";var Wz={xs:"0.25rem",sm:"0.5rem",md:"1rem",normal:"1.5rem",lg:"2rem",xl:"3rem","2xl":"4rem","3xl":"6rem","4xl":"8rem",px:"1px",.5:"0.125rem",1:"0.25rem",1.5:"0.375rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",3.5:"0.875rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem",12:"3rem",14:"3.5rem",16:"4rem",20:"5rem",24:"6rem",28:"7rem",32:"8rem",36:"9rem",40:"10rem",44:"11rem",48:"12rem",52:"13rem",56:"14rem",60:"15rem",64:"16rem",72:"18rem",80:"20rem",96:"24rem"},cee={...Wz,max:"max-content",min:"min-content",full:"100%","9xs":"1rem","8xs":"1.5rem","7xs":"2rem","6xs":"3rem","5xs":"4.5rem","4xs":"6rem","3xs":"7.5rem","2xs":"10rem",xs:"15rem",sm:"20rem",md:"24rem",lg:"28rem",xl:"32rem","2xl":"36rem","3xl":"42rem","4xl":"48rem","5xl":"56rem","6xl":"64rem","7xl":"72rem","8xl":"80rem","9xl":"90rem"},dee={property:{common:"background-color, border-color, color, fill, stroke, opacity, box-shadow, transform",colors:"background-color, border-color, color, fill, stroke",dimensions:"width, height",position:"left, right, top, bottom",background:"background-color, background-image, background-position"},easing:{"ease-in":"cubic-bezier(0.4, 0, 1, 1)","ease-out":"cubic-bezier(0, 0, 0.2, 1)","ease-in-out":"cubic-bezier(0.4, 0, 0.2, 1)"},duration:{"ultra-fast":"50ms",faster:"100ms",fast:"150ms",normal:"200ms",slow:"300ms",slower:"400ms","ultra-slow":"500ms"}},pee={yamcha:1,kurillin:9,nappa:99,guldo:100,jeice:110,burter:120,recoome:130,ginyu:140,dodoria:150,zarbon:160,freeza:9996,vegeta:9997,sonGoku:9998,beerus:9999},hee={hairline:100,thin:200,light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,black:900},fee={heading:'-apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", "游ゴシック体", YuGothic, "YuGothic M", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',body:'-apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", "游ゴシック体", YuGothic, "YuGothic M", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',mono:'SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'},mee={},gee={tighter:"-0.05em",tight:"-0.025em",normal:"0",wide:"0.025em",wider:"0.05em",widest:"0.1em"},yee={normal:"normal",none:1,shorter:1.25,short:1.375,base:1.5,tall:1.625,taller:"2",3:".75rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem"},bee={none:"0",sm:"0.125rem",base:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},vee={xs:"0 0 0 1px rgba(0, 0, 0, 0.05)",sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",base:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","2xl":"0 25px 50px -12px rgba(0, 0, 0, 0.25)","3xl":"0 25px 50px -12px rgba(0, 0, 0, 0.25), 0 -25px 50px -12px rgba(0, 0, 0, 0.25)",outline:"0 0 0 3px rgb(0, 112, 240)",inline:"inset 0 0 0 3px rgb(0, 112, 240)",inner:"inset 0 2px 4px 0 rgba(0,0,0,0.06)",none:"none","dark-sm":"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px, rgba(0, 0, 0, 0.2) 0px 1px 2px","dark-md":"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px, rgba(0, 0, 0, 0.2) 0px 5px 10px","dark-lg":"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px, rgba(0, 0, 0, 0.2) 0px 5px 10px, rgba(0, 0, 0, 0.4) 0px 15px 40px"},xee={},wee={sm:"4px",md:"8px",lg:"12px",xl:"16px","2xl":"24px"},kee={},See={sm:"30em",md:"48em",lg:"61em",xl:"80em","2xl":"90em"},Iee={transparent:"transparent",current:"currentColor",black:"#141414",white:"#fbfbfb",border:["#dcdcde","#434248"],focus:"#0070F0",whiteAlpha:{50:"rgba(255, 255, 255, 0.04)",100:"rgba(255, 255, 255, 0.06)",200:"rgba(255, 255, 255, 0.08)",300:"rgba(255, 255, 255, 0.16)",400:"rgba(255, 255, 255, 0.24)",500:"rgba(255, 255, 255, 0.36)",600:"rgba(255, 255, 255, 0.48)",700:"rgba(255, 255, 255, 0.64)",800:"rgba(255, 255, 255, 0.80)",900:"rgba(255, 255, 255, 0.92)",950:"rgba(255, 255, 255, 0.96)"},blackAlpha:{50:"rgba(0, 0, 0, 0.04)",100:"rgba(0, 0, 0, 0.06)",200:"rgba(0, 0, 0, 0.08)",300:"rgba(0, 0, 0, 0.16)",400:"rgba(0, 0, 0, 0.24)",500:"rgba(0, 0, 0, 0.36)",600:"rgba(0, 0, 0, 0.48)",700:"rgba(0, 0, 0, 0.64)",800:"rgba(0, 0, 0, 0.80)",900:"rgba(0, 0, 0, 0.92)",950:"rgba(0, 0, 0, 0.96)"},gray:{50:"#dedfe3",100:"#d3d5da",200:"#b7bbc3",300:"#9ea3ae",400:"#828997",500:"#6b7280",600:"#565c67",700:"#434851",800:"#2e3138",900:"#1c1e21",950:"#101113"},neutral:{50:"#dedede",100:"#d4d4d4",200:"#bababa",300:"#a3a3a3",400:"#8a8a8a",500:"#737373",600:"#5c5c5c",700:"#474747",800:"#303030",900:"#1c1c1c",950:"#0f0f0f"},red:{50:"#fdeae8",100:"#fbd9d5",200:"#f6b2ac",300:"#f28c82",400:"#ee6a5d",500:"#ea4334",600:"#de2817",700:"#b42013",800:"#8a190f",900:"#66120b",950:"#530f09"},rose:{50:"#feecef",100:"#fdd8de",200:"#fbb2be",300:"#f88b9d",400:"#f6657d",500:"#f43e5c",600:"#f2183c",700:"#cf0c2d",800:"#a40a23",900:"#7d071b",950:"#650616"},pink:{50:"#fde8ed",100:"#fcd9e3",200:"#f9b9ca",300:"#f693ad",400:"#f37295",500:"#f0517c",600:"#ec275c",700:"#d81347",800:"#ae0f39",900:"#880c2d",950:"#710a25"},flashy:{50:"#fdedf5",100:"#fbdaeb",200:"#f7b5d6",300:"#f390c2",400:"#ef6bad",500:"#ec4699",600:"#e82185",700:"#c6156e",800:"#a21159",900:"#780d42",950:"#660b38"},orange:{50:"#fef0e6",100:"#fee4d2",200:"#fdc7a1",300:"#fbac74",400:"#fa9247",500:"#f97415",600:"#e06106",700:"#b34d05",800:"#863a03",900:"#5e2902",950:"#461e02"},amber:{50:"#fdf0d8",100:"#fde8c4",200:"#fbd593",300:"#f9c367",400:"#f7b23b",500:"#f59f0a",600:"#ce8509",700:"#a26907",800:"#764c05",900:"#4e3303",950:"#362302"},yellow:{50:"#fef4d7",100:"#feefc3",200:"#fde290",300:"#fdd663",400:"#fcc931",500:"#fbbd04",600:"#ce9b03",700:"#a67d03",800:"#795b02",900:"#503d01",950:"#372a01"},lime:{50:"#e7facc",100:"#ddf7b5",200:"#c7f287",300:"#b2ee59",400:"#9de92b",500:"#82cb15",600:"#6ba611",700:"#507d0d",800:"#385809",900:"#1e2e05",950:"#121c03"},green:{50:"#e0f5e6",100:"#d0f1d9",200:"#a9e5b9",300:"#86da9c",400:"#5fce7d",500:"#3cc360",600:"#31a04f",700:"#28813f",800:"#1d5e2e",900:"#133e1f",950:"#0d2b15"},emerald:{50:"#d0fbed",100:"#b4f8e2",200:"#80f4cd",300:"#4defb9",400:"#19eba5",500:"#10b77f",600:"#0d9165",700:"#096748",800:"#06422e",900:"#021710",950:"#000503"},teal:{50:"#cdf9f4",100:"#b1f6ee",200:"#7ef1e3",300:"#51ecda",400:"#1ee6cf",500:"#14b8a5",600:"#108e80",700:"#0c6a5f",800:"#07403a",900:"#031c19",950:"#010504"},cyan:{50:"#cef6fd",100:"#b0f1fd",200:"#7ee8fb",300:"#4de0f9",400:"#16d6f8",500:"#07b6d5",600:"#0590a8",700:"#046e81",800:"#034854",900:"#012228",950:"#011114"},sky:{50:"#ddf3fd",100:"#c5eafc",200:"#95d9f9",300:"#65c8f6",400:"#35b7f3",500:"#0da2e7",600:"#0b87c1",700:"#096995",800:"#064e6f",900:"#042f43",950:"#032230"},blue:{50:"#e2edfd",100:"#cfe0fc",200:"#adcbfa",300:"#8bb5f8",400:"#659cf6",500:"#4387f4",600:"#186bf2",700:"#0c59d4",800:"#0a47a9",900:"#07357d",950:"#062c6a"},indigo:{50:"#e8e8fd",100:"#d9dafc",200:"#bdbef9",300:"#9c9ef6",400:"#8082f4",500:"#6467f2",600:"#3a3dee",700:"#1417e6",800:"#1114c0",900:"#0d0f96",950:"#0b0d83"},violet:{50:"#eee7fe",100:"#e3d8fd",200:"#cbb6fb",300:"#b699fa",400:"#a17cf8",500:"#895af6",600:"#6d34f4",700:"#500ced",800:"#410ac2",900:"#34089b",950:"#2e0788"},purple:{50:"#f0e2fe",100:"#e9d3fd",200:"#d7b1fb",300:"#c994fa",400:"#b772f8",500:"#a855f7",600:"#9229f5",700:"#7e0bea",800:"#6609be",900:"#510797",950:"#44067f"},fuchsia:{50:"#f9e3fd",100:"#f5d0fb",200:"#eeaff8",300:"#e78af5",400:"#e069f2",500:"#d948ef",600:"#d01eeb",700:"#b112ca",800:"#900ea4",900:"#6b0b7a",950:"#5b0967"}},Cee={"2xs":"0.625rem",xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem","2xl":"1.5rem","3xl":"1.875rem","4xl":"2rem","5xl":"2.25rem","6xl":"3rem","7xl":"3.75rem","8xl":"4.5rem","9xl":"6rem"},_ee={animations:xee,blurs:wee,borders:kee,breakpoints:See,colors:Iee,fontSizes:Cee,fontWeights:hee,fonts:fee,gradients:mee,letterSpacings:gee,lineHeights:yee,radii:bee,shadows:vee,sizes:cee,spaces:Wz,transitions:dee,zIndices:pee},Tee={"*":{boxSizing:"border-box"},"::before, ::after":{boxSizing:"inherit"},html:{lineHeight:1.15,WebkitTextSizeAdjust:"100%",WebkitTapHighlightColor:"transparent"},body:{margin:0},main:{display:"block"},"p, table, blockquote, address, pre, iframe, form, figure, dl":{margin:0},"h1, h2, h3, h4, h5, h6":{fontSize:"inherit",lineHeight:"inherit",fontWeight:"inherit",margin:0},"ul, ol":{margin:0,padding:0,listStyle:"none"},dt:{fontWeight:"bold"},dd:{marginLeft:0},hr:{boxSizing:"content-box",height:0,overflow:"visible",border:0,borderTop:"1px solid",margin:0,clear:"both",color:"inherit"},pre:{fontFamily:"monospace, monospace",fontSize:"inherit"},address:{fontStyle:"inherit"},a:{backgroundColor:"transparent",textDecoration:"none",color:"inherit"},"abbr[title]":{borderBottom:"none",textDecoration:"underline dotted"},"b, strong":{fontWeight:"bolder"},"code, kbd, samp":{fontFamily:"monospace, monospace",fontSize:"inherit"},small:{fontSize:"80%"},"sub, sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sub:{bottom:"-0.25em"},sup:{top:"-0.5em"},img:{borderStyle:"none",verticalAlign:"bottom"},"embed, object, iframe":{border:0,verticalAlign:"bottom"},"button, input, optgroup, select, textarea":{WebkitAppearance:"none",appearance:"none",verticalAlign:"middle",color:"inherit",font:"inherit",border:0,background:"transparent",padding:0,margin:0,outline:0,borderRadius:0,textAlign:"inherit"},"[type='checkbox']":{WebkitAppearance:"checkbox",appearance:"checkbox"},"[type='radio']":{WebkitAppearance:"radio",appearance:"radio"},"button, input":{overflow:"visible"},"button, select":{textTransform:"none"},"button, [type='button'], [type='reset'], [type='submit']":{cursor:"pointer",WebkitAppearance:"none",appearance:"none"},"button[disabled], [type='button'][disabled], [type='reset'][disabled], [type='submit'][disabled]":{cursor:"default"},"button::-moz-focus-inner, [type='button']::-moz-focus-inner, [type='reset']::-moz-focus-inner, [type='submit']::-moz-focus-inner":{borderStyle:"none",padding:0},"button:-moz-focusring, [type='button']:-moz-focusring, [type='reset']:-moz-focusring, [type='submit']:-moz-focusring":{outline:"1px dotted ButtonText"},"select::-ms-expand":{display:"none"},option:{padding:0},fieldset:{margin:0,padding:0,border:0,minWidth:0},legend:{color:"inherit",display:"table",maxWidth:"100%",padding:0,whiteSpace:"normal"},progress:{verticalAlign:"baseline"},textarea:{overflow:"auto"},"[type='number']::-webkit-inner-spin-button, [type='number']::-webkit-outer-spin-button":{display:"none"},"[type='search']":{outlineOffset:"-2px"},"[type='search']::-webkit-search-decoration":{WebkitAppearance:"none"},"[type='time']::-webkit-calendar-picker-indicator":{display:"none"},"::-webkit-file-upload-button":{WebkitAppearance:"button",font:"inherit"},"::-webkit-search-cancel-button":{WebkitAppearance:"none"},"label[for]":{cursor:"pointer"},details:{display:"block"},summary:{display:"list-item"},"[contenteditable]":{outline:"none"},table:{borderCollapse:"collapse",borderSpacing:0},caption:{textAlign:"left"},"td, th":{verticalAlign:"top",padding:0},th:{textAlign:"left",fontWeight:"bold"},template:{display:"none"},"[hidden]":{display:"none !important"}},Nee={},Eee={body:{fontFamily:"body",bg:["white","black"],color:["black","white"],transitionProperty:"background-color",transitionDuration:"normal",lineHeight:"base",overflowX:"hidden"},"*::placeholder":{color:"blackAlpha.600"},_dark:{"*::placeholder":{color:"whiteAlpha.400"}},"*, *::before, *::after":{borderWidth:"0",borderStyle:"solid",borderColor:"border",wordWrap:"break-word"}},$ee={},Aee={baseStyle:{container:({orientation:e})=>({display:"flex",flexDirection:e==="vertical"?"row":"column"}),tabList:({align:e,orientation:t})=>({flexDirection:t==="vertical"?"column":"row",justifyContent:e==="center"?e:`flex-${e}`}),tab:({isFitted:e})=>({flex:e?1:void 0,whiteSpace:"nowrap",transitionProperty:"common",transitionDuration:"normal",_hover:{opacity:.7},_focusVisible:{zIndex:"yamcha",boxShadow:"outline"},_selected:{_hover:{opacity:1}},_disabled:{cursor:"not-allowed",opacity:.4}}),tabPanels:{},tabPanel:{p:"md"}},variants:{line:({colorScheme:e="primary",orientation:t})=>{const n=t==="vertical";return{tabList:{borderColor:"inherit",...n?{borderEndWidth:"1px"}:{borderBottomWidth:"1px"}},tab:{borderColor:"transparent",_selected:{color:[`${e}.500`,Be(e)?`${e}.100`:`${e}.400`],borderColor:"currentColor"},...n?{borderEndWidth:"1px",borderEndStyle:"solid",me:"-1px"}:{borderBottomWidth:"1px",borderBottomStyle:"solid",mb:"-1px"},_ripple:{display:"none"}}}},sticky:({colorScheme:e="primary",orientation:t})=>{const n=t==="vertical";return{tabList:{borderColor:"inherit",...n?{borderEndWidth:"1px"}:{borderBottomWidth:"1px"}},tab:{borderColor:"transparent",_selected:{color:[`${e}.500`,Be(e)?`${e}.100`:`${e}.400`],borderColor:"inherit",...n?{borderEndColor:["white","black"]}:{borderBottomColor:["white","black"]}},...n?{roundedLeft:"md",borderWidth:"1px",borderStyle:"solid",me:"-2px"}:{roundedTop:"md",borderWidth:"1px",borderStyle:"solid",mb:"-2px"},_ripple:{display:"none"}}}},"sticky-subtle":({theme:e,colorMode:t,colorScheme:n="primary",orientation:r})=>{const a=r==="vertical";return{tabList:{borderColor:"inherit",...a?{borderEndWidth:"1px"}:{borderBottomWidth:"1px"}},tab:{borderColor:"inherit",_notLast:{...a?{borderBottom:"none"}:{borderEnd:"none"}},_selected:{bg:[Be(n)?`${n}.50`:`${n}.100`,ln(`${n}.300`,58)(e,t)],color:[`${n}.800`,Be(n)?`${n}.50`:`${n}.200`]},...a?{borderWidth:"1px",borderStyle:"solid",me:"-1px"}:{borderWidth:"1px",borderStyle:"solid",mb:"-1px"}}}},"sticky-solid":({theme:e,colorMode:t,colorScheme:n="primary",orientation:r})=>{const a=r==="vertical";return{tabList:{borderColor:"inherit",...a?{borderEndWidth:"1px"}:{borderBottomWidth:"1px"}},tab:{borderColor:"inherit",_notLast:{...a?{borderBottom:"none"}:{borderEnd:"none"}},_selected:{bg:[vn(`${n}.600`,24)(e,t),ln(`${n}.600`,16)(e,t)],color:"white"},...a?{borderWidth:"1px",borderStyle:"solid",me:"-1px"}:{borderWidth:"1px",borderStyle:"solid",mb:"-1px"}}}},rounded:({theme:e,colorMode:t,colorScheme:n="primary"})=>{const r=sn(_e(`${n}.500`)(e,t),_e(Be(n)?`${n}.100`:`${n}.400`)(e,t))(t);return{tabList:{gap:"sm"},tab:{borderRadius:"full",_selected:{color:r,boxShadow:`inset 0 0 0px 1px ${r}`}}}},"rounded-subtle":({theme:e,colorMode:t,colorScheme:n="primary"})=>({tabList:{gap:"sm"},tab:{borderRadius:"full",_selected:{bg:[Be(n)?`${n}.50`:`${n}.100`,ln(`${n}.300`,58)(e,t)],color:[`${n}.800`,Be(n)?`${n}.50`:`${n}.200`]}}}),"rounded-solid":({theme:e,colorMode:t,colorScheme:n="primary"})=>({tabList:{gap:"sm"},tab:{borderRadius:"full",_selected:{bg:[vn(`${n}.600`,24)(e,t),ln(`${n}.600`,16)(e,t)],color:"white"}}}),unstyled:{tab:{_hover:{opacity:"inherit"},_ripple:{display:"none"}}}},sizes:{sm:{tab:{py:1,px:3,fontSize:"sm"}},md:{tab:{fontSize:"md",py:2,px:4}},lg:{tab:{fontSize:"lg",py:3,px:5}}},defaultProps:{size:"md",variant:"line",colorScheme:"primary"}},Ree={baseStyle:{container:{outline:0,fontWeight:"medium",rounded:"md",_focusVisible:{boxShadow:"outline"}},label:{overflow:"visible"},closeButton:{transitionProperty:"common",transitionDuration:"normal",rounded:"full",opacity:.5,_disabled:{opacity:.4},_hover:{opacity:.8,_disabled:{opacity:.4,cursor:"not-allowed"}},_active:{opacity:1},_focusVisible:{boxShadow:"outline",bg:"rgba(0, 0, 0, 0.14)"}}},variants:{solid:{container:({theme:e,colorMode:t,colorScheme:n="primary"})=>({bg:[vn(`${n}.600`,24)(e,t),ln(`${n}.600`,16)(e,t)],color:"white"})},subtle:{container:({theme:e,colorMode:t,colorScheme:n="primary"})=>({bg:[Be(n)?`${n}.50`:`${n}.100`,ln(`${n}.300`,58)(e,t)],color:[`${n}.800`,Be(n)?`${n}.50`:`${n}.200`]})},outline:{container:({theme:e,colorMode:t,colorScheme:n="primary"})=>{const r=sn(_e(`${n}.500`)(e,t),_e(Be(n)?`${n}.100`:`${n}.400`)(e,t))(t);return{color:r,boxShadow:`inset 0 0 0px 1px ${r}`}}}},sizes:{sm:({theme:e})=>({container:{minH:"6",minW:"6",fontSize:"xs",px:"2",lineHeight:Ue(e,"sizes.6")}}),md:({theme:e})=>({container:{minH:"7",minW:"7",fontSize:"sm",px:"2",lineHeight:Ue(e,"sizes.7")}}),lg:({theme:e})=>({container:{minH:"8",minW:"8",fontSize:"md",px:"3",lineHeight:Ue(e,"sizes.8")}})},defaultProps:{size:"md",variant:"subtle",colorScheme:"primary"}},Eu={baseStyle:{container:{},field:{width:"100%",minWidth:0,outline:0,position:"relative",appearance:"none",transitionProperty:"common",transitionDuration:"normal",_placeholder:{color:"blackAlpha.600"},_dark:{_placeholder:{color:"whiteAlpha.400"}},_disabled:{opacity:.4,cursor:"not-allowed"}}},variants:{outline:({theme:e,colorMode:t,focusBorderColor:n="focus",errorBorderColor:r=["danger.500","danger.400"]})=>{const a=lt(n)?sn(_e(n[0],n[0])(e,t),_e(n[1],n[1])(e,t))(t):_e(n,n)(e,t),i=lt(r)?sn(_e(r[0],r[0])(e,t),_e(r[1],r[1])(e,t))(t):_e(r,r)(e,t);return{field:{border:"1px solid",borderColor:"inherit",bg:"inherit",_hover:{borderColor:["blackAlpha.500","whiteAlpha.400"]},_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:i,boxShadow:`0 0 0 1px ${i}`},_active:{borderColor:a,boxShadow:`0 0 0 1px ${a}`},_focusVisible:{zIndex:"yamcha",borderColor:a,boxShadow:`0 0 0 1px ${a}`}},addon:{border:"1px solid",borderColor:["inherit","whiteAlpha.50"],bg:["blackAlpha.300","whiteAlpha.300"]}}},filled:({theme:e,colorMode:t,focusBorderColor:n="focus",errorBorderColor:r=["danger.500","danger.400"]})=>{const a=lt(n)?sn(_e(n[0],n[0])(e,t),_e(n[1],n[1])(e,t))(t):_e(n,n)(e,t),i=lt(r)?sn(_e(r[0],r[0])(e,t),_e(r[1],r[1])(e,t))(t):_e(r,r)(e,t);return{field:{border:"2px solid",borderColor:"transparent",bg:["blackAlpha.50","whiteAlpha.50"],_hover:{bg:["blackAlpha.100","whiteAlpha.100"]},_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:i,boxShadow:`0 0 0 1px ${i}`},_active:{bg:"transparent",borderColor:a,boxShadow:`0 0 0 1px ${a}`},_focusVisible:{bg:"transparent",borderColor:a,boxShadow:`0 0 0 1px ${a}`}},addon:{border:"2px solid transparent",bg:["blackAlpha.300","whiteAlpha.300"]}}},flushed:({theme:e,colorMode:t,focusBorderColor:n="focus",errorBorderColor:r=["danger.500","danger.400"]})=>{const a=lt(n)?sn(_e(n[0],n[0])(e,t),_e(n[1],n[1])(e,t))(t):_e(n,n)(e,t),i=lt(r)?sn(_e(r[0],r[0])(e,t),_e(r[1],r[1])(e,t))(t):_e(r,r)(e,t);return{field:{borderBottom:"1px solid",borderColor:"inherit",rounded:"0",px:"0",bg:"transparent",_hover:{borderColor:["blackAlpha.500","whiteAlpha.400"]},_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:i,boxShadow:`0px 1px 0px 0px ${i}`},_active:{borderColor:a,boxShadow:`0px 1px 0px 0px ${a}`},_focusVisible:{borderColor:a,boxShadow:`0px 1px 0px 0px ${a}`}},addon:{borderBottom:"1px solid",borderColor:"inherit",bg:"transparent",rounded:"0"}}},unstyled:{field:{bg:"transparent",minH:"auto",px:"0"},addon:{bg:"transparent",minH:"auto",px:"0"}}},sizes:{xs:{field:{fontSize:"xs",px:"2",minH:"6",rounded:"sm"},addon:{fontSize:"xs",px:"2",minH:"6",rounded:"sm"}},sm:{field:{fontSize:"sm",px:"2",minH:"8",rounded:"md"},addon:{fontSize:"sm",px:"2",minH:"8",rounded:"md"}},md:{field:{fontSize:"md",px:"3",minH:"10",rounded:"md"},addon:{fontSize:"md",px:"3",minH:"10",rounded:"md"}},lg:{field:{fontSize:"lg",px:"4",minH:"12",rounded:"md"},addon:{fontSize:"lg",px:"4",minH:"12",rounded:"md"}}},defaultProps:{size:"md",variant:"outline"}},Fee=QM(J9(Eu,"field"),{baseStyle:{py:"2",lineHeight:"short",verticalAlign:"top"},variants:{unstyled:{h:"auto",py:"0",px:"0"}},sizes:{xs:{py:"2",minH:"20"},sm:{py:"2",minH:"20"},md:{py:"2",minH:"20"},lg:{py:"3",minH:"20"}}})(),Dee={baseStyle:{rounded:"md",bg:["white","black"],border:"1px solid",borderColor:["blackAlpha.200","whiteAlpha.100"],px:"sm",py:"0.5",fontWeight:"medium",fontSize:"sm",color:"inherit",boxShadow:["md","dark-md"],maxW:"xs",zIndex:"dodoria"}},Mee={baseStyle:{container:{w:"100%"},item:{w:"100%",h:"100%",_selected:{boxShadow:["md","dark-md"]}},trigger:{color:["blackAlpha.300","whiteAlpha.300"]}},variants:{elevated:{item:{bg:["white","black"],boxShadow:["base","dark-md"]}},outline:{item:{bg:["white","black"],borderWidth:"1px"}},unstyled:{item:{rounded:0,p:0,_selected:{boxShadow:"unset"}}}},sizes:{sm:{item:{rounded:"base",p:"sm"}},md:{item:{rounded:"md",p:"md"}},normal:{item:{rounded:"lg",p:"normal"}},lg:{item:{rounded:"xl",p:"lg"}}},defaultProps:{variant:"outline",size:"md"}},Oee={baseStyle:{_scrollbar:{w:"3",h:"3"},_scrollbarTrack:{bg:"transparent"},_scrollbarThumb:{bg:"blackAlpha.600",bgClip:"padding-box",border:"3px solid transparent",rounded:"full",_nativeHover:{bg:"blackAlpha.800",bgClip:"padding-box"}},_dark:{_scrollbarThumb:{bg:"whiteAlpha.600",bgClip:"padding-box",_nativeHover:{bg:"whiteAlpha.800",bgClip:"padding-box"}}},_scrollbarButton:{},_scrollbarCorner:{bg:"transparent"}}},Pee={baseStyle:{container:{p:"1",bg:["blackAlpha.50","whiteAlpha.50"],_readOnly:{cursor:"auto"},_disabled:{cursor:"not-allowed"}},active:{transitionProperty:"common",transitionDuration:"normal",boxShadow:"md"},button:{transitionProperty:"common",transitionDuration:"ultra-slow",fontWeight:"medium",whiteSpace:"nowrap",color:["blackAlpha.800","whiteAlpha.800"],_hover:{opacity:.7,_checked:{opacity:1}},_focusVisible:{boxShadow:"outline"},_readOnly:{cursor:"auto"},_disabled:{opacity:.4,cursor:"not-allowed"}}},variants:{basic:({colorScheme:e="gray"})=>({container:{rounded:"lg"},active:{bg:Be(e)?["whiteAlpha.700",`${e}.700`]:[Zn(e)?`${e}.400`:`${e}.500`,`${e}.600`],color:[Be(e)||Zn(e)?"black":"white","white"],rounded:"md"},button:{rounded:"md",_checked:{color:[Be(e)||Zn(e)?"black":"white","white"]}}}),rounded:({colorScheme:e="gray"})=>({container:{rounded:"full"},active:{bg:Be(e)?["whiteAlpha.700",`${e}.700`]:[Zn(e)?`${e}.400`:`${e}.500`,`${e}.600`],color:[Be(e)||Zn(e)?"black":"white","white"],rounded:"full"},button:{rounded:"full",_checked:{color:[Be(e)||Zn(e)?"black":"white","white"]}}})},sizes:{sm:{container:{minW:"xs"},button:{py:"1",px:"2",fontSize:"sm"}},md:{container:{minW:"sm"},button:{py:"1.5",px:"3",fontSize:"md"}},lg:{container:{minW:"md"},button:{py:"2",px:"4"}}},defaultProps:{variant:"basic",size:"md"}},zee={baseStyle:{background:["blackAlpha.300","whiteAlpha.300"],borderColor:["blackAlpha.400","whiteAlpha.400"],opacity:.7,borderRadius:"sm"},defaultProps:{startColor:["blackAlpha.300","whiteAlpha.300"],endColor:["blackAlpha.400","whiteAlpha.400"]}},Lee={baseStyle:({colorScheme:e="primary"})=>({stepper:{w:"100%",display:"flex",justifyContent:"space-between",_vertical:{flexDirection:"column",alignItems:"flex-start",gap:0},_horizontal:{flexDirection:"row",alignItems:"center",gap:4}},step:{position:"relative",display:"flex",gap:2,flex:1,flexShrink:0,_horizontal:{alignItems:"center"},"&:last-of-type:not([data-stretch])":{flex:"initial"}},status:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0,rounded:"full",transitionProperty:"common",transitionDuration:"slow","&[data-status=active]":{borderWidth:"2px",borderColor:[`${e}.500`,`${e}.400`]},"&[data-status=complete]":{bg:[`${e}.500`,`${e}.400`],color:["white","black"]},"&[data-status=incomplete]":{borderWidth:"2px"}},icon:{flexShrink:0},number:{},title:{fontWeight:"medium"},description:{color:["blackAlpha.700","whiteAlpha.600"]},separator:{bg:"border",flex:1,transitionProperty:"common",transitionDuration:"slow","&[data-status=complete]":{bg:[`${e}.500`,`${e}.400`]},_vertical:{position:"absolute",w:.5,h:"100%"},_horizontal:{w:"100%",h:.5,ms:2}}}),sizes:{sm:({theme:e})=>({title:{fontSize:"sm"},description:{fontSize:"xs"},status:{w:6,h:6},icon:{w:4,h:4},number:{fontSize:"sm"},separator:{maxHeight:`calc(100% - ${Ue(e,"sizes.6")} - 8px)`,top:`calc(${Ue(e,"sizes.6")} + 4px)`,insetStart:`calc(${Ue(e,"sizes.6")} / 2 - 1px)`}}),md:({theme:e})=>({title:{fontSize:"md"},description:{fontSize:"sn"},status:{w:8,h:8},icon:{w:5,h:5},number:{fontSize:"md"},separator:{maxHeight:`calc(100% - ${Ue(e,"sizes.8")} - 8px)`,top:`calc(${Ue(e,"sizes.8")} + 4px)`,insetStart:`calc(${Ue(e,"sizes.8")} / 2 - 1px)`}}),lg:({theme:e})=>({title:{fontSize:"lg"},description:{fontSize:"md"},status:{w:10,h:10},icon:{w:6,h:6},number:{fontSize:"lg"},separator:{maxHeight:`calc(100% - ${Ue(e,"sizes.10")} - 8px)`,top:`calc(${Ue(e,"sizes.10")} + 4px)`,insetStart:`calc(${Ue(e,"sizes.10")} / 2 - 1px)`}})},defaultProps:{size:"md",colorScheme:"primary"}},Bee={baseStyle:{container:{_readOnly:{cursor:"auto"},_disabled:{opacity:.4,cursor:"not-allowed"}},track:{rounded:"full",bg:["blackAlpha.400","whiteAlpha.300"],transitionProperty:"common",transitionDuration:"fast",_checked:{justifyContent:"flex-end"},_focusVisible:{boxShadow:"outline"}},thumb:{rounded:"inherit",bg:"white"},label:{userSelect:"none"}},variants:{thick:({colorScheme:e="primary"})=>({track:{p:"1",_checked:{bg:[`${e}.500`,`${e}.600`]}}}),thin:({theme:e,colorMode:t,colorScheme:n="primary"})=>({track:{_checked:{bg:[Be(n)?`${n}.50`:`${n}.100`,ln(`${n}.300`,58)(e,t)]}},thumb:{boxShadow:"dark-md",_checked:{bg:[`${n}.500`,`${n}.600`]}}})},sizes:{sm:({variant:e})=>({track:{w:"6",h:e==="thin"?"2":void 0},thumb:{w:"3",h:"3"},label:{fontSize:"sm"}}),md:({variant:e})=>({track:{w:"8",h:e==="thin"?"3":void 0},thumb:{w:"4",h:"4"},label:{fontSize:"md"}}),lg:({variant:e})=>({track:{w:"10",h:e==="thin"?"4":void 0},thumb:{w:"5",h:"5"},label:{fontSize:"lg"}})},defaultProps:{size:"md",variant:"thick",colorScheme:"primary"}},Wee=Kr(Eu,{baseStyle:{stepper:{borderStart:"1px solid",borderColor:"inherit",color:["blackAlpha.700","whiteAlpha.700"],_hover:{bg:["blackAlpha.100","whiteAlpha.100"]},_active:{bg:["blackAlpha.200","whiteAlpha.200"]},_readOnly:{cursor:"auto"},_disabled:{opacity:.4,cursor:"not-allowed"}}},variants:{flushed:{stepper:{bg:"transparent",border:"none",_hover:{bg:"transparent",opacity:.8},_active:{bg:"transparent",opacity:.7},_last:{border:"none"}}},unstyled:{stepper:{bg:"transparent",border:"none",_hover:{bg:"transparent"},_active:{bg:"transparent"},_last:{border:"none"}}}},sizes:{xs:{stepper:{fontSize:"xs",_first:{borderTopEndRadius:"sm"},_last:{borderBottomEndRadius:"sm",mt:"-1px",borderTop:"1px solid",borderColor:"inherit"}}},sm:{stepper:{fontSize:"sm",_first:{borderTopEndRadius:"md"},_last:{borderBottomEndRadius:"md",mt:"-1px",borderTop:"1px solid",borderColor:"inherit"}}},md:{stepper:{fontSize:"md",_first:{borderTopEndRadius:"md"},_last:{borderBottomEndRadius:"md",mt:"-1px",borderTop:"1px solid",borderColor:"inherit"}}},lg:{stepper:{fontSize:"lg",_first:{borderTopEndRadius:"md"},_last:{borderBottomEndRadius:"md",mt:"-1px",borderTop:"1px solid",borderColor:"inherit"}}}}})({omit:["addon"]}),Vee={baseStyle:{container:{_disabled:{cursor:"not-allowed"}},inner:{flex:1},item:{px:1,color:["blackAlpha.700","whiteAlpha.700"],rounded:"md",transitionProperty:"common",transitionDuration:"slower",_selected:{cursor:"default",pointerEvents:"none"},_focus:{outline:"none"},_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{_disabled:{bg:["initial","initial"]}},_focusVisible:{boxShadow:"outline"}},first:{},last:{},prev:{},next:{},dots:{pointerEvents:"none"}},variants:{solid:({colorScheme:e="primary"})=>({item:{border:"1px solid",borderColor:"border",_selected:{bg:Be(e)?[`${e}.50`,`${e}.700`]:[Zn(e)?`${e}.400`:`${e}.500`,`${e}.600`],borderColor:Be(e)?[`${e}.50`,`${e}.700`]:[Zn(e)?`${e}.400`:`${e}.500`,`${e}.600`],color:[Be(e)||Zn(e)?"black":"white","white"],_hover:{bg:Be(e)?[`${e}.100`,`${e}.800`]:[Zn(e)?`${e}.500`:`${e}.600`,`${e}.700`]}},_hover:{bg:["blackAlpha.50","whiteAlpha.50"],_disabled:{bg:["initial","initial"]}},_active:{bg:["blackAlpha.100","whiteAlpha.100"]}},dots:{border:"0"}}),outline:({colorScheme:e="primary"})=>({item:{border:"1px solid",borderColor:"border",_selected:{bg:"transparent",borderColor:[`${e}.600`,`${e}.500`],color:Be(e)?["blackAlpha.800","whiteAlpha.700"]:[`${e}.600`,`${e}.500`],_hover:{bg:["transparent","transparent"]}},_hover:{bg:["blackAlpha.50","whiteAlpha.50"],_disabled:{bg:["initial","initial"]}},_active:{bg:["blackAlpha.100","whiteAlpha.100"]}},dots:{border:"0"}}),ghost:({theme:e,colorMode:t,colorScheme:n="primary"})=>({item:{_selected:{bg:Be(n)?void 0:"transparent",fontWeight:"semibold",color:Be(n)?["blackAlpha.800","whiteAlpha.700"]:[`${n}.600`,`${n}.500`]},_hover:{bg:[`${n}.50`,wa(`${n}.600`,.12)(e,t)]},_active:{bg:Be(n)?[`${n}.300`,"whiteAlpha.300"]:[`${n}.200`,wa(`${n}.200`,.24)(e,t)]}}}),unstyled:{container:{gap:0},inner:{gap:0},item:{bg:"none",color:"inherit",minW:"auto",minH:"auto"},_ripple:{display:"none"}}},sizes:{xs:{container:{gap:"xs"},inner:{gap:"xs"},item:{minW:6,minH:6,fontSize:"xs"}},sm:{container:{gap:"xs"},inner:{gap:"xs"},item:{minW:7,minH:7,fontSize:"sm"}},md:{container:{gap:"sm"},inner:{gap:"sm"},item:{minW:8,minH:8,fontSize:"md"}},lg:{container:{gap:"sm"},inner:{gap:"sm"},item:{minW:10,minH:10,fontSize:"lg"}},xl:{container:{gap:"md"},inner:{gap:"md"},item:{minW:12,minH:12,fontSize:"xl"}}},defaultProps:{variant:"solid",size:"md",colorScheme:"primary"}},Vz={baseStyle:{container:{w:"100%"},table:{h:"100%",w:"100%",fontVariantNumeric:"lining-nums tabular-nums",borderCollapse:"collapse"},tr:{color:["blackAlpha.700","whiteAlpha.600"],_disabled:{cursor:"not-allowed",opacity:.4,_hover:{bg:["initial","initial"]}}},th:{fontFamily:"heading",fontWeight:"semibold",textAlign:"start",textTransform:"uppercase",letterSpacing:"wider"},td:{textAlign:"start"},caption:{fontFamily:"heading",fontWeight:"medium",textAlign:"center",color:["blackAlpha.700","whiteAlpha.600"]}},variants:{simple:({theme:e,colorMode:t,colorScheme:n="gray",withBorder:r,withColumnBorders:a,highlightOnSelected:i,highlightOnHover:s})=>({table:{...r?{borderWidth:"1px"}:{}},th:{borderBottomWidth:"1px","&[data-is-numeric=true]":{textAlign:"end"},...a?{_notLast:{borderRightWidth:"1px"}}:{}},td:{borderBottomWidth:"1px","&[data-is-numeric=true]":{textAlign:"end"},...a?{_notLast:{borderRightWidth:"1px"}}:{}},tbody:{tr:{...i?{_selected:{bg:[Be(n)?vn(`${n}.50`,72)(e,t):vn(`${n}.50`,64)(e,t),wa(`${n}.300`,.04)(e,t)]}}:{},...s?{cursor:"pointer",transitionProperty:"common",transitionDuration:"slow",_hover:{bg:[wa(`${n}.400`,.08)(e,t),wa(`${n}.300`,.12)(e,t)]}}:{}}},tfoot:{tr:{_last:{th:{borderBottomWidth:0}}}}}),striped:({theme:e,colorMode:t,colorScheme:n="gray",withBorder:r,withColumnBorders:a,highlightOnHover:i})=>({table:{...r?{borderWidth:"1px"}:{}},th:{borderBottomWidth:"1px","&[data-is-numeric=true]":{textAlign:"end"},...a?{_notLast:{borderRightWidth:"1px"}}:{}},td:{borderBottomWidth:"1px","&[data-is-numeric=true]":{textAlign:"end"},...a?{_notLast:{borderRightWidth:"1px"}}:{}},tbody:{tr:{_odd:{bg:[Be(n)?vn(`${n}.50`,72)(e,t):vn(`${n}.50`,64)(e,t),wa(`${n}.300`,.04)(e,t)]},...i?{cursor:"pointer",transitionProperty:"common",transitionDuration:"slow",_hover:{bg:[wa(`${n}.400`,.08)(e,t),wa(`${n}.300`,.12)(e,t)]}}:{}}},tfoot:{tr:{_last:{th:{borderBottomWidth:0}}}}}),unstyled:{}},sizes:{sm:{container:{gap:2},th:{px:2,py:1,fontSize:"xs",lineHeight:5},td:{px:2,py:1,fontSize:"xs",lineHeight:5},caption:{mt:1,px:2,py:1,fontSize:"xs"}},md:{container:{gap:4},th:{px:3,py:2,fontSize:"sm",lineHeight:5},td:{px:3,py:2,fontSize:"sm",lineHeight:5},caption:{mt:2,px:3,py:2,fontSize:"sm"}},lg:{container:{gap:6},th:{px:4,py:3,lineHeight:6},td:{px:4,py:3,lineHeight:6},caption:{mt:3,px:4,py:3}},xl:{container:{gap:8},th:{px:6,py:4,fontSize:"lg",lineHeight:6},td:{px:6,py:4,fontSize:"lg",lineHeight:6},caption:{mt:4,px:6,py:4,fontSize:"lg"}}},defaultProps:{variant:"simple",size:"md",colorScheme:"gray"}},Uz=Kr(Vz,{baseStyle:{sortIcon:{}},sizes:{sm:{sortIcon:{right:2}},md:{sortIcon:{right:3}},lg:{sortIcon:{right:4}},xl:{sortIcon:{right:6}}}})(),Uee=Kr(Uz,{baseStyle:{pagingControl:{gridTemplateColumns:"1fr 5fr 1fr"}},sizes:{sm:{pagingControl:{gap:2}},md:{pagingControl:{gap:4}},lg:{pagingControl:{gap:6}},xl:{pagingControl:{gap:8}}}})(),jee=Kr(Eu,{baseStyle:{container:{gap:"sm"},field:{textAlign:"center"}},variants:{unstyled:{field:{h:"auto"}}},sizes:{xs:{field:{fontSize:"xs",boxSize:"6",rounded:"sm"}},sm:{field:{fontSize:"sm",boxSize:"8",rounded:"md"}},md:{field:{fontSize:"md",boxSize:"10",rounded:"md"}},lg:{field:{fontSize:"lg",boxSize:"12",rounded:"md"}}}})({omit:["addon","sizes"]}),Hee={baseStyle:{container:{rounded:"md",bg:["white","black"],border:"1px solid",borderColor:["blackAlpha.200","whiteAlpha.100"],color:"inherit",boxShadow:["lg","dark-lg"],zIndex:"guldo",_focusVisible:{outline:0,boxShadow:"outline"}},closeButton:{top:"2",right:"2"},header:{p:"sm",gap:"sm",fontWeight:"semibold",borderBottom:"1px solid",borderColor:"inherit"},body:{my:"sm",px:"sm",gap:"sm"},footer:{p:"sm",gap:"sm",borderTop:"1px solid",borderColor:"inherit"}}},Gee={baseStyle:{track:{bg:"border"},filledTrack:({theme:e,colorMode:t,colorScheme:n="primary",hasStripe:r,isAnimation:a,filledTrackColor:i})=>{r=!a&&r;const s=sn("rgba(255, 255, 255, 0.15)","rgba(0,0,0,0.1)")(t),o=i?lt(i)?sn(_e(i[0],i[0])(e,t),_e(i[1],i[1])(e,t))(t):_e(i,i)(e,t):_e(`${n}.500`)(e,t);return{transitionProperty:"common",transitionDuration:"slow",bgImage:r?`linear-gradient(
            45deg,
            ${s} 25%,
            transparent 25%,
            transparent 50%,
            ${s} 50%,
            ${s} 75%,
            transparent 75%,
            transparent
          )`:a?`linear-gradient(
            to right,
            transparent 0%,
            ${o} 50%,
            transparent 100%
          )`:void 0,...r?{bgSize:"1rem 1rem"}:{},...a?{}:{bgColor:o}}}},sizes:{xs:{track:{h:"1"}},sm:{track:{h:"2"}},md:{track:{h:"3"}},lg:{track:{h:"4"}}},defaultProps:{size:"md",colorScheme:"primary"}},qee={baseStyle:{container:{_readOnly:{cursor:"auto"},_disabled:{cursor:"not-allowed"}},icon:({colorScheme:e="primary"})=>({transitionProperty:"box-shadow",transitionDuration:"normal",border:"2px solid",borderColor:"inherit",rounded:"full",color:"white",display:"inline-flex",justifyContent:"center",alignItems:"center",_checked:{_before:{content:'""',display:"inline-block",rounded:"full",bg:[`${e}.500`,`${e}.600`]},_hover:{_before:{bg:[`${e}.600`,`${e}.700`]}},_disabled:{_before:{bg:["blackAlpha.400","whiteAlpha.300"]},_dark:{_before:{bg:"whiteAlpha.300"}}}},_disabled:{bg:["blackAlpha.200","whiteAlpha.100"]},_focusVisible:{boxShadow:"outline"},_invalid:{borderColor:["danger.500","danger.400"],_focusVisible:{borderColor:["inherit","inherit"]}}}),label:{userSelect:"none",_disabled:{opacity:.4}}},sizes:{sm:{icon:{boxSize:"3.5",_before:{boxSize:"1.5"}},label:{fontSize:"sm"}},md:{icon:{boxSize:"4",_before:{boxSize:"2"}},label:{fontSize:"md"}},lg:{icon:{boxSize:"5",_before:{boxSize:"3"}},label:{fontSize:"lg"}}},defaultProps:{size:"md",colorScheme:"primary"}},jz={baseStyle:{container:({orientation:e})=>({display:"inline-block",position:"relative",cursor:"pointer",_readOnly:{cursor:"auto"},_disabled:{opacity:.6,cursor:"not-allowed"},...e==="vertical"?{h:"100%"}:{w:"100%"}}),track:{overflow:"hidden",rounded:"sm",bg:"border",_disabled:{bg:["blackAlpha.200","whiteAlpha.400"]}},filledTrack:({colorScheme:e="primary"})=>({w:"inherit",h:"inherit",bg:[`${e}.500`,`${e}.400`]}),mark:{fontSize:"sm"},thumb:({theme:e,colorMode:t,orientation:n})=>({position:"absolute",zIndex:"yamcha",display:"flex",alignItems:"center",justifyContent:"center",outline:0,rounded:"full",bg:"white",boxShadow:"base",border:"1px solid",borderColor:"transparent",transitionProperty:"transform",transitionDuration:"normal",_focusVisible:{boxShadow:"outline"},_disabled:{bg:[vn("black",72)(e,t),ln("white",64)]},...n==="vertical"?{left:"50%",transform:"translateX(-50%)",_active:{transform:"translateX(-50%) scale(1.15)"}}:{top:"50%",transform:"translateY(-50%)",_active:{transform:"translateY(-50%) scale(1.15)"}}})},sizes:{sm:({orientation:e})=>({track:e==="vertical"?{w:"0.5"}:{h:"0.5"},thumb:{boxSize:"2.5"},mark:e==="vertical"?{ml:"2"}:{mt:"2"}}),md:({orientation:e})=>({track:e==="vertical"?{w:"1"}:{h:"1"},thumb:{boxSize:"3.5"},mark:e==="vertical"?{ml:"3"}:{mt:"3"}}),lg:({orientation:e})=>({track:e==="vertical"?{w:"1.5"}:{h:"1.5"},thumb:{boxSize:"5"},mark:e==="vertical"?{ml:"4"}:{mt:"4"}})},defaultProps:{size:"md",colorScheme:"primary"}},Kee=Kr(jz)(),Xee={baseStyle:{w:"full","*:first-of-type":{mt:"0 !important"},"h1, h2, h3, h4, h5, h6":{mt:"24px",mb:"16px",fontWeight:"semibold",lineHeight:"1.25"},h1:{pb:".3em",fontSize:"2em",borderBottom:"1px solid",borderBottomColor:"border"},h2:{pb:".3em",fontSize:"1.5em",borderBottom:"1px solid",borderBottomColor:"border"},h3:{fontSize:"1.25em"},h4:{fontSize:"1em"},h5:{fontSize:"0.875em"},h6:{fontSize:"0.85em"},"p, blockquote, ul, ol, dl, table, pre, details":{mt:"0px",mb:"16px"},strong:{fontWeight:"semibold"},a:{color:"link",textDecoration:"none"},img:{maxW:"100%",boxSizing:"content-box"},blockquote:{px:"1em",color:["blackAlpha.700","whiteAlpha.600"],borderLeft:"0.25em solid",borderLeftColor:"border"},"blockquote>:last-child":{mb:0},ul:{pl:"2em",listStyleType:"disc"},"li + li":{mt:"0.25em"},"code:not(pre > *)":{py:"0.2em",px:"0.4em",m:0,fontFamily:"mono",fontSize:"85%",bg:["blackAlpha.200","whiteAlpha.300"],rounded:"6px"},pre:{mt:"16px",fontSize:"92.5%",lineHeight:1.45,rounded:"6px"},hr:{h:"0.25em",p:0,my:"24px",bg:"border",border:0},table:{display:"block",w:"max-content",maxW:"100%",overflow:"auto"},tr:{borderTop:"1px solid",borderTopColor:"border"},th:{fontWeight:"semibold"},"th, td":{py:"6px",px:"13px",border:"1px solid",borderColor:"border"}}},Hz={baseStyle:{button:{transitionProperty:"common",transitionDuration:"normal"},list:{rounded:"md",minW:"xs",py:"2",bg:["white","black"],border:"1px solid",borderColor:["blackAlpha.200","whiteAlpha.100"],color:"inherit",boxShadow:["lg","dark-lg"],zIndex:"yamcha"},item:{cursor:"pointer",py:"1.5",px:"3",transitionProperty:"background",transitionDuration:"ultra-fast",transitionTimingFunction:"ease-in",_focus:{bg:["blackAlpha.50","whiteAlpha.50"]},_hover:{bg:["blackAlpha.100","whiteAlpha.100"]},_active:{bg:["blackAlpha.200","whiteAlpha.200"]},_disabled:{opacity:.4,cursor:"not-allowed"}},icon:{color:["blackAlpha.700","whiteAlpha.700"]},command:{opacity:.6},divider:{my:"2",borderBottomWidth:"1px",borderColor:"inherit"},group:{},groupLabel:{py:"1.5",px:"3",fontSize:"sm",fontWeight:"semibold",color:["blackAlpha.700","whiteAlpha.600"]}}},Gz=Kr(Eu,{baseStyle:{container:{},field:{cursor:"pointer",pr:"8",pb:"px",_focus:{zIndex:"unset"},_readOnly:{pointerEvents:"none",_placeholder:{color:"inherit !important"}}},icon:{w:"6",py:"2",color:["blackAlpha.700","whiteAlpha.700"],fontSize:"xl",outline:0,rounded:"md",_disabled:{opacity:.5}}},sizes:{xs:{icon:{pt:"3",fontSize:"lg",insetEnd:"1"}},sm:{icon:{insetEnd:"2"}},md:{icon:{insetEnd:"2"}},lg:{icon:{insetEnd:"2"}}}})({omit:["addon"]}),OC=Kr(Gz,Hz,{baseStyle:{inner:{},list:{w:"100%",maxH:"xs",overflowY:"auto"},itemIcon:{}}})({omit:["button","command"]}),PC=Kr(OC,{baseStyle:{clearIcon:{transitionProperty:"common",transitionDuration:"normal",pointerEvents:"auto",_hover:{opacity:.8},_disabled:{pointerEvents:"none",opacity:.4},_focusVisible:{boxShadow:"outline"}}}})(),qz=Kr(Eu,PC,{baseStyle:{container:{},field:{cursor:"pointer",pb:"px",_focus:{zIndex:"unset"},_readOnly:{pointerEvents:"none",_placeholder:{color:"inherit !important"}}},list:{w:"auto",minW:"auto",maxH:"auto",overflowY:"inherit",p:"2"}},sizes:{xs:{icon:{pt:"2",fontSize:"md"}}}})({omit:["addon","group","groupLabel","item","itemIcon"]}),Yee=Kr(qz)(),Zee=Kr(PC)(),Qee={baseStyle:{fontFamily:"heading",fontWeight:"bold"},sizes:{"4xl":{fontSize:{base:"7xl",sm:"6xl"}},"3xl":{fontSize:{base:"6xl",sm:"5xl"}},"2xl":{fontSize:{base:"5xl",sm:"4xl"}},xl:{fontSize:{base:"4xl",sm:"3xl"}},lg:{fontSize:{base:"3xl",sm:"2xl"}},md:{fontSize:"xl"},sm:{fontSize:"md"},xs:{fontSize:"sm"}},defaultProps:{size:"xl"}},Jee={baseStyle:({withBorder:e})=>({zIndex:"kurillin",rounded:"full",w:"fit-content",h:"fit-content",display:"flex",justifyContent:"center",alignItems:"center",outline:0,whiteSpace:"nowrap",...e?{borderWidth:"0.2em",borderColor:["white","black"]}:{}}),sizes:{sm:{minH:2,minW:2,fontSize:"xs",px:1,lineHeight:1.6},md:{minH:3,minW:3,fontSize:"sm",px:1.5,lineHeight:1.5},lg:{minH:4,minW:4,fontSize:"md",px:2,lineHeight:1.4}},variants:{solid:({colorScheme:e="primary"})=>({bg:[`${e}.500`,`${e}.600`],color:"white"}),subtle:({theme:e,colorMode:t,colorScheme:n="primary"})=>({bg:[Be(n)?`${n}.50`:`${n}.100`,ln(`${n}.300`,58)(e,t)],color:[`${n}.800`,Be(n)?`${n}.50`:`${n}.200`]})},defaultProps:{size:"md",variant:"solid",colorScheme:"primary"}},ete={baseStyle:{fontFamily:"mono",bg:["blackAlpha.50","whiteAlpha.50"],rounded:"md",borderWidth:"1px",fontSize:"0.8em",fontWeight:"bold",lineHeight:"shorter",py:"0.2em",px:"0.4em",whiteSpace:"nowrap"}},tte={baseStyle:{transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"link",_hover:{textDecoration:"underline"},_focusVisible:{boxShadow:"outline"}}},nte={baseStyle:{container:{},item:{},icon:{me:"2",display:"inline-block",verticalAlign:"middle"}}},rte={baseStyle:{px:"1",py:"1"},variants:{solid:({theme:e,colorMode:t,colorScheme:n="gray"})=>({bg:[vn(`${n}.600`,24)(e,t),ln(`${n}.600`,16)(e,t)],color:"white"}),subtle:({theme:e,colorMode:t,colorScheme:n="gray"})=>({bg:[Be(n)?`${n}.50`:`${n}.100`,ln(`${n}.300`,58)(e,t)],color:[`${n}.800`,Be(n)?`${n}.50`:`${n}.200`]}),outline:({theme:e,colorMode:t,colorScheme:n="gray"})=>{const r=sn(_e(`${n}.500`)(e,t),_e(Be(n)?`${n}.100`:`${n}.400`)(e,t))(t);return{color:r,boxShadow:`inset 0 0 0px 1px ${r}`}},"text-accent":({colorScheme:e="gray"})=>({color:[`${e}.500`,Be(e)?`${e}.100`:`${e}.400`],p:0}),unstyled:{p:0}},defaultProps:{variant:"subtle",colorScheme:"secondary"}},zC={baseStyle:{container:{w:"100%",rounded:"md",bg:["white","black"],color:"inherit",boxShadow:["lg","dark-lg"],zIndex:"recoome"},closeButton:{top:"3",right:"3"},overlay:{bg:"blackAlpha.600",zIndex:"burter"},header:{pt:"md",px:"md",gap:"md",fontSize:"xl",fontWeight:"semibold"},body:{my:"md",px:"md",gap:"md",flex:"1"},footer:{px:"md",pb:"md",gap:"md"}},sizes:{xs:{container:{maxW:"xs"}},sm:{container:{maxW:"sm"}},md:{container:{maxW:"md"}},lg:{container:{maxW:"lg"}},xl:{container:{maxW:"xl"}},"2xl":{container:{maxW:"2xl"}},"3xl":{container:{maxW:"3xl"}},"4xl":{container:{maxW:"4xl"}},"5xl":{container:{maxW:"5xl"}},"6xl":{container:{maxW:"6xl"}},full:{container:{minW:"100vw",minH:"100dvh",rounded:0}}},defaultProps:{size:"md"}},ate=Kr(zC)(),ite={baseStyle:{borderColor:"border"},variants:{solid:{borderStyle:"solid"},dashed:{borderStyle:"dashed"},dotted:{borderStyle:"dotted"}},defaultProps:{variant:"solid"}},ste=Kr(zC,{baseStyle:{container:({isFullHeight:e})=>({...e?{height:"100dvh"}:{},w:"auto"}),body:{overflow:"auto"}},sizes:{xs:{container:{maxW:"xs"}},sm:{container:{maxW:"md"}},md:{container:{maxW:"lg"}},lg:{container:{maxW:"2xl"}},xl:{container:{maxW:"4xl"}},full:{container:{minW:"100vw",minH:"100dvh"}}},defaultProps:{size:"md"}})({omit:["sizes"]}),ote={baseStyle:({theme:e,colorMode:t})=>({container:{color:["blackAlpha.700","whiteAlpha.600"],rounded:"md",w:"100%",bg:["blackAlpha.50","whiteAlpha.50"],outline:0,overflow:"hidden",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed"},_hover:{cursor:"pointer",bg:["blackAlpha.100","whiteAlpha.100"]},_loading:{cursor:"not-allowed",bg:["blackAlpha.100","whiteAlpha.100"]},_accept:{bg:["success.50",wa("success.400",.12)(e,t)],borderColor:["success.500","success.400"]},_reject:{bg:["danger.50",wa("danger.400",.12)(e,t)],borderColor:["danger.500","danger.400"]}},overlay:{bg:["whiteAlpha.600","blackAlpha.600"],zIndex:"kurillin"}}),variants:{solid:({theme:e,colorMode:t,focusBorderColor:n="focus",errorBorderColor:r=["danger.500","danger.400"]})=>{const a=lt(n)?sn(_e(n[0],n[0])(e,t),_e(n[1],n[1])(e,t))(t):_e(n,n)(e,t),i=lt(r)?sn(_e(r[0],r[0])(e,t),_e(r[1],r[1])(e,t))(t):_e(r,r)(e,t);return{container:{borderWidth:"1px",borderStyle:"solid",_invalid:{borderColor:i,boxShadow:`0 0 0 1px ${i}`},_focus:{zIndex:"yamcha",borderColor:a,boxShadow:`0 0 0 1px ${a}`},_focusVisible:{zIndex:"yamcha",borderColor:a,boxShadow:`0 0 0 1px ${a}`}}}},dashed:({theme:e,colorMode:t,focusBorderColor:n="focus",errorBorderColor:r=["danger.500","danger.400"]})=>{const a=lt(n)?sn(_e(n[0],n[0])(e,t),_e(n[1],n[1])(e,t))(t):_e(n,n)(e,t),i=lt(r)?sn(_e(r[0],r[0])(e,t),_e(r[1],r[1])(e,t))(t):_e(r,r)(e,t);return{container:{borderWidth:"1px",borderStyle:"dashed",_invalid:{borderColor:i,boxShadow:`0 0 0 1px ${i}`},_focus:{zIndex:"yamcha",borderColor:a,boxShadow:`0 0 0 1px ${a}`},_focusVisible:{zIndex:"yamcha",borderColor:a,boxShadow:`0 0 0 1px ${a}`}}}},unstyled:{container:{color:"inherit",rounded:"inherit",bg:"transparent",h:"auto",_hover:{cursor:"inherit",bg:"transparent"},_loading:{cursor:"auto",bg:"transparent"},_accept:{bg:"transparent",borderColor:"inherit"},_reject:{bg:"transparent",borderColor:"inherit"}},overlay:{bg:"transparent"}}},sizes:{xs:{container:{h:"xs"}},sm:{container:{h:"sm"}},md:{container:{h:"md"}},lg:{container:{h:"lg"}},full:{container:{h:"full"}}},defaultProps:{size:"sm",variant:"dashed"}},lte={baseStyle:{container:{w:"full"},preview:{rounded:"md",p:"1",whiteSpace:"pre-line",transitionProperty:"common",transitionDuration:"normal"},input:({theme:e,colorMode:t,focusBorderColor:n="focus",errorBorderColor:r=["danger.500","danger.400"]})=>{const a=lt(n)?sn(_e(n[0],n[0])(e,t),_e(n[1],n[1])(e,t))(t):_e(n,n)(e,t),i=lt(r)?sn(_e(r[0],r[0])(e,t),_e(r[1],r[1])(e,t))(t):_e(r,r)(e,t);return{rounded:"md",p:"1",w:"full",transitionProperty:"common",transitionDuration:"normal",_placeholder:{opacity:.6},_invalid:{boxShadow:`0px 0px 0px 1px ${i}`},_focus:{zIndex:"yamcha",boxShadow:`0px 0px 0px 1px ${a}`},_focusVisible:{zIndex:"yamcha",boxShadow:`0px 0px 0px 1px ${a}`}}},textarea:({theme:e,colorMode:t,focusBorderColor:n="focus",errorBorderColor:r=["danger.500","danger.400"]})=>{const a=lt(n)?sn(_e(n[0],n[0])(e,t),_e(n[1],n[1])(e,t))(t):_e(n,n)(e,t),i=lt(r)?sn(_e(r[0],r[0])(e,t),_e(r[1],r[1])(e,t))(t):_e(r,r)(e,t);return{boxSizing:"content-box",rounded:"md",p:"1",w:"full",h:"1lh",transitionProperty:"common",transitionDuration:"normal",_placeholder:{opacity:.6},_invalid:{boxShadow:`0px 0px 0px 1px ${i}`},_focus:{zIndex:"yamcha",boxShadow:`0px 0px 0px 1px ${a}`},_focusVisible:{zIndex:"yamcha",boxShadow:`0px 0px 0px 1px ${a}`}}}}},ute=Kr(Eu)(),cte={baseStyle:{container:{w:"100%",position:"relative"},label:{fontSize:"md",me:"3",mb:"2",fontWeight:"medium",transitionProperty:"common",transitionDuration:"normal",opacity:1,_disabled:{opacity:.4}},requiredIndicator:{ms:"1",color:["danger.500","danger.400"]},helperMessage:{mt:"2",color:["blackAlpha.700","whiteAlpha.600"],fontSize:"sm"},errorMessage:{mt:"2",color:["danger.500","danger.400"],fontSize:"sm"}}},dte={baseStyle:{container:{},item:{},link:{transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",textDecoration:"none",outline:"none",color:"inherit","&:not([aria-current=page])":{cursor:"pointer",_hover:{textDecoration:"underline"},_focusVisible:{boxShadow:"outline"}}},separator:{}}},pte={baseStyle:{container:{gap:"md"},header:{},label:{color:["blackAlpha.700","whiteAlpha.600"]},labelIcon:{color:["blackAlpha.500","whiteAlpha.500"]},control:{color:["blackAlpha.500","whiteAlpha.500"],fontSize:"1.25em",_hidden:{opacity:0,pointerEvents:"none"}},prev:{},next:{},content:{},year:{gridTemplateColumns:"repeat(4, 1fr)"},month:{gridTemplateColumns:"repeat(3, 1fr)"},button:{_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none",_focusVisible:{boxShadow:"0 0 0 3px rgba(125, 125, 125, 0.6)"}}},date:{},weekday:{userSelect:"none",color:["blackAlpha.700","whiteAlpha.600"],justifyContent:"center",alignItems:"center"},day:{_weekend:{color:["red.600","red.400"]},_outside:{color:["blackAlpha.500","whiteAlpha.500"]},_holiday:{color:["red.600","red.400"]},_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none",_focusVisible:{boxShadow:"0 0 0 3px rgba(125, 125, 125, 0.6)"}}}},variants:{solid:({theme:e,colorMode:t,colorScheme:n="primary"})=>({button:{_hover:{bg:["blackAlpha.50","whiteAlpha.50"],_disabled:{bg:["initial","initial"]}},_selected:{bg:Be(n)?[`${n}.50`,`${n}.700`]:[Zn(n)?`${n}.400`:`${n}.500`,`${n}.600`],color:[Be(n)||Zn(n)?"black":"white","white"]}},day:{_hover:{bg:["blackAlpha.50","whiteAlpha.50"],_disabled:{bg:["initial","initial"]}},_today:{bg:[Be(n)?`${n}.50`:`${n}.100`,ln(`${n}.300`,58)(e,t)]},_selected:{bg:Be(n)?[`${n}.50`,`${n}.700`]:[Zn(n)?`${n}.400`:`${n}.500`,`${n}.600`],color:[Be(n)||Zn(n)?"black":"white","white"],borderColor:["transparent","transparent"]}}}),subtle:({theme:e,colorMode:t,colorScheme:n="primary"})=>({button:{_hover:{bg:["blackAlpha.50","whiteAlpha.50"],_disabled:{bg:["initial","initial"]}},_selected:{bg:[Be(n)?`${n}.50`:`${n}.100`,ln(`${n}.300`,58)(e,t)],color:[`${n}.800`,Be(n)?`${n}.50`:`${n}.200`]}},day:{_hover:{bg:["blackAlpha.50","whiteAlpha.50"],_disabled:{bg:["initial","initial"]}},_today:{bg:[vn(`${n}.50`,24)(e,t),ln(`${n}.300`,76)(e,t)]},_selected:{bg:[Be(n)?`${n}.50`:`${n}.100`,ln(`${n}.300`,58)(e,t)],color:[`${n}.800`,Be(n)?`${n}.50`:`${n}.200`],borderColor:["transparent","transparent"]}}}),unstyled:{container:{gap:"inherit",fontSize:"inherit"},content:{w:"auto"},label:{h:"auto",pointerEvents:"inherit",_hover:{bg:"inherit"},_active:{bg:"inherit",pointerEvents:"inherit"}},labelIcon:{color:"inherit"},control:{fontSize:"inherit",w:"auto",h:"auto",_hover:{bg:"inherit"},_active:{bg:"inherit"},_hidden:{opacity:"inherit",pointerEvents:"inherit"}},button:{h:"auto",_hover:{bg:"inherit"},_active:{bg:"inherit"},_disabled:{opacity:"inherit",cursor:"inherit",boxShadow:"inherit",_focusVisible:{boxShadow:"inherit"}}},weekday:{userSelect:"auto",color:"inherit",w:"auto",h:"auto"},day:{w:"auto",h:"auto",_hover:{bg:"inherit"},_active:{bg:"inherit"},_weekend:{color:"inherit"},_outside:{color:"inherit"},_holiday:{color:"inherit"},_disabled:{opacity:"inherit",cursor:"inherit",boxShadow:"inherit",_focusVisible:{boxShadow:"inherit"}}}}},sizes:{sm:{container:{fontSize:"xs"},content:{w:56},label:{h:8},control:{w:8,h:8},button:{h:8},weekday:{w:8,h:8},day:{w:8,h:8}},md:{container:{fontSize:"sm"},content:{w:"17.5rem"},label:{h:10},control:{w:10,h:10},button:{h:10},weekday:{w:10,h:10},day:{w:10,h:10}},lg:{container:{fontSize:"md"},content:{w:"21rem"},label:{h:12},control:{fontSize:"1.5em",w:12,h:12},button:{h:12},weekday:{w:12,h:12},day:{w:12,h:12}},full:{container:{w:"full",fontSize:"md"},content:{w:"full"},label:{h:12},control:{fontSize:"1.5em",w:12,h:12},button:{h:12},weekday:{w:"full",h:12},day:{w:"full",h:12}}},defaultProps:{size:"md",variant:"solid",colorScheme:"primary"}},hte={baseStyle:{container:{},header:{},body:{flex:"1"},footer:{}},variants:{elevated:{container:{boxShadow:["md","dark-md"]}},outline:{container:{borderWidth:"1px"}},solid:({theme:e,colorMode:t,colorScheme:n="primary"})=>({container:{bg:[vn(`${n}.600`,16)(e,t),ln(`${n}.600`,16)(e,t)],color:"white"}}),subtle:({theme:e,colorMode:t,colorScheme:n="primary"})=>({container:{bg:[`${n}.100`,ln(`${n}.300`,58)(e,t)]}}),unstyled:{container:{rounded:0},header:{p:0},body:{p:0},footer:{p:0}}},sizes:{sm:{container:{rounded:"base"},header:{pt:"sm",px:"sm",gap:"sm"},body:{py:"sm",px:"sm",gap:"sm"},footer:{pb:"sm",px:"sm",gap:"sm"}},md:{container:{rounded:"md"},header:{pt:"md",px:"md",gap:"md"},body:{py:"md",px:"md",gap:"md"},footer:{pb:"md",px:"md",gap:"md"}},normal:{container:{rounded:"lg"},header:{pt:"normal",px:"normal",gap:"normal"},body:{py:"normal",px:"normal",gap:"normal"},footer:{pb:"normal",px:"normal",gap:"normal"}},lg:{container:{rounded:"xl"},header:{pt:"lg",px:"lg",gap:"lg"},body:{py:"lg",px:"lg",gap:"lg"},footer:{pb:"lg",px:"lg",gap:"lg"}}},defaultProps:{variant:"elevated",colorScheme:"primary",size:"md"}},fte={baseStyle:{container:{w:"100%"},inner:{},slide:{},control:{},prev:({orientation:e})=>({...e==="vertical"?{left:"50%",top:"4",transform:"translateX(-50%)"}:{top:"50%",left:"4",transform:"translateY(-50%)"}}),next:({orientation:e})=>({...e==="vertical"?{left:"50%",bottom:"4",transform:"translateX(-50%)"}:{top:"50%",right:"4",transform:"translateY(-50%)"}}),indicators:({orientation:e})=>({gap:"md",...e==="vertical"?{py:"4",h:"100%",top:"50%",right:"4",transform:"translateY(-50%)"}:{px:"4",w:"100%",h:"2",left:"50%",bottom:"4",transform:"translateX(-50%)"}}),indicator:({orientation:e})=>({rounded:"full",bg:["whiteAlpha.400","blackAlpha.400"],_hover:{bg:["whiteAlpha.500","blackAlpha.500"]},_active:{bg:["whiteAlpha.600","blackAlpha.600"]},_selected:{bg:["whiteAlpha.700","blackAlpha.700"]},transitionProperty:"common",transitionDuration:"slower",...e==="vertical"?{h:"8",right:"4"}:{w:"8",bottom:"4"}})},sizes:{sm:{inner:{h:"sm"},indicators:({orientation:e})=>({...e==="vertical"?{w:"1.5"}:{h:"1.5"}})},md:{inner:{h:"md"},indicators:({orientation:e})=>({...e==="vertical"?{w:"1.5"}:{h:"1.5"}})},lg:{inner:{h:"lg"},indicators:({orientation:e})=>({...e==="vertical"?{w:"2"}:{h:"2"}})},xl:{inner:{h:"xl"},indicators:({orientation:e})=>({...e==="vertical"?{w:"2"}:{h:"2"}})}},defaultProps:{size:"md"}},mte={baseStyle:{container:{_readOnly:{cursor:"auto"},_disabled:{cursor:"not-allowed"}},icon:({colorScheme:e="primary"})=>({transitionProperty:"box-shadow",transitionDuration:"normal",border:"2px solid",borderColor:"inherit",color:["white","black"],_checked:{bg:`${e}.500`,borderColor:`${e}.500`,color:["white","black"],_hover:{bg:`${e}.600`,borderColor:`${e}.600`},_disabled:{bg:["blackAlpha.400","whiteAlpha.300"]}},_indeterminate:{bg:`${e}.500`,borderColor:`${e}.500`,color:["white","black"]},_disabled:{bg:["blackAlpha.200","whiteAlpha.100"],borderColor:["transparent","transparent"]},_focusVisible:{boxShadow:"outline"},_invalid:{borderColor:["danger.500","danger.400"],_focusVisible:{borderColor:"inherit",_checked:{borderColor:`${e}.500`}}}}),label:{userSelect:"none",_disabled:{opacity:.4}}},sizes:{sm:{icon:{boxSize:"3.5",rounded:"base",fontSize:"2xs"},label:{fontSize:"sm"}},md:{icon:{boxSize:"4",rounded:"base",fontSize:"2xs"},label:{fontSize:"md"}},lg:{icon:{boxSize:"5",rounded:"base",fontSize:"sm"},label:{fontSize:"lg"}}},defaultProps:{size:"md",colorScheme:"primary"}},Kz={baseStyle:{rounded:"md",fontWeight:"semibold",transitionProperty:"common",transitionDuration:"slower",_focus:{outline:"none"},_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_readOnly:{cursor:"default"},_hover:{_disabled:{bg:["initial","initial"]}}},variants:{solid:({theme:e,colorMode:t,colorScheme:n="gray",errorBorderColor:r=["danger.500","danger.400"]})=>{const a=lt(r)?sn(_e(r[0],r[0])(e,t),_e(r[1],r[1])(e,t))(t):_e(r,r)(e,t);return{bg:Be(n)?[`${n}.50`,`${n}.700`]:[Zn(n)?`${n}.400`:`${n}.500`,`${n}.600`],color:[Be(n)||Zn(n)?"black":"white","white"],_hover:{bg:Be(n)?[`${n}.100`,`${n}.800`]:[Zn(n)?`${n}.500`:`${n}.600`,`${n}.700`],_disabled:{bg:Be(n)?[`${n}.50`,`${n}.700`]:[Zn(n)?`${n}.400`:`${n}.500`,`${n}.600`]}},_invalid:{border:"1px solid",borderColor:a,boxShadow:`0 0 0 1px ${a}`},_focusVisible:{borderColor:"transparent",boxShadow:"outline"}}},outline:({theme:e,colorMode:t,colorScheme:n="gray",errorBorderColor:r=["danger.500","danger.400"]})=>{const a=lt(r)?sn(_e(r[0],r[0])(e,t),_e(r[1],r[1])(e,t))(t):_e(r,r)(e,t);return{border:"1px solid",borderColor:[`${n}.600`,`${n}.500`],color:Be(n)?["blackAlpha.800","whiteAlpha.700"]:[`${n}.600`,`${n}.500`],bg:"transparent",_hover:{bg:[`${n}.50`,wa(`${n}.600`,.12)(e,t)]},_invalid:{borderColor:[a,a],boxShadow:`0 0 0 1px ${a}`},_focusVisible:{boxShadow:"outline",_invalid:{borderColor:"transparent"}}}},link:({colorScheme:e="gray"})=>({padding:0,height:"auto",lineHeight:"normal",verticalAlign:"baseline",color:[`${e}.600`,`${e}.500`],_hover:{textDecoration:"underline",_disabled:{textDecoration:"none"}},_active:{color:[`${e}.700`,`${e}.600`],_disabled:{color:[`${e}.600`,`${e}.500`]}},_focusVisible:{boxShadow:"outline"},_ripple:{display:"none"}}),ghost:({theme:e,colorMode:t,colorScheme:n="gray",errorBorderColor:r=["danger.500","danger.400"]})=>{const a=lt(r)?sn(_e(r[0],r[0])(e,t),_e(r[1],r[1])(e,t))(t):_e(r,r)(e,t);return{color:Be(n)?["blackAlpha.800","whiteAlpha.700"]:[`${n}.600`,`${n}.500`],bg:"transparent",_hover:{bg:[`${n}.50`,wa(`${n}.600`,.12)(e,t)]},_invalid:{border:"1px solid",borderColor:a,boxShadow:`0 0 0 1px ${a}`},_focusVisible:{borderColor:"transparent",boxShadow:"outline"}}},unstyled:{bg:"none",color:"inherit",display:"inline",lineHeight:"inherit",m:0,p:0,_ripple:{display:"none"}}},sizes:{xs:({theme:e})=>({h:6,minW:6,fontSize:"xs",lineHeight:Ue(e,"sizes.6"),px:2}),sm:({theme:e})=>({h:8,minW:8,fontSize:"sm",lineHeight:Ue(e,"sizes.8"),px:3}),md:({theme:e})=>({h:10,minW:10,fontSize:"md",lineHeight:Ue(e,"sizes.10"),px:4}),lg:({theme:e})=>({h:12,minW:12,fontSize:"lg",lineHeight:Ue(e,"sizes.12"),px:6})},defaultProps:{variant:"solid",size:"md",colorScheme:"gray"}},gte=QM(Kz,{baseStyle:{_hover:{bg:["blackAlpha.100","whiteAlpha.100"]},_active:{bg:["blackAlpha.200","whiteAlpha.200"]}},sizes:{sm:{boxSize:6,fontSize:"2xs"},md:{boxSize:8,fontSize:"xs"},lg:{boxSize:10,fontSize:"md"}},defaultProps:{size:"md"}})({omit:["variants","sizes","defaultProps"]}),yte={baseStyle:{w:"100%",display:"flex",flexDirection:"column",gap:{base:"lg",sm:"md"},p:{base:"lg",sm:"md"}}},bte={baseStyle:{container:{},item:{},button:{transitionProperty:"common",transitionDuration:"normal",_focusVisible:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed"},py:"3",px:"4"},panel:{px:"4",pb:"3"},icon:{ml:"auto",fontSize:"1.25em",color:["blackAlpha.700","whiteAlpha.700"]}},variants:{basic:{item:{borderTopWidth:"1px",borderColor:"inherit",_last:{borderBottomWidth:"1px"}},button:{_hover:{bg:["blackAlpha.50","whiteAlpha.50"],_disabled:{bg:"none"}}}},card:{item:{borderWidth:"1px",rounded:"md",bg:["blackAlpha.50","whiteAlpha.50"],_expanded:{bg:["white","black"]},_notFirst:{mt:"md"}},button:{_hover:{bg:["blackAlpha.100","whiteAlpha.100"],_expanded:{bg:"none"},_disabled:{bg:"none"}}}},unstyled:{}},defaultProps:{variant:"basic"}},vte={baseStyle:{container:{px:4,py:3,rounded:"md"},icon:{flexShrink:0,marginEnd:3,boxSize:5},loading:{flexShrink:0,marginEnd:3,fontSize:"xl"},title:{marginEnd:2,fontWeight:"bold",lineHeight:5},description:{lineHeight:5}},variants:{basic:({theme:e,colorMode:t,colorScheme:n="primary"})=>({container:{bg:["white","black"],borderWidth:"1px"},icon:{color:[vn(`${n}.600`,16)(e,t),`${n}.400`]}}),subtle:({theme:e,colorMode:t,colorScheme:n="primary"})=>({container:{bg:[`${n}.100`,ln(`${n}.300`,58)(e,t)]},icon:{color:[vn(`${n}.600`,16)(e,t),`${n}.400`]}}),solid:({theme:e,colorMode:t,colorScheme:n="primary"})=>({container:{bg:[vn(`${n}.600`,16)(e,t),ln(`${n}.600`,16)(e,t)],color:"white"}}),"island-accent":({theme:e,colorMode:t,colorScheme:n="primary"})=>({container:{bg:["white","black"],borderWidth:"1px",pl:7,_before:{content:'""',position:"absolute",top:"50%",left:3,transform:"translateY(-50%)",w:1,h:"calc(100% - 1.5rem)",bg:[vn(`${n}.600`,16)(e,t),`${n}.400`],rounded:"full"}},icon:{color:[vn(`${n}.600`,16)(e,t),`${n}.400`]}}),"left-accent":({theme:e,colorMode:t,colorScheme:n="primary"})=>({container:{bg:[`${n}.100`,ln(`${n}.300`,58)(e,t)],pl:3,borderLeft:"0.25rem solid",borderLeftColor:[vn(`${n}.600`,16)(e,t),`${n}.400`],rounded:4},icon:{color:[vn(`${n}.600`,16)(e,t),`${n}.400`]}}),"top-accent":({theme:e,colorMode:t,colorScheme:n="primary"})=>({container:{bg:[`${n}.100`,ln(`${n}.300`,58)(e,t)],pt:3,borderTop:"0.25rem solid",borderTopColor:[vn(`${n}.600`,16)(e,t),`${n}.400`],rounded:4},icon:{color:[vn(`${n}.600`,16)(e,t),`${n}.400`]}})},defaultProps:{variant:"basic",colorScheme:"primary"}},xte=Kr(OC)(),wte={baseStyle:{group:{},container:({theme:e,colorMode:t,name:n})=>{const r=n?ZG({string:n}):"blackAlpha.600";return{bg:r,color:a8(r)(e,t)?"white":"black",borderColor:["white","black"],verticalAlign:"top",_loaded:{bg:"inherit"}}},name:{},excess:{borderColor:["white","black"],bg:["blackAlpha.200","whiteAlpha.200"]},badge:{rounded:"full",borderWidth:"0.2em",borderColor:["white","black"]}},sizes:{"2xs":({theme:e})=>({container:{w:"4",h:"4",fontSize:`calc(${Ue(e,"sizes.4")} / 2.5)`},name:{fontSize:`calc(${Ue(e,"sizes.4")} / 2.5)`,lineHeight:Ue(e,"sizes.16")},excess:{w:"4",h:"4"}}),xs:({theme:e})=>({container:{w:"6",h:"6",fontSize:`calc(${Ue(e,"sizes.6")} / 2.5)`},name:{fontSize:`calc(${Ue(e,"sizes.6")} / 2.5)`,lineHeight:Ue(e,"sizes.16")},excess:{w:"6",h:"6"}}),sm:({theme:e})=>({container:{w:"8",h:"8",fontSize:`calc(${Ue(e,"sizes.8")} / 2.5)`},name:{fontSize:`calc(${Ue(e,"sizes.8")} / 2.5)`,lineHeight:Ue(e,"sizes.16")},excess:{w:"8",h:"8"}}),md:({theme:e})=>({container:{w:"12",h:"12",fontSize:`calc(${Ue(e,"sizes.12")} / 2.5)`},name:{fontSize:`calc(${Ue(e,"sizes.12")} / 2.5)`,lineHeight:Ue(e,"sizes.16")},excess:{w:"12",h:"12"}}),lg:({theme:e})=>({container:{w:"16",h:"16",fontSize:`calc(${Ue(e,"sizes.16")} / 2.5)`},name:{fontSize:`calc(${Ue(e,"sizes.16")} / 2.5)`,lineHeight:Ue(e,"sizes.16")},excess:{w:"16",h:"16"}}),xl:({theme:e})=>({container:{w:"24",h:"24",fontSize:`calc(${Ue(e,"sizes.24")} / 2.5)`},name:{fontSize:`calc(${Ue(e,"sizes.24")} / 2.5)`,lineHeight:Ue(e,"sizes.16")},excess:{w:"24",h:"24"}}),"2xl":({theme:e})=>({container:{w:"32",h:"32",fontSize:`calc(${Ue(e,"sizes.32")} / 2.5)`},name:{fontSize:`calc(${Ue(e,"sizes.32")} / 2.5)`,lineHeight:Ue(e,"sizes.16")},excess:{w:"32",h:"32"}})},defaultProps:{size:"md"}},kte={baseStyle:{px:1,textTransform:"uppercase",fontSize:"xs",rounded:"sm",fontWeight:"bold"},variants:{solid:({theme:e,colorMode:t,colorScheme:n="primary"})=>({bg:[vn(`${n}.600`,24)(e,t),ln(`${n}.600`,16)(e,t)],color:"white"}),subtle:({theme:e,colorMode:t,colorScheme:n="primary"})=>({bg:[Be(n)?`${n}.50`:`${n}.100`,ln(`${n}.300`,58)(e,t)],color:[`${n}.800`,Be(n)?`${n}.50`:`${n}.200`]}),outline:({theme:e,colorMode:t,colorScheme:n="primary"})=>{const r=sn(_e(`${n}.500`)(e,t),_e(Be(n)?`${n}.100`:wa(`${n}.400`,.92)(e,t))(e,t))(t);return{color:r,boxShadow:`inset 0 0 0px 1px ${r}`}}},defaultProps:{variant:"subtle",colorScheme:"primary"}},Ste={Indicator:Jee,Accordion:bte,Alert:vte,Autocomplete:xte,Avatar:wte,Badge:kte,Breadcrumb:dte,Button:Kz,Calendar:pte,Card:hte,Carousel:fte,Checkbox:mte,CloseButton:gte,Container:yte,DatePicker:qz,Dialog:ate,Divider:ite,Drawer:ste,Dropzone:ote,Editable:lte,FileInput:ute,FormControl:cte,Heading:Qee,Input:Eu,Kbd:ete,Link:tte,List:nte,Mark:rte,Markdown:Xee,Menu:Hz,Modal:zC,MonthPicker:Yee,MultiAutocomplete:Zee,MultiSelect:PC,NativeSelect:Gz,NumberInput:Wee,Pagination:Vee,PagingTable:Uee,PinInput:jee,Popover:Hee,Progress:Gee,Radio:qee,RangeSlider:Kee,Reorder:Mee,ScrollArea:Oee,SegmentedControl:Pee,Select:OC,NativeTable:Vz,Skeleton:zee,Slider:jz,Stepper:Lee,Switch:Bee,Table:Uz,Tabs:Aee,Tag:Ree,Textarea:Fee,Tooltip:Dee},Ite={initialThemeScheme:"base",initialColorMode:"light",var:{prefix:"ui"}},Cte={colors:{primary:"blue.500",secondary:"violet.500",info:"blue.500",success:"green.500",warning:"orange.500",danger:"red.500",link:"sky.500"},colorSchemes:{primary:"blue",secondary:"violet",info:"blue",success:"green",warning:"orange",danger:"red",link:"sky"}},_te={styles:{globalStyle:Eee,resetStyle:Tee,layerStyles:$ee,textStyles:Nee},semantics:Cte,components:Ste,..._ee},Tte=Ite,Nte=({theme:e=_te,config:t=Tte,disableResetStyle:n,disableGlobalStyle:r,colorModeManager:a,themeSchemeManager:i,environment:s,disableEnvironment:o,children:l})=>z.jsx(lq,{theme:e,config:t,themeSchemeManager:i,children:z.jsx(iq,{colorModeManager:a,config:t,children:z.jsx(EM,{environment:s,disabled:o,children:z.jsxs(jJ,{...t.loading,children:[n?null:z.jsx(cq,{}),r?null:z.jsx(dq,{}),l,z.jsx(lee,{...t.notice})]})})})}),Ete=({value:e,...t})=>{var n;(n=t.onUpdate)!=null||(t.onUpdate=(u,d)=>u!==d);const r=R0(t.onChange),a=R0(t.onUpdate),[i,s]=M.useState(t.defaultValue),o=e!==void 0,l=o?e:i,c=R0(u=>{const d=na(u,l);a(l,d)&&((!o||Dv(d)||AG(d))&&s(d),r(d))},[o,l,r,a]);return[l,c]},$te={enter:({transition:e,transitionEnd:t,delay:n,duration:r,enter:a}={})=>({opacity:1,transition:ZY(e==null?void 0:e.enter)(n,r),transitionEnd:t==null?void 0:t.enter,...a}),exit:({transition:e,transitionEnd:t,delay:n,duration:r,exit:a}={})=>({opacity:0,transition:QY(e==null?void 0:e.exit)(n,r),transitionEnd:t==null?void 0:t.exit,...a})},Ate={initial:"exit",animate:"enter",exit:"exit",variants:$te},Rte=dt(({unmountOnExit:e,isOpen:t,transition:n,transitionEnd:r,delay:a,duration:i,className:s,...o},l)=>{const c=t||e?"enter":"exit",u={transition:n,transitionEnd:r,delay:a,duration:i};t=e?t&&e:!0;const d={w:"100%"};return z.jsx(ox,{custom:u,children:t?z.jsx(at.div,{as:sx.div,ref:l,className:ut("ui-fade",s),custom:u,...Ate,animate:c,__css:d,...o}):null})}),[Fte,Dte]=Iu({strict:!1,name:"ButtonGroupContext"});dt(({className:e,size:t,variant:n,direction:r,isAttached:a,isDisabled:i,gap:s,columnGap:o,rowGap:l,...c},u)=>{const d=r==="column"||r==="column-reverse",p={display:"inline-flex",flexDirection:r},h=M.useMemo(()=>({size:t,variant:n,isDisabled:i}),[t,n,i]);return a?Object.assign(p,{"> *:first-of-type:not(:last-of-type)":d?{borderBottomRadius:0,marginBlockEnd:"-1px"}:{borderRightRadius:0,marginInlineEnd:"-1px"},"> *:not(:first-of-type):not(:last-of-type)":d?{borderRadius:0,marginBlockStart:"-1px"}:{borderRadius:0,marginInlineEnd:"-1px"},"> *:not(:first-of-type):last-of-type":d?{borderTopRadius:0,marginBlockStart:"-1px"}:{borderLeftRadius:0}}):Object.assign(p,{gap:s,columnGap:o,rowGap:l}),z.jsx(Fte,{value:h,children:z.jsx(at.div,{ref:u,role:"group",className:ut("ui-button-group",e),"data-attached":ka(a),__css:p,...c})})});var Xz=dt(({children:e,...t},n)=>{const r=Dte(),[a,i]=sg("Button",{...r,...t}),{className:s,as:o,type:l,isLoading:c,isActive:u,isDisabled:d=r==null?void 0:r.isDisabled,leftIcon:p,rightIcon:h,loadingIcon:f,loadingText:m,loadingPlacement:g="start",disableRipple:y,__css:b,...v}=Ls(i),{ref:x,type:w}=Mte(o),S=KG(n,x),{onPointerDown:C,...T}=zz(v),E=M.useMemo(()=>{var _;const D="_focus"in a?$n((_=a._focus)!=null?_:{},{zIndex:"yamcha"}):{};return{display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"2",appearance:"none",userSelect:"none",position:"relative",whiteSpace:"nowrap",verticalAlign:"middle",overflow:"hidden",outline:"none",...a,...b,...r?{_focus:D}:{}}},[a,b,r]),R={leftIcon:p,rightIcon:h,children:e},$={loadingIcon:f,loadingText:m};return z.jsxs(at.button,{ref:S,as:o,className:ut("ui-button",s),type:l??w,disabled:d||c,"data-active":ka(u),data__loading:ka(c),__css:E,...v,onPointerDown:C,children:[c&&g==="start"?z.jsx(uF,{className:"ui-button__loading--start",...$}):null,c?m||z.jsx(at.span,{opacity:0,children:z.jsx(cF,{...R})}):z.jsx(cF,{...R}),c&&g==="end"?z.jsx(uF,{className:"ui-button__loading--end",...$}):null,z.jsx(Pz,{isDisabled:y||d||c,...T})]})}),uF=({className:e,loadingIcon:t,loadingText:n})=>{const r=M.useMemo(()=>({display:"flex",alignItems:"center",position:n?"relative":"absolute",fontSize:"1em",lineHeight:"normal"}),[n]),a=M.useMemo(()=>typeof t=="string"?z.jsx(Jl,{color:"current",variant:t}):t||z.jsx(Jl,{color:"current"}),[t]);return z.jsx(at.div,{className:ut("ui-button__loading",e),__css:r,children:a})},cF=({leftIcon:e,rightIcon:t,children:n})=>z.jsxs(z.Fragment,{children:[e?z.jsx(dF,{children:e}):null,n,t?z.jsx(dF,{children:t}):null]}),dF=({children:e,className:t,...n})=>z.jsx(at.span,{className:ut("ui-button__icon",t),display:"inline-flex",alignSelf:"center",flexShrink:0,"aria-hidden":!0,...n,children:e}),Mte=e=>{const[t,n]=M.useState(!e);return{ref:M.useCallback(i=>{i&&n(i.tagName==="BUTTON")},[]),type:t?"button":void 0}},Ote=dt(({icon:e,isRounded:t,children:n,className:r,...a},i)=>z.jsx(Xz,{className:ut("ui-icon-button",r),ref:i,p:0,...t?{rounded:"full"}:{},...a,children:e||n})),[Pte,Tx]=Iu({strict:!1,name:"FormControlContext"}),[zte,Nx]=Iu({strict:!1,name:"FormControlStyleContext"});dt(({id:e,...t},n)=>{const[r,a]=Zv("FormControl",t),{className:i,isRequired:s=!1,isDisabled:o=!1,isInvalid:l=!1,isReadOnly:c=!1,isReplace:u=!0,label:d,helperMessage:p,errorMessage:h,children:f,requiredIndicator:m,optionalIndicator:g,...y}=Ls(a);e??(e=M.useId());const[b,v]=M.useState(!1),x=TM(f),[w]=Od(x,pF),[S]=Od(x,hF),[C]=Od(x,fF),T=!!w,E=!!S,R=!!C,$={...r.container};return z.jsx(Pte,{value:{id:e,isFocused:b,isRequired:s,isDisabled:o,isInvalid:l,isReadOnly:c,isReplace:u,onFocus:()=>v(!0),onBlur:()=>v(!1)},children:z.jsx(zte,{value:r,children:z.jsxs(at.div,{ref:n,className:ut("ui-form__control",i),role:"group",__css:$,...y,children:[!T&&d?z.jsx(pF,{requiredIndicator:m,optionalIndicator:g,children:d}):null,f,!E&&p?z.jsx(hF,{children:p}):null,!R&&h?z.jsx(fF,{children:h}):null]})})})});var Lte=({id:e,disabled:t,readOnly:n,required:r,isDisabled:a,isReadOnly:i,isRequired:s,isInvalid:o,onFocus:l,onBlur:c,...u})=>{const d=Tx();return t??(t=a??(d==null?void 0:d.isDisabled)),r??(r=s??(d==null?void 0:d.isRequired)),n??(n=i??(d==null?void 0:d.isReadOnly)),o??(o=d==null?void 0:d.isInvalid),{id:e??(d==null?void 0:d.id),disabled:t,required:r,readOnly:n,"aria-disabled":Ly(t),"aria-readonly":Ly(n),"aria-required":Ly(r),"aria-invalid":Ly(o),onFocus:$o(d==null?void 0:d.onFocus,l),onBlur:$o(d==null?void 0:d.onBlur,c),...t||n?{_hover:{},_active:{},_focus:{},_invalid:{},_focusVisible:{}}:{},...u}},Bte=["disabled","required","readOnly","aria-disabled","aria-readonly","aria-required","aria-invalid","onFocus","onBlur","_hover","_active","_focus","_invalid","_focusVisible"],pF=dt(({className:e,htmlFor:t,isRequired:n,requiredIndicator:r=z.jsx(Wte,{}),optionalIndicator:a=null,children:i,...s},o)=>{var l,c;const{id:u,isRequired:d,isFocused:p,isDisabled:h,isInvalid:f,isReadOnly:m}=(l=Tx())!=null?l:{},g=(c=Nx())!=null?c:{};n??(n=d);const y={display:"block",pointerEvents:m?"none":void 0,...g.label};return z.jsxs(at.label,{ref:o,className:ut("ui-form__label",e),"data-focus":ka(p),"data-disabled":ka(h),"data-readonly":ka(m),"data-invalid":ka(f),htmlFor:t??u,__css:y,style:{cursor:h?"not-allowed":void 0},...s,children:[i,n?r:a]})}),Wte=dt(({className:e,...t},n)=>{var r;const i={...((r=Nx())!=null?r:{}).requiredIndicator};return z.jsx(at.span,{ref:n,className:ut("ui-form__required-indicator",e),role:"presentation","aria-hidden":!0,__css:i,...t,children:"*"})}),hF=dt(({className:e,...t},n)=>{var r,a;const{isInvalid:i,isReplace:s}=(r=Tx())!=null?r:{},o=(a=Nx())!=null?a:{};if(s&&i)return null;const l={...o.helperMessage};return z.jsx(at.div,{ref:n,className:ut("ui-form__helper-message",e),__css:l,...t})}),fF=dt(({className:e,...t},n)=>{var r,a;const{isInvalid:i}=(r=Tx())!=null?r:{},s=(a=Nx())!=null?a:{};if(!i)return null;const o={...s.errorMessage};return z.jsx(at.div,{ref:n,className:ut("ui-form__error-message",e),"aria-live":"polite",__css:o,...t})}),Vte=at("div",{baseStyle:{justifyContent:"center",display:"flex",alignItems:"center"}}),Ute=dt((e,t)=>{const[n,r]=sg("Container",e),{className:a,centerContent:i,...s}=Ls(r),o=M.useMemo(()=>({alignItems:i?"center":void 0,...n}),[i,n]);return z.jsx(at.section,{ref:t,className:ut("ui-container",a),__css:o,...s})}),Yz={exports:{}},jte="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Hte=jte,Gte=Hte;function Zz(){}function Qz(){}Qz.resetWarningCache=Zz;var qte=function(){function e(r,a,i,s,o,l){if(l!==Gte){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Qz,resetWarningCache:Zz};return n.PropTypes=n,n};Yz.exports=qte();var Kte=Yz.exports;const Pt=t2(Kte);var Xte=dt((e,t)=>{const[n,r]=sg("Heading",e),{className:a,...i}=Ls(r);return z.jsx(at.h1,{ref:t,className:ut("ui-heading",a),__css:n,...i})}),Yte=dt((e,t)=>{const[n,r]=sg("Text",e),{className:a,align:i,decoration:s,casing:o,...l}=Ls(r),c=Mv({textAlign:i,textDecoration:s,textTransform:o});return z.jsx(at.p,{ref:t,className:ut("ui-text",a),__css:n,...c,...l})}),Zte=(e,t)=>e!=="loaded"&&t==="beforeLoadOrError"||e==="failed"&&t==="onError",Qte=({loading:e,src:t,srcSet:n,onLoad:r,onError:a,crossOrigin:i,sizes:s,ignoreFallback:o})=>{const[l,c]=M.useState("pending");M.useEffect(()=>{c(t?"loading":"pending")},[t]);const u=M.useRef(),d=M.useCallback(()=>{if(!t)return;p();const h=new Image;h.src=t,i&&(h.crossOrigin=i),n&&(h.srcset=n),s&&(h.sizes=s),e&&(h.loading=e),h.onload=f=>{p(),c("loaded"),r==null||r(f)},h.onerror=f=>{p(),c("failed"),a==null||a(f)},u.current=h},[t,i,n,s,r,a,e]),p=()=>{u.current&&(u.current.onload=null,u.current.onerror=null,u.current=null)};return dm(()=>{if(!o)return l==="loading"&&d(),()=>{p()}},[l,d,o]),o?"loaded":l},Jte=dt((e,t)=>{let{fallback:n,src:r,srcSet:a,loading:i,ignoreFallback:s,crossOrigin:o,className:l,fallbackStrategy:c="beforeLoadOrError",referrerPolicy:u,size:d,fit:p,...h}=e;s=i!=null||s||!n;const f=Qte({...e,crossOrigin:o,ignoreFallback:s}),m=M.useMemo(()=>({boxSize:d,objectFit:p}),[d,p]);return Zte(f,c)?M.isValidElement(n)?n:z.jsx(at.img,{ref:t,className:ut("ui-image--fallback",l),src:n,__css:m,...s?h:Xd(h,["onError","onLoad"])}):z.jsx(at.img,{ref:t,src:r,srcSet:a,crossOrigin:o,loading:i,referrerPolicy:u,className:ut("ui-image",l),__css:m,...s?h:Xd(h,["onError","onLoad"])})}),KS={},mF=FC;KS.createRoot=mF.createRoot,KS.hydrateRoot=mF.hydrateRoot;var ene=Object.defineProperty,tne=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),LC=(e,t)=>{for(var n in t)ene(e,n,{get:t[n],enumerable:!0})},nne={};LC(nne,{Abs:()=>Mp,Acos:()=>Au,Acosh:()=>Ru,AdadeltaOptimizer:()=>iT,AdagradOptimizer:()=>sT,AdamOptimizer:()=>oT,AdamaxOptimizer:()=>lT,Add:()=>Jo,AddN:()=>Fu,All:()=>Op,Any:()=>Pp,ArgMax:()=>zp,ArgMin:()=>Lp,Asin:()=>Du,Asinh:()=>Mu,Atan:()=>Ou,Atan2:()=>zu,Atanh:()=>Pu,AvgPool:()=>Lu,AvgPool3D:()=>Bp,AvgPool3DGrad:()=>bg,AvgPoolGrad:()=>yg,BackendWasm:()=>Bj,BatchMatMul:()=>Bu,BatchToSpaceND:()=>Wp,Bincount:()=>Vp,BitwiseAnd:()=>Up,BroadcastArgs:()=>vg,BroadcastTo:()=>hL,Callback:()=>jW,CallbackList:()=>GB,Cast:()=>Wu,Ceil:()=>Vu,ClipByValue:()=>el,Complex:()=>Fx,ComplexAbs:()=>xg,Concat:()=>jp,Conv2D:()=>Uu,Conv2DBackpropFilter:()=>Dx,Conv2DBackpropInput:()=>ju,Conv3D:()=>Hu,Conv3DBackpropFilterV2:()=>Hp,Conv3DBackpropInputV2:()=>Gp,Cos:()=>Gu,Cosh:()=>qu,CropAndResize:()=>Kp,Cumprod:()=>qp,Cumsum:()=>Ku,CustomCallback:()=>KB,DataStorage:()=>$x,DenseBincount:()=>wg,DepthToSpace:()=>Xp,DepthwiseConv2dNative:()=>Xu,DepthwiseConv2dNativeBackpropFilter:()=>Mx,DepthwiseConv2dNativeBackpropInput:()=>Ox,Diag:()=>kg,Dilation2D:()=>Yu,Dilation2DBackpropFilter:()=>lp,Dilation2DBackpropInput:()=>op,Draw:()=>GC,ENV:()=>jC,EarlyStopping:()=>HW,Einsum:()=>Px,Elu:()=>Qu,EluGrad:()=>Yp,Environment:()=>dL,Equal:()=>Zp,Erf:()=>Ju,Exp:()=>ec,ExpandDims:()=>Qp,Expm1:()=>tc,FFT:()=>zx,Fill:()=>Sg,FlipLeftRight:()=>Jp,Floor:()=>nc,FloorDiv:()=>rc,FromPixels:()=>Zb,FusedBatchNorm:()=>ac,FusedConv2D:()=>su,FusedDepthwiseConv2D:()=>ou,GPGPUContext:()=>ib,GatherNd:()=>th,GatherV2:()=>eh,GraphModel:()=>qN,Greater:()=>nh,GreaterEqual:()=>ic,History:()=>qB,IFFT:()=>Lx,Identity:()=>sc,Imag:()=>Bx,InputSpec:()=>kn,IsFinite:()=>oc,IsInf:()=>lc,IsNan:()=>uc,KernelBackend:()=>mg,LRN:()=>hc,LRNGrad:()=>uh,LayerVariable:()=>LB,LayersModel:()=>Ns,LeakyRelu:()=>cc,Less:()=>rh,LessEqual:()=>ah,LinSpace:()=>ih,Log:()=>dc,Log1p:()=>pc,LogSoftmax:()=>mL,LogicalAnd:()=>sh,LogicalNot:()=>oh,LogicalOr:()=>lh,LogicalXor:()=>fL,LowerBound:()=>qne,MathBackendCPU:()=>G1,MathBackendWebGL:()=>X1,MatrixBandPart:()=>Kne,Max:()=>fc,MaxPool:()=>gc,MaxPool3D:()=>ch,MaxPool3DGrad:()=>Cg,MaxPoolGrad:()=>Ig,MaxPoolWithArgmax:()=>_g,Maximum:()=>mc,Mean:()=>yc,Min:()=>bc,Minimum:()=>vc,MirrorPad:()=>xc,Mod:()=>wc,MomentumOptimizer:()=>uT,Multinomial:()=>dh,Multiply:()=>kc,Neg:()=>ph,NonMaxSuppressionV3:()=>fh,NonMaxSuppressionV4:()=>mh,NonMaxSuppressionV5:()=>gh,NotEqual:()=>hh,OP_SCOPE_SUFFIX:()=>XC,OneHot:()=>Sc,OnesLike:()=>yh,Optimizer:()=>Hs,OptimizerConstructors:()=>kB,Pack:()=>bh,PadV2:()=>Ic,Pool:()=>Xne,Pow:()=>Cc,Prelu:()=>_c,Prod:()=>Tc,RMSPropOptimizer:()=>cT,RNN:()=>as,RaggedGather:()=>Wx,RaggedRange:()=>Vx,RaggedTensorToTensor:()=>Ux,Range:()=>Tg,Rank:()=>ZS,Real:()=>jx,RealDiv:()=>Zu,Reciprocal:()=>Nc,Reduction:()=>wr,Relu:()=>Ec,Relu6:()=>Rc,Reshape:()=>vh,ResizeBilinear:()=>Ac,ResizeBilinearGrad:()=>wh,ResizeNearestNeighbor:()=>$c,ResizeNearestNeighborGrad:()=>xh,Reverse:()=>Fc,RotateWithOffset:()=>Oh,Round:()=>Dc,Rsqrt:()=>Mc,SGDOptimizer:()=>_1,ScatterNd:()=>kh,SearchSorted:()=>Ih,Select:()=>Ch,Selu:()=>Oc,Sequential:()=>xp,Sigmoid:()=>Bc,Sign:()=>Lc,Sin:()=>Pc,Sinh:()=>zc,Slice:()=>_h,Softmax:()=>jc,Softplus:()=>Wc,SpaceToBatchND:()=>Th,SparseFillEmptyRows:()=>Ng,SparseReshape:()=>Eh,SparseSegmentMean:()=>Eg,SparseSegmentSum:()=>$g,SparseToDense:()=>$h,SplitV:()=>Nh,Sqrt:()=>Vc,Square:()=>Ag,SquaredDifference:()=>Hc,StaticRegexReplace:()=>Rg,Step:()=>nl,StridedSlice:()=>Ah,StringNGrams:()=>Fg,StringSplit:()=>Dg,StringToHashBucketFast:()=>Mg,Sub:()=>Gc,Sum:()=>Uc,SymbolicTensor:()=>yi,Tan:()=>qc,Tanh:()=>Kc,Tensor:()=>Ze,TensorBuffer:()=>Sn,TensorScatterUpdate:()=>Sh,Tile:()=>tl,TopK:()=>Rh,Transform:()=>Fh,Transpose:()=>Ts,Unique:()=>Og,Unpack:()=>Dh,UnsortedSegmentSum:()=>Pg,UpperBound:()=>Yne,Variable:()=>lu,ZerosLike:()=>Mh,_FusedMatMul:()=>iu,abs:()=>xn,acos:()=>JC,acosh:()=>e_,add:()=>re,addN:()=>WL,all:()=>Xx,any:()=>jm,argMax:()=>du,argMin:()=>t_,asin:()=>n_,asinh:()=>r_,atan:()=>a_,atan2:()=>i_,atanh:()=>s_,avgPool:()=>Vs,avgPool3d:()=>l_,backend:()=>BL,backend_util:()=>N,basicLSTMCell:()=>HL,batchNorm:()=>Xc,batchNorm2d:()=>u_,batchNorm3d:()=>c_,batchNorm4d:()=>d_,batchToSpaceND:()=>jg,bincount:()=>p_,bitwiseAnd:()=>GL,booleanMaskAsync:()=>O4,broadcastArgs:()=>qL,broadcastTo:()=>Hl,broadcast_util:()=>Ph,browser:()=>ny,buffer:()=>et,callbacks:()=>Rye,cast:()=>he,ceil:()=>h_,clipByValue:()=>hr,clone:()=>Ki,complex:()=>Os,concat:()=>Et,concat1d:()=>f_,concat2d:()=>m_,concat3d:()=>g_,concat4d:()=>y_,constraints:()=>VB,conv1d:()=>Yx,conv2d:()=>_r,conv2dTranspose:()=>Zx,conv3d:()=>v_,conv3dTranspose:()=>x_,copyRegisteredKernels:()=>ere,cos:()=>Hg,cosh:()=>Qx,cosineWindow:()=>w1,cumprod:()=>qm,cumsum:()=>Jx,customGrad:()=>Qi,data:()=>fV,denseBincount:()=>rv,deprecationWarn:()=>LL,depthToSpace:()=>w_,depthwiseConv2d:()=>Yc,deregisterOp:()=>Mye,device_util:()=>Wg,diag:()=>XL,dilation2d:()=>k_,disableDeprecationWarnings:()=>cae,dispose:()=>je,disposeVariables:()=>dae,div:()=>Ie,divNoNan:()=>S_,dot:()=>I_,dropout:()=>eT,einsum:()=>ZL,elu:()=>zh,enableDebugMode:()=>uae,enableProdMode:()=>lae,enclosingPowerOfTwo:()=>tT,engine:()=>Ga,ensureShape:()=>QL,env:()=>Q,equal:()=>pa,erf:()=>C_,euclideanNorm:()=>N_,exp:()=>Tr,expandDims:()=>Qn,expm1:()=>E_,eye:()=>e1,fft:()=>ey,fill:()=>ua,findBackend:()=>bae,findBackendFactory:()=>vae,floor:()=>Bh,floorDiv:()=>Kx,forceHalfFloat:()=>DU,fused:()=>gp,gather:()=>Wh,gatherND:()=>B4,gather_util:()=>hT,getBackend:()=>gae,getGradient:()=>XS,getKernel:()=>Qb,getKernelsForBackend:()=>Jb,getThreadsCount:()=>OLe,gpgpu_util:()=>pU,grad:()=>mse,grads:()=>gse,greater:()=>Rr,greaterEqual:()=>Us,ifft:()=>mp,imag:()=>Gg,image:()=>Ia,inTopKAsync:()=>W4,initializers:()=>UB,input:()=>lW,io:()=>tr,irfft:()=>f1,isFinite:()=>$_,isInf:()=>A_,isNaN:()=>R_,keep:()=>An,kernel_impls:()=>rs,layers:()=>jB,leakyRelu:()=>qg,less:()=>dp,lessEqual:()=>al,linalg:()=>aT,linspace:()=>r4,loadGraphModel:()=>W0e,loadGraphModelSync:()=>V0e,loadLayersModel:()=>Nme,localResponseNormalization:()=>F_,log:()=>ha,log1p:()=>Kg,logSigmoid:()=>D_,logSoftmax:()=>n1,logSumExp:()=>r1,logicalAnd:()=>ri,logicalNot:()=>Xg,logicalOr:()=>a1,logicalXor:()=>M_,losses:()=>J4,lowerBound:()=>i4,matMul:()=>Ye,math:()=>uB,max:()=>$a,maxPool:()=>Ln,maxPool3d:()=>O_,maxPoolWithArgmax:()=>s4,maximum:()=>ns,mean:()=>Jt,memory:()=>nv,meshgrid:()=>o4,metrics:()=>WW,min:()=>cp,minimum:()=>Lo,mirrorPad:()=>P_,mod:()=>z_,model:()=>Ame,models:()=>VW,moments:()=>Yg,movingAverage:()=>P4,mul:()=>j,multiRNNCell:()=>l4,multinomial:()=>u4,neg:()=>Bt,nextFrame:()=>fT,norm:()=>Lh,notEqual:()=>mu,oneHot:()=>pp,ones:()=>ia,onesLike:()=>fa,op:()=>U,outerProduct:()=>c4,pad:()=>Ti,pad1d:()=>d4,pad2d:()=>p4,pad3d:()=>h4,pad4d:()=>f4,pool:()=>L_,pow:()=>Ps,prelu:()=>Qg,print:()=>QC,prod:()=>B_,profile:()=>pae,raggedGather:()=>m4,raggedRange:()=>g4,raggedTensorToTensor:()=>y4,rand:()=>b4,randomGamma:()=>k4,randomNormal:()=>s1,randomStandardNormal:()=>S4,randomUniform:()=>il,randomUniformInt:()=>I4,range:()=>gu,ready:()=>mae,real:()=>hp,reciprocal:()=>H_,registerBackend:()=>qx,registerCallbackConstructor:()=>Fme,registerGradient:()=>gL,registerKernel:()=>zg,registerOp:()=>Dye,regularizers:()=>UW,relu:()=>Ct,relu6:()=>o1,removeBackend:()=>yae,reshape:()=>H,reverse:()=>Da,reverse1d:()=>C4,reverse2d:()=>_4,reverse3d:()=>T4,reverse4d:()=>N4,rfft:()=>ty,round:()=>l1,rsqrt:()=>u1,scalar:()=>Re,scatterND:()=>z4,scatter_util:()=>y1,searchSorted:()=>i1,selu:()=>c1,separableConv2d:()=>Vh,sequential:()=>Rme,serialization:()=>le,setBackend:()=>fae,setPlatform:()=>xae,setThreadsCount:()=>MLe,setWasmPath:()=>FLe,setWasmPaths:()=>DLe,setWebGLContext:()=>O5,setdiff1dAsync:()=>E4,shared:()=>ZN,sigmoid:()=>ei,sign:()=>G_,signal:()=>Q4,sin:()=>d1,sinh:()=>p1,slice:()=>it,slice1d:()=>Jg,slice2d:()=>h1,slice3d:()=>Uh,slice4d:()=>fp,slice_util:()=>Dn,softmax:()=>sl,softplus:()=>Zc,spaceToBatchND:()=>Zg,sparse:()=>eB,sparseToDense:()=>L4,spectral:()=>Z4,split:()=>Wr,sqrt:()=>ar,square:()=>Tt,squaredDifference:()=>m1,squeeze:()=>ol,stack:()=>Fn,step:()=>Qc,stridedSlice:()=>q_,string:()=>tB,sub:()=>we,sum:()=>Te,sumOutType:()=>Gx,tan:()=>K_,tanh:()=>hu,tensor:()=>Ir,tensor1d:()=>It,tensor2d:()=>Xi,tensor3d:()=>g1,tensor4d:()=>Bo,tensor5d:()=>$4,tensor6d:()=>A4,tensorScatterUpdate:()=>F4,tensor_util:()=>xi,test_util:()=>v4,tidy:()=>G,tile:()=>aa,time:()=>hae,topk:()=>Y_,train:()=>_l,transpose:()=>Je,truncatedNormal:()=>v1,unique:()=>Z_,unregisterGradient:()=>Jne,unregisterKernel:()=>Qne,unsortedSegmentSum:()=>x1,unstack:()=>dn,upcastType:()=>Fa,upperBound:()=>D4,util:()=>k,valueAndGrad:()=>yse,valueAndGrads:()=>bse,variable:()=>Q_,variableGrads:()=>a4,version:()=>ULe,version_converter:()=>j0e,version_core:()=>Pce,version_cpu:()=>Vve,version_layers:()=>OT,version_wasm:()=>PLe,version_webgl:()=>ACe,webgl:()=>RCe,webgl_util:()=>M5,where:()=>Hn,whereAsync:()=>J_,zeros:()=>en,zerosLike:()=>st});var rne=Object.create,BC=Object.defineProperty,ane=Object.getOwnPropertyDescriptor,ine=Object.getOwnPropertyNames,sne=Object.getPrototypeOf,one=Object.prototype.hasOwnProperty,Cn=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),He=(e,t)=>{for(var n in t)BC(e,n,{get:t[n],enumerable:!0})},lne=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of ine(t))!one.call(e,a)&&a!==n&&BC(e,a,{get:()=>t[a],enumerable:!(r=ane(t,a))||r.enumerable});return e},Qo=(e,t,n)=>(n=e!=null?rne(sne(e)):{},lne(t||!e||!e.__esModule?BC(n,"default",{value:e,enumerable:!0}):n,e)),une=Cn((e,t)=>{t.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function r(_,D,P){this.low=_|0,this.high=D|0,this.unsigned=!!P}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0});function a(_){return(_&&_.__isLong__)===!0}r.isLong=a;var i={},s={};function o(_,D){var P,B,W;return D?(_>>>=0,(W=0<=_&&_<256)&&(B=s[_],B)?B:(P=c(_,(_|0)<0?-1:0,!0),W&&(s[_]=P),P)):(_|=0,(W=-128<=_&&_<128)&&(B=i[_],B)?B:(P=c(_,_<0?-1:0,!1),W&&(i[_]=P),P))}r.fromInt=o;function l(_,D){if(isNaN(_))return D?x:v;if(D){if(_<0)return x;if(_>=g)return E}else{if(_<=-y)return R;if(_+1>=y)return T}return _<0?l(-_,D).neg():c(_%m|0,_/m|0,D)}r.fromNumber=l;function c(_,D,P){return new r(_,D,P)}r.fromBits=c;var u=Math.pow;function d(_,D,P){if(_.length===0)throw Error("empty string");if(_==="NaN"||_==="Infinity"||_==="+Infinity"||_==="-Infinity")return v;if(typeof D=="number"?(P=D,D=!1):D=!!D,P=P||10,P<2||36<P)throw RangeError("radix");var B;if((B=_.indexOf("-"))>0)throw Error("interior hyphen");if(B===0)return d(_.substring(1),D,P).neg();for(var W=l(u(P,8)),Y=v,O=0;O<_.length;O+=8){var q=Math.min(8,_.length-O),Z=parseInt(_.substring(O,O+q),P);if(q<8){var X=l(u(P,q));Y=Y.mul(X).add(l(Z))}else Y=Y.mul(W),Y=Y.add(l(Z))}return Y.unsigned=D,Y}r.fromString=d;function p(_,D){return typeof _=="number"?l(_,D):typeof _=="string"?d(_,D):c(_.low,_.high,typeof D=="boolean"?D:_.unsigned)}r.fromValue=p;var h=65536,f=1<<24,m=h*h,g=m*m,y=g/2,b=o(f),v=o(0);r.ZERO=v;var x=o(0,!0);r.UZERO=x;var w=o(1);r.ONE=w;var S=o(1,!0);r.UONE=S;var C=o(-1);r.NEG_ONE=C;var T=c(-1,2147483647,!1);r.MAX_VALUE=T;var E=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=E;var R=c(0,-2147483648,!1);r.MIN_VALUE=R;var $=r.prototype;$.toInt=function(){return this.unsigned?this.low>>>0:this.low},$.toNumber=function(){return this.unsigned?(this.high>>>0)*m+(this.low>>>0):this.high*m+(this.low>>>0)},$.toString=function(_){if(_=_||10,_<2||36<_)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(R)){var D=l(_),P=this.div(D),B=P.mul(D).sub(this);return P.toString(_)+B.toInt().toString(_)}else return"-"+this.neg().toString(_);for(var W=l(u(_,6),this.unsigned),Y=this,O="";;){var q=Y.div(W),Z=Y.sub(q.mul(W)).toInt()>>>0,X=Z.toString(_);if(Y=q,Y.isZero())return X+O;for(;X.length<6;)X="0"+X;O=""+X+O}},$.getHighBits=function(){return this.high},$.getHighBitsUnsigned=function(){return this.high>>>0},$.getLowBits=function(){return this.low},$.getLowBitsUnsigned=function(){return this.low>>>0},$.getNumBitsAbs=function(){if(this.isNegative())return this.eq(R)?64:this.neg().getNumBitsAbs();for(var _=this.high!=0?this.high:this.low,D=31;D>0&&!(_&1<<D);D--);return this.high!=0?D+33:D+1},$.isZero=function(){return this.high===0&&this.low===0},$.eqz=$.isZero,$.isNegative=function(){return!this.unsigned&&this.high<0},$.isPositive=function(){return this.unsigned||this.high>=0},$.isOdd=function(){return(this.low&1)===1},$.isEven=function(){return(this.low&1)===0},$.equals=function(_){return a(_)||(_=p(_)),this.unsigned!==_.unsigned&&this.high>>>31===1&&_.high>>>31===1?!1:this.high===_.high&&this.low===_.low},$.eq=$.equals,$.notEquals=function(_){return!this.eq(_)},$.neq=$.notEquals,$.ne=$.notEquals,$.lessThan=function(_){return this.comp(_)<0},$.lt=$.lessThan,$.lessThanOrEqual=function(_){return this.comp(_)<=0},$.lte=$.lessThanOrEqual,$.le=$.lessThanOrEqual,$.greaterThan=function(_){return this.comp(_)>0},$.gt=$.greaterThan,$.greaterThanOrEqual=function(_){return this.comp(_)>=0},$.gte=$.greaterThanOrEqual,$.ge=$.greaterThanOrEqual,$.compare=function(_){if(a(_)||(_=p(_)),this.eq(_))return 0;var D=this.isNegative(),P=_.isNegative();return D&&!P?-1:!D&&P?1:this.unsigned?_.high>>>0>this.high>>>0||_.high===this.high&&_.low>>>0>this.low>>>0?-1:1:this.sub(_).isNegative()?-1:1},$.comp=$.compare,$.negate=function(){return!this.unsigned&&this.eq(R)?R:this.not().add(w)},$.neg=$.negate,$.add=function(_){a(_)||(_=p(_));var D=this.high>>>16,P=this.high&65535,B=this.low>>>16,W=this.low&65535,Y=_.high>>>16,O=_.high&65535,q=_.low>>>16,Z=_.low&65535,X=0,ne=0,te=0,se=0;return se+=W+Z,te+=se>>>16,se&=65535,te+=B+q,ne+=te>>>16,te&=65535,ne+=P+O,X+=ne>>>16,ne&=65535,X+=D+Y,X&=65535,c(te<<16|se,X<<16|ne,this.unsigned)},$.subtract=function(_){return a(_)||(_=p(_)),this.add(_.neg())},$.sub=$.subtract,$.multiply=function(_){if(this.isZero())return v;if(a(_)||(_=p(_)),n){var D=n.mul(this.low,this.high,_.low,_.high);return c(D,n.get_high(),this.unsigned)}if(_.isZero())return v;if(this.eq(R))return _.isOdd()?R:v;if(_.eq(R))return this.isOdd()?R:v;if(this.isNegative())return _.isNegative()?this.neg().mul(_.neg()):this.neg().mul(_).neg();if(_.isNegative())return this.mul(_.neg()).neg();if(this.lt(b)&&_.lt(b))return l(this.toNumber()*_.toNumber(),this.unsigned);var P=this.high>>>16,B=this.high&65535,W=this.low>>>16,Y=this.low&65535,O=_.high>>>16,q=_.high&65535,Z=_.low>>>16,X=_.low&65535,ne=0,te=0,se=0,oe=0;return oe+=Y*X,se+=oe>>>16,oe&=65535,se+=W*X,te+=se>>>16,se&=65535,se+=Y*Z,te+=se>>>16,se&=65535,te+=B*X,ne+=te>>>16,te&=65535,te+=W*Z,ne+=te>>>16,te&=65535,te+=Y*q,ne+=te>>>16,te&=65535,ne+=P*X+B*Z+W*q+Y*O,ne&=65535,c(se<<16|oe,ne<<16|te,this.unsigned)},$.mul=$.multiply,$.divide=function(_){if(a(_)||(_=p(_)),_.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&_.low===-1&&_.high===-1)return this;var D=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,_.low,_.high);return c(D,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?x:v;var P,B,W;if(this.unsigned){if(_.unsigned||(_=_.toUnsigned()),_.gt(this))return x;if(_.gt(this.shru(1)))return S;W=x}else{if(this.eq(R)){if(_.eq(w)||_.eq(C))return R;if(_.eq(R))return w;var Y=this.shr(1);return P=Y.div(_).shl(1),P.eq(v)?_.isNegative()?w:C:(B=this.sub(_.mul(P)),W=P.add(B.div(_)),W)}else if(_.eq(R))return this.unsigned?x:v;if(this.isNegative())return _.isNegative()?this.neg().div(_.neg()):this.neg().div(_).neg();if(_.isNegative())return this.div(_.neg()).neg();W=v}for(B=this;B.gte(_);){P=Math.max(1,Math.floor(B.toNumber()/_.toNumber()));for(var O=Math.ceil(Math.log(P)/Math.LN2),q=O<=48?1:u(2,O-48),Z=l(P),X=Z.mul(_);X.isNegative()||X.gt(B);)P-=q,Z=l(P,this.unsigned),X=Z.mul(_);Z.isZero()&&(Z=w),W=W.add(Z),B=B.sub(X)}return W},$.div=$.divide,$.modulo=function(_){if(a(_)||(_=p(_)),n){var D=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,_.low,_.high);return c(D,n.get_high(),this.unsigned)}return this.sub(this.div(_).mul(_))},$.mod=$.modulo,$.rem=$.modulo,$.not=function(){return c(~this.low,~this.high,this.unsigned)},$.and=function(_){return a(_)||(_=p(_)),c(this.low&_.low,this.high&_.high,this.unsigned)},$.or=function(_){return a(_)||(_=p(_)),c(this.low|_.low,this.high|_.high,this.unsigned)},$.xor=function(_){return a(_)||(_=p(_)),c(this.low^_.low,this.high^_.high,this.unsigned)},$.shiftLeft=function(_){return a(_)&&(_=_.toInt()),(_&=63)===0?this:_<32?c(this.low<<_,this.high<<_|this.low>>>32-_,this.unsigned):c(0,this.low<<_-32,this.unsigned)},$.shl=$.shiftLeft,$.shiftRight=function(_){return a(_)&&(_=_.toInt()),(_&=63)===0?this:_<32?c(this.low>>>_|this.high<<32-_,this.high>>_,this.unsigned):c(this.high>>_-32,this.high>=0?0:-1,this.unsigned)},$.shr=$.shiftRight,$.shiftRightUnsigned=function(_){if(a(_)&&(_=_.toInt()),_&=63,_===0)return this;var D=this.high;if(_<32){var P=this.low;return c(P>>>_|D<<32-_,D>>>_,this.unsigned)}else return _===32?c(D,0,this.unsigned):c(D>>>_-32,0,this.unsigned)},$.shru=$.shiftRightUnsigned,$.shr_u=$.shiftRightUnsigned,$.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},$.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},$.toBytes=function(_){return _?this.toBytesLE():this.toBytesBE()},$.toBytesLE=function(){var _=this.high,D=this.low;return[D&255,D>>>8&255,D>>>16&255,D>>>24,_&255,_>>>8&255,_>>>16&255,_>>>24]},$.toBytesBE=function(){var _=this.high,D=this.low;return[_>>>24,_>>>16&255,_>>>8&255,_&255,D>>>24,D>>>16&255,D>>>8&255,D&255]},r.fromBytes=function(_,D,P){return P?r.fromBytesLE(_,D):r.fromBytesBE(_,D)},r.fromBytesLE=function(_,D){return new r(_[0]|_[1]<<8|_[2]<<16|_[3]<<24,_[4]|_[5]<<8|_[6]<<16|_[7]<<24,D)},r.fromBytesBE=function(_,D){return new r(_[4]<<24|_[5]<<16|_[6]<<8|_[7],_[0]<<24|_[1]<<16|_[2]<<8|_[3],D)}}),cne=Cn(()=>{}),dne=Cn(()=>{}),pne=Cn((e,t)=>{(function(n,r,a){function i(c){var u=this,d=l();u.next=function(){var p=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=p-(u.c=p|0)},u.c=1,u.s0=d(" "),u.s1=d(" "),u.s2=d(" "),u.s0-=d(c),u.s0<0&&(u.s0+=1),u.s1-=d(c),u.s1<0&&(u.s1+=1),u.s2-=d(c),u.s2<0&&(u.s2+=1),d=null}function s(c,u){return u.c=c.c,u.s0=c.s0,u.s1=c.s1,u.s2=c.s2,u}function o(c,u){var d=new i(c),p=u&&u.state,h=d.next;return h.int32=function(){return d.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,p&&(typeof p=="object"&&s(p,d),h.state=function(){return s(d,{})}),h}function l(){var c=4022871197,u=function(d){d=String(d);for(var p=0;p<d.length;p++){c+=d.charCodeAt(p);var h=.02519603282416938*c;c=h>>>0,h-=c,h*=c,c=h>>>0,h-=c,c+=h*4294967296}return(c>>>0)*23283064365386963e-26};return u}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.alea=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),hne=Cn((e,t)=>{(function(n,r,a){function i(l){var c=this,u="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var p=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^p^p>>>8},l===(l|0)?c.x=l:u+=l;for(var d=0;d<u.length+64;d++)c.x^=u.charCodeAt(d)|0,c.next()}function s(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function o(l,c){var u=new i(l),d=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,d&&(typeof d=="object"&&s(d,u),p.state=function(){return s(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.xor128=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),fne=Cn((e,t)=>{(function(n,r,a){function i(l){var c=this,u="";c.next=function(){var p=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(p^p<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(l|0)?c.x=l:u+=l;for(var d=0;d<u.length+64;d++)c.x^=u.charCodeAt(d)|0,d==u.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function s(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function o(l,c){var u=new i(l),d=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,d&&(typeof d=="object"&&s(d,u),p.state=function(){return s(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.xorwow=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),mne=Cn((e,t)=>{(function(n,r,a){function i(l){var c=this;c.next=function(){var d=c.x,p=c.i,h,f;return h=d[p],h^=h>>>7,f=h^h<<24,h=d[p+1&7],f^=h^h>>>10,h=d[p+3&7],f^=h^h>>>3,h=d[p+4&7],f^=h^h<<7,h=d[p+7&7],h=h^h<<13,f^=h^h<<9,d[p]=f,c.i=p+1&7,f};function u(d,p){var h,f=[];if(p===(p|0))f[0]=p;else for(p=""+p,h=0;h<p.length;++h)f[h&7]=f[h&7]<<15^p.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],d.x=f,d.i=0,h=256;h>0;--h)d.next()}u(c,l)}function s(l,c){return c.x=l.x.slice(),c.i=l.i,c}function o(l,c){l==null&&(l=+new Date);var u=new i(l),d=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,d&&(d.x&&s(d,u),p.state=function(){return s(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.xorshift7=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),gne=Cn((e,t)=>{(function(n,r,a){function i(l){var c=this;c.next=function(){var d=c.w,p=c.X,h=c.i,f,m;return c.w=d=d+1640531527|0,m=p[h+34&127],f=p[h=h+1&127],m^=m<<13,f^=f<<17,m^=m>>>15,f^=f>>>12,m=p[h]=m^f,c.i=h,m+(d^d>>>16)|0};function u(d,p){var h,f,m,g,y,b=[],v=128;for(p===(p|0)?(f=p,p=null):(p=p+"\0",f=0,v=Math.max(v,p.length)),m=0,g=-32;g<v;++g)p&&(f^=p.charCodeAt((g+32)%p.length)),g===0&&(y=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,g>=0&&(y=y+1640531527|0,h=b[g&127]^=f+y,m=h==0?m+1:0);for(m>=128&&(b[(p&&p.length||0)&127]=-1),m=127,g=4*128;g>0;--g)f=b[m+34&127],h=b[m=m+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,b[m]=f^h;d.w=y,d.X=b,d.i=m}u(c,l)}function s(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function o(l,c){l==null&&(l=+new Date);var u=new i(l),d=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,d&&(d.X&&s(d,u),p.state=function(){return s(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.xor4096=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),yne=Cn((e,t)=>{(function(n,r,a){function i(l){var c=this,u="";c.next=function(){var p=c.b,h=c.c,f=c.d,m=c.a;return p=p<<25^p>>>7^h,h=h-f|0,f=f<<24^f>>>8^m,m=m-p|0,c.b=p=p<<20^p>>>12^h,c.c=h=h-f|0,c.d=f<<16^h>>>16^m,c.a=m-p|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=l|0):u+=l;for(var d=0;d<u.length+20;d++)c.b^=u.charCodeAt(d)|0,c.next()}function s(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function o(l,c){var u=new i(l),d=c&&c.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(h+f)/(1<<21);while(m===0);return m},p.int32=u.next,p.quick=p,d&&(typeof d=="object"&&s(d,u),p.state=function(){return s(u,{})}),p}r&&r.exports?r.exports=o:a&&a.amd?a(function(){return o}):this.tychei=o})(e,typeof t=="object"&&t,typeof define=="function"&&define)}),bne=Cn(()=>{}),vne=Cn((e,t)=>{(function(n,r,a){var i=256,s=6,o=52,l="random",c=a.pow(i,s),u=a.pow(2,o),d=u*2,p=i-1,h;function f(w,S,C){var T=[];S=S==!0?{entropy:!0}:S||{};var E=b(y(S.entropy?[w,x(r)]:w??v(),3),T),R=new m(T),$=function(){for(var _=R.g(s),D=c,P=0;_<u;)_=(_+P)*i,D*=i,P=R.g(1);for(;_>=d;)_/=2,D/=2,P>>>=1;return(_+P)/D};return $.int32=function(){return R.g(4)|0},$.quick=function(){return R.g(4)/4294967296},$.double=$,b(x(R.S),r),(S.pass||C||function(_,D,P,B){return B&&(B.S&&g(B,R),_.state=function(){return g(R,{})}),P?(a[l]=_,D):_})($,E,"global"in S?S.global:this==a,S.state)}function m(w){var S,C=w.length,T=this,E=0,R=T.i=T.j=0,$=T.S=[];for(C||(w=[C++]);E<i;)$[E]=E++;for(E=0;E<i;E++)$[E]=$[R=p&R+w[E%C]+(S=$[E])],$[R]=S;(T.g=function(_){for(var D,P=0,B=T.i,W=T.j,Y=T.S;_--;)D=Y[B=p&B+1],P=P*i+Y[p&(Y[B]=Y[W=p&W+D])+(Y[W]=D)];return T.i=B,T.j=W,P})(i)}function g(w,S){return S.i=w.i,S.j=w.j,S.S=w.S.slice(),S}function y(w,S){var C=[],T=typeof w,E;if(S&&T=="object")for(E in w)try{C.push(y(w[E],S-1))}catch{}return C.length?C:T=="string"?w:w+"\0"}function b(w,S){for(var C=w+"",T,E=0;E<C.length;)S[p&E]=p&(T^=S[p&E]*19)+C.charCodeAt(E++);return x(S)}function v(){try{var w;return h&&(w=h.randomBytes)?w=w(i):(w=new Uint8Array(i),(n.crypto||n.msCrypto).getRandomValues(w)),x(w)}catch{var S=n.navigator,C=S&&S.plugins;return[+new Date,n,C,n.screen,x(r)]}}function x(w){return String.fromCharCode.apply(0,w)}if(b(a.random(),r),typeof t=="object"&&t.exports){t.exports=f;try{h=bne()}catch{}}else typeof define=="function"&&define.amd?define(function(){return f}):a["seed"+l]=f})(typeof self<"u"?self:e,[],Math)}),Ex=Cn((e,t)=>{var n=pne(),r=hne(),a=fne(),i=mne(),s=gne(),o=yne(),l=vne();l.alea=n,l.xor128=r,l.xorwow=a,l.xorshift7=i,l.xor4096=s,l.tychei=o,t.exports=l}),Jz=Cn(()=>{}),WC=Cn(()=>{}),eL=Cn(()=>{}),xne=Cn(()=>{}),wne=Cn(()=>{}),kne=Cn(()=>{}),Sne=Cn((e,t)=>{var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(a){a=a||{};function i(){return O.buffer!=ue&&Fe(O.buffer),ye}function s(){return O.buffer!=ue&&Fe(O.buffer),de}function o(){return O.buffer!=ue&&Fe(O.buffer),Ce}function l(){return O.buffer!=ue&&Fe(O.buffer),Ae}function c(){return O.buffer!=ue&&Fe(O.buffer),Me}var u=typeof a<"u"?a:{},d,p;u.ready=new Promise(function(L,J){d=L,p=J});var h;typeof process<"u"&&process.listeners&&(h={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var f=Object.assign({},u),m=(L,J)=>{throw J},g=typeof window=="object",y=typeof importScripts=="function",b=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",v=u.ENVIRONMENT_IS_PTHREAD||!1,x="";function w(L){return u.locateFile?u.locateFile(L,x):x+L}var S,C,T;function E(L){L instanceof ls||B("exiting due to exception: "+L)}if(b){var R=WC(),$=eL();y?x=$.dirname(x)+"/":x=__dirname+"/",S=(J,ge)=>(J=qs(J)?new URL(J):$.normalize(J),R.readFileSync(J,ge?void 0:"utf8")),T=J=>{var ge=S(J,!0);return ge.buffer||(ge=new Uint8Array(ge)),ge},C=(J,ge,Le)=>{J=qs(J)?new URL(J):$.normalize(J),R.readFile(J,function(qe,Xe){qe?Le(qe):ge(Xe.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(J){if(!(J instanceof ls))throw J}),process.on("unhandledRejection",function(J){throw J}),m=(J,ge)=>{if(Mt())throw process.exitCode=J,ge;E(ge),process.exit(J)},u.inspect=function(){return"[Emscripten Module object]"};let L;try{L=xne()}catch(J){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),J}global.Worker=L.Worker}else(g||y)&&(y?x=self.location.href:typeof document<"u"&&document.currentScript&&(x=document.currentScript.src),typeof r<"u"&&r&&(x=r),x.indexOf("blob:")!==0?x=x.substr(0,x.replace(/[?#].*/,"").lastIndexOf("/")+1):x="",b||(S=L=>{var J=new XMLHttpRequest;return J.open("GET",L,!1),J.send(null),J.responseText},y&&(T=L=>{var J=new XMLHttpRequest;return J.open("GET",L,!1),J.responseType="arraybuffer",J.send(null),new Uint8Array(J.response)}),C=(L,J,ge)=>{var Le=new XMLHttpRequest;Le.open("GET",L,!0),Le.responseType="arraybuffer",Le.onload=()=>{if(Le.status==200||Le.status==0&&Le.response){J(Le.response);return}ge()},Le.onerror=ge,Le.send(null)}));b&&typeof performance>"u"&&(global.performance=wne().performance);var _=console.log.bind(console),D=console.warn.bind(console);b&&(_=L=>R.writeSync(1,L+`
`),D=L=>R.writeSync(2,L+`
`));var P=u.print||_,B=u.printErr||D;Object.assign(u,f),f=null,u.arguments&&u.arguments,u.thisProgram&&u.thisProgram,u.quit&&(m=u.quit);var W;u.wasmBinary&&(W=u.wasmBinary);var Y=u.noExitRuntime||!0;typeof WebAssembly!="object"&&Dr("no native wasm support detected");var O,q,Z=!1,X;function ne(L,J){L||Dr(J)}var te=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function se(L,J,ge){J>>>=0;for(var Le=J+ge,qe=J;L[qe]&&!(qe>=Le);)++qe;if(qe-J>16&&L.buffer&&te)return te.decode(L.buffer instanceof SharedArrayBuffer?L.slice(J,qe):L.subarray(J,qe));for(var Xe="";J<qe;){var Se=L[J++];if(!(Se&128)){Xe+=String.fromCharCode(Se);continue}var De=L[J++]&63;if((Se&224)==192){Xe+=String.fromCharCode((Se&31)<<6|De);continue}var Zt=L[J++]&63;if((Se&240)==224?Se=(Se&15)<<12|De<<6|Zt:Se=(Se&7)<<18|De<<12|Zt<<6|L[J++]&63,Se<65536)Xe+=String.fromCharCode(Se);else{var ba=Se-65536;Xe+=String.fromCharCode(55296|ba>>10,56320|ba&1023)}}return Xe}function oe(L,J){return L>>>=0,L?se(s(),L,J):""}function fe(L,J,ge,Le){if(ge>>>=0,!(Le>0))return 0;for(var qe=ge,Xe=ge+Le-1,Se=0;Se<L.length;++Se){var De=L.charCodeAt(Se);if(De>=55296&&De<=57343){var Zt=L.charCodeAt(++Se);De=65536+((De&1023)<<10)|Zt&1023}if(De<=127){if(ge>=Xe)break;J[ge++>>>0]=De}else if(De<=2047){if(ge+1>=Xe)break;J[ge++>>>0]=192|De>>6,J[ge++>>>0]=128|De&63}else if(De<=65535){if(ge+2>=Xe)break;J[ge++>>>0]=224|De>>12,J[ge++>>>0]=128|De>>6&63,J[ge++>>>0]=128|De&63}else{if(ge+3>=Xe)break;J[ge++>>>0]=240|De>>18,J[ge++>>>0]=128|De>>12&63,J[ge++>>>0]=128|De>>6&63,J[ge++>>>0]=128|De&63}}return J[ge>>>0]=0,ge-qe}function ce(L,J,ge){return fe(L,s(),J,ge)}var ue,ye,de,Ce,Ae,Me;v&&(ue=u.buffer);function Fe(L){ue=L,u.HEAP8=ye=new Int8Array(L),u.HEAP16=new Int16Array(L),u.HEAP32=Ce=new Int32Array(L),u.HEAPU8=de=new Uint8Array(L),u.HEAPU16=new Uint16Array(L),u.HEAPU32=Ae=new Uint32Array(L),u.HEAPF32=new Float32Array(L),u.HEAPF64=Me=new Float64Array(L)}var Ge=u.INITIAL_MEMORY||16777216;if(v)O=u.wasmMemory,ue=u.buffer;else if(u.wasmMemory)O=u.wasmMemory;else if(O=new WebAssembly.Memory({initial:Ge/65536,maximum:65536,shared:!0}),!(O.buffer instanceof SharedArrayBuffer))throw B("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),b&&B("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");O&&(ue=O.buffer),Ge=ue.byteLength,Fe(ue);var ze,nt=[],vt=[],Kn=[];function Mt(){return Y}function ve(){if(u.preRun)for(typeof u.preRun=="function"&&(u.preRun=[u.preRun]);u.preRun.length;)St(u.preRun.shift());Ot(nt)}function Pe(){!v&&Ot(vt)}function ot(){if(!v){if(u.postRun)for(typeof u.postRun=="function"&&(u.postRun=[u.postRun]);u.postRun.length;)yn(u.postRun.shift());Ot(Kn)}}function St(L){nt.unshift(L)}function Ft(L){vt.unshift(L)}function yn(L){Kn.unshift(L)}var Yt=0,or=null;function La(L){Yt++,u.monitorRunDependencies&&u.monitorRunDependencies(Yt)}function ui(L){if(Yt--,u.monitorRunDependencies&&u.monitorRunDependencies(Yt),Yt==0&&or){var J=or;or=null,J()}}function Dr(L){u.onAbort&&u.onAbort(L),L="Aborted("+L+")",B(L),Z=!0,X=1,L+=". Build with -sASSERTIONS for more info.";var J=new WebAssembly.RuntimeError(L);throw p(J),J}var os="data:application/octet-stream;base64,";function Ba(L){return L.startsWith(os)}function qs(L){return L.startsWith("file://")}var Xn;Xn="tfjs-backend-wasm-threaded-simd.wasm",Ba(Xn)||(Xn=w(Xn));function Sy(L){try{if(L==Xn&&W)return new Uint8Array(W);if(T)return T(L);throw"both async and sync fetching of the wasm failed"}catch(J){Dr(J)}}function Iy(){if(!W&&(g||y)){if(typeof fetch=="function"&&!qs(Xn))return fetch(Xn,{credentials:"same-origin"}).then(function(L){if(!L.ok)throw"failed to load wasm binary file at '"+Xn+"'";return L.arrayBuffer()}).catch(function(){return Sy(Xn)});if(C)return new Promise(function(L,J){C(Xn,function(ge){L(new Uint8Array(ge))},J)})}return Promise.resolve().then(function(){return Sy(Xn)})}function Cy(){var L={env:o$,wasi_snapshot_preview1:o$};function J(Se,De){var Zt=Se.exports;if(u.asm=Zt,us(u.asm._emscripten_tls_init),ze=u.asm.__indirect_function_table,Ft(u.asm.__wasm_call_ctors),q=De,!v){var ba=ke.unusedWorkers.length;ke.unusedWorkers.forEach(function(cs){ke.loadWasmModuleToWorker(cs,function(){--ba||ui()})})}}v||La();function ge(Se){J(Se.instance,Se.module)}function Le(Se){return Iy().then(function(De){return WebAssembly.instantiate(De,L)}).then(function(De){return De}).then(Se,function(De){B("failed to asynchronously prepare wasm: "+De),Dr(De)})}function qe(){return!W&&typeof WebAssembly.instantiateStreaming=="function"&&!Ba(Xn)&&!qs(Xn)&&!b&&typeof fetch=="function"?fetch(Xn,{credentials:"same-origin"}).then(function(Se){var De=WebAssembly.instantiateStreaming(Se,L);return De.then(ge,function(Zt){return B("wasm streaming compile failed: "+Zt),B("falling back to ArrayBuffer instantiation"),Le(ge)})}):Le(ge)}if(u.instantiateWasm)try{var Xe=u.instantiateWasm(L,J);return Xe}catch(Se){B("Module.instantiateWasm callback failed with error: "+Se),p(Se)}return qe().catch(p),{}}var _y={};function ls(L){this.name="ExitStatus",this.message="Program terminated with exit("+L+")",this.status=L}function od(L){var J=ke.pthreads[L];delete ke.pthreads[L],J.terminate(),sw(L),ke.runningWorkers.splice(ke.runningWorkers.indexOf(J),1),J.pthread_ptr=0}function Ty(L){var J=ke.pthreads[L];J.postMessage({cmd:"cancel"})}function ml(L){var J=ke.pthreads[L];ne(J),ke.returnWorkerToPool(J)}function gl(L){var J=ke.getNewWorker();if(!J)return 6;ke.runningWorkers.push(J),ke.pthreads[L.pthread_ptr]=J,J.pthread_ptr=L.pthread_ptr;var ge={cmd:"run",start_routine:L.startRoutine,arg:L.arg,pthread_ptr:L.pthread_ptr};return J.runPthread=()=>{b&&J.ref(),J.postMessage(ge,L.transferList),delete J.runPthread},J.loaded&&J.runPthread(),0}function Ny(L){if(v)return ld(1,1,L);X=L,Mt()||(ke.terminateAllThreads(),u.onExit&&u.onExit(L),Z=!0),m(L,new ls(L))}function ie(L,J){if(X=L,!J&&v)throw rt(L),"unwind";Ny(L)}var me=ie;function Oe(L){if(L instanceof ls||L=="unwind")return X;m(1,L)}var ke={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],pthreads:{},init:function(){v?ke.initWorker():ke.initMainThread()},initMainThread:function(){for(var L=8;L--;)ke.allocateUnusedWorker()},initWorker:function(){Y=!1},setExitStatus:function(L){X=L},terminateAllThreads:function(){for(var L of Object.values(ke.pthreads))ke.returnWorkerToPool(L);for(var L of ke.unusedWorkers)L.terminate();ke.unusedWorkers=[]},returnWorkerToPool:function(L){var J=L.pthread_ptr;delete ke.pthreads[J],ke.unusedWorkers.push(L),ke.runningWorkers.splice(ke.runningWorkers.indexOf(L),1),L.pthread_ptr=0,b&&L.unref(),sw(J)},receiveObjectTransfer:function(L){},threadInitTLS:function(){ke.tlsInitFunctions.forEach(L=>L())},loadWasmModuleToWorker:function(L,J){L.onmessage=Xe=>{var Se=Xe.data,De=Se.cmd;if(L.pthread_ptr&&(ke.currentProxiedOperationCallerThread=L.pthread_ptr),Se.targetThread&&Se.targetThread!=Ry()){var Zt=ke.pthreads[Se.targetThread];Zt?Zt.postMessage(Se,Se.transferList):B('Internal error! Worker sent a message "'+De+'" to target pthread '+Se.targetThread+", but that thread no longer exists!"),ke.currentProxiedOperationCallerThread=void 0;return}De==="processProxyingQueue"?rw(Se.queue):De==="spawnThread"?gl(Se):De==="cleanupThread"?ml(Se.thread):De==="killThread"?od(Se.thread):De==="cancelThread"?Ty(Se.thread):De==="loaded"?(L.loaded=!0,b&&L.unref(),J&&J(L),L.runPthread&&L.runPthread()):De==="print"?P("Thread "+Se.threadId+": "+Se.text):De==="printErr"?B("Thread "+Se.threadId+": "+Se.text):De==="alert"?alert("Thread "+Se.threadId+": "+Se.text):Se.target==="setimmediate"?L.postMessage(Se):De==="callHandler"?u[Se.handler](...Se.args):De&&B("worker sent an unknown command "+De),ke.currentProxiedOperationCallerThread=void 0},L.onerror=Xe=>{var Se="worker sent an error!";throw B(Se+" "+Xe.filename+":"+Xe.lineno+": "+Xe.message),Xe},b&&(L.on("message",function(Xe){L.onmessage({data:Xe})}),L.on("error",function(Xe){L.onerror(Xe)}),L.on("detachedExit",function(){}));var ge=[],Le=["onExit","onAbort","print","printErr"];for(var qe of Le)u.hasOwnProperty(qe)&&ge.push(qe);L.postMessage({cmd:"load",handlers:ge,urlOrBlob:u.mainScriptUrlOrBlob||r,wasmMemory:O,wasmModule:q})},allocateUnusedWorker:function(){var L,J=w("tfjs-backend-wasm-threaded-simd.worker.js");L=new Worker(J),ke.unusedWorkers.push(L)},getNewWorker:function(){return ke.unusedWorkers.length==0&&(ke.allocateUnusedWorker(),ke.loadWasmModuleToWorker(ke.unusedWorkers[0])),ke.unusedWorkers.pop()}};u.PThread=ke;function Ot(L){for(;L.length>0;)L.shift()(u)}function jt(){var L=Ry(),J=o()[L+52>>>2],ge=o()[L+56>>>2],Le=J-ge;p$(J,Le),Fy(J)}u.establishStackSpace=jt;function rt(L){if(v)return ld(2,0,L);try{me(L)}catch(J){Oe(J)}}var Ke=[];function bn(L){var J=Ke[L];return J||(L>=Ke.length&&(Ke.length=L+1),Ke[L]=J=ze.get(L)),J}function ya(L,J){var ge=bn(L)(J);Mt()?ke.setExitStatus(ge):d$(ge)}u.invokeEntryPoint=ya;function us(L){ke.tlsInitFunctions.push(L)}function Ey(L){l$(L,!y,1,!g),ke.threadInitTLS()}function sf(L){v?postMessage({cmd:"cleanupThread",thread:L}):ml(L)}function $y(L,J,ge,Le){return v?ld(3,1,L,J,ge,Le):mr(L,J,ge,Le)}function mr(L,J,ge,Le){if(typeof SharedArrayBuffer>"u")return B("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var qe=[],Xe=0;if(v&&(qe.length===0||Xe))return $y(L,J,ge,Le);var Se={startRoutine:ge,pthread_ptr:L,arg:Le,transferList:qe};return v?(Se.cmd="spawnThread",postMessage(Se,qe),0):gl(Se)}function Ks(){return 65536}var Ay=!0;function WH(){return Ay}function rw(L){Atomics.store(o(),L>>2,1),Ry()&&c$(L),Atomics.compareExchange(o(),L>>2,1,0)}u.executeNotifiedProxyingQueue=rw;function VH(L,J,ge,Le){if(L==J)setTimeout(()=>rw(Le));else if(v)postMessage({targetThread:L,cmd:"processProxyingQueue",queue:Le});else{var qe=ke.pthreads[L];if(!qe)return;qe.postMessage({cmd:"processProxyingQueue",queue:Le})}return 1}function UH(L,J,ge){return-1}function jH(){Dr("")}function of(L){of.shown||(of.shown={}),of.shown[L]||(of.shown[L]=1,b&&(L="warning: "+L),B(L))}function HH(){b||y||of("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")}function GH(){return Date.now()}function n$(){return 4294901760}function qH(){return n$()}var aw;b?aw=()=>{var L=process.hrtime();return L[0]*1e3+L[1]/1e6}:aw=()=>performance.timeOrigin+performance.now();function KH(L,J,ge){s().copyWithin(L>>>0,J>>>0,J+ge>>>0)}function XH(){return b?kne().cpus().length:navigator.hardwareConcurrency}function YH(L){var J=ow(),ge=L();return Fy(J),ge}function ld(L,J){var ge=arguments.length-2,Le=arguments;return YH(()=>{for(var qe=ge,Xe=Dy(qe*8),Se=Xe>>3,De=0;De<ge;De++){var Zt=Le[2+De];c()[Se+De>>>0]=Zt}return u$(L,qe,Xe,J)})}var iw=[];function ZH(L,J,ge){iw.length=J;for(var Le=ge>>3,qe=0;qe<J;qe++)iw[qe]=c()[Le+qe>>>0];var Xe=L<0,Se=Xe?_y[-L-1]:sG[L];return Se.apply(null,iw)}function QH(L){try{return O.grow(L-ue.byteLength+65535>>>16),Fe(O.buffer),1}catch{}}function JH(L){var J=s().length;if(L=L>>>0,L<=J)return!1;var ge=n$();if(L>ge)return!1;let Le=(Zt,ba)=>Zt+(ba-Zt%ba)%ba;for(var qe=1;qe<=4;qe*=2){var Xe=J*(1+.2/qe);Xe=Math.min(Xe,L+100663296);var Se=Math.min(ge,Le(Math.max(L,Xe),65536)),De=QH(Se);if(De)return!0}return!1}function eG(){throw"unwind"}function r$(L){return v?ld(4,1,L):52}function a$(L,J,ge,Le,qe){return v?ld(5,1,L,J,ge,Le,qe):70}var tG=[null,[],[]];function nG(L,J){var ge=tG[L];J===0||J===10?((L===1?P:B)(se(ge,0)),ge.length=0):ge.push(J)}function i$(L,J,ge,Le){if(v)return ld(6,1,L,J,ge,Le);for(var qe=0,Xe=0;Xe<ge;Xe++){var Se=l()[J>>>2],De=l()[J+4>>>2];J+=8;for(var Zt=0;Zt<De;Zt++)nG(L,s()[Se+Zt>>>0]);qe+=De}return l()[Le>>>2]=qe,0}function s$(L){var J=u["_"+L];return J}function rG(L,J){i().set(L,J>>>0)}function aG(L,J,ge,Le,qe){var Xe={string:va=>{var ud=0;if(va!=null&&va!==0){var m$=(va.length<<2)+1;ud=Dy(m$),ce(va,ud,m$)}return ud},array:va=>{var ud=Dy(va.length);return rG(va,ud),ud}};function Se(va){return J==="string"?oe(va):J==="boolean"?!!va:va}var De=s$(L),Zt=[],ba=0;if(Le)for(var cs=0;cs<Le.length;cs++){var f$=Xe[ge[cs]];f$?(ba===0&&(ba=ow()),Zt[cs]=f$(Le[cs])):Zt[cs]=Le[cs]}var lw=De.apply(null,Zt);function lG(va){return ba!==0&&Fy(ba),Se(va)}return lw=lG(lw),lw}function iG(L,J,ge,Le){ge=ge||[];var qe=ge.every(Se=>Se==="number"||Se==="boolean"),Xe=J!=="string";return Xe&&qe&&!Le?s$(L):function(){return aG(L,J,ge,arguments)}}ke.init();var sG=[null,Ny,rt,$y,r$,a$,i$],o$={__emscripten_init_main_thread_js:Ey,__emscripten_thread_cleanup:sf,__pthread_create_js:mr,_emscripten_default_pthread_stack_size:Ks,_emscripten_get_now_is_monotonic:WH,_emscripten_notify_task_queue:VH,_emscripten_set_offscreencanvas_size:UH,abort:jH,emscripten_check_blocking_allowed:HH,emscripten_date_now:GH,emscripten_get_heap_max:qH,emscripten_get_now:aw,emscripten_memcpy_big:KH,emscripten_num_logical_cores:XH,emscripten_receive_on_main_thread_js:ZH,emscripten_resize_heap:JH,emscripten_unwind_to_js_event_loop:eG,exit:me,fd_close:r$,fd_seek:a$,fd_write:i$,memory:O||u.wasmMemory};Cy(),u.___wasm_call_ctors=function(){return(u.___wasm_call_ctors=u.asm.__wasm_call_ctors).apply(null,arguments)},u._init=function(){return(u._init=u.asm.init).apply(null,arguments)},u._init_with_threads_count=function(){return(u._init_with_threads_count=u.asm.init_with_threads_count).apply(null,arguments)},u._get_threads_count=function(){return(u._get_threads_count=u.asm.get_threads_count).apply(null,arguments)},u._register_tensor=function(){return(u._register_tensor=u.asm.register_tensor).apply(null,arguments)},u._dispose_data=function(){return(u._dispose_data=u.asm.dispose_data).apply(null,arguments)},u._dispose=function(){return(u._dispose=u.asm.dispose).apply(null,arguments)},u._Abs=function(){return(u._Abs=u.asm.Abs).apply(null,arguments)},u._Acos=function(){return(u._Acos=u.asm.Acos).apply(null,arguments)},u._Acosh=function(){return(u._Acosh=u.asm.Acosh).apply(null,arguments)},u._Add=function(){return(u._Add=u.asm.Add).apply(null,arguments)},u._AddN=function(){return(u._AddN=u.asm.AddN).apply(null,arguments)},u._All=function(){return(u._All=u.asm.All).apply(null,arguments)},u._Any=function(){return(u._Any=u.asm.Any).apply(null,arguments)},u._ArgMax=function(){return(u._ArgMax=u.asm.ArgMax).apply(null,arguments)},u._ArgMin=function(){return(u._ArgMin=u.asm.ArgMin).apply(null,arguments)},u._Asin=function(){return(u._Asin=u.asm.Asin).apply(null,arguments)},u._Asinh=function(){return(u._Asinh=u.asm.Asinh).apply(null,arguments)},u._Atan=function(){return(u._Atan=u.asm.Atan).apply(null,arguments)},u._Atan2=function(){return(u._Atan2=u.asm.Atan2).apply(null,arguments)},u._Atanh=function(){return(u._Atanh=u.asm.Atanh).apply(null,arguments)},u._AvgPool=function(){return(u._AvgPool=u.asm.AvgPool).apply(null,arguments)},u._AvgPool3D=function(){return(u._AvgPool3D=u.asm.AvgPool3D).apply(null,arguments)},u._AvgPool3DGrad=function(){return(u._AvgPool3DGrad=u.asm.AvgPool3DGrad).apply(null,arguments)},u._AvgPoolGrad=function(){return(u._AvgPoolGrad=u.asm.AvgPoolGrad).apply(null,arguments)},u._BatchMatMul=function(){return(u._BatchMatMul=u.asm.BatchMatMul).apply(null,arguments)},u._Bincount=function(){return(u._Bincount=u.asm.Bincount).apply(null,arguments)},u._BitwiseAnd=function(){return(u._BitwiseAnd=u.asm.BitwiseAnd).apply(null,arguments)},u._Ceil=function(){return(u._Ceil=u.asm.Ceil).apply(null,arguments)},u._ClipByValue=function(){return(u._ClipByValue=u.asm.ClipByValue).apply(null,arguments)},u._Conv2D=function(){return(u._Conv2D=u.asm.Conv2D).apply(null,arguments)},u._Conv2DBackpropInput=function(){return(u._Conv2DBackpropInput=u.asm.Conv2DBackpropInput).apply(null,arguments)},u._Conv3D=function(){return(u._Conv3D=u.asm.Conv3D).apply(null,arguments)},u._Conv3DBackpropFilterV2=function(){return(u._Conv3DBackpropFilterV2=u.asm.Conv3DBackpropFilterV2).apply(null,arguments)},u._Conv3DBackpropInputV2=function(){return(u._Conv3DBackpropInputV2=u.asm.Conv3DBackpropInputV2).apply(null,arguments)},u._Cos=function(){return(u._Cos=u.asm.Cos).apply(null,arguments)},u._Cosh=function(){return(u._Cosh=u.asm.Cosh).apply(null,arguments)},u._CropAndResize=function(){return(u._CropAndResize=u.asm.CropAndResize).apply(null,arguments)},u._Cumprod=function(){return(u._Cumprod=u.asm.Cumprod).apply(null,arguments)},u._Cumsum=function(){return(u._Cumsum=u.asm.Cumsum).apply(null,arguments)},u._DenseBincount=function(){return(u._DenseBincount=u.asm.DenseBincount).apply(null,arguments)},u._DepthToSpace=function(){return(u._DepthToSpace=u.asm.DepthToSpace).apply(null,arguments)},u._DepthwiseConv2dNative=function(){return(u._DepthwiseConv2dNative=u.asm.DepthwiseConv2dNative).apply(null,arguments)},u._Diag=function(){return(u._Diag=u.asm.Diag).apply(null,arguments)},u._Dilation2D=function(){return(u._Dilation2D=u.asm.Dilation2D).apply(null,arguments)},u._Dilation2DBackpropFilter=function(){return(u._Dilation2DBackpropFilter=u.asm.Dilation2DBackpropFilter).apply(null,arguments)},u._Dilation2DBackpropInput=function(){return(u._Dilation2DBackpropInput=u.asm.Dilation2DBackpropInput).apply(null,arguments)},u._Elu=function(){return(u._Elu=u.asm.Elu).apply(null,arguments)},u._EluGrad=function(){return(u._EluGrad=u.asm.EluGrad).apply(null,arguments)},u._Equal=function(){return(u._Equal=u.asm.Equal).apply(null,arguments)},u._Erf=function(){return(u._Erf=u.asm.Erf).apply(null,arguments)},u._Exp=function(){return(u._Exp=u.asm.Exp).apply(null,arguments)},u._Expm1=function(){return(u._Expm1=u.asm.Expm1).apply(null,arguments)},u._FlipLeftRight=function(){return(u._FlipLeftRight=u.asm.FlipLeftRight).apply(null,arguments)},u._Floor=function(){return(u._Floor=u.asm.Floor).apply(null,arguments)},u._FloorDiv=function(){return(u._FloorDiv=u.asm.FloorDiv).apply(null,arguments)},u._FusedBatchNorm=function(){return(u._FusedBatchNorm=u.asm.FusedBatchNorm).apply(null,arguments)},u._FusedConv2D=function(){return(u._FusedConv2D=u.asm.FusedConv2D).apply(null,arguments)},u._FusedDepthwiseConv2D=function(){return(u._FusedDepthwiseConv2D=u.asm.FusedDepthwiseConv2D).apply(null,arguments)},u._Gather=function(){return(u._Gather=u.asm.Gather).apply(null,arguments)},u._GatherNd=function(){return(u._GatherNd=u.asm.GatherNd).apply(null,arguments)},u._Greater=function(){return(u._Greater=u.asm.Greater).apply(null,arguments)},u._GreaterEqual=function(){return(u._GreaterEqual=u.asm.GreaterEqual).apply(null,arguments)},u._IsFinite=function(){return(u._IsFinite=u.asm.IsFinite).apply(null,arguments)},u._IsInf=function(){return(u._IsInf=u.asm.IsInf).apply(null,arguments)},u._IsNan=function(){return(u._IsNan=u.asm.IsNan).apply(null,arguments)},u._LRN=function(){return(u._LRN=u.asm.LRN).apply(null,arguments)},u._LRNGrad=function(){return(u._LRNGrad=u.asm.LRNGrad).apply(null,arguments)},u._LeakyRelu=function(){return(u._LeakyRelu=u.asm.LeakyRelu).apply(null,arguments)},u._Less=function(){return(u._Less=u.asm.Less).apply(null,arguments)},u._LessEqual=function(){return(u._LessEqual=u.asm.LessEqual).apply(null,arguments)},u._LinSpace=function(){return(u._LinSpace=u.asm.LinSpace).apply(null,arguments)},u._Log=function(){return(u._Log=u.asm.Log).apply(null,arguments)},u._Log1p=function(){return(u._Log1p=u.asm.Log1p).apply(null,arguments)},u._LogicalAnd=function(){return(u._LogicalAnd=u.asm.LogicalAnd).apply(null,arguments)},u._LogicalNot=function(){return(u._LogicalNot=u.asm.LogicalNot).apply(null,arguments)},u._LogicalOr=function(){return(u._LogicalOr=u.asm.LogicalOr).apply(null,arguments)},u._LogicalXor=function(){return(u._LogicalXor=u.asm.LogicalXor).apply(null,arguments)},u._Max=function(){return(u._Max=u.asm.Max).apply(null,arguments)},u._MaxPool=function(){return(u._MaxPool=u.asm.MaxPool).apply(null,arguments)},u._MaxPool3D=function(){return(u._MaxPool3D=u.asm.MaxPool3D).apply(null,arguments)},u._MaxPool3DGrad=function(){return(u._MaxPool3DGrad=u.asm.MaxPool3DGrad).apply(null,arguments)},u._MaxPoolGrad=function(){return(u._MaxPoolGrad=u.asm.MaxPoolGrad).apply(null,arguments)},u._MaxPoolWithArgmax=function(){return(u._MaxPoolWithArgmax=u.asm.MaxPoolWithArgmax).apply(null,arguments)},u._Maximum=function(){return(u._Maximum=u.asm.Maximum).apply(null,arguments)},u._Mean=function(){return(u._Mean=u.asm.Mean).apply(null,arguments)},u._Min=function(){return(u._Min=u.asm.Min).apply(null,arguments)},u._Minimum=function(){return(u._Minimum=u.asm.Minimum).apply(null,arguments)},u._MirrorPad=function(){return(u._MirrorPad=u.asm.MirrorPad).apply(null,arguments)},u._Mod=function(){return(u._Mod=u.asm.Mod).apply(null,arguments)},u._Multinomial=function(){return(u._Multinomial=u.asm.Multinomial).apply(null,arguments)},u._Multiply=function(){return(u._Multiply=u.asm.Multiply).apply(null,arguments)},u._Neg=function(){return(u._Neg=u.asm.Neg).apply(null,arguments)},u._NonMaxSuppressionV3=function(){return(u._NonMaxSuppressionV3=u.asm.NonMaxSuppressionV3).apply(null,arguments)},u._NonMaxSuppressionV4=function(){return(u._NonMaxSuppressionV4=u.asm.NonMaxSuppressionV4).apply(null,arguments)},u._NonMaxSuppressionV5=function(){return(u._NonMaxSuppressionV5=u.asm.NonMaxSuppressionV5).apply(null,arguments)},u._NotEqual=function(){return(u._NotEqual=u.asm.NotEqual).apply(null,arguments)},u._OneHot=function(){return(u._OneHot=u.asm.OneHot).apply(null,arguments)},u._PadV2=function(){return(u._PadV2=u.asm.PadV2).apply(null,arguments)},u._Pow=function(){return(u._Pow=u.asm.Pow).apply(null,arguments)},u._Prelu=function(){return(u._Prelu=u.asm.Prelu).apply(null,arguments)},u._Prod=function(){return(u._Prod=u.asm.Prod).apply(null,arguments)},u._RealDiv=function(){return(u._RealDiv=u.asm.RealDiv).apply(null,arguments)},u._Reciprocal=function(){return(u._Reciprocal=u.asm.Reciprocal).apply(null,arguments)},u._Relu=function(){return(u._Relu=u.asm.Relu).apply(null,arguments)},u._Relu6=function(){return(u._Relu6=u.asm.Relu6).apply(null,arguments)},u._ResizeBilinear=function(){return(u._ResizeBilinear=u.asm.ResizeBilinear).apply(null,arguments)},u._ResizeBilinearGrad=function(){return(u._ResizeBilinearGrad=u.asm.ResizeBilinearGrad).apply(null,arguments)},u._ResizeNearestNeighbor=function(){return(u._ResizeNearestNeighbor=u.asm.ResizeNearestNeighbor).apply(null,arguments)},u._ResizeNearestNeighborGrad=function(){return(u._ResizeNearestNeighborGrad=u.asm.ResizeNearestNeighborGrad).apply(null,arguments)},u._Reverse=function(){return(u._Reverse=u.asm.Reverse).apply(null,arguments)},u._RotateWithOffset=function(){return(u._RotateWithOffset=u.asm.RotateWithOffset).apply(null,arguments)},u._Round=function(){return(u._Round=u.asm.Round).apply(null,arguments)},u._Rsqrt=function(){return(u._Rsqrt=u.asm.Rsqrt).apply(null,arguments)},u._ScatterNd=function(){return(u._ScatterNd=u.asm.ScatterNd).apply(null,arguments)},u._SearchSorted=function(){return(u._SearchSorted=u.asm.SearchSorted).apply(null,arguments)},u._SelectV2=function(){return(u._SelectV2=u.asm.SelectV2).apply(null,arguments)},u._Selu=function(){return(u._Selu=u.asm.Selu).apply(null,arguments)},u._Sigmoid=function(){return(u._Sigmoid=u.asm.Sigmoid).apply(null,arguments)},u._Sign=function(){return(u._Sign=u.asm.Sign).apply(null,arguments)},u._Sin=function(){return(u._Sin=u.asm.Sin).apply(null,arguments)},u._Sinh=function(){return(u._Sinh=u.asm.Sinh).apply(null,arguments)},u._Softmax=function(){return(u._Softmax=u.asm.Softmax).apply(null,arguments)},u._Softplus=function(){return(u._Softplus=u.asm.Softplus).apply(null,arguments)},u._SparseFillEmptyRows=function(){return(u._SparseFillEmptyRows=u.asm.SparseFillEmptyRows).apply(null,arguments)},u._SparseReshape=function(){return(u._SparseReshape=u.asm.SparseReshape).apply(null,arguments)},u._SparseSegmentReduction=function(){return(u._SparseSegmentReduction=u.asm.SparseSegmentReduction).apply(null,arguments)},u._SparseToDense=function(){return(u._SparseToDense=u.asm.SparseToDense).apply(null,arguments)},u._Sqrt=function(){return(u._Sqrt=u.asm.Sqrt).apply(null,arguments)},u._Square=function(){return(u._Square=u.asm.Square).apply(null,arguments)},u._SquaredDifference=function(){return(u._SquaredDifference=u.asm.SquaredDifference).apply(null,arguments)},u._Step=function(){return(u._Step=u.asm.Step).apply(null,arguments)},u._StridedSlice=function(){return(u._StridedSlice=u.asm.StridedSlice).apply(null,arguments)},u._Sub=function(){return(u._Sub=u.asm.Sub).apply(null,arguments)},u._Sum=function(){return(u._Sum=u.asm.Sum).apply(null,arguments)},u._Tan=function(){return(u._Tan=u.asm.Tan).apply(null,arguments)},u._Tanh=function(){return(u._Tanh=u.asm.Tanh).apply(null,arguments)},u._TensorScatterUpdate=function(){return(u._TensorScatterUpdate=u.asm.TensorScatterUpdate).apply(null,arguments)},u._Tile=function(){return(u._Tile=u.asm.Tile).apply(null,arguments)},u._TopK=function(){return(u._TopK=u.asm.TopK).apply(null,arguments)},u._Transform=function(){return(u._Transform=u.asm.Transform).apply(null,arguments)},u._Transpose=function(){return(u._Transpose=u.asm.Transpose).apply(null,arguments)},u.__FusedMatMul=function(){return(u.__FusedMatMul=u.asm._FusedMatMul).apply(null,arguments)},u._malloc=function(){return(u._malloc=u.asm.malloc).apply(null,arguments)},u._free=function(){return(u._free=u.asm.free).apply(null,arguments)},u.__emscripten_tls_init=function(){return(u.__emscripten_tls_init=u.asm._emscripten_tls_init).apply(null,arguments)};var Ry=u._pthread_self=function(){return(Ry=u._pthread_self=u.asm.pthread_self).apply(null,arguments)};u.___errno_location=function(){return(u.___errno_location=u.asm.__errno_location).apply(null,arguments)};var l$=u.__emscripten_thread_init=function(){return(l$=u.__emscripten_thread_init=u.asm._emscripten_thread_init).apply(null,arguments)};u.__emscripten_thread_crashed=function(){return(u.__emscripten_thread_crashed=u.asm._emscripten_thread_crashed).apply(null,arguments)},u._emscripten_main_thread_process_queued_calls=function(){return(u._emscripten_main_thread_process_queued_calls=u.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)},u._emscripten_main_browser_thread_id=function(){return(u._emscripten_main_browser_thread_id=u.asm.emscripten_main_browser_thread_id).apply(null,arguments)};var u$=u._emscripten_run_in_main_runtime_thread_js=function(){return(u$=u._emscripten_run_in_main_runtime_thread_js=u.asm.emscripten_run_in_main_runtime_thread_js).apply(null,arguments)};u._emscripten_dispatch_to_thread_=function(){return(u._emscripten_dispatch_to_thread_=u.asm.emscripten_dispatch_to_thread_).apply(null,arguments)};var c$=u.__emscripten_proxy_execute_task_queue=function(){return(c$=u.__emscripten_proxy_execute_task_queue=u.asm._emscripten_proxy_execute_task_queue).apply(null,arguments)},sw=u.__emscripten_thread_free_data=function(){return(sw=u.__emscripten_thread_free_data=u.asm._emscripten_thread_free_data).apply(null,arguments)},d$=u.__emscripten_thread_exit=function(){return(d$=u.__emscripten_thread_exit=u.asm._emscripten_thread_exit).apply(null,arguments)},p$=u._emscripten_stack_set_limits=function(){return(p$=u._emscripten_stack_set_limits=u.asm.emscripten_stack_set_limits).apply(null,arguments)},ow=u.stackSave=function(){return(ow=u.stackSave=u.asm.stackSave).apply(null,arguments)},Fy=u.stackRestore=function(){return(Fy=u.stackRestore=u.asm.stackRestore).apply(null,arguments)},Dy=u.stackAlloc=function(){return(Dy=u.stackAlloc=u.asm.stackAlloc).apply(null,arguments)};u.dynCall_iijjiiii=function(){return(u.dynCall_iijjiiii=u.asm.dynCall_iijjiiii).apply(null,arguments)},u.dynCall_jiji=function(){return(u.dynCall_jiji=u.asm.dynCall_jiji).apply(null,arguments)},u.keepRuntimeAlive=Mt,u.wasmMemory=O,u.cwrap=iG,u.ExitStatus=ls,u.PThread=ke;var My;or=function L(){My||h$(),My||(or=L)};function h$(L){if(Yt>0)return;if(v){d(u),Pe(),startWorker(u);return}if(ve(),Yt>0)return;function J(){My||(My=!0,u.calledRun=!0,!Z&&(Pe(),d(u),u.onRuntimeInitialized&&u.onRuntimeInitialized(),ot()))}u.setStatus?(u.setStatus("Running..."),setTimeout(function(){setTimeout(function(){u.setStatus("")},1),J()},1)):J()}if(u.preInit)for(typeof u.preInit=="function"&&(u.preInit=[u.preInit]);u.preInit.length>0;)u.preInit.pop()();h$();var Oy;h&&(Oy={uncaughtException:process.listeners("uncaughtException").filter(function(L){return!h.uncaughtException.indexOf(L)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(L){return!h.unhandledRejection.indexOf(L)>-1})});var Py;if(typeof WasmBackendModule<"u")Py=WasmBackendModule;else if(typeof a<"u")Py=a;else throw new Error("Could not find wasm module in post.js");if(Oy){var oG=Py._dispose;Py._dispose=function(){oG(),Oy.uncaughtException.forEach(function(L){process.removeListener("uncaughtException",L)}),Oy.unhandledRejection.forEach(function(L){process.removeListener("unhandledRejection",L)})}}return a.ready}})();typeof e=="object"&&typeof t=="object"?t.exports=n:typeof define=="function"&&define.amd?define([],function(){return n}):typeof e=="object"&&(e.WasmBackendModuleThreadedSimd=n)}),Ine=Cn((e,t)=>{t.exports.wasmWorkerContents=`"use strict";var Module={};var ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads");var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",data=>onmessage({data:data}));var fs=require("fs");Object.assign(global,{self:global,require:require,Module:Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:function(f){(0,eval)(fs.readFileSync(f,"utf8")+"//# sourceURL="+f)},postMessage:function(msg){parentPort.postMessage(msg)},performance:global.performance||{now:function(){return Date.now()}}})}var initializedJS=false;var pendingNotifiedProxyingQueues=[];function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,text+"
");return}console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;self.alert=threadAlert;Module["instantiateWasm"]=(info,receiveInstance)=>{var instance=new WebAssembly.Instance(Module["wasmModule"],info);receiveInstance(instance);Module["wasmModule"]=null;return instance.exports};self.onunhandledrejection=e=>{throw e.reason??e};self.startWorker=instance=>{Module=instance;postMessage({"cmd":"loaded"})};self.onmessage=e=>{try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;for(const handler of e.data.handlers){Module[handler]=function(){postMessage({cmd:"callHandler",handler:handler,args:[...arguments]})}}Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob=="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module)}else if(e.data.cmd==="run"){Module["__emscripten_thread_init"](e.data.pthread_ptr,0,0,1);Module["establishStackSpace"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].threadInitTLS();if(!initializedJS){pendingNotifiedProxyingQueues.forEach(queue=>{Module["executeNotifiedProxyingQueue"](queue)});pendingNotifiedProxyingQueues=[];initializedJS=true}try{Module["invokeEntryPoint"](e.data.start_routine,e.data.arg)}catch(ex){if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["keepRuntimeAlive"]()){}else{Module["__emscripten_thread_exit"](ex.status)}}else{throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["__emscripten_thread_exit"](-1)}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processProxyingQueue"){if(initializedJS){Module["executeNotifiedProxyingQueue"](e.data.queue)}else{pendingNotifiedProxyingQueues.push(e.data.queue)}}else if(e.data.cmd){err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){if(Module["__emscripten_thread_crashed"]){Module["__emscripten_thread_crashed"]()}throw ex}};`}),Cne=Cn((e,t)=>{var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(a){a=a||{};var i=typeof a<"u"?a:{},s,o;i.ready=new Promise(function(ie,me){s=ie,o=me});var l;typeof process<"u"&&process.listeners&&(l={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var c=Object.assign({},i),u=typeof window=="object",d=typeof importScripts=="function",p=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",h="";function f(ie){return i.locateFile?i.locateFile(ie,h):h+ie}var m,g,y;if(p){var b=WC(),v=eL();d?h=v.dirname(h)+"/":h=__dirname+"/",m=(ie,me)=>(ie=Ge(ie)?new URL(ie):v.normalize(ie),b.readFileSync(ie,me?void 0:"utf8")),y=ie=>{var me=m(ie,!0);return me.buffer||(me=new Uint8Array(me)),me},g=(ie,me,Oe)=>{ie=Ge(ie)?new URL(ie):v.normalize(ie),b.readFile(ie,function(ke,Ot){ke?Oe(ke):me(Ot.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(ie){if(!(ie instanceof Mt))throw ie}),process.on("unhandledRejection",function(ie){throw ie}),i.inspect=function(){return"[Emscripten Module object]"}}else(u||d)&&(d?h=self.location.href:typeof document<"u"&&document.currentScript&&(h=document.currentScript.src),r&&(h=r),h.indexOf("blob:")!==0?h=h.substr(0,h.replace(/[?#].*/,"").lastIndexOf("/")+1):h="",m=ie=>{var me=new XMLHttpRequest;return me.open("GET",ie,!1),me.send(null),me.responseText},d&&(y=ie=>{var me=new XMLHttpRequest;return me.open("GET",ie,!1),me.responseType="arraybuffer",me.send(null),new Uint8Array(me.response)}),g=(ie,me,Oe)=>{var ke=new XMLHttpRequest;ke.open("GET",ie,!0),ke.responseType="arraybuffer",ke.onload=()=>{if(ke.status==200||ke.status==0&&ke.response){me(ke.response);return}Oe()},ke.onerror=Oe,ke.send(null)});var x=i.print||console.log.bind(console),w=i.printErr||console.warn.bind(console);Object.assign(i,c),c=null,i.arguments&&i.arguments,i.thisProgram&&i.thisProgram,i.quit&&i.quit;var S;i.wasmBinary&&(S=i.wasmBinary),i.noExitRuntime,typeof WebAssembly!="object"&&Ae("no native wasm support detected");var C,T=!1,E=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function R(ie,me,Oe){me>>>=0;for(var ke=me+Oe,Ot=me;ie[Ot]&&!(Ot>=ke);)++Ot;if(Ot-me>16&&ie.buffer&&E)return E.decode(ie.subarray(me,Ot));for(var jt="";me<Ot;){var rt=ie[me++];if(!(rt&128)){jt+=String.fromCharCode(rt);continue}var Ke=ie[me++]&63;if((rt&224)==192){jt+=String.fromCharCode((rt&31)<<6|Ke);continue}var bn=ie[me++]&63;if((rt&240)==224?rt=(rt&15)<<12|Ke<<6|bn:rt=(rt&7)<<18|Ke<<12|bn<<6|ie[me++]&63,rt<65536)jt+=String.fromCharCode(rt);else{var ya=rt-65536;jt+=String.fromCharCode(55296|ya>>10,56320|ya&1023)}}return jt}function $(ie,me){return ie>>>=0,ie?R(W,ie,me):""}function _(ie,me,Oe,ke){if(Oe>>>=0,!(ke>0))return 0;for(var Ot=Oe,jt=Oe+ke-1,rt=0;rt<ie.length;++rt){var Ke=ie.charCodeAt(rt);if(Ke>=55296&&Ke<=57343){var bn=ie.charCodeAt(++rt);Ke=65536+((Ke&1023)<<10)|bn&1023}if(Ke<=127){if(Oe>=jt)break;me[Oe++>>>0]=Ke}else if(Ke<=2047){if(Oe+1>=jt)break;me[Oe++>>>0]=192|Ke>>6,me[Oe++>>>0]=128|Ke&63}else if(Ke<=65535){if(Oe+2>=jt)break;me[Oe++>>>0]=224|Ke>>12,me[Oe++>>>0]=128|Ke>>6&63,me[Oe++>>>0]=128|Ke&63}else{if(Oe+3>=jt)break;me[Oe++>>>0]=240|Ke>>18,me[Oe++>>>0]=128|Ke>>12&63,me[Oe++>>>0]=128|Ke>>6&63,me[Oe++>>>0]=128|Ke&63}}return me[Oe>>>0]=0,Oe-Ot}function D(ie,me,Oe){return _(ie,W,me,Oe)}var P,B,W,Y;function O(ie){P=ie,i.HEAP8=B=new Int8Array(ie),i.HEAP16=new Int16Array(ie),i.HEAP32=new Int32Array(ie),i.HEAPU8=W=new Uint8Array(ie),i.HEAPU16=new Uint16Array(ie),i.HEAPU32=Y=new Uint32Array(ie),i.HEAPF32=new Float32Array(ie),i.HEAPF64=new Float64Array(ie)}i.INITIAL_MEMORY;var q=[],Z=[],X=[];function ne(){if(i.preRun)for(typeof i.preRun=="function"&&(i.preRun=[i.preRun]);i.preRun.length;)oe(i.preRun.shift());ve(q)}function te(){ve(Z)}function se(){if(i.postRun)for(typeof i.postRun=="function"&&(i.postRun=[i.postRun]);i.postRun.length;)ce(i.postRun.shift());ve(X)}function oe(ie){q.unshift(ie)}function fe(ie){Z.unshift(ie)}function ce(ie){X.unshift(ie)}var ue=0,ye=null;function de(ie){ue++,i.monitorRunDependencies&&i.monitorRunDependencies(ue)}function Ce(ie){if(ue--,i.monitorRunDependencies&&i.monitorRunDependencies(ue),ue==0&&ye){var me=ye;ye=null,me()}}function Ae(ie){i.onAbort&&i.onAbort(ie),ie="Aborted("+ie+")",w(ie),T=!0,ie+=". Build with -sASSERTIONS for more info.";var me=new WebAssembly.RuntimeError(ie);throw o(me),me}var Me="data:application/octet-stream;base64,";function Fe(ie){return ie.startsWith(Me)}function Ge(ie){return ie.startsWith("file://")}var ze;ze="tfjs-backend-wasm.wasm",Fe(ze)||(ze=f(ze));function nt(ie){try{if(ie==ze&&S)return new Uint8Array(S);if(y)return y(ie);throw"both async and sync fetching of the wasm failed"}catch(me){Ae(me)}}function vt(){if(!S&&(u||d)){if(typeof fetch=="function"&&!Ge(ze))return fetch(ze,{credentials:"same-origin"}).then(function(ie){if(!ie.ok)throw"failed to load wasm binary file at '"+ze+"'";return ie.arrayBuffer()}).catch(function(){return nt(ze)});if(g)return new Promise(function(ie,me){g(ze,function(Oe){ie(new Uint8Array(Oe))},me)})}return Promise.resolve().then(function(){return nt(ze)})}function Kn(){var ie={env:Iy,wasi_snapshot_preview1:Iy};function me(rt,Ke){var bn=rt.exports;i.asm=bn,C=i.asm.memory,O(C.buffer),i.asm.__indirect_function_table,fe(i.asm.__wasm_call_ctors),Ce()}de();function Oe(rt){me(rt.instance)}function ke(rt){return vt().then(function(Ke){return WebAssembly.instantiate(Ke,ie)}).then(function(Ke){return Ke}).then(rt,function(Ke){w("failed to asynchronously prepare wasm: "+Ke),Ae(Ke)})}function Ot(){return!S&&typeof WebAssembly.instantiateStreaming=="function"&&!Fe(ze)&&!Ge(ze)&&!p&&typeof fetch=="function"?fetch(ze,{credentials:"same-origin"}).then(function(rt){var Ke=WebAssembly.instantiateStreaming(rt,ie);return Ke.then(Oe,function(bn){return w("wasm streaming compile failed: "+bn),w("falling back to ArrayBuffer instantiation"),ke(Oe)})}):ke(Oe)}if(i.instantiateWasm)try{var jt=i.instantiateWasm(ie,me);return jt}catch(rt){w("Module.instantiateWasm callback failed with error: "+rt),o(rt)}return Ot().catch(o),{}}function Mt(ie){this.name="ExitStatus",this.message="Program terminated with exit("+ie+")",this.status=ie}function ve(ie){for(;ie.length>0;)ie.shift()(i)}function Pe(){Ae("")}function ot(){return 4294901760}function St(){return ot()}function Ft(ie,me,Oe){W.copyWithin(ie>>>0,me>>>0,me+Oe>>>0)}function yn(ie){try{return C.grow(ie-P.byteLength+65535>>>16),O(C.buffer),1}catch{}}function Yt(ie){var me=W.length;ie=ie>>>0;var Oe=ot();if(ie>Oe)return!1;let ke=(bn,ya)=>bn+(ya-bn%ya)%ya;for(var Ot=1;Ot<=4;Ot*=2){var jt=me*(1+.2/Ot);jt=Math.min(jt,ie+100663296);var rt=Math.min(Oe,ke(Math.max(ie,jt),65536)),Ke=yn(rt);if(Ke)return!0}return!1}function or(ie){return 52}function La(ie,me,Oe,ke,Ot){return 70}var ui=[null,[],[]];function Dr(ie,me){var Oe=ui[ie];me===0||me===10?((ie===1?x:w)(R(Oe,0)),Oe.length=0):Oe.push(me)}function os(ie,me,Oe,ke){for(var Ot=0,jt=0;jt<Oe;jt++){var rt=Y[me>>>2],Ke=Y[me+4>>>2];me+=8;for(var bn=0;bn<Ke;bn++)Dr(ie,W[rt+bn>>>0]);Ot+=Ke}return Y[ke>>>2]=Ot,0}function Ba(ie){var me=i["_"+ie];return me}function qs(ie,me){B.set(ie,me>>>0)}function Xn(ie,me,Oe,ke,Ot){var jt={string:mr=>{var Ks=0;if(mr!=null&&mr!==0){var Ay=(mr.length<<2)+1;Ks=ls(Ay),D(mr,Ks,Ay)}return Ks},array:mr=>{var Ks=ls(mr.length);return qs(mr,Ks),Ks}};function rt(mr){return me==="string"?$(mr):me==="boolean"?!!mr:mr}var Ke=Ba(ie),bn=[],ya=0;if(ke)for(var us=0;us<ke.length;us++){var Ey=jt[Oe[us]];Ey?(ya===0&&(ya=Cy()),bn[us]=Ey(ke[us])):bn[us]=ke[us]}var sf=Ke.apply(null,bn);function $y(mr){return ya!==0&&_y(ya),rt(mr)}return sf=$y(sf),sf}function Sy(ie,me,Oe,ke){Oe=Oe||[];var Ot=Oe.every(rt=>rt==="number"||rt==="boolean"),jt=me!=="string";return jt&&Ot&&!ke?Ba(ie):function(){return Xn(ie,me,Oe,arguments)}}var Iy={abort:Pe,emscripten_get_heap_max:St,emscripten_memcpy_big:Ft,emscripten_resize_heap:Yt,fd_close:or,fd_seek:La,fd_write:os};Kn(),i.___wasm_call_ctors=function(){return(i.___wasm_call_ctors=i.asm.__wasm_call_ctors).apply(null,arguments)},i._init=function(){return(i._init=i.asm.init).apply(null,arguments)},i._init_with_threads_count=function(){return(i._init_with_threads_count=i.asm.init_with_threads_count).apply(null,arguments)},i._get_threads_count=function(){return(i._get_threads_count=i.asm.get_threads_count).apply(null,arguments)},i._register_tensor=function(){return(i._register_tensor=i.asm.register_tensor).apply(null,arguments)},i._dispose_data=function(){return(i._dispose_data=i.asm.dispose_data).apply(null,arguments)},i._dispose=function(){return(i._dispose=i.asm.dispose).apply(null,arguments)},i._Abs=function(){return(i._Abs=i.asm.Abs).apply(null,arguments)},i._Acos=function(){return(i._Acos=i.asm.Acos).apply(null,arguments)},i._Acosh=function(){return(i._Acosh=i.asm.Acosh).apply(null,arguments)},i._Add=function(){return(i._Add=i.asm.Add).apply(null,arguments)},i._AddN=function(){return(i._AddN=i.asm.AddN).apply(null,arguments)},i._All=function(){return(i._All=i.asm.All).apply(null,arguments)},i._Any=function(){return(i._Any=i.asm.Any).apply(null,arguments)},i._ArgMax=function(){return(i._ArgMax=i.asm.ArgMax).apply(null,arguments)},i._ArgMin=function(){return(i._ArgMin=i.asm.ArgMin).apply(null,arguments)},i._Asin=function(){return(i._Asin=i.asm.Asin).apply(null,arguments)},i._Asinh=function(){return(i._Asinh=i.asm.Asinh).apply(null,arguments)},i._Atan=function(){return(i._Atan=i.asm.Atan).apply(null,arguments)},i._Atan2=function(){return(i._Atan2=i.asm.Atan2).apply(null,arguments)},i._Atanh=function(){return(i._Atanh=i.asm.Atanh).apply(null,arguments)},i._AvgPool=function(){return(i._AvgPool=i.asm.AvgPool).apply(null,arguments)},i._AvgPool3D=function(){return(i._AvgPool3D=i.asm.AvgPool3D).apply(null,arguments)},i._AvgPool3DGrad=function(){return(i._AvgPool3DGrad=i.asm.AvgPool3DGrad).apply(null,arguments)},i._AvgPoolGrad=function(){return(i._AvgPoolGrad=i.asm.AvgPoolGrad).apply(null,arguments)},i._BatchMatMul=function(){return(i._BatchMatMul=i.asm.BatchMatMul).apply(null,arguments)},i._Bincount=function(){return(i._Bincount=i.asm.Bincount).apply(null,arguments)},i._BitwiseAnd=function(){return(i._BitwiseAnd=i.asm.BitwiseAnd).apply(null,arguments)},i._Ceil=function(){return(i._Ceil=i.asm.Ceil).apply(null,arguments)},i._ClipByValue=function(){return(i._ClipByValue=i.asm.ClipByValue).apply(null,arguments)},i._Conv2D=function(){return(i._Conv2D=i.asm.Conv2D).apply(null,arguments)},i._Conv2DBackpropInput=function(){return(i._Conv2DBackpropInput=i.asm.Conv2DBackpropInput).apply(null,arguments)},i._Conv3D=function(){return(i._Conv3D=i.asm.Conv3D).apply(null,arguments)},i._Conv3DBackpropFilterV2=function(){return(i._Conv3DBackpropFilterV2=i.asm.Conv3DBackpropFilterV2).apply(null,arguments)},i._Conv3DBackpropInputV2=function(){return(i._Conv3DBackpropInputV2=i.asm.Conv3DBackpropInputV2).apply(null,arguments)},i._Cos=function(){return(i._Cos=i.asm.Cos).apply(null,arguments)},i._Cosh=function(){return(i._Cosh=i.asm.Cosh).apply(null,arguments)},i._CropAndResize=function(){return(i._CropAndResize=i.asm.CropAndResize).apply(null,arguments)},i._Cumprod=function(){return(i._Cumprod=i.asm.Cumprod).apply(null,arguments)},i._Cumsum=function(){return(i._Cumsum=i.asm.Cumsum).apply(null,arguments)},i._DenseBincount=function(){return(i._DenseBincount=i.asm.DenseBincount).apply(null,arguments)},i._DepthToSpace=function(){return(i._DepthToSpace=i.asm.DepthToSpace).apply(null,arguments)},i._DepthwiseConv2dNative=function(){return(i._DepthwiseConv2dNative=i.asm.DepthwiseConv2dNative).apply(null,arguments)},i._Diag=function(){return(i._Diag=i.asm.Diag).apply(null,arguments)},i._Dilation2D=function(){return(i._Dilation2D=i.asm.Dilation2D).apply(null,arguments)},i._Dilation2DBackpropFilter=function(){return(i._Dilation2DBackpropFilter=i.asm.Dilation2DBackpropFilter).apply(null,arguments)},i._Dilation2DBackpropInput=function(){return(i._Dilation2DBackpropInput=i.asm.Dilation2DBackpropInput).apply(null,arguments)},i._Elu=function(){return(i._Elu=i.asm.Elu).apply(null,arguments)},i._EluGrad=function(){return(i._EluGrad=i.asm.EluGrad).apply(null,arguments)},i._Equal=function(){return(i._Equal=i.asm.Equal).apply(null,arguments)},i._Erf=function(){return(i._Erf=i.asm.Erf).apply(null,arguments)},i._Exp=function(){return(i._Exp=i.asm.Exp).apply(null,arguments)},i._Expm1=function(){return(i._Expm1=i.asm.Expm1).apply(null,arguments)},i._FlipLeftRight=function(){return(i._FlipLeftRight=i.asm.FlipLeftRight).apply(null,arguments)},i._Floor=function(){return(i._Floor=i.asm.Floor).apply(null,arguments)},i._FloorDiv=function(){return(i._FloorDiv=i.asm.FloorDiv).apply(null,arguments)},i._FusedBatchNorm=function(){return(i._FusedBatchNorm=i.asm.FusedBatchNorm).apply(null,arguments)},i._FusedConv2D=function(){return(i._FusedConv2D=i.asm.FusedConv2D).apply(null,arguments)},i._FusedDepthwiseConv2D=function(){return(i._FusedDepthwiseConv2D=i.asm.FusedDepthwiseConv2D).apply(null,arguments)},i._Gather=function(){return(i._Gather=i.asm.Gather).apply(null,arguments)},i._GatherNd=function(){return(i._GatherNd=i.asm.GatherNd).apply(null,arguments)},i._Greater=function(){return(i._Greater=i.asm.Greater).apply(null,arguments)},i._GreaterEqual=function(){return(i._GreaterEqual=i.asm.GreaterEqual).apply(null,arguments)},i._IsFinite=function(){return(i._IsFinite=i.asm.IsFinite).apply(null,arguments)},i._IsInf=function(){return(i._IsInf=i.asm.IsInf).apply(null,arguments)},i._IsNan=function(){return(i._IsNan=i.asm.IsNan).apply(null,arguments)},i._LRN=function(){return(i._LRN=i.asm.LRN).apply(null,arguments)},i._LRNGrad=function(){return(i._LRNGrad=i.asm.LRNGrad).apply(null,arguments)},i._LeakyRelu=function(){return(i._LeakyRelu=i.asm.LeakyRelu).apply(null,arguments)},i._Less=function(){return(i._Less=i.asm.Less).apply(null,arguments)},i._LessEqual=function(){return(i._LessEqual=i.asm.LessEqual).apply(null,arguments)},i._LinSpace=function(){return(i._LinSpace=i.asm.LinSpace).apply(null,arguments)},i._Log=function(){return(i._Log=i.asm.Log).apply(null,arguments)},i._Log1p=function(){return(i._Log1p=i.asm.Log1p).apply(null,arguments)},i._LogicalAnd=function(){return(i._LogicalAnd=i.asm.LogicalAnd).apply(null,arguments)},i._LogicalNot=function(){return(i._LogicalNot=i.asm.LogicalNot).apply(null,arguments)},i._LogicalOr=function(){return(i._LogicalOr=i.asm.LogicalOr).apply(null,arguments)},i._LogicalXor=function(){return(i._LogicalXor=i.asm.LogicalXor).apply(null,arguments)},i._Max=function(){return(i._Max=i.asm.Max).apply(null,arguments)},i._MaxPool=function(){return(i._MaxPool=i.asm.MaxPool).apply(null,arguments)},i._MaxPool3D=function(){return(i._MaxPool3D=i.asm.MaxPool3D).apply(null,arguments)},i._MaxPool3DGrad=function(){return(i._MaxPool3DGrad=i.asm.MaxPool3DGrad).apply(null,arguments)},i._MaxPoolGrad=function(){return(i._MaxPoolGrad=i.asm.MaxPoolGrad).apply(null,arguments)},i._MaxPoolWithArgmax=function(){return(i._MaxPoolWithArgmax=i.asm.MaxPoolWithArgmax).apply(null,arguments)},i._Maximum=function(){return(i._Maximum=i.asm.Maximum).apply(null,arguments)},i._Mean=function(){return(i._Mean=i.asm.Mean).apply(null,arguments)},i._Min=function(){return(i._Min=i.asm.Min).apply(null,arguments)},i._Minimum=function(){return(i._Minimum=i.asm.Minimum).apply(null,arguments)},i._MirrorPad=function(){return(i._MirrorPad=i.asm.MirrorPad).apply(null,arguments)},i._Mod=function(){return(i._Mod=i.asm.Mod).apply(null,arguments)},i._Multinomial=function(){return(i._Multinomial=i.asm.Multinomial).apply(null,arguments)},i._Multiply=function(){return(i._Multiply=i.asm.Multiply).apply(null,arguments)},i._Neg=function(){return(i._Neg=i.asm.Neg).apply(null,arguments)},i._NonMaxSuppressionV3=function(){return(i._NonMaxSuppressionV3=i.asm.NonMaxSuppressionV3).apply(null,arguments)},i._NonMaxSuppressionV4=function(){return(i._NonMaxSuppressionV4=i.asm.NonMaxSuppressionV4).apply(null,arguments)},i._NonMaxSuppressionV5=function(){return(i._NonMaxSuppressionV5=i.asm.NonMaxSuppressionV5).apply(null,arguments)},i._NotEqual=function(){return(i._NotEqual=i.asm.NotEqual).apply(null,arguments)},i._OneHot=function(){return(i._OneHot=i.asm.OneHot).apply(null,arguments)},i._PadV2=function(){return(i._PadV2=i.asm.PadV2).apply(null,arguments)},i._Pow=function(){return(i._Pow=i.asm.Pow).apply(null,arguments)},i._Prelu=function(){return(i._Prelu=i.asm.Prelu).apply(null,arguments)},i._Prod=function(){return(i._Prod=i.asm.Prod).apply(null,arguments)},i._RealDiv=function(){return(i._RealDiv=i.asm.RealDiv).apply(null,arguments)},i._Reciprocal=function(){return(i._Reciprocal=i.asm.Reciprocal).apply(null,arguments)},i._Relu=function(){return(i._Relu=i.asm.Relu).apply(null,arguments)},i._Relu6=function(){return(i._Relu6=i.asm.Relu6).apply(null,arguments)},i._ResizeBilinear=function(){return(i._ResizeBilinear=i.asm.ResizeBilinear).apply(null,arguments)},i._ResizeBilinearGrad=function(){return(i._ResizeBilinearGrad=i.asm.ResizeBilinearGrad).apply(null,arguments)},i._ResizeNearestNeighbor=function(){return(i._ResizeNearestNeighbor=i.asm.ResizeNearestNeighbor).apply(null,arguments)},i._ResizeNearestNeighborGrad=function(){return(i._ResizeNearestNeighborGrad=i.asm.ResizeNearestNeighborGrad).apply(null,arguments)},i._Reverse=function(){return(i._Reverse=i.asm.Reverse).apply(null,arguments)},i._RotateWithOffset=function(){return(i._RotateWithOffset=i.asm.RotateWithOffset).apply(null,arguments)},i._Round=function(){return(i._Round=i.asm.Round).apply(null,arguments)},i._Rsqrt=function(){return(i._Rsqrt=i.asm.Rsqrt).apply(null,arguments)},i._ScatterNd=function(){return(i._ScatterNd=i.asm.ScatterNd).apply(null,arguments)},i._SearchSorted=function(){return(i._SearchSorted=i.asm.SearchSorted).apply(null,arguments)},i._SelectV2=function(){return(i._SelectV2=i.asm.SelectV2).apply(null,arguments)},i._Selu=function(){return(i._Selu=i.asm.Selu).apply(null,arguments)},i._Sigmoid=function(){return(i._Sigmoid=i.asm.Sigmoid).apply(null,arguments)},i._Sign=function(){return(i._Sign=i.asm.Sign).apply(null,arguments)},i._Sin=function(){return(i._Sin=i.asm.Sin).apply(null,arguments)},i._Sinh=function(){return(i._Sinh=i.asm.Sinh).apply(null,arguments)},i._Softmax=function(){return(i._Softmax=i.asm.Softmax).apply(null,arguments)},i._Softplus=function(){return(i._Softplus=i.asm.Softplus).apply(null,arguments)},i._SparseFillEmptyRows=function(){return(i._SparseFillEmptyRows=i.asm.SparseFillEmptyRows).apply(null,arguments)},i._SparseReshape=function(){return(i._SparseReshape=i.asm.SparseReshape).apply(null,arguments)},i._SparseSegmentReduction=function(){return(i._SparseSegmentReduction=i.asm.SparseSegmentReduction).apply(null,arguments)},i._SparseToDense=function(){return(i._SparseToDense=i.asm.SparseToDense).apply(null,arguments)},i._Sqrt=function(){return(i._Sqrt=i.asm.Sqrt).apply(null,arguments)},i._Square=function(){return(i._Square=i.asm.Square).apply(null,arguments)},i._SquaredDifference=function(){return(i._SquaredDifference=i.asm.SquaredDifference).apply(null,arguments)},i._Step=function(){return(i._Step=i.asm.Step).apply(null,arguments)},i._StridedSlice=function(){return(i._StridedSlice=i.asm.StridedSlice).apply(null,arguments)},i._Sub=function(){return(i._Sub=i.asm.Sub).apply(null,arguments)},i._Sum=function(){return(i._Sum=i.asm.Sum).apply(null,arguments)},i._Tan=function(){return(i._Tan=i.asm.Tan).apply(null,arguments)},i._Tanh=function(){return(i._Tanh=i.asm.Tanh).apply(null,arguments)},i._TensorScatterUpdate=function(){return(i._TensorScatterUpdate=i.asm.TensorScatterUpdate).apply(null,arguments)},i._Tile=function(){return(i._Tile=i.asm.Tile).apply(null,arguments)},i._TopK=function(){return(i._TopK=i.asm.TopK).apply(null,arguments)},i._Transform=function(){return(i._Transform=i.asm.Transform).apply(null,arguments)},i._Transpose=function(){return(i._Transpose=i.asm.Transpose).apply(null,arguments)},i.__FusedMatMul=function(){return(i.__FusedMatMul=i.asm._FusedMatMul).apply(null,arguments)},i._malloc=function(){return(i._malloc=i.asm.malloc).apply(null,arguments)},i._free=function(){return(i._free=i.asm.free).apply(null,arguments)},i.___errno_location=function(){return(i.___errno_location=i.asm.__errno_location).apply(null,arguments)};var Cy=i.stackSave=function(){return(Cy=i.stackSave=i.asm.stackSave).apply(null,arguments)},_y=i.stackRestore=function(){return(_y=i.stackRestore=i.asm.stackRestore).apply(null,arguments)},ls=i.stackAlloc=function(){return(ls=i.stackAlloc=i.asm.stackAlloc).apply(null,arguments)};i.dynCall_iijjiiii=function(){return(i.dynCall_iijjiiii=i.asm.dynCall_iijjiiii).apply(null,arguments)},i.dynCall_jiji=function(){return(i.dynCall_jiji=i.asm.dynCall_jiji).apply(null,arguments)},i.cwrap=Sy;var od;ye=function ie(){od||Ty(),od||(ye=ie)};function Ty(ie){if(ue>0||(ne(),ue>0))return;function me(){od||(od=!0,i.calledRun=!0,!T&&(te(),s(i),i.onRuntimeInitialized&&i.onRuntimeInitialized(),se()))}i.setStatus?(i.setStatus("Running..."),setTimeout(function(){setTimeout(function(){i.setStatus("")},1),me()},1)):me()}if(i.preInit)for(typeof i.preInit=="function"&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();Ty();var ml;l&&(ml={uncaughtException:process.listeners("uncaughtException").filter(function(ie){return!l.uncaughtException.indexOf(ie)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(ie){return!l.unhandledRejection.indexOf(ie)>-1})});var gl;if(typeof a<"u")gl=a;else if(typeof WasmBackendModuleThreadedSimd<"u")gl=WasmBackendModuleThreadedSimd;else throw new Error("Could not find wasm module in post.js");if(ml){var Ny=gl._dispose;gl._dispose=function(){Ny(),ml.uncaughtException.forEach(function(ie){process.removeListener("uncaughtException",ie)}),ml.unhandledRejection.forEach(function(ie){process.removeListener("unhandledRejection",ie)})}}return a.ready}})();typeof e=="object"&&typeof t=="object"?t.exports=n:typeof define=="function"&&define.amd?define([],function(){return n}):typeof e=="object"&&(e.WasmBackendModule=n)}),$x=class{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}},mg=class{refCount(e){return Zr("refCount")}incRef(e){return Zr("incRef")}timerAvailable(){return!0}time(e){return Zr("time")}read(e){return Zr("read")}readSync(e){return Zr("readSync")}readToGPU(e,t){return Zr("readToGPU")}numDataIds(){return Zr("numDataIds")}disposeData(e,t){return Zr("disposeData")}write(e,t,n){return Zr("write")}move(e,t,n,r,a){return Zr("move")}createTensorFromGPUData(e,t,n){return Zr("createTensorFromGPUData")}memory(){return Zr("memory")}floatPrecision(){return Zr("floatPrecision")}epsilon(){return this.floatPrecision()===32?1e-7:1e-4}dispose(){return Zr("dispose")}};function Zr(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function tL(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,Kb(e,t,n)}function _ne(e,t){if(e.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${e.length}Second array length was ${t.length}`);let n=e.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,Kb(e,n,r),Kb(t,n,r)}function Lm(e,t,n){return Math.max(e,Math.min(t,n))}function Tne(e){return e%2===0?e:e+1}function Kb(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function Nne(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function Ene(e,t){let n=Math.random();return t*n+(1-n)*e}function $ne(e,t){let n=0;for(let r=0;r<e.length;r++){let a=Number(e[r])-Number(t[r]);n+=a*a}return n}function F(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function $r(e,t,n=""){F(Ws(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function $u(e){F(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Lt(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function Ane(e){return e.length===0}function nL(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==null&&t[n]!==null&&e[n]!==t[n])return!1;return!0}function Ws(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function sp(e){return e%1===0}function Rne(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{let t=Math.exp(2*e);return(t-1)/(t+1)}}function Fne(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function Dne(e){let t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return tL(t),t}function am(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Mne(e,t=a=>0,n,r){return new Promise((a,i)=>{let s=0,o=()=>{if(e()){a();return}s++;let l=t(s);if(n!=null&&s>=n){i();return}r!=null?r(o,l):setTimeout(o,l)};o()})}function One(e,t){let n=1,r=-1;for(let i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(e[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(e[i]<0)throw Error(`Shapes can not be < 0. Found ${e[i]} at dim ${i}`);if(r===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(n===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);let a=e.slice();return a[r]=t/n,a}function si(e,t){let n=t.length;return e=e==null?t.map((r,a)=>a):[].concat(e),F(e.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),F(e.every(r=>sp(r)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(r=>r<0?n+r:r)}function rL(e,t){let n=[],r=[],a=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||a?null:si(t,e).sort(),s=0;for(let o=0;o<e.length;++o){if(i!=null){if(i[s]===o&&e[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${e[o]}' is not 1`);(i[s]==null||i[s]>o)&&e[o]===1&&(n.push(e[o]),r.push(o)),i[s]<=o&&s++}e[o]!==1&&(n.push(e[o]),r.push(o))}return{newShape:n,keptDims:r}}function aL(e,t){return VC(e,t)}function VC(e,t){let n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error(`Unknown data type ${e}`);return n}function iL(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function sL(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function Pne(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function Xb(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error(`Unknown dtype ${e}`)}function oL(e){if(e==null)return 0;let t=0;return e.forEach(n=>t+=n.length),t}function po(e){return typeof e=="string"||e instanceof String}function lL(e){return typeof e=="boolean"}function uL(e){return typeof e=="number"}function gg(e){return Array.isArray(e)?gg(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":uL(e)?"float32":po(e)?"string":lL(e)?"bool":"float32"}function Oo(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Yb(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function Dp(e){let t=e.length;if(t<2)return[];let n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function cL(e,t,n,r=!1){let a=new Array;if(t.length===1){let i=t[0]*(r?2:1);for(let s=0;s<i;s++)a[s]=n[e+s]}else{let i=t[0],s=t.slice(1),o=s.reduce((l,c)=>l*c)*(r?2:1);for(let l=0;l<i;l++)a[l]=cL(e+l*o,s,n,r)}return a}function Hd(e,t,n=!1){if(e.length===0)return t[0];let r=e.reduce((a,i)=>a*i)*(n?2:1);if(r===0)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return cL(0,e,t,n)}function zne(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function UC(e,t){let n=Ax(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function Ax(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function Lne(e,t){let n=e.reduce((r,a)=>r*a,1);if(t==null||t==="float32")return Hd(e,new Float32Array(n));if(t==="int32")return Hd(e,new Int32Array(n));if(t==="bool")return Hd(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function ga(e){e.forEach(t=>{F(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function Bne(e,t,n){if(t===0)return 0;if(t===1)return e[0];let r=e[e.length-1];for(let a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function Wne(e,t,n){if(t===0)return[];if(t===1)return[e];let r=new Array(t);for(let a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function Rx(e){return e&&e.then&&typeof e.then=="function"}var gF="tfjsflags",dL=class{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Vne,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(Q().getBool("IS_TEST")||Q().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},this.urlFlags[e]!=null){let r=this.urlFlags[e];Q().getBool("IS_TEST")||Q().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];let t=this.evaluateFlag(e);if(Rx(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;let e=this.getQueryParams(this.global.location.search);gF in e&&e[gF].split(",").forEach(t=>{let[n,r]=t.split(":");this.urlFlags[n]=jne(n,r)})}};function Vne(e){let t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(Une(t,r[0],r[1]),r.join("="))),t}function Une(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function jne(e,t){let n=t.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:t}function Q(){return jC}var jC=null;function Hne(e){jC=e}var ak;function pL(){if(ak==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");ak=e}return ak}function Gne(){let e=pL();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function HC(e,t){let n=Gne();if(n.has(e))return n.get(e);{let r=t();return n.set(e,r),n.get(e)}}var Mp="Abs",Au="Acos",Ru="Acosh",Jo="Add",Fu="AddN",Op="All",Pp="Any",zp="ArgMax",Lp="ArgMin",Du="Asin",Mu="Asinh",Ou="Atan",Pu="Atanh",zu="Atan2",Lu="AvgPool",yg="AvgPoolGrad",Bp="AvgPool3D",bg="AvgPool3DGrad",Bu="BatchMatMul",Wp="BatchToSpaceND",Vp="Bincount",Up="BitwiseAnd",hL="BroadcastTo",vg="BroadcastArgs",Wu="Cast",Vu="Ceil",el="ClipByValue",Fx="Complex",xg="ComplexAbs",jp="Concat",Uu="Conv2D",Dx="Conv2DBackpropFilter",ju="Conv2DBackpropInput",Hu="Conv3D",Hp="Conv3DBackpropFilterV2",Gp="Conv3DBackpropInputV2",Gu="Cos",qu="Cosh",qp="Cumprod",Ku="Cumsum",Kp="CropAndResize",wg="DenseBincount",Xp="DepthToSpace",Xu="DepthwiseConv2dNative",Mx="DepthwiseConv2dNativeBackpropFilter",Ox="DepthwiseConv2dNativeBackpropInput",kg="Diag",Yu="Dilation2D",op="Dilation2DBackpropInput",lp="Dilation2DBackpropFilter",GC="Draw",Zu="RealDiv",Px="Einsum",Qu="Elu",Yp="EluGrad",Ju="Erf",Zp="Equal",ec="Exp",Qp="ExpandDims",tc="Expm1",zx="FFT",Sg="Fill",Jp="FlipLeftRight",nc="Floor",rc="FloorDiv",ac="FusedBatchNorm",eh="GatherV2",th="GatherNd",nh="Greater",ic="GreaterEqual",sc="Identity",Lx="IFFT",Bx="Imag",oc="IsFinite",lc="IsInf",uc="IsNan",cc="LeakyRelu",rh="Less",ah="LessEqual",ih="LinSpace",dc="Log",pc="Log1p",sh="LogicalAnd",oh="LogicalNot",lh="LogicalOr",fL="LogicalXor",mL="LogSoftmax",qne="LowerBound",hc="LRN",uh="LRNGrad",Kne="MatrixBandPart",fc="Max",mc="Maximum",gc="MaxPool",Ig="MaxPoolGrad",ch="MaxPool3D",Cg="MaxPool3DGrad",_g="MaxPoolWithArgmax",yc="Mean",bc="Min",vc="Minimum",xc="MirrorPad",wc="Mod",dh="Multinomial",kc="Multiply",ph="Neg",hh="NotEqual",fh="NonMaxSuppressionV3",mh="NonMaxSuppressionV4",gh="NonMaxSuppressionV5",yh="OnesLike",Sc="OneHot",bh="Pack",Ic="PadV2",Xne="Pool",Cc="Pow",_c="Prelu",Tc="Prod",Wx="RaggedGather",Vx="RaggedRange",Ux="RaggedTensorToTensor",Tg="Range",jx="Real",Nc="Reciprocal",Ec="Relu",vh="Reshape",$c="ResizeNearestNeighbor",xh="ResizeNearestNeighborGrad",Ac="ResizeBilinear",wh="ResizeBilinearGrad",Rc="Relu6",Fc="Reverse",Dc="Round",Mc="Rsqrt",kh="ScatterNd",Sh="TensorScatterUpdate",Ih="SearchSorted",Ch="Select",Oc="Selu",_h="Slice",Pc="Sin",zc="Sinh",Lc="Sign",Bc="Sigmoid",Wc="Softplus",Vc="Sqrt",Uc="Sum",Th="SpaceToBatchND",Nh="SplitV",jc="Softmax",Ng="SparseFillEmptyRows",Eh="SparseReshape",Eg="SparseSegmentMean",$g="SparseSegmentSum",$h="SparseToDense",Hc="SquaredDifference",Ag="Square",Rg="StaticRegexReplace",Ah="StridedSlice",Fg="StringNGrams",Dg="StringSplit",Mg="StringToHashBucketFast",Gc="Sub",qc="Tan",Kc="Tanh",tl="Tile",Rh="TopK",Fh="Transform",Ts="Transpose",Og="Unique",Dh="Unpack",Pg="UnsortedSegmentSum",Yne="UpperBound",Mh="ZerosLike",nl="Step",Zb="FromPixels",Oh="RotateWithOffset",iu="_FusedMatMul",su="FusedConv2D",ou="FusedDepthwiseConv2D";function lo(...e){Q().getBool("IS_TEST")||Q().getBool("PROD")||console.warn(...e)}function Zne(...e){Q().getBool("IS_TEST")||Q().getBool("PROD")||console.log(...e)}var up=HC("kernelRegistry",()=>new Map),Bm=HC("gradRegistry",()=>new Map);function Qb(e,t){let n=qC(e,t);return up.get(n)}function XS(e){return Bm.get(e)}function Jb(e){let t=up.entries(),n=[];for(;;){let{done:r,value:a}=t.next();if(r)break;let[i,s]=a,[o]=i.split("_");o===e&&n.push(s)}return n}function zg(e){let{kernelName:t,backendName:n}=e,r=qC(t,n);up.has(r)&&lo(`The kernel '${t}' for backend '${n}' is already registered`),up.set(r,e)}function gL(e){let{kernelName:t}=e;Bm.has(t)&&Q().getBool("DEBUG")&&lo(`Overriding the gradient for '${t}'`),Bm.set(t,e)}function Qne(e,t){let n=qC(e,t);if(!up.has(n))throw new Error(`The kernel '${e}' for backend '${t}' is not registered`);up.delete(n)}function Jne(e){if(!Bm.has(e))throw new Error(`The gradient '${e}' for backend is not registered`);Bm.delete(e)}function ere(e,t){Jb(e).forEach(n=>{let r=Object.assign({},n,{backendName:t});zg(r)})}function qC(e,t){return`${t}_${e}`}var k={};He(k,{arraysEqual:()=>Ws,arraysEqualWithNull:()=>nL,assert:()=>F,assertNonNegativeIntegerDimensions:()=>ga,assertNonNull:()=>$u,assertShapesMatch:()=>$r,bytesFromStringArray:()=>oL,bytesPerElement:()=>Xb,checkConversionForErrors:()=>iL,clamp:()=>Lm,computeStrides:()=>Dp,convertBackendValuesAndArrayBuffer:()=>zne,createScalarValue:()=>sre,createShuffledIndices:()=>Dne,decodeString:()=>ev,distSquared:()=>$ne,encodeString:()=>Bg,fetch:()=>lre,fingerPrint64:()=>ire,flatten:()=>Po,getArrayFromDType:()=>VC,getTypedArrayFromDType:()=>aL,hasEncodingLoss:()=>Pne,hexToLong:()=>Lg,indexToLoc:()=>Wne,inferDtype:()=>gg,inferFromImplicitShape:()=>One,isBoolean:()=>lL,isFunction:()=>Oo,isInt:()=>sp,isNumber:()=>uL,isPromise:()=>Rx,isScalarShape:()=>Ane,isString:()=>po,isTypedArray:()=>Vn,isValidDtype:()=>sL,locToIndex:()=>Bne,makeOnesTypedArray:()=>UC,makeZerosNestedTypedArray:()=>Lne,makeZerosTypedArray:()=>Ax,nearestDivisor:()=>Yb,nearestLargerEven:()=>Tne,now:()=>Wm,parseAxisParam:()=>si,randUniform:()=>Ene,repeatedTry:()=>Mne,rightPad:()=>am,shuffle:()=>tL,shuffleCombo:()=>_ne,sizeFromShape:()=>Lt,sizeToSquarishShape:()=>Fne,squeezeShape:()=>rL,sum:()=>Nne,swap:()=>Kb,tanh:()=>Rne,toNestedArray:()=>Hd,toTypedArray:()=>Hx});function yL(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var yF=Qo(une()),El=yF.default||yF;function Lg(e){return El.fromString(e,!0,16)}var bL=Lg("c3a5c85c97cb3127"),Cl=Lg("b492b66fbe98f273"),xr=Lg("9ae16a3b2f90404f");function YS(e){return e.xor(e.shru(47))}function vL(e,t,n){let r=e.slice(t,t+n);return El.fromBytes(Array.from(r),!0,!0)}function zt(e,t){return vL(e,t,8)}function bF(e,t){return vL(e,t,4)}function Wn(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function Co(e,t,n=Lg("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let a=t.xor(r).mul(n);return a=a.xor(a.shru(47)),a=a.mul(n),a}function tre(e,t,n,r,a,i){a=a.add(e),i=Wn(i.add(a).add(r),21);let s=a;return a=a.add(t),a=a.add(n),i=i.add(Wn(a,44)),[a.add(r),i.add(s)]}function p0(e,t,n,r){return tre(zt(e,t),zt(e,t+8),zt(e,t+16),zt(e,t+24),n,r)}function nre(e,t=e.length){if(t>=8){let n=xr.add(t*2),r=zt(e,0).add(xr),a=zt(e,t-8),i=Wn(a,37).mul(n).add(r),s=Wn(r,25).add(a).mul(n);return Co(i,s,n)}if(t>=4){let n=xr.add(t*2),r=bF(e,0);return Co(r.shl(3).add(t),bF(e,t-4),n)}if(t>0){let n=e[0],r=e[t>>1],a=e[t-1],i=n+(r<<8),s=t+(a<<2);return YS(xr.mul(i).xor(bL.mul(s))).mul(xr)}return xr}function rre(e,t=e.length){let n=xr.add(t*2),r=zt(e,0).mul(Cl),a=zt(e,8),i=zt(e,t-8).mul(n),s=zt(e,t-16).mul(xr);return Co(Wn(r.add(a),43).add(Wn(i,30)).add(s),r.add(Wn(a.add(xr),18)).add(i),n)}function are(e,t=e.length){let n=xr.add(t*2),r=zt(e,0).mul(xr),a=zt(e,8),i=zt(e,t-8).mul(n),s=zt(e,t-16).mul(xr),o=Wn(r.add(a),43).add(Wn(i,30)).add(s),l=Co(o,r.add(Wn(a.add(xr),18)).add(i),n),c=zt(e,16).mul(n),u=zt(e,24),d=o.add(zt(e,t-32)).mul(n),p=l.add(zt(e,t-24)).mul(n);return Co(Wn(c.add(u),43).add(Wn(d,30)).add(p),c.add(Wn(u.add(r),18)).add(d),n)}function ire(e,t=e.length){let n=El.fromNumber(81,!0);if(t<=32)return t<=16?nre(e,t):rre(e,t);if(t<=64)return are(e,t);let r=n,a=n.mul(Cl).add(113),i=YS(a.mul(xr).add(113)).mul(xr),s=[El.UZERO,El.UZERO],o=[El.UZERO,El.UZERO];r=r.mul(xr).add(zt(e,0));let l=0,c=(t-1>>6)*64,u=c+(t-1&63)-63;do r=Wn(r.add(a).add(s[0]).add(zt(e,l+8)),37).mul(Cl),a=Wn(a.add(s[1]).add(zt(e,l+48)),42).mul(Cl),r=r.xor(o[1]),a=a.add(s[0]).add(zt(e,l+40)),i=Wn(i.add(o[0]),33).mul(Cl),s=p0(e,l,s[1].mul(Cl),r.add(o[0])),o=p0(e,l+32,i.add(o[1]),a.add(zt(e,l+16))),[i,r]=[r,i],l+=64;while(l!==c);let d=Cl.add(i.and(255).shl(1));return l=u,o[0]=o[0].add(t-1&63),s[0]=s[0].add(o[0]),o[0]=o[0].add(s[0]),r=Wn(r.add(a).add(s[0]).add(zt(e,l+8)),37).mul(d),a=Wn(a.add(s[1]).add(zt(e,l+48)),42).mul(d),r=r.xor(o[1].mul(9)),a=a.add(s[0].mul(9).add(zt(e,l+40))),i=Wn(i.add(o[0]),33).mul(d),s=p0(e,l,s[1].mul(d),r.add(o[0])),o=p0(e,l+32,i.add(o[1]),a.add(zt(e,l+16))),[i,r]=[r,i],Co(Co(s[0],o[0],d).add(YS(a).mul(bL)).add(i),Co(s[1],o[1],d).add(r),d)}function sre(e,t){return t==="string"?Bg(e):Hx([e],t)}function ore(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function Hx(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Po(e)),Q().getBool("DEBUG")&&iL(e,t),ore(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){let n=new Uint8Array(e.length);for(let r=0;r<n.length;++r)Math.round(e[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${t}`)}function Wm(){return Q().platform.now()}function lre(e,t){return Q().platform.fetch(e,t)}function Bg(e,t="utf-8"){return t=t||"utf-8",Q().platform.encode(e,t)}function ev(e,t="utf-8"){return t=t||"utf-8",Q().platform.decode(e,t)}function Vn(e){return Q().platform.isTypedArray!=null?Q().platform.isTypedArray(e):yL(e)}function Po(e,t=[],n=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||Rx(e)||e==null||Vn(e)&&n)t.push(e);else if(Array.isArray(e)||Vn(e))for(let r=0;r<e.length;++r)Po(e[r],t,n);else{let r=-1;for(let a of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(a)&&(r=Math.max(r,Number(a)));for(let a=0;a<=r;a++)Po(e[a],t,n)}return t}var ure=class{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new dre)}profileKernel(e,t,n){let r,a=()=>{r=n()},i,s=Wm();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(a);else{a();for(let o of r)o.dataSync();i=Promise.resolve({kernelMs:Wm()-s})}if(Q().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let o=0;o<r.length;o++){let l=r[o];l.data().then(c=>{cre(c,l.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:i.then(o=>o.kernelMs),extraInfo:i.then(o=>o.getExtraProfileInfo!=null?o.getExtraProfileInfo():"")}}logKernelProfile(e){let{kernelName:t,outputs:n,timeMs:r,inputs:a,extraInfo:i}=e;n.forEach(s=>{Promise.all([s.data(),r,i]).then(o=>{this.logger.logKernelProfile(t,s,o[0],o[1],a,o[2])})})}};function cre(e,t,n){if(t!=="float32")return!1;for(let r=0;r<e.length;r++){let a=e[r];if(isNaN(a)||!isFinite(a))return console.warn(`Found ${a} in the result of '${n}'`),!0}return!1}var dre=class{logKernelProfile(e,t,n,r,a,i){let s=typeof r=="number"?am(`${r}ms`,9):r.error,o=am(e,25),l=t.rank,c=t.size,u=am(t.shape.toString(),14),d="";for(let p in a){let h=a[p];if(h!=null){let f=h.shape||t.shape,m=f.length;d+=`${p}: ${m}D ${m>0?f:""} `}}console.log(`%c${o}	%c${s}	%c${l}D ${u}	%c${c}	%c${d}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};function pre(e,t,n){let r={},a={};for(let l=0;l<t.length;l++)r[t[l].id]=!0;for(let l=0;l<e.length;l++){let c=e[l],u=c.inputs;for(let d in u){let p=u[d],h=!1;for(let f=0;f<t.length;f++)if(r[p.id]){c.outputs.forEach(m=>r[m.id]=!0),h=!0,a[c.id]=!0;break}if(h)break}}let i={};i[n.id]=!0;let s={};for(let l=e.length-1;l>=0;l--){let c=e[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(i[c.outputs[d].id]){for(let p in u)i[u[p].id]=!0,s[c.id]=!0;break}}let o=[];for(let l=0;l<e.length;l++){let c=e[l];if(a[c.id]&&s[c.id]){let u={};for(let p in c.inputs){let h=c.inputs[p];r[h.id]&&(u[p]=h)}let d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,o.push(d)}}return o}function hre(e,t,n,r){for(let a=t.length-1;a>=0;a--){let i=t[a],s=[];if(i.outputs.forEach(l=>{let c=e[l.id];c!=null?s.push(c):s.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);let o=i.gradient(s);for(let l in i.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);let c=n(()=>o[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);let u=i.inputs[l];if(!Ws(c.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(e[u.id]==null)e[u.id]=c;else{let d=e[u.id];e[u.id]=r(d,c),d.dispose()}}}}var vF=20,vf=3,ik=7;function fre(e,t,n,r){let a=Dp(t),i=mre(e,t,n,a),s=t.length,o=Q0(e,t,n,a,i),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${s}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(o.map(c=>"    "+c).join(`
`)),l.join(`
`)}function mre(e,t,n,r){let a=Lt(t),i=r[r.length-1],s=new Array(i).fill(0),o=t.length,l=n==="complex64"?Af(e):e;if(o>1)for(let c=0;c<a/i;c++){let u=c*i;for(let d=0;d<i;d++)s[d]=Math.max(s[d],$f(l[u+d],0,n).length)}return s}function $f(e,t,n){let r;return Array.isArray(e)?r=`${parseFloat(e[0].toFixed(ik))} + ${parseFloat(e[1].toFixed(ik))}j`:po(e)?r=`'${e}'`:n==="bool"?r=xL(e):r=parseFloat(e.toFixed(ik)).toString(),am(r,t)}function xL(e){return e===0?"false":"true"}function Q0(e,t,n,r,a,i=!0){let s=n==="complex64"?2:1,o=t[0],l=t.length;if(l===0){if(n==="complex64"){let m=Af(e);return[$f(m[0],0,n)]}return n==="bool"?[xL(e[0])]:[e[0].toString()]}if(l===1){if(o>vF){let m=vf*s,g=Array.from(e.slice(0,m)),y=Array.from(e.slice((o-vf)*s,o*s));return n==="complex64"&&(g=Af(g),y=Af(y)),["["+g.map((b,v)=>$f(b,a[v],n)).join(", ")+", ..., "+y.map((b,v)=>$f(b,a[o-vf+v],n)).join(", ")+"]"]}return["["+(n==="complex64"?Af(e):Array.from(e)).map((m,g)=>$f(m,a[g],n)).join(", ")+"]"]}let c=t.slice(1),u=r.slice(1),d=r[0]*s,p=[];if(o>vF){for(let m=0;m<vf;m++){let g=m*d,y=g+d;p.push(...Q0(e.slice(g,y),c,n,u,a,!1))}p.push("...");for(let m=o-vf;m<o;m++){let g=m*d,y=g+d;p.push(...Q0(e.slice(g,y),c,n,u,a,m===o-1))}}else for(let m=0;m<o;m++){let g=m*d,y=g+d;p.push(...Q0(e.slice(g,y),c,n,u,a,m===o-1))}let h=l===2?",":"";p[0]="["+(o>0?p[0]+h:"");for(let m=1;m<p.length-1;m++)p[m]=" "+p[m]+h;let f=`,
`;for(let m=2;m<l;m++)f+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(i?"":f),p}function Af(e){let t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var Sn=class{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=Lt(e),n!=null){let r=n.length;F(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||VC(t,this.size),this.strides=Dp(e)}set(e,...t){t.length===0&&(t=[0]),F(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);let n=this.locToIndex(t);this.values[n]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(let r of e){if(r<0||r>=this.shape[t]){let a=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(a)}t++}let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return this.values[n]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];let t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return mi().makeTensor(this.values,this.shape,this.dtype)}},mi=null,vd=null;function gre(e){mi=e}function yre(e){vd=e}var Ze=class{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Lt(e),this.strides=Dp(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){let e=await this.data();return vd.buffer(this.shape,this.dtype,e)}bufferSync(){return vd.buffer(this.shape,this.dtype,this.dataSync())}async array(){let e=await this.data();return Hd(this.shape,e,this.dtype==="complex64")}arraySync(){return Hd(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();let e=mi().read(this.dataId);if(this.dtype==="string"){let t=await e;try{return t.map(n=>ev(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),mi().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();let e=mi().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>ev(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();let e=await mi().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(mi().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return vd.print(this,e)}clone(){return this.throwIfDisposed(),vd.clone(this)}toString(e=!1){let t=this.dataSync();return fre(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),vd.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),mi().makeVariable(this,e,t,n)}};Object.defineProperty(Ze,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function ae(){return HC("Tensor",()=>Ze)}ae();var lu=class extends Ze{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Ws(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);mi().disposeTensor(this),this.dataId=e.dataId,mi().incRef(this,null)}dispose(){mi().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(lu,Symbol.hasInstance,{value:e=>e instanceof Ze&&e.assign!=null&&e.assign instanceof Function});var xi={};He(xi,{assertTypesMatch:()=>SL,getTensorsInContainer:()=>KC,isTensorInList:()=>vre,makeTypesMatch:()=>nn});var ZS;(function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"})(ZS||(ZS={}));var QS;(function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"})(QS||(QS={}));var JS;(function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"})(JS||(JS={}));var eI;(function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"})(eI||(eI={}));var tI;(function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"})(tI||(tI={}));var bre={float32:eI,int32:QS,bool:JS,complex64:tI};function Fa(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return bre[e][t]}function Gx(e){return Fa(e,"int32")}function wL(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function kL(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}function nn(e,t){if(e.dtype===t.dtype)return[e,t];let n=Fa(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function SL(e,t){F(e.dtype===t.dtype,()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`)}function vre(e,t){return t.some(n=>n.id===e.id)}function KC(e){let t=[];return IL(e,t,new Set),t}function IL(e,t,n){if(e==null)return;if(e instanceof Ze){t.push(e);return}if(!xre(e))return;let r=e;for(let a in r){let i=r[a];n.has(i)||(n.add(i),IL(i,t,n))}}function xre(e){return Array.isArray(e)||typeof e=="object"}function sk(e){return e.kernelName!=null}var xF=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(let e in this.registeredVariables)this.registeredVariables[e].dispose()}},Vm=class{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new xF}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t];if(await this.initializeBackend(n).success){await this.setBackend(n);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){let{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){let{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,n=1){return e in this.registryFactory?(lo(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;let{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new ure(this.backendInstance),!0}setupRegisteredKernels(){Jb(this.backendName).forEach(e=>{e.setupFunc!=null&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Jb(e).forEach(t=>{t.disposeFunc!=null&&t.disposeFunc(this.registry[e])})}initializeBackend(e){let t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{let n=t.factory();if(n&&!(n instanceof mg)&&typeof n.then=="function"){let r=++this.pendingBackendInitId,a=n.then(i=>r<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,lo(`Initialization of backend ${e} failed`),lo(i.stack||i.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[e]=n,{success:!0,asyncInit:!1}}catch(n){return lo(`Initialization of backend ${e} failed`),lo(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t],{success:r,asyncInit:a}=this.initializeBackend(n);if(a||r)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){let n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");n=e}let r;return this.scopedRun(()=>this.startScope(n),()=>this.endScope(r),()=>(r=t(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,t,n){e();try{let r=n();return t(),r}catch(r){throw t(),r}}nextTensorId(){return Vm.nextTensorId++}nextVariableId(){return Vm.nextVariableId++}clone(e){let t=V.runKernel(sc,{x:e}),n={x:e},r=i=>({x:()=>{let s="float32",o={x:i},l={dtype:s};return V.runKernel(Wu,o,l)}}),a=[];return this.addTapeNode(this.state.activeScope.name,n,[t],r,a,{}),t}runKernel(e,t,n){if(this.backendName==null&&this.backend,Qb(e,this.backendName)==null)throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){let r=this.backend.numDataIds(),a=0;n.forEach(o=>{a+=o.dtype==="complex64"?3:1});let i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=r-t-a-i;if(s>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${s} data ids) after running '${e}'`)}runKernelFunc(e){let t,n=[],r=this.isTapeOn(),a=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let s;this.backendName==null&&this.backend;let o,l=sk(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(sk(e)){let{kernelName:h,inputs:f,attrs:m}=e;this.backendName==null&&this.backend;let g=Qb(h,this.backendName);F(g!=null,()=>`Cannot find registered kernel '${h}' for backend '${this.backendName}'`),s=()=>{let y=this.backend.numDataIds();o=g.kernelFunc({inputs:f,attrs:m,backend:this.backend});let b=Array.isArray(o)?o:[o];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(h,y,b);let v=b.map(x=>x.rank!=null?x:this.makeTensorFromTensorInfo(x));if(r){let x=this.getTensorsForGradient(h,f,v);n=this.saveTensorsForBackwardMode(x)}return v}}else{let{forwardFunc:h}=e,f=m=>{r&&(n=m.map(g=>this.keep(this.clone(g))))};s=()=>{let m=this.backend.numDataIds();o=this.tidy(()=>h(this.backend,f));let g=Array.isArray(o)?o:[o];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,m,g),g}}let{inputs:c,attrs:u}=e,d=sk(e)?null:e.backwardsFunc,p;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=s():(p=this.profiler.profileKernel(l,c,()=>s()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(p),t=p.outputs)}),r&&this.addTapeNode(l,c,t,d,n,u),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(h=>c[h]!=null?c[h].shape:null),outputShapes:t.map(h=>h.shape),kernelTimeMs:p.timeMs,extraInfo:p.extraInfo}),Array.isArray(o)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(t=>this.keep(this.clone(t)))}getTensorsForGradient(e,t,n){let r=XS(e);if(r!=null){let a=r.inputsToSave||[],i=r.outputsToSave||[],s;r.saveAllInputs?(F(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),s=Object.keys(t).map(l=>t[l])):s=a.map(l=>t[l]);let o=n.filter((l,c)=>i[c]);return s.concat(o)}return[]}makeTensor(e,t,n,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let a=e;n==="string"&&po(e[0])&&(a=e.map(o=>Bg(o)));let i=r.write(a,t,n),s=new Ze(t,n,i,this.nextTensorId());if(this.trackTensor(s,r),n==="string"){let o=this.state.tensorInfo.get(i),l=oL(a);this.state.numBytes+=l-o.bytes,o.bytes=l}return s}makeTensorFromDataId(e,t,n,r){n=n||"float32";let a={dataId:e,shape:t,dtype:n};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(e,t){let{dataId:n,shape:r,dtype:a}=e,i=new Ze(r,a,n,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e,t=!0,n,r){n=n||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));let a=new lu(e,t,n,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let n=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(n=e.size*Xb(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof lu||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;let t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){let n=e.size*Xb(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(let e in this.state.registeredVariables){let t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){let e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;let t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(let r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,n,r,a,i){let s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},o=XS(e);o!=null&&(r=o.gradFunc),r!=null&&(s.gradient=l=>(l=l.map((c,u)=>{if(c==null){let d=n[u],p=Ax(d.size,d.dtype);return this.makeTensor(p,d.shape,d.dtype)}return c}),r(l.length>1?l:l[0],a,i))),this.state.activeTape.push(s)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){let t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){let t=KC(e),n=new Set(t.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){let i=this.state.activeScope.track[a];!i.kept&&!n.has(i.id)&&i.dispose()}let r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(a=>{!a.kept&&a.scopeId===r.id&&this.track(a)})}gradients(e,t,n,r=!1){if(F(t.length>0,()=>"gradients() received an empty list of xs."),n!=null&&n.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);let a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));F(a instanceof Ze,()=>"The result y returned by f() must be a tensor.");let i=pre(this.state.activeTape,t,a);if(!r&&i.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let s={};s[a.id]=n??wre(a.shape),hre(s,i,l=>this.tidy(l),kre);let o=t.map(l=>s[l.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(l=>{for(let c of l.saved)c.dispose()}),this.state.activeTape=null),{value:a,grads:o}})}customGrad(e){return F(Oo(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{F(t.every(s=>s instanceof Ze),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let n,r={};t.forEach((s,o)=>{r[o]=s});let a=(s,o)=>(n=e(...t,o),F(n.value instanceof Ze,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),F(Oo(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),i=(s,o)=>{let l=n.gradFunc(s,o),c=Array.isArray(l)?l:[l];F(c.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),F(c.every(d=>d instanceof Ze),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let u={};return c.forEach((d,p)=>{u[p]=()=>d}),u};return this.runKernelFunc({forwardFunc:a,backwardsFunc:i,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){let t=Wm(),n=await this.backend.time(e);return n.wallMs=Wm()-t,n}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new xF;for(let e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};Vm.nextTensorId=0;Vm.nextVariableId=0;function wre(e){let t=UC(Lt(e),"float32");return V.makeTensor(t,e,"float32")}function CL(){let e=pL();if(e._tfengine==null){let t=new dL(e);e._tfengine=new Vm(t)}return Hne(e._tfengine.ENV),gre(()=>e._tfengine),e._tfengine}var V=CL();function kre(e,t){let n={a:e,b:t};return V.runKernel(Jo,n)}var Wg={};He(Wg,{isBrowser:()=>_L,isMobile:()=>Cre,mockIsMobile:()=>Ire});function Sre(){return typeof navigator<"u"&&navigator!=null}var nI;function Ire(e){nI=e}function Cre(e){if(nI!==void 0)return nI;if(e||Sre()){if(e||(e=navigator),e.product==="ReactNative")return!0;let t=e.userAgent||e.vendor||(typeof window<"u"?window.opera:"");if(!t){let n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function _L(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Ur=Q();Ur.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Ur.registerFlag("IS_BROWSER",()=>_L());Ur.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Ur.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Ur.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Ur.registerFlag("PROD",()=>!1);Ur.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Ur.getBool("DEBUG"));Ur.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Ur.registerFlag("IS_TEST",()=>!1);Ur.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Ur.getBool("DEBUG"));Ur.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Ur.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Ur.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);function Zi(e,t){let n=e;if(Vn(e))return t==="string"?[]:[e.length];if(wL(e)){let a=e.channels||"RGBA";return[e.height,e.width*a.length]}else if(kL(e))return[e.buffer.size/(t==null?4:Xb(t))];if(!Array.isArray(e))return[];let r=[];for(;Array.isArray(n)||Vn(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&Q().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&TL(e,r,[]),r}function TL(e,t,n){if(n=n||[],!Array.isArray(e)&&!Vn(e)){F(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}F(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`),F(e.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`);let r=t.slice(1);for(let a=0;a<e.length;++a)TL(e[a],r,n.concat(a))}function wF(e,t,n,r){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function A(e,t,n,r="numeric"){if(e instanceof Ze)return wF(r,e.dtype,t,n),e;let a=gg(e);if(a!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),wF(r,a,t,n),e==null||!Vn(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){let o=e==null?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${o}'`)}let i=Zi(e,a);!Vn(e)&&!Array.isArray(e)&&(e=[e]);let s=a!=="string"?Hx(e,a):Po(e,[],!0);return V.makeTensor(s,i,a)}function Um(e,t,n,r="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((a,i)=>A(a,`${t}[${i}]`,n,r))}var XC="__op";function U(e){let t=Object.keys(e);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+XC;let a=(...i)=>{V.startScope(n);try{let s=r(...i);return Rx(s)&&console.error("Cannot return a Promise inside of tidy."),V.endScope(s),s}catch(s){throw V.endScope(null),s}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}function _re(e,t){let n=A(e,"real","complex"),r=A(t,"imag","complex");$r(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);let a={real:n,imag:r};return V.runKernel(Fx,a)}var Os=U({complex_:_re});function rl(e,t,n,r){if(r==null)r=gg(e);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(kL(e)||wL(e)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return V.backend.createTensorFromGPUData(e,t||n,r)}if(!Vn(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){ga(t);let a=Lt(t),i=Lt(n);F(a===i,()=>`Based on the provided shape, [${t}], the tensor should have ${a} values but has ${i}`);for(let s=0;s<n.length;++s){let o=n[s],l=s===n.length-1?o!==Lt(t.slice(s)):!0;F(n[s]===t[s]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Vn(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e=r!=="string"?Hx(e,r):Po(e,[],!0),V.makeTensor(e,t,r)}function Ir(e,t,n){let r=Zi(e,n);return rl(e,t,r,n)}var rI={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},es=class{static join(e){return new es(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(n=>Vn(n)?n.buffer:n),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){let r=e[n];n!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let a=t+r.byteLength;this.shards.push({buffer:r,start:t,end:a}),t=a}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);let n=this.findShardForByte(e);if(n===-1)throw new Error(`Could not find start shard for byte ${e}`);let r=t-e,a=new ArrayBuffer(r),i=new Uint8Array(a),s=0;for(let o=n;o<this.shards.length;o++){let l=this.shards[o],c=e+s-l.start,u=s,d=Math.min(t,l.end)-l.start,p=new Uint8Array(l.buffer,c,d-c);if(i.set(p,u),s+=p.length,t<l.end)break}return a}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(r){return e<r.start?-1:e>=r.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;let n=Tre(this.shards,t);return n===-1?-1:(this.previousShardIndex=n,this.previousShardIndex)}};function Tre(e,t){let n=0,r=e.length;for(;n<=r;){let a=Math.floor((r-n)/2)+n,i=t(e[a]);if(i===0)return a;i<0?r=a:n=a+1}return-1}var tv=4;async function Nre(e,t){let n=[],r=[],a=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);for(let s=0;s<a.length;++s){let o=a[s],l=Array.isArray(e)?e[s].tensor:e[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);let c={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){let u=new Promise(async d=>{let p=await l.bytes(),h=p.reduce((g,y)=>g+y.length,0)+tv*p.length,f=new Uint8Array(h),m=0;for(let g=0;g<p.length;g++){let y=p[g],b=new Uint8Array(new Uint32Array([y.length]).buffer);f.set(b,m),m+=tv,f.set(y,m),m+=y.length}d(f)});r.push(u)}else r.push(l.data());t!=null&&(c.group=t),n.push(c)}let i=await Promise.all(r);return{data:Ere(i),specs:n}}function NL(e,t){let n=new es(e),r={},a,i=0;for(let s of t){let o=s.name,l=s.dtype,c=s.shape,u=Lt(c),d;if("quantization"in s){let p=s.quantization;if(p.dtype==="uint8"||p.dtype==="uint16"){if(!("min"in p&&"scale"in p))throw new Error(`Weight ${s.name} with quantization ${p.dtype} doesn't have corresponding metadata min and scale.`)}else if(p.dtype==="float16"){if(l!=="float32")throw new Error(`Weight ${s.name} is quantized with ${p.dtype} which only supports weights of type float32 not ${l}.`)}else throw new Error(`Weight ${s.name} has unknown quantization dtype ${p.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);let h=rI[p.dtype],f=n.slice(i,i+u*h),m=p.dtype==="uint8"?new Uint8Array(f):new Uint16Array(f);if(l==="float32")if(p.dtype==="uint8"||p.dtype==="uint16"){d=new Float32Array(m.length);for(let g=0;g<m.length;g++){let y=m[g];d[g]=y*p.scale+p.min}}else if(p.dtype==="float16")a===void 0&&(a=Ore()),d=a(m);else throw new Error(`Unsupported quantization type ${p.dtype} for weight type float32.`);else if(l==="int32"){if(p.dtype!=="uint8"&&p.dtype!=="uint16")throw new Error(`Unsupported quantization type ${p.dtype} for weight type int32.`);d=new Int32Array(m.length);for(let g=0;g<m.length;g++){let y=m[g];d[g]=Math.round(y*p.scale+p.min)}}else throw new Error(`Unsupported dtype in weight '${o}': ${l}`);i+=u*h}else if(l==="string"){let p=Lt(s.shape);d=[];for(let h=0;h<p;h++){let f=new Uint32Array(n.slice(i,i+tv))[0];i+=tv;let m=new Uint8Array(n.slice(i,i+f));d.push(m),i+=f}}else{let p=rI[l],h=n.slice(i,i+u*p);if(l==="float32")d=new Float32Array(h);else if(l==="int32")d=new Int32Array(h);else if(l==="bool")d=new Uint8Array(h);else if(l==="complex64"){d=new Float32Array(h);let f=new Float32Array(d.length/2),m=new Float32Array(d.length/2);for(let b=0;b<f.length;b++)f[b]=d[b*2],m[b]=d[b*2+1];let g=Ir(f,c,"float32"),y=Ir(m,c,"float32");r[o]=Os(g,y),g.dispose(),y.dispose()}else throw new Error(`Unsupported dtype in weight '${o}': ${l}`);i+=u*p}l!=="complex64"&&(r[o]=Ir(d,c,l))}return r}function Ere(e){if(e===null)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0,n=[];e.forEach(i=>{if(t+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});let r=new Uint8Array(t),a=0;return n.forEach(i=>{r.set(new Uint8Array(i.buffer),a),a+=i.byteLength}),r.buffer}var YC=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function kF(e){return YC?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function $re(e){if(YC)return Buffer.from(e).toString("base64");let t=new Uint8Array(e),n="";for(let r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function Are(e){if(YC){let r=Buffer.from(e,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}let t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}function Rre(e){return es.join(e)}function SF(e){let t="/";for(e=e.trim();e.endsWith(t);)e=e.slice(0,e.length-1);let n=e.split(t);return n[n.length-1]}function EL(e,t){let n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return e.signature!=null&&(n.signature=e.signature),e.userDefinedMetadata!=null&&(n.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(n.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(n.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(n.trainingConfig=e.trainingConfig),n}function $L(e,t,n){let r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(e.trainingConfig!=null&&(r.trainingConfig=e.trainingConfig),e.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return e.signature!=null&&(r.signature=e.signature),e.userDefinedMetadata!=null&&(r.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(r.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(r.initializerSignature=e.initializerSignature),r}async function ZC(e,t){let n,r;return e.weightsManifest!=null&&([n,r]=await t(e.weightsManifest)),$L(e,n,r)}function Vg(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:kF(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:kF(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new es(e.weightData).byteLength}}function AL(e){let t=[];for(let n of e)t.push(...n.weights);return t}function Fre(){let e=n=>{let r=n<<13,a=0;for(;!(r&8388608);)a-=8388608,r<<=1;return r&=-8388609,a+=947912704,r|a},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function Dre(){let e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}function Mre(){let e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}function Ore(){let e=Fre(),t=Dre(),n=Mre();return r=>{let a=new ArrayBuffer(4*r.length),i=new Uint32Array(a);for(let s=0;s<r.length;s++){let o=r[s],l=e[n[o>>10]+(o&1023)]+t[o>>10];i[s]=l}return new Float32Array(a)}}var rn=class{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return rn.instance==null&&(rn.instance=new rn),rn.instance}static registerSaveRouter(e){rn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){rn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return rn.getHandlers(e,"save")}static getLoadHandlers(e,t){return rn.getHandlers(e,"load",t)}static getHandlers(e,t,n){let r=[];return(t==="load"?rn.getInstance().loadRouters:rn.getInstance().saveRouters).forEach(a=>{let i=a(e,n);i!==null&&r.push(i)}),r}},Pre=e=>rn.registerSaveRouter(e),zre=e=>rn.registerLoadRouter(e),Lre=e=>rn.getSaveHandlers(e),Bre=(e,t)=>rn.getLoadHandlers(e,t),aI="tensorflowjs",iI=1,Bl="models_store",ho="model_info_store";function RL(){if(!Q().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function sI(e){let t=e.result;t.createObjectStore(Bl,{keyPath:"modelPath"}),t.createObjectStore(ho,{keyPath:"modelPath"})}var uu=class{constructor(e){if(this.indexedDB=RL(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((n,r)=>{let a=this.indexedDB.open(aI,iI);a.onupgradeneeded=()=>sI(a),a.onsuccess=()=>{let i=a.result;if(t==null){let s=i.transaction(Bl,"readonly"),o=s.objectStore(Bl).get(this.modelPath);o.onsuccess=()=>{if(o.result==null)return i.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));n(o.result.modelArtifacts)},o.onerror=l=>(i.close(),r(o.error)),s.oncomplete=()=>i.close()}else{t.weightData=es.join(t.weightData);let s=Vg(t),o=i.transaction(ho,"readwrite"),l=o.objectStore(ho),c;try{c=l.put({modelPath:this.modelPath,modelArtifactsInfo:s})}catch(d){return r(d)}let u;c.onsuccess=()=>{u=i.transaction(Bl,"readwrite");let d=u.objectStore(Bl),p;try{p=d.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:s})}catch(h){return r(h)}p.onsuccess=()=>n({modelArtifactsInfo:s}),p.onerror=h=>{l=o.objectStore(ho);let f=l.delete(this.modelPath);f.onsuccess=()=>(i.close(),r(p.error)),f.onerror=m=>(i.close(),r(p.error))}},c.onerror=d=>(i.close(),r(c.error)),o.oncomplete=()=>{u==null?i.close():u.oncomplete=()=>i.close()}}},a.onerror=i=>r(a.error)})}};uu.URL_SCHEME="indexeddb://";var FL=e=>Q().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(uu.URL_SCHEME)?Wre(e.slice(uu.URL_SCHEME.length)):null;rn.registerSaveRouter(FL);rn.registerLoadRouter(FL);function Wre(e){return new uu(e)}function Vre(e){return e.startsWith(uu.URL_SCHEME)?e.slice(uu.URL_SCHEME.length):e}var Ure=class{constructor(){this.indexedDB=RL()}async listModels(){return new Promise((e,t)=>{let n=this.indexedDB.open(aI,iI);n.onupgradeneeded=()=>sI(n),n.onsuccess=()=>{let r=n.result,a=r.transaction(ho,"readonly"),i=a.objectStore(ho).getAll();i.onsuccess=()=>{let s={};for(let o of i.result)s[o.modelPath]=o.modelArtifactsInfo;e(s)},i.onerror=s=>(r.close(),t(i.error)),a.oncomplete=()=>r.close()},n.onerror=r=>t(n.error)})}async removeModel(e){return e=Vre(e),new Promise((t,n)=>{let r=this.indexedDB.open(aI,iI);r.onupgradeneeded=()=>sI(r),r.onsuccess=()=>{let a=r.result,i=a.transaction(ho,"readwrite"),s=i.objectStore(ho),o=s.get(e),l;o.onsuccess=()=>{if(o.result==null)return a.close(),n(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{let c=s.delete(e),u=()=>{l=a.transaction(Bl,"readwrite");let d=l.objectStore(Bl).delete(e);d.onsuccess=()=>t(o.result.modelArtifactsInfo),d.onerror=p=>n(o.error)};c.onsuccess=u,c.onerror=d=>(u(),a.close(),n(o.error))}},o.onerror=c=>(a.close(),n(o.error)),i.oncomplete=()=>{l==null?a.close():l.oncomplete=()=>a.close()}},r.onerror=a=>n(r.error)})}},vs="/",xd="tensorflowjs_models",DL="info",jre="model_topology",Hre="weight_specs",Gre="weight_data",qre="model_metadata";function ML(e){return{info:[xd,e,DL].join(vs),topology:[xd,e,jre].join(vs),weightSpecs:[xd,e,Hre].join(vs),weightData:[xd,e,Gre].join(vs),modelMetadata:[xd,e,qre].join(vs)}}function OL(e){for(let t of Object.values(e))window.localStorage.removeItem(t)}function Kre(e){let t=e.split(vs);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(vs)}function Xre(e){return e.startsWith(cu.URL_SCHEME)?e.slice(cu.URL_SCHEME.length):e}var cu=class{constructor(e){if(!Q().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=ML(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=Vg(e),a=es.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,$re(a));let i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw OL(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(n==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;let r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;let a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){let s=JSON.parse(a);t.format=s.format,t.generatedBy=s.generatedBy,t.convertedBy=s.convertedBy,s.signature!=null&&(t.signature=s.signature),s.userDefinedMetadata!=null&&(t.userDefinedMetadata=s.userDefinedMetadata),s.modelInitializer!=null&&(t.modelInitializer=s.modelInitializer),s.initializerSignature!=null&&(t.initializerSignature=s.initializerSignature),s.trainingConfig!=null&&(t.trainingConfig=s.trainingConfig)}let i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=Are(i),t}};cu.URL_SCHEME="localstorage://";var PL=e=>Q().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(cu.URL_SCHEME)?Yre(e.slice(cu.URL_SCHEME.length)):null;rn.registerSaveRouter(PL);rn.registerLoadRouter(PL);function Yre(e){return new cu(e)}var Zre=class{constructor(){F(Q().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),F(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){let e={},t=xd+vs,n=vs+DL;for(let r=0;r<this.LS.length;++r){let a=this.LS.key(r);if(a.startsWith(t)&&a.endsWith(n)){let i=Kre(a);e[i]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){e=Xre(e);let t=ML(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);let n=JSON.parse(this.LS.getItem(t.info));return OL(t),n}},Gd="://",Pr=class{constructor(){this.managers={}}static getInstance(){return Pr.instance==null&&(Pr.instance=new Pr),Pr.instance}static registerManager(e,t){F(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Gd)&&(e=e.slice(0,e.indexOf(Gd))),F(e.length>0,()=>"scheme must not be an empty string.");let n=Pr.getInstance();F(n.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),n.managers[e]=t}static getManager(e){let t=Pr.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(Pr.getInstance().managers)}};function J0(e){if(e.indexOf(Gd)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Pr.getSchemes().join(",")}`);return{scheme:e.split(Gd)[0],path:e.split(Gd)[1]}}async function zL(e,t,n=!1){F(e!==t,()=>`Old path and new path are the same: '${e}'`);let r=rn.getLoadHandlers(e);F(r.length>0,()=>`Copying failed because no load handler is found for source URL ${e}.`),F(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${e}.`);let a=r[0],i=rn.getSaveHandlers(t);F(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),F(i.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`);let s=i[0],o=J0(e).scheme,l=J0(e).path,c=o===J0(e).scheme,u=await a.load();n&&c&&await Pr.getManager(o).removeModel(l);let d=await s.save(u);return n&&!c&&await Pr.getManager(o).removeModel(l),d.modelArtifactsInfo}async function Qre(){let e=Pr.getSchemes(),t={};for(let n of e){let r=await Pr.getManager(n).listModels();for(let a in r){let i=n+Gd+a;t[i]=r[a]}}return t}async function Jre(e){let t=J0(e);return Pr.getManager(t.scheme).removeModel(t.path)}async function eae(e,t){return zL(e,t,!1)}async function tae(e,t){return zL(e,t,!0)}var nae=class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!Q().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",n=>{if(n.source===window&&n.data.name===this.messageName){n.stopPropagation();let r=this.functionRefs[n.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return yL(e)}};if(Q().get("IS_BROWSER")){Q().setPlatform("browser",new nae);try{Pr.registerManager(cu.URL_SCHEME,new Zre)}catch{}try{Pr.registerManager(uu.URL_SCHEME,new Ure)}catch{}}var rae={importFetch:()=>cne()},ok,aae=class{constructor(){this.util=dne(),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return Q().global.fetch!=null?Q().global.fetch(e,t):(ok==null&&(ok=rae.importFetch()),ok(e,t))}now(){let e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}};Q().get("IS_NODE")&&!Q().get("IS_BROWSER")&&Q().setPlatform("node",new aae);function et(e,t="float32",n){return t=t||"float32",ga(e),new Sn(e,t,n)}function iae(e,t){let n=A(e,"x","cast");if(!sL(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");let r={x:n},a={dtype:t};return V.runKernel(Wu,r,a)}var he=U({cast_:iae});function sae(e){let t={x:A(e,"x","clone","string_or_numeric")};return V.runKernel(sc,t)}var Ki=U({clone_:sae});function QC(e,t=!1){console.log(e.toString(t))}CL();var oae={buffer:et,cast:he,clone:Ki,print:QC};yre(oae);function lae(){Q().set("PROD",!0)}function uae(){Q().set("DEBUG",!0)}function cae(){Q().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function LL(e){Q().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function dae(){V.disposeVariables()}function Ga(){return V}function nv(){return V.memory()}function pae(e){return V.profile(e)}function G(e,t){return V.tidy(e,t)}function je(e){KC(e).forEach(t=>t.dispose())}function An(e){return V.keep(e)}function hae(e){return V.time(e)}function fae(e){return V.setBackend(e)}function mae(){return V.ready()}function gae(){return V.backendName}function yae(e){V.removeBackend(e)}function bae(e){return V.findBackend(e)}function vae(e){return V.findBackendFactory(e)}function qx(e,t,n=1){return V.registerBackend(e,t,n)}function BL(){return V.backend}function xae(e,t){Q().setPlatform(e,t)}function wae(e,t){let n=A(e,"a","add"),r=A(t,"b","add");[n,r]=nn(n,r);let a={a:n,b:r};return V.runKernel(Jo,a)}var re=U({add_:wae});function kae(e,t){let n=A(e,"a","floorDiv"),r=A(t,"b","floorDiv");[n,r]=nn(n,r);let a={a:n,b:r};return V.runKernel(rc,a)}var Kx=U({floorDiv_:kae});function Sae(e,t){let n=A(e,"a","div"),r=A(t,"b","div");if([n,r]=nn(n,r),n.dtype==="int32"&&r.dtype==="int32")return Kx(n,r);let a={a:n,b:r},i={};return V.runKernel(Zu,a,i)}var Ie=U({div_:Sae});function Iae(e,t){let n=A(e,"a","mul"),r=A(t,"b","mul");[n,r]=nn(n,r);let a={a:n,b:r};return V.runKernel(kc,a)}var j=U({mul_:Iae});function Cae(e){let t=A(e,"x","abs");if(t.dtype==="complex64"){let n={x:t};return V.runKernel(xg,n)}else{let n={x:t};return V.runKernel(Mp,n)}}var xn=U({abs_:Cae});function _ae(e){let t={x:A(e,"x","acos")};return V.runKernel(Au,t)}var JC=U({acos_:_ae});function Tae(e){let t={x:A(e,"x","acosh")};return V.runKernel(Ru,t)}var e_=U({acosh_:Tae});function Nae(e){F(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),F(e.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`);let t=e.map((a,i)=>A(a,`tensors${i}`,"addN")),n=t[0];t.forEach(a=>{if(a.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(a=>{if(!Ws(a.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});let r=t;return V.runKernel(Fu,r)}var WL=U({addN_:Nae});function Eae(e,t=null,n=!1){let r={x:A(e,"x","all","bool")},a={axis:t,keepDims:n};return V.runKernel(Op,r,a)}var Xx=U({all_:Eae});function $ae(e,t=null,n=!1){let r={x:A(e,"x","any","bool")},a={axis:t,keepDims:n};return V.runKernel(Pp,r,a)}var jm=U({any_:$ae});function Aae(e,t=0){let n={x:A(e,"x","argMax")},r={axis:t};return V.runKernel(zp,n,r)}var du=U({argMax_:Aae});function Rae(e,t=0){let n={x:A(e,"x","argMin")},r={axis:t};return V.runKernel(Lp,n,r)}var t_=U({argMin_:Rae});function Fae(e){let t={x:A(e,"x","asin")};return V.runKernel(Du,t)}var n_=U({asin_:Fae});function Dae(e){let t={x:A(e,"x","asinh")};return V.runKernel(Mu,t)}var r_=U({asinh_:Dae});function Mae(e){let t={x:A(e,"x","atan")};return V.runKernel(Ou,t)}var a_=U({atan_:Mae});function Oae(e,t){let n=A(e,"a","atan2"),r=A(t,"b","atan2");[n,r]=nn(n,r);let a={a:n,b:r};return V.runKernel(zu,a)}var i_=U({atan2_:Oae});function Pae(e){let t={x:A(e,"x","atanh")};return V.runKernel(Pu,t)}var s_=U({atanh_:Pae});function zae(e,t,n,r,a="NHWC",i){let s=e[3],o=[...t,s],l=jL(a);return Ug(e,o,n,i,r,null,null,l)}function VL(e,t,n,r,a,i,s="channelsLast"){let[o,l]=Hm(t),c;if(s==="channelsLast")c=[o,l,e[3],e[3]];else if(s==="channelsFirst")c=[o,l,e[1],e[1]];else throw new Error(`Unknown dataFormat ${s}`);return Ug(e,c,n,r,a,i,!1,s)}function Lae(e,t,n,r,a,i,s="NDHWC"){let[o,l,c]=oI(t),u,d;if(s==="NDHWC")d="channelsLast",u=[o,l,c,e[4],e[4]];else if(s==="NCDHW")d="channelsFirst",u=[o,l,c,e[1],e[1]];else throw new Error(`Unknown dataFormat ${s}`);return UL(e,u,n,r,a,!1,d,i)}function Ug(e,t,n,r,a,i,s=!1,o="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,d]=e;else if(o==="channelsFirst")[l,d,c,u]=e;else throw new Error(`Unknown dataFormat ${o}`);let[p,h,,f]=t,[m,g]=Hm(n),[y,b]=Hm(r),v=qd(p,y),x=qd(h,b),{padInfo:w,outHeight:S,outWidth:C}=Vae(a,c,u,m,g,v,x,i,o),T=s?f*d:f,E;return o==="channelsFirst"?E=[l,T,S,C]:o==="channelsLast"&&(E=[l,S,C,T]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:u,inChannels:d,outHeight:S,outWidth:C,outChannels:T,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:p,filterWidth:h,effectiveFilterHeight:v,effectiveFilterWidth:x,dilationHeight:y,dilationWidth:b,inShape:e,outShape:E,filterShape:t}}function UL(e,t,n,r,a,i=!1,s="channelsLast",o){let[l,c,u,d,p]=[-1,-1,-1,-1,-1];if(s==="channelsLast")[l,c,u,d,p]=e;else if(s==="channelsFirst")[l,p,c,u,d]=e;else throw new Error(`Unknown dataFormat ${s}`);let[h,f,m,,g]=t,[y,b,v]=oI(n),[x,w,S]=oI(r),C=qd(h,x),T=qd(f,w),E=qd(m,S),{padInfo:R,outDepth:$,outHeight:_,outWidth:D}=Uae(a,c,u,d,y,b,v,C,T,E,o),P=i?g*p:g,B;return s==="channelsFirst"?B=[l,P,$,_,D]:s==="channelsLast"&&(B=[l,$,_,D,P]),{batchSize:l,dataFormat:s,inDepth:c,inHeight:u,inWidth:d,inChannels:p,outDepth:$,outHeight:_,outWidth:D,outChannels:P,padInfo:R,strideDepth:y,strideHeight:b,strideWidth:v,filterDepth:h,filterHeight:f,filterWidth:m,effectiveFilterDepth:C,effectiveFilterHeight:T,effectiveFilterWidth:E,dilationDepth:x,dilationHeight:w,dilationWidth:S,inShape:e,outShape:B,filterShape:t}}function Bae(e,t,n,r,a){r==null&&(r=o_(e,t,n));let i=e[0],s=e[1],o=Gm((i-t+2*r)/n+1,a),l=Gm((s-t+2*r)/n+1,a);return[o,l]}function Wae(e,t,n,r,a,i){a==null&&(a=o_(e,t[0],r[0]));let s=[0,0,0,n];for(let o=0;o<3;o++)e[o]+2*a>=t[o]&&(s[o]=Gm((e[o]-t[o]+2*a)/r[o]+1,i));return s}function o_(e,t,n,r=1){let a=qd(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function Hm(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function oI(e){return typeof e=="number"?[e,e,e]:e}function qd(e,t){return t<=1?e:e+(e-1)*(t-1)}function Vae(e,t,n,r,a,i,s,o,l){let c,u,d;if(typeof e=="number"){c={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};let p=Bae([t,n],i,r,e,o);u=p[0],d=p[1]}else if(e==="same"){u=Math.ceil(t/r),d=Math.ceil(n/a);let p=Math.max(0,(u-1)*r+i-t),h=Math.max(0,(d-1)*a+s-n),f=Math.floor(p/2),m=p-f,g=Math.floor(h/2),y=h-g;c={top:f,bottom:m,left:g,right:y,type:"SAME"}}else if(e==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((t-i+1)/r),d=Math.ceil((n-s+1)/a);else if(typeof e=="object"){let p=l==="channelsLast"?e[1][0]:e[2][0],h=l==="channelsLast"?e[1][1]:e[2][1],f=l==="channelsLast"?e[2][0]:e[3][0],m=l==="channelsLast"?e[2][1]:e[3][1];c={top:p,bottom:h,left:f,right:m,type:p===0&&h===0&&f===0&&m===0?"VALID":"EXPLICIT"},u=Gm((t-i+p+h)/r+1,o),d=Gm((n-s+f+m)/a+1,o)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:c,outHeight:u,outWidth:d}}function Uae(e,t,n,r,a,i,s,o,l,c,u){let d,p,h,f;if(e==="valid"&&(e=0),typeof e=="number"){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};let m=Wae([t,n,r,1],[o,l,c],1,[a,i,s],e,u);p=m[0],h=m[1],f=m[2]}else if(e==="same"){p=Math.ceil(t/a),h=Math.ceil(n/i),f=Math.ceil(r/s);let m=(p-1)*a+o-t,g=(h-1)*i+l-n,y=(f-1)*s+c-r,b=Math.floor(m/2),v=m-b,x=Math.floor(g/2),w=g-x,S=Math.floor(y/2),C=y-S;d={top:x,bottom:w,left:S,right:C,front:b,back:v,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:d,outDepth:p,outHeight:h,outWidth:f}}function Gm(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function zo(e){let[t,n,r]=Hm(e);return t===1&&n===1&&r===1}function ts(e,t){return zo(e)||zo(t)}function pu(e){return Hm(e).every(t=>t>0)}function jL(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function Ar(e,t,n){if(n!=null){if(typeof t=="string")throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t=="number")F(sp(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t=="object")t.forEach(r=>{r.forEach(a=>{F(sp(a),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${a}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}function jae(e,t){let n={x:A(e,"x","reshape","string_or_numeric")},r={shape:t};return V.runKernel(vh,n,r)}var H=U({reshape_:jae});function Hae(e,t,n,r,a){let i=A(e,"x","avgPool","float32"),s=1;F(ts(n,s),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);let o=i,l=!1;i.rank===3&&(l=!0,o=H(i,[1,i.shape[0],i.shape[1],i.shape[2]])),F(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),Ar("avgPool",r,a);let c={x:o},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a},d=V.runKernel(Lu,c,u);return d=he(d,i.dtype),l?H(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var Vs=U({avgPool_:Hae});function Gae(e,t,n,r,a,i="NDHWC"){let s=A(e,"x","avgPool3d","float32"),o=s,l=!1;s.rank===4&&(l=!0,o=H(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),F(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),F(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),F(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Ar("avgPool3d",r,a);let c={x:o},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},d=V.runKernel(Bp,c,u);return d=he(d,o.dtype),l?H(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}var l_=U({avgPool3d_:Gae});function qae(e,t=0){F(e.length>=1,()=>"Pass at least one tensor to concat");let n=Um(e,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return Ki(n[0]);let r=n,a={axis:t};return V.runKernel(jp,r,a)}var Et=U({concat_:qae});function Kae(e,t,n=!1,r=!1){let a=A(e,"a","matMul"),i=A(t,"b","matMul");[a,i]=nn(a,i);let s={a,b:i},o={transposeA:n,transposeB:r};return V.runKernel(Bu,s,o)}var Ye=U({matMul_:Kae});function Xae(e){let t={x:A(e,"x","sigmoid","float32")};return V.runKernel(Bc,t)}var ei=U({sigmoid_:Xae});function Yae(e,t,n){let r=A(e,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");let a={x:r},i={begin:t,size:n};return V.runKernel(_h,a,i)}var it=U({slice_:Yae});function Zae(e){let t={x:A(e,"x","tanh","float32")};return V.runKernel(Kc,t)}var hu=U({tanh_:Zae});function Qae(e,t,n,r,a,i){let s=A(e,"forgetBias","basicLSTMCell"),o=A(t,"lstmKernel","basicLSTMCell"),l=A(n,"lstmBias","basicLSTMCell"),c=A(r,"data","basicLSTMCell"),u=A(a,"c","basicLSTMCell"),d=A(i,"h","basicLSTMCell"),p=Et([c,d],1),h=Ye(p,o),f=re(h,l),m=f.shape[0],g=f.shape[1]/4,y=[m,g],b=it(f,[0,0],y),v=it(f,[0,g],y),x=it(f,[0,g*2],y),w=it(f,[0,g*3],y),S=re(j(ei(b),hu(v)),j(u,ei(re(s,x)))),C=j(hu(S),ei(w));return[S,C]}var HL=U({basicLSTMCell_:Qae});function Jae(e,t,n){let r=A(e,"x","batchToSpaceND"),a=t.reduce((o,l)=>o*l);F(r.rank>=1+t.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`),F(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),F(r.shape[0]%a===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${a}`);let i={x:r},s={blockShape:t,crops:n};return V.runKernel(Wp,i,s)}var jg=U({batchToSpaceND_:Jae});function eie(e){let t;return e.rank===0||e.rank===1?t=H(e,[1,1,1,e.size]):e.rank===2?t=H(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=H(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}function tie(e,t,n,r,a,i){i==null&&(i=.001);let s=A(e,"x","batchNorm"),o=A(t,"mean","batchNorm"),l=A(n,"variance","batchNorm"),c;a!=null&&(c=A(a,"scale","batchNorm"));let u;r!=null&&(u=A(r,"offset","batchNorm")),F(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),F(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),F(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let d={x:eie(s),scale:c,offset:u,mean:o,variance:l},p={varianceEpsilon:i},h=V.runKernel(ac,d,p);return H(h,s.shape)}var Xc=U({batchNorm_:tie});function nie(e,t,n,r,a,i){let s=A(e,"x","batchNorm"),o=A(t,"mean","batchNorm"),l=A(n,"variance","batchNorm"),c;a!=null&&(c=A(a,"scale","batchNorm"));let u;return r!=null&&(u=A(r,"offset","batchNorm")),F(s.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${s.rank}.`),F(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),F(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&F(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&F(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),Xc(s,o,l,u,c,i)}var u_=U({batchNorm2d_:nie});function rie(e,t,n,r,a,i){let s=A(e,"x","batchNorm"),o=A(t,"mean","batchNorm"),l=A(n,"variance","batchNorm"),c;a!=null&&(c=A(a,"scale","batchNorm"));let u;return r!=null&&(u=A(r,"offset","batchNorm")),F(s.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${s.rank}.`),F(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),F(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&F(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&F(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),Xc(s,o,l,u,c,i)}var c_=U({batchNorm3d_:rie});function aie(e,t,n,r,a,i){let s=A(e,"x","batchNorm"),o=A(t,"mean","batchNorm"),l=A(n,"variance","batchNorm"),c;a!=null&&(c=A(a,"scale","batchNorm"));let u;return r!=null&&(u=A(r,"offset","batchNorm")),F(s.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${s.rank}.`),F(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),F(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&F(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&F(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),Xc(s,o,l,u,c,i)}var d_=U({batchNorm4d_:aie});function iie(e,t,n){let r=A(e,"x","bincount"),a=A(t,"weights","bincount");F(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),F(n>=0,()=>`size must be non-negative, but got ${n}.`),F(a.size===r.size||a.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${a.shape}.`);let i={x:r,weights:a},s={size:n};return V.runKernel(Vp,i,s)}var p_=U({bincount_:iie});function sie(e,t){let n=A(e,"x","bitwiseAnd"),r=A(t,"y","bitwiseAnd");if(!Ws(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);let a={a:n,b:r};return V.runKernel(Up,a)}var GL=U({bitwiseAnd_:sie});function oie(e,t){let n=A(e,"s0","broadcastArgs","int32"),r=A(t,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);let a={s0:n,s1:r};return V.runKernel(vg,a)}var qL=U({broadcastArgs_:oie});function lie(e,t){let n=A(e,"broadcastTo","x"),r=n.shape;if(ga(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){let l=n.shape.slice();for(;l.length<t.length;)l.unshift(1);n=H(n,l)}let a=n.shape,i=Array.from(t);for(let l=t.length-1;l>=0;l--)if(a[l]===t[l])i[l]=1;else if(n.shape[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(i.map((l,c)=>l>1?c:-1).filter(l=>l>=0).length===0)return Ki(n);let s={x:n},o={reps:i};return V.runKernel(tl,s,o)}var Hl=U({broadcastTo_:lie});function uie(e){let t={x:A(e,"x","ceil","float32")};return V.runKernel(Vu,t)}var h_=U({ceil_:uie});function ua(e,t,n){ga(e),n=n||gg(t);let r={shape:e,value:t,dtype:n};return V.runKernel(Sg,{},r)}function cie(e,t,n){let r=A(e,"x","clipByValue");if(F(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return ua(r.shape,t,r.dtype);let a={x:r},i={clipValueMin:t,clipValueMax:n};return V.runKernel(el,a,i)}var hr=U({clipByValue_:cie});function die(e){return Et(e,0)}var f_=U({concat1d_:die});function pie(e,t){return Et(e,t)}var m_=U({concat2d_:pie});function hie(e,t){return Et(e,t)}var g_=U({concat3d_:hie});function fie(e,t){return Et(e,t)}var y_=U({concat4d_:fie});function mie(e,t,n,r,a="NHWC",i=[1,1],s){let o=A(e,"x","conv2d","float32"),l=A(t,"filter","conv2d","float32"),c=o,u=!1;o.rank===3&&(u=!0,c=H(o,[1,o.shape[0],o.shape[1],o.shape[2]])),F(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),F(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Ar("conv2d",r,s);let d=a==="NHWC"?c.shape[3]:c.shape[1];F(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),F(ts(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),F(pu(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),F(pu(n),()=>"Error in conv2D: Strides should be larger than 0.");let p={x:c,filter:l},h={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:s},f=V.runKernel(Uu,p,h);return u?H(f,[f.shape[1],f.shape[2],f.shape[3]]):f}var _r=U({conv2d_:mie});function gie(e,t,n,r,a="NWC",i=1,s){let o=A(e,"x","conv1d"),l=A(t,"filter","conv1d"),c=o,u=!1;o.rank===2&&(u=!0,c=H(o,[1,o.shape[0],o.shape[1]])),F(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),F(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Ar("conv1d",r,s),F(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),F(ts(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),F(pu(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),F(pu(n),()=>"Error in conv1D: Stride should be larger than 0."),F(a==="NWC",()=>`Error in conv1d: got dataFormat of ${a} but only NWC is currently supported.`);let d=H(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=H(c,[c.shape[0],1,c.shape[1],c.shape[2]]),h=_r(p,d,[1,n],r,"NHWC",[1,i],s);return u?H(h,[h.shape[2],h.shape[3]]):H(h,[h.shape[0],h.shape[2],h.shape[3]])}var Yx=U({conv1d_:gie});function yie(e,t,n,r,a,i="NHWC",s){F(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let o=e,l=t,c=!1;t.rank===3&&(c=!0,l=H(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,e[0],e[1],e[2]]),F(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),F(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),F(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);let u=i==="NHWC"?o[3]:o[1],d=i==="NHWC"?l.shape[3]:l.shape[1];F(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),F(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),Ar("conv2dDerInput",a,s);let p={dy:l,filter:n},h={strides:r,pad:a,dataFormat:i,dimRoundingMode:s,inputShape:o},f=V.runKernel(ju,p,h);return c?H(f,[f.shape[1],f.shape[2],f.shape[3]]):f}var b_=U({conv2DBackpropInput_:yie});function bie(e,t,n,r,a,i){let s=A(e,"x","conv2dTranspose"),o=A(t,"filter","conv2dTranspose");return b_(n,s,o,r,a,"NHWC",i)}var Zx=U({conv2dTranspose_:bie});function vie(e,t,n,r,a="NDHWC",i=[1,1,1]){let s=A(e,"x","conv3d"),o=A(t,"filter","conv3d"),l=s,c=!1;s.rank===4&&(c=!0,l=H(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),F(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),F(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),F(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),F(ts(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),F(a==="NDHWC",()=>`Error in conv3d: got dataFormat of ${a} but only NDHWC is currently supported.`),F(pu(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),F(pu(n),()=>"Error in conv3D: Strides should be larger than 0.");let u={x:l,filter:o},d={strides:n,pad:r,dataFormat:a,dilations:i},p=V.runKernel(Hu,u,d);return c?H(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var v_=U({conv3d_:vie});function xie(e,t,n,r,a){F(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let i=e,s=t,o=!1;t.rank===4&&(o=!0,s=H(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);let l=i[4],c=s.shape[4];F(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),F(s.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${s.rank}`),F(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),F(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),F(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);let u={dy:s,filter:n},d={pad:a,strides:r,inputShape:i},p=V.runKernel(Gp,u,d);return o?H(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var KL=U({conv3DBackpropInput_:xie});function wie(e,t,n,r,a){let i=A(e,"x","conv3dTranspose"),s=A(t,"filter","conv3dTranspose");return KL(n,i,s,r,a)}var x_=U({conv3dTranspose_:wie});function kie(e){let t={x:A(e,"x","cos","float32")};return V.runKernel(Gu,t)}var Hg=U({cos_:kie});function Sie(e){let t={x:A(e,"x","cosh","float32")};return V.runKernel(qu,t)}var Qx=U({cosh_:Sie});function Iie(e,t=0,n=!1,r=!1){let a={x:A(e,"x","cumprod")},i={axis:t,exclusive:n,reverse:r};return V.runKernel(qp,a,i)}var qm=U({cumprod_:Iie});function Cie(e,t=0,n=!1,r=!1){let a={x:A(e,"x","cumsum")},i={axis:t,exclusive:n,reverse:r};return V.runKernel(Ku,a,i)}var Jx=U({cumsum_:Cie});function _ie(e,t,n,r=!1){let a=A(e,"x","denseBincount"),i=A(t,"weights","denseBincount");F(a.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${a.dtype}`),F(a.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${a.rank}.`),F(n>=0,()=>`size must be non-negative, but got ${n}.`),F(i.size===a.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${a.shape}, weights shape: ${i.shape}.`);let s={x:a,weights:i},o={size:n,binaryOutput:r};return V.runKernel(wg,s,o)}var rv=U({denseBincount_:_ie});function Tie(e,t,n="NHWC"){let r=A(e,"x","depthToSpace","float32"),a=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],s=n==="NHWC"?r.shape[3]:r.shape[1];F(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),F(a*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${t}  for depthToSpace with input shape
    ${r.shape}`),F(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${t} for depthToSpace with input shape
        ${r.shape}`),F(s%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${s} for depthToSpace with input shape ${r.shape}`);let o={x:r},l={blockSize:t,dataFormat:n};return V.runKernel(Xp,o,l)}var w_=U({depthToSpace_:Tie});function Nie(e,t,n,r,a="NHWC",i=[1,1],s){let o=A(e,"x","depthwiseConv2d","float32"),l=A(t,"filter","depthwiseConv2d","float32"),c=o,u=!1;o.rank===3&&(u=!0,c=H(o,[1,o.shape[0],o.shape[1],o.shape[2]])),F(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),F(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);let d=a==="NHWC"?c.shape[3]:c.shape[1];F(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),Ar("depthwiseConv2d",r,s);let p={x:c,filter:l},h={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:s},f=V.runKernel(Xu,p,h);return u?H(f,[f.shape[1],f.shape[2],f.shape[3]]):f}var Yc=U({depthwiseConv2d_:Nie});function Eie(e){let t={x:A(e,"x","diag")};return V.runKernel(kg,t)}var XL=U({diag_:Eie});function $ie(e,t,n,r,a=[1,1],i="NHWC"){let s=A(e,"x","dilation2d"),o=A(t,"filter","dilation2d");F(s.rank===3||s.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${s.rank}.`),F(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),F(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=s,c=!1;s.rank===3&&(l=H(s,[1,s.shape[0],s.shape[1],s.shape[2]]),c=!0),F(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);let u={x:l,filter:o},d={strides:n,pad:r,dilations:a},p=V.runKernel(Yu,u,d);return c?H(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var k_=U({dilation2d_:$ie}),Ph={};He(Ph,{assertAndGetBroadcastShape:()=>$t,getBroadcastDims:()=>YL,getReductionAxes:()=>In});function YL(e,t){let n=e.length,r=[];for(let a=0;a<n;a++){let i=n-1-a,s=e[i]||1;(t[t.length-1-a]||1)>1&&s===1&&r.unshift(i)}return r}function In(e,t){let n=[];for(let r=0;r<t.length;r++){let a=e[e.length-r-1],i=t.length-r-1,s=t[i];(a==null||a===1&&s>1)&&n.unshift(i)}return n}function $t(e,t){let n=Math.max(e.length,t.length),r=new Array(n);for(let a=0;a<n;a++){let i=e[e.length-a-1];i==null&&(i=1);let s=t[t.length-a-1];if(s==null&&(s=1),i===1)r[n-a-1]=s;else if(s===1)r[n-a-1]=i;else if(i!==s){let o=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(o)}else r[n-a-1]=i}return r}function Aie(e,t){let n=A(e,"a","equal","string_or_numeric"),r=A(t,"b","equal","string_or_numeric");[n,r]=nn(n,r),$t(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(Zp,a)}var pa=U({equal_:Aie});function Rie(e,t,n){let r=A(t,"a","where"),a=A(n,"b","where"),i=A(e,"condition","where","bool"),s=$t($t(i.shape,r.shape),a.shape),o=Hl(i,s),l=Hl(r,s),c=Hl(a,s),u={condition:o,t:l,e:c};return V.runKernel(Ch,u)}var Hn=U({where_:Rie});function Fie(e){let t={x:A(e,"x","zerosLike")};return V.runKernel(Mh,t)}var st=U({zerosLike_:Fie});function Die(e,t){let n=A(e,"a","div"),r=A(t,"b","div");[n,r]=nn(n,r);let a=Ie(n,r),i=st(a),s=pa(r,i);return Hn(s,i,a)}var S_=U({divNoNan_:Die});function Mie(e,t){let n=A(e,"t1","dot"),r=A(t,"t2","dot");F((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);let a=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];if(F(a===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${a} and ${i}.`),n.rank===1&&r.rank===1){let s=H(n,[1,-1]),o=H(r,[-1,1]),l=Ye(s,o);return H(l,[])}else if(n.rank===1&&r.rank===2){let s=H(n,[1,-1]),o=H(r,[r.shape[0],r.shape[1]]),l=Ye(s,o);return H(l,[l.size])}else if(n.rank===2&&r.rank===1){let s=H(r,[-1,1]),o=Ye(n,s);return H(o,[o.size])}else{let s=H(r,[r.shape[0],r.shape[1]]);return Ye(n,s)}}var I_=U({dot_:Mie});function Oie(e,...t){let n=t.map((a,i)=>A(a,`tensors${i}`,"einsum")),r={equation:e};return V.runKernel(Px,n,r)}var ZL=U({einsum_:Oie});function Pie(e){let t={x:A(e,"x","elu","float32")};return V.runKernel(Qu,t)}var zh=U({elu_:Pie});function zie(e,t){let n=A(e,"x","ensureShape","string_or_numeric");if(!nL(n.shape,t))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}var QL=U({ensureShape_:zie});function Lie(e){let t=A(e,"x","erf");F(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=he(t,"float32"));let n={x:t};return V.runKernel(Ju,n)}var C_=U({erf_:Lie});function __(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function JL(e,t,n){let r=e.length+t.length,a=[],i=0,s=0;for(let o=0;o<r;o++)n.indexOf(o)===-1?a.push(e[i++]):a.push(t[s++]);return a}function e4(e,t){let n=[],r=e.length;for(let i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);let a=t.map(i=>e[i]);return[n,a]}function fu(e,t){let n=t.map(r=>1);return JL(e,n,t)}function Bie(e,t,n){F(__(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function t4(e,t){if(__(e,t))return null;let n=[];for(let r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(r=>n.push(r)),n}function T_(e){return e.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function Wie(e,t){let n=[];for(let r=t-e;r<t;++r)n.push(r);return n}function Vie(e,t=null,n=!1){let r={x:A(e,"x","max")},a={reductionIndices:t,keepDims:n};return V.runKernel(fc,r,a)}var $a=U({max_:Vie});function Uie(e,t=null,n=!1){let r={x:A(e,"x","min")},a={axis:t,keepDims:n};return V.runKernel(bc,r,a)}var cp=U({min_:Uie});function jie(e,t){let n=A(e,"base","pow"),r=A(t,"exp","pow");[n,r]=nn(n,r);let a={a:n,b:r};return V.runKernel(Cc,a)}var Ps=U({pow_:jie});function Re(e,t){if((Vn(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Vn(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return rl(e,[],[],t)}function Hie(e){let t={x:A(e,"x","sqrt","float32")};return V.runKernel(Vc,t)}var ar=U({sqrt_:Hie});function Gie(e){let t=A(e,"x","square"),n={};return V.runKernel("Square",{x:t},n)}var Tt=U({square_:Gie});function qie(e,t=null,n=!1){let r=A(e,"x","sum");r.dtype==="bool"&&(r=he(r,"int32"));let a={x:r},i={axis:t,keepDims:n};return V.runKernel(Uc,a,i)}var Te=U({sum_:qie});function Kie(e,t="euclidean",n=null,r=!1){e=A(e,"x","norm");let a=n4(e,t,n),i=a.shape;if(r){let s=si(n,e.shape);i=fu(a.shape,s)}return H(a,i)}function n4(e,t,n=null){if(e.rank===0)return xn(e);if(e.rank!==1&&n===null)return n4(H(e,[-1]),t,n);if(e.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return Te(xn(e),n);if(t===1/0)return $a(xn(e),n);if(t===-1/0)return cp(xn(e),n);if(t==="euclidean"||t===2)return ar(Te(Ps(xn(e),Re(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return $a(Te(xn(e),n[0]),n[1]-1);if(t===1/0)return $a(Te(xn(e),n[1]),n[0]);if(t===-1/0)return cp(Te(xn(e),n[1]),n[0]);if(t==="fro"||t==="euclidean")return ar(Te(Tt(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}var Lh=U({norm_:Kie});function Xie(e,t=null,n=!1){return Lh(e,"euclidean",t,n)}var N_=U({euclideanNorm_:Xie});function Yie(e){let t={x:A(e,"x","exp")};return V.runKernel(ec,t)}var Tr=U({exp_:Yie});function Zie(e,t=0){let n=A(e,"x","expandDims","string_or_numeric");F(t<=n.rank,()=>"Axis must be <= rank of the tensor");let r={input:n},a={dim:t};return V.runKernel(Qp,r,a)}var Qn=U({expandDims_:Zie});function Qie(e){let t={x:A(e,"x","expm1")};return V.runKernel(tc,t)}var E_=U({expm1_:Qie});function Jie(e,t){let n=A(e,"x","tile","string_or_numeric");F(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);let r={x:n},a={reps:t};return V.runKernel(tl,r,a)}var aa=U({tile_:Jie});function ese(e,t,n,r="float32"){t==null&&(t=e);let a=et([e,t],r),i=e<=t?e:t;for(let o=0;o<i;++o)a.set(1,o,o);let s=H(a.toTensor(),[e,t]);if(n==null)return s;if(n.length===1)return aa(Qn(s,0),[n[0],1,1]);if(n.length===2)return aa(Qn(Qn(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return aa(Qn(Qn(Qn(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}var e1=U({eye_:ese});function tse(e){let t={x:A(e,"x","floor","float32")};return V.runKernel(nc,t)}var Bh=U({floor_:tse});function nse(e,t,n=0,r=0){let a=A(e,"x","gather"),i=A(t,"indices","gather","int32"),s={x:a,indices:i},o={axis:n,batchDims:r};return V.runKernel(eh,s,o)}var Wh=U({gather_:nse});function rse(e,t){let n=A(e,"a","greater","string_or_numeric"),r=A(t,"b","greater","string_or_numeric");[n,r]=nn(n,r),$t(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(nh,a)}var Rr=U({greater_:rse});function ase(e,t){let n=A(e,"a","greaterEqual","string_or_numeric"),r=A(t,"b","greaterEqual","string_or_numeric");[n,r]=nn(n,r),$t(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(ic,a)}var Us=U({greaterEqual_:ase});function ise(e){let t={input:A(e,"input","imag")};return V.runKernel(Bx,t)}var Gg=U({imag_:ise});function sse(e){let t={x:A(e,"x","isFinite")};return V.runKernel(oc,t)}var $_=U({isFinite_:sse});function ose(e){let t={x:A(e,"x","isInf")};return V.runKernel(lc,t)}var A_=U({isInf_:ose});function lse(e){let t={x:A(e,"x","isNaN")};return V.runKernel(uc,t)}var R_=U({isNaN_:lse});function use(e,t=.2){let n={x:A(e,"x","leakyRelu")},r={alpha:t};return V.runKernel(cc,n,r)}var qg=U({leakyRelu_:use});function cse(e,t){let n=A(e,"a","less","string_or_numeric"),r=A(t,"b","less","string_or_numeric");[n,r]=nn(n,r),$t(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(rh,a)}var dp=U({less_:cse});function dse(e,t){let n=A(e,"a","lessEqual","string_or_numeric"),r=A(t,"b","lessEqual","string_or_numeric");[n,r]=nn(n,r),$t(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(ah,a)}var al=U({lessEqual_:dse});function r4(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");let r={start:e,stop:t,num:n};return V.runKernel(ih,{},r)}function pse(e,t=5,n=1,r=1,a=.5){let i=A(e,"x","localResponseNormalization");F(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),F(sp(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let s=i,o=!1;i.rank===3&&(o=!0,s=H(i,[1,i.shape[0],i.shape[1],i.shape[2]]));let l={x:s},c={depthRadius:t,bias:n,alpha:r,beta:a},u=V.runKernel(hc,l,c);return o?H(u,[u.shape[1],u.shape[2],u.shape[3]]):u}var F_=U({localResponseNormalization_:pse});function hse(e){let t={x:A(e,"x","log","float32")};return V.runKernel(dc,t)}var ha=U({log_:hse});function fse(e){let t={x:A(e,"x","log1p")};return V.runKernel(pc,t)}var Kg=U({log1p_:fse});function mse(e){return F(Oo(e),()=>"The f passed in grad(f) must be a function"),(t,n)=>{let r=A(t,"x","tf.grad","string_or_numeric"),a=n!=null?A(n,"dy","tf.grad"):null;return V.tidy(()=>{let{value:i,grads:s}=V.gradients(()=>e(r),[r],a);return a!=null&&$r(i.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),t1(s),s[0]})}}function gse(e){return F(Oo(e),()=>"The f passed in grads(f) must be a function"),(t,n)=>{F(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");let r=Um(t,"args","tf.grads","string_or_numeric"),a=n!=null?A(n,"dy","tf.grads"):null;return V.tidy(()=>{let{value:i,grads:s}=V.gradients(()=>e(...r),r,a);return a!=null&&$r(i.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),t1(s),s})}}function yse(e){return F(Oo(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{F(t instanceof Ze,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),F(n==null||n instanceof Ze,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");let{grads:r,value:a}=V.gradients(()=>e(t),[t],n);return t1(r),{grad:r[0],value:a}}}function bse(e){return F(Oo(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{F(Array.isArray(t)&&t.every(a=>a instanceof Ze),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),F(n==null||n instanceof Ze,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");let r=V.gradients(()=>e(...t),t,n);return n!=null&&$r(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),t1(r.grads),r}}function a4(e,t){F(Oo(e),()=>"The f passed in variableGrads(f) must be a function"),F(t==null||Array.isArray(t)&&t.every(c=>c instanceof lu),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let n=t!=null;if(!n){t=[];for(let c in V.registeredVariables)t.push(V.registeredVariables[c])}let r=n?t.filter(c=>!c.trainable):null,a=t.length;t=t.filter(c=>c.trainable),F(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${a} variables is trainable.`);let i=!0,{value:s,grads:o}=V.gradients(e,t,null,i);F(o.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),F(s.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${s.rank} tensor`);let l={};return t.forEach((c,u)=>{o[u]!=null&&(l[c.name]=o[u])}),r!=null&&r.forEach(c=>l[c.name]=null),{value:s,grads:l}}function Qi(e){return V.customGrad(e)}function t1(e){if(e.filter(t=>t==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}function vse(e){let t={x:A(e,"x","neg")};return V.runKernel(ph,t)}var Bt=U({neg_:vse});function xse(e){let t={x:A(e,"x","softplus")};return V.runKernel(Wc,t)}var Zc=U({softplus_:xse});function wse(e){let t=A(e,"x","logSigmoid");return Qi(n=>({value:Bt(Zc(Bt(n))),gradFunc:r=>j(r,ei(Bt(n)))}))(t)}var D_=U({logSigmoid_:wse});function kse(e,t){let n=A(e,"a","sub"),r=A(t,"b","sub");[n,r]=nn(n,r);let a={a:n,b:r};return V.runKernel(Gc,a)}var we=U({sub_:kse});function Sse(e,t=-1){let n=A(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return Qi((r,a)=>{let i=$a(r,t,!0),s=we(r,i),o=we(he(s,"float32"),ha(Te(Tr(s),t,!0)));return a([o]),{value:o,gradFunc:(l,c)=>{let[u]=c,d=!0,p=Tr(u);return we(l,j(Te(l,t,d),p))}}})(n)}var n1=U({logSoftmax_:Sse});function Ise(e,t=null,n=!1){let r=A(e,"x","logSumExp"),a=si(t,r.shape),i=$a(r,a,!0),s=we(r,i),o=Tr(s),l=Te(o,a),c=ha(l),u=re(H(i,c.shape),c);if(n){let d=fu(u.shape,a);return H(u,d)}return u}var r1=U({logSumExp_:Ise});function Cse(e,t){let n=A(e,"a","logicalAnd","bool"),r=A(t,"b","logicalAnd","bool");$t(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(sh,a)}var ri=U({logicalAnd_:Cse});function _se(e){let t={x:A(e,"x","logicalNot","bool")};return V.runKernel(oh,t)}var Xg=U({logicalNot_:_se});function Tse(e,t){let n=A(e,"a","logicalOr","bool"),r=A(t,"b","logicalOr","bool");$t(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(lh,a)}var a1=U({logicalOr_:Tse});function Nse(e,t){let n=A(e,"a","logicalXor","bool"),r=A(t,"b","logicalXor","bool");return $t(n.shape,r.shape),ri(a1(e,t),Xg(ri(e,t)))}var M_=U({logicalXor_:Nse}),h0=2147483648;function Ese(e,t,n="left"){let r=A(e,"sortedSequence","searchSorted"),a=A(t,"values","searchSorted"),i=r.shape[r.shape.length-1],s=a.shape[a.shape.length-1],o=H(r,[-1,i]),l=H(a,[-1,s]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Lt(l.shape)>=h0)throw new Error(`values tensor size must less than ${h0}`);if(o.shape[1]>=h0)throw new Error(`trailing dim_size must less than ${h0} for int32 output type, was ${o.shape[1]}`);let c={sortedSequence:o,values:l},u={side:n};return V.runKernel(Ih,c,u)}var i1=U({searchSorted_:Ese});function i4(e,t){return i1(e,t,"left")}function $se(e,t,n,r,a){let i=A(e,"x","maxPool"),s=1,o=i,l=!1;i.rank===3&&(l=!0,o=H(i,[1,i.shape[0],i.shape[1],i.shape[2]])),F(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),F(ts(n,s),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),Ar("maxPool",r,a);let c={x:o},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a},d=V.runKernel(gc,c,u);return l?H(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var Ln=U({maxPool_:$se});function Ase(e,t=[1,1,1],n,r,a,i="NDHWC"){let s=A(e,"x","maxPool3d"),o=s,l=!1;s.rank===4&&(l=!0,o=H(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),F(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),F(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),Ar("maxPool3d",r,a);let c={x:o},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},d=V.runKernel(ch,c,u);return l?H(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}var O_=U({maxPool3d_:Ase});function Rse(e,t,n,r,a=!1){let i={x:A(e,"x","maxPoolWithArgmax")},s={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},o=V.runKernel(_g,i,s);return{result:o[0],indexes:o[1]}}var s4=U({maxPoolWithArgmax_:Rse});function Fse(e,t){let n=A(e,"a","maximum"),r=A(t,"b","maximum");[n,r]=nn(n,r),n.dtype==="bool"&&(n=he(n,"int32"),r=he(r,"int32")),$t(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(mc,a)}var ns=U({maximum_:Fse});function Dse(e,t=null,n=!1){let r={x:A(e,"x","mean")},a={axis:t,keepDims:n};return V.runKernel(yc,r,a)}var Jt=U({mean_:Dse});function en(e,t="float32"){if(ga(e),t==="complex64"){let r=en(e,"float32"),a=en(e,"float32");return Os(r,a)}let n=Ax(Lt(e),t);return V.makeTensor(n,e,t)}function ia(e,t="float32"){if(ga(e),t==="complex64"){let r=ia(e,"float32"),a=en(e,"float32");return Os(r,a)}let n=UC(Lt(e),t);return V.makeTensor(n,e,t)}function o4(e,t,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(e===void 0)return[];let r=A(e,"x","meshgrid",e instanceof Ze?e.dtype:"float32");if(t===void 0)return[r];let a=A(t,"y","meshgrid",t instanceof Ze?t.dtype:"float32"),i=Lt(r.shape),s=Lt(a.shape);return n==="xy"?(r=H(r,[1,-1]),a=H(a,[-1,1]),[Ye(ia([s,1],r.dtype),r),Ye(a,ia([1,i],a.dtype))]):(r=H(r,[-1,1]),a=H(a,[1,-1]),[Ye(r,ia([1,s],r.dtype)),Ye(ia([i,1],a.dtype),a)])}function Mse(e,t){let n=A(e,"a","minimum"),r=A(t,"b","minimum");[n,r]=nn(n,r),n.dtype==="bool"&&(n=he(n,"int32"),r=he(r,"int32")),$t(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(vc,a)}var Lo=U({minimum_:Mse});function Ose(e,t,n){F(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);let r=A(e,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");F(t.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`);let a=n==="reflect"?1:0;for(let o=0;o<r.rank;o++)F(t[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),F(t[o][0]>=0&&t[o][0]<=r.shape[o]-a&&t[o][1]>=0&&t[o][1]<=r.shape[o]-a,()=>`Padding in dimension ${o} cannot be greater than or equal to ${r.shape[o]-a} or less than 0 for input of shape ${r.shape}`);let i={paddings:t,mode:n},s={x:r};return V.runKernel(xc,s,i)}var P_=U({mirrorPad_:Ose});function Pse(e,t){let n=A(e,"a","mod"),r=A(t,"b","mod");[n,r]=nn(n,r);let a={a:n,b:r};return V.runKernel(wc,a)}var z_=U({mod_:Pse});function zse(e,t=null,n=!1){e=A(e,"x","moments");let r=si(t,e.shape),a=Jt(e,r,n),i=a.shape;n||(i=fu(a.shape,r));let s=Tt(we(he(e,"float32"),H(a,i))),o=Jt(s,r,n);return{mean:a,variance:o}}var Yg=U({moments_:zse});function Lse(e,t,n,r){let a=A(t,"data","multiRNNCell"),i=Um(n,"c","multiRNNCell"),s=Um(r,"h","multiRNNCell"),o=a,l=[];for(let d=0;d<e.length;d++){let p=e[d](o,i[d],s[d]);l.push(p[0]),l.push(p[1]),o=p[1]}let c=[],u=[];for(let d=0;d<l.length;d+=2)c.push(l[d]),u.push(l[d+1]);return[c,u]}var l4=U({multiRNNCell_:Lse});function Bse(e,t,n,r=!1){let a=A(e,"logits","multinomial"),i=a.size,s=a.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(s>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${s}`);n=n||Math.random();let o={logits:s===1?H(a,[1,-1]):a},l={numSamples:t,seed:n,normalized:r},c=V.runKernel(dh,o,l);return s===1?H(c,[c.size]):c}var u4=U({multinomial_:Bse});function Wse(e,t){let n=A(e,"a","notEqual","string_or_numeric"),r=A(t,"b","notEqual","string_or_numeric");[n,r]=nn(n,r),$t(n.shape,r.shape);let a={a:n,b:r};return V.runKernel(hh,a)}var mu=U({notEqual_:Wse});function Vse(e,t,n=1,r=0,a="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);let i={indices:A(e,"indices","oneHot","int32")},s={dtype:a,depth:t,onValue:n,offValue:r};return V.runKernel(Sc,i,s)}var pp=U({oneHot_:Vse});function Use(e){let t={x:A(e,"x","onesLike")};return V.runKernel(yh,t)}var fa=U({onesLike_:Use});function jse(e,t){let n=A(e,"v1","outerProduct"),r=A(t,"v2","outerProduct");F(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);let a=H(n,[-1,1]),i=H(r,[1,-1]);return Ye(a,i)}var c4=U({outerProduct_:jse});function Hse(e,t,n=0){let r=A(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");let a={paddings:t,constantValue:n},i={x:r};return V.runKernel(Ic,i,a)}var Ti=U({pad_:Hse});function Gse(e,t,n=0){return F(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),Ti(e,[t],n)}var d4=U({pad1d_:Gse});function qse(e,t,n=0){return F(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ti(e,t,n)}var p4=U({pad2d_:qse});function Kse(e,t,n=0){return F(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ti(e,t,n)}var h4=U({pad3d_:Kse});function Xse(e,t,n=0){return F(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Ti(e,t,n)}var f4=U({pad4d_:Xse});function Yse(e,t,n){let r=A(e,"x","spaceToBatchND");F(r.rank>=1+t.length,()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`),F(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),F(r.shape.reduce((s,o,l)=>l>0&&l<=t.length?s&&(o+n[l-1][0]+n[l-1][1])%t[l-1]===0:s,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);let a={x:r},i={blockShape:t,paddings:n};return V.runKernel(Th,a,i)}var Zg=U({spaceToBatchND_:Yse});function Zse(e,t,n,r,a,i,s){a==null&&(a=[1,1]),i==null&&(i=1),r===0&&(r="valid");let o=A(e,"x","maxPool"),l=o,c=!1;o.rank===3&&(c=!0,l=H(o,[1,o.shape[0],o.shape[1],o.shape[2]])),F(ts(i,a),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${a}'`);let u=VL(l.shape,t,i,a,r),d=[u.dilationHeight,u.dilationWidth],p;r==="same"?p=Jse([u.filterHeight,u.filterWidth],d):p=[[0,0],[0,0]];let h=d[0]===1&&d[1]===1,[f,m]=Qse([u.inHeight,u.inWidth],d,p),g=h?r:"valid",y=h?l:Zg(l,d,f),b=(n==="avg"?()=>Vs(y,t,i,g,s):()=>Ln(y,t,i,g,s))(),v=h?b:jg(b,d,m);return c?H(v,[v.shape[1],v.shape[2],v.shape[3]]):v}function Qse(e,t,n){let r=n.map(u=>u[0]),a=n.map(u=>u[1]),i=e.concat(r,a),s=t.map((u,d)=>(u-i[d]%u)%u),o=a.map((u,d)=>u+s[d]),l=t.map((u,d)=>[r[d],o[d]]),c=t.map((u,d)=>[0,s[d]]);return[l,c]}function Jse(e,t){let n=e.map((i,s)=>i+(i-1)*(t[s]-1)).map(i=>i-1),r=n.map(i=>Math.floor(i/2)),a=n.map((i,s)=>i-r[s]);return n.map((i,s)=>[r[s],a[s]])}var L_=U({pool_:Zse});function eoe(e,t){let n=A(e,"x","prelu"),r=A(t,"alpha","prelu"),a={x:n,alpha:r};return V.runKernel(_c,a)}var Qg=U({prelu_:eoe});function toe(e,t=null,n=!1){let r=A(e,"x","prod");r.dtype==="bool"&&(r=he(r,"int32"));let a={x:r},i={axis:t,keepDims:n};return V.runKernel(Tc,a,i)}var B_=U({prod_:toe});function noe(e,t,n,r){let a=e.map((u,d)=>A(u,`tensors${d}`,"raggedGather","int32")),i=A(t,"paramsDenseValues","raggedGather"),s=A(n,"indices","raggedGather","int32"),o={paramsNestedSplits:a,paramsDenseValues:i,indices:s},l={outputRaggedRank:r},c=V.runKernel(Wx,o,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}var m4=U({raggedGather_:noe});function roe(e,t,n){let r=A(e,"starts","raggedRange"),a=A(t,"limits","raggedRange",r.dtype),i=A(n,"deltas","raggedRange",r.dtype),s={starts:r,limits:a,deltas:i},o=V.runKernel(Vx,s);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}var g4=U({raggedRange_:roe});function aoe(e,t,n,r,a){let i=A(e,"shape","raggedTensorToTensor","int32"),s=A(t,"values","raggedTensorToTensor"),o=A(n,"defaultValue","raggedTensorToTensor",s.dtype),l=r.map((d,p)=>A(d,`tensors${p}`,"raggedTensorToTensor","int32")),c={shape:i,values:s,defaultValue:o,rowPartitionTensors:l},u={rowPartitionTypes:a};return V.runKernel(Ux,c,u)}var y4=U({raggedTensorToTensor_:aoe});function ioe(e,t,n){ga(e);let r=Lt(e),a=null;if(n==null||n==="float32")a=new Float32Array(r);else if(n==="int32")a=new Int32Array(r);else if(n==="bool")a=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let i=0;i<r;i++)a[i]=t();return V.makeTensor(a,e,n)}var b4=U({rand_:ioe}),W_=Qo(Ex()),v4={};He(v4,{TEST_EPSILON_FLOAT16:()=>x4,createVideoElement:()=>hoe,encodeStrings:()=>w4,expectArrayBuffersEqual:()=>poe,expectArraysClose:()=>ooe,expectArraysEqual:()=>uoe,expectNumbersClose:()=>coe,expectPromiseToFail:()=>loe,expectValuesInRange:()=>doe,play:()=>foe,testEpsilon:()=>V_});var soe=.001,x4=.1;function ooe(e,t,n){return n==null&&(n=V_()),lI(e,t,(r,a)=>U_(r,a,n))}function V_(){return V.backend.floatPrecision()===32?soe:x4}function lI(e,t,n){let r=!0;if((Vn(e)||Vn(t))&&(r=!1),Vn(e)&&Vn(t)&&(r=!0),r){let s=e.constructor.name,o=t.constructor.name;if(s!==o)throw new Error(`Arrays are of different type. Actual: ${s}. Expected: ${o}`)}if(Array.isArray(e)&&Array.isArray(t)){let s=Zi(e),o=Zi(t);if(!Ws(s,o))throw new Error(`Arrays have different shapes. Actual: [${s}]. Expected: [${o}]`)}let a=Vn(e)?e:Po(e),i=Vn(t)?t:Po(t);if(a.length!==i.length)throw new Error(`Arrays have different lengths actual: ${a.length} vs expected: ${i.length}.
Actual:   ${a}.
Expected: ${i}.`);for(let s=0;s<i.length;++s){let o=a[s],l=i[s];if(!n(o,l))throw new Error(`Arrays differ: actual[${s}] = ${o}, expected[${s}] = ${l}.
Actual:   ${a}.
Expected: ${i}.`)}typeof expect<"u"&&expect().nothing()}function loe(e,t){e().then(()=>t.fail(),()=>t()),typeof expect<"u"&&expect().nothing()}function uoe(e,t){let n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return po(e)||po(e[0])||po(t)||po(t[0])?lI(e,n,(r,a)=>r==a):lI(e,t,(r,a)=>U_(r,a,0))}function coe(e,t,n){if(n==null&&(n=V_()),!U_(e,t,n))throw new Error(`Numbers differ: actual === ${e}, expected === ${t}`);typeof expect<"u"&&expect().nothing()}function U_(e,t,n){return!isFinite(e)&&!isFinite(t)?!0:!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function doe(e,t,n){for(let r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error(`Value out of range:${e[r]} low: ${t}, high: ${n}`)}function poe(e,t){let n=new Float32Array(e),r=new Float32Array(t);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let a=0;a<r.length;a++)if(n[a]!==r[a])throw new Error(`Expected ArrayBuffer value at ${a} to be ${r[a]} but got ${n[a]} instead`)}function w4(e){for(let t=0;t<e.length;t++){let n=e[t];Array.isArray(n)?w4(n):e[t]=Bg(n)}return e}function hoe(e){let t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(n=>{t.addEventListener("loadeddata",r=>n(t)),t.load()})}async function foe(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise(t=>{e.requestVideoFrameCallback(t)})}var j_=class{constructor(e,t,n,r,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);let i=a||Math.random();this.random=W_.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){let r=this.nextVal;return this.nextVal=NaN,r}let e,t,n=!1;for(;!n;){let r,a,i;do r=2*this.random()-1,a=2*this.random()-1,i=r*r+a*a;while(i>=1||i===0);let s=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*r*s,t=this.mean+this.stdDev*a*s,(!this.truncated||this.isValidTruncated(e))&&(n=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}},moe=class{constructor(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;let a=r||Math.random();this.randu=W_.alea(a.toString()),this.randn=new j_(0,1,n,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,r,a,i;for(;;){do r=this.randn.nextValue(),i=1+this.c*r;while(i<=0);if(i*=i*i,e=r*r,t=1-.331*e*e,n=.5*e+this.d*(1-i+Math.log(i)),a=this.randu(),a<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}},goe=class{constructor(e=0,t=1,n,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=n,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=W_.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}};function yoe(e,t,n=1,r="float32",a){if(ga(e),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);let i=new moe(t,n,r,a),s=et(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}var k4=U({randomGamma_:yoe});function boe(e,t=0,n=1,r,a){if(ga(e),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);let i=new j_(t,n,r,!1,a),s=et(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}var s1=U({randomNormal_:boe});function voe(e,t,n){if(t!=null&&t==="bool")throw new Error(`Unsupported data type ${t}`);return s1(e,0,1,t,n)}var S4=U({randomStandardNormal_:voe});function xoe(e,t=0,n=1,r="float32",a){ga(e);let i=et(e,r),s=new goe(t,n,null,a);for(let o=0;o<i.values.length;o++)i.values[o]=s.nextValue();return i.toTensor()}var il=U({randomUniform_:xoe});function woe(e,t,n,r){return il(e,t,n,"int32",r)}var I4=U({randomUniformInt_:woe});function gu(e,t,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");let a={start:e,stop:t,step:n,dtype:r};return V.runKernel(Tg,{},a)}function koe(e){let t={input:A(e,"input","real")};return V.runKernel(jx,t)}var hp=U({real_:koe});function Soe(e){let t={x:A(e,"x","reciprocal")};return V.runKernel(Nc,t)}var H_=U({reciprocal_:Soe});function Ioe(e){let t={x:A(e,"x","relu")};return V.runKernel(Ec,t)}var Ct=U({relu_:Ioe});function Coe(e){let t={x:A(e,"x","relu6")};return V.runKernel(Rc,t)}var o1=U({relu6_:Coe});function _oe(e,t){let n={x:A(e,"x","reverse")},r={dims:t};return V.runKernel(Fc,n,r)}var Da=U({reverse_:_oe});function Toe(e){let t=A(e,"x","reverse");return F(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),Da(t,0)}var C4=U({reverse1d_:Toe});function Noe(e,t){let n=A(e,"x","reverse");return F(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Da(n,t)}var _4=U({reverse2d_:Noe});function Eoe(e,t){let n=A(e,"x","reverse");return F(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Da(n,t)}var T4=U({reverse3d_:Eoe});function $oe(e,t){let n=A(e,"x","reverse");return F(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Da(n,t)}var N4=U({reverse4d_:$oe});function Aoe(e){let t={x:A(e,"x","round")};return V.runKernel(Dc,t)}var l1=U({round_:Aoe});function Roe(e){let t={x:A(e,"x","rsqrt","float32")};return V.runKernel(Mc,t)}var u1=U({rsqrt_:Roe});function Foe(e){let t={x:A(e,"x","selu")};return V.runKernel(Oc,t)}var c1=U({selu_:Foe});function Doe(e,t,n,r,a,i=[1,1],s="NHWC"){let o=A(e,"x","separableConv2d"),l=A(t,"depthwiseFilter","separableConv2d"),c=A(n,"pointwiseFilter","separableConv2d"),u=o,d=!1;if(o.rank===3&&(d=!0,u=H(o,[1,o.shape[0],o.shape[1],o.shape[2]])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");F(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),F(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),F(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),F(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),F(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);let p=l.shape[2],h=l.shape[3];F(c.shape[2]===p*h,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*h}, but got ${c.shape[2]}.`);let f=Yc(u,l,r,a,s,i),m=_r(f,c,1,"valid",s);return d?H(m,[m.shape[1],m.shape[2],m.shape[3]]):m}var Vh=U({separableConv2d_:Doe});async function Moe(e,t){let n=A(e,"x","setdiff1d"),r=A(t,"y","setdiff1d");F(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),F(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),F(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);let a=await n.data(),i=await r.data(),s=new Set(i),o=0;for(let u=0;u<a.length;u++)s.has(a[u])||o++;let l=new Sn([o],n.dtype),c=new Sn([o],"int32");for(let u=0,d=0;u<a.length;u++)s.has(a[u])||(l.values[d]=a[u],c.values[d]=u,d++);return[l.toTensor(),c.toTensor()]}var E4=Moe;function Ooe(e){let t={x:A(e,"x","sign")};return V.runKernel(Lc,t)}var G_=U({sign_:Ooe});function Poe(e){let t={x:A(e,"x","sin","float32")};return V.runKernel(Pc,t)}var d1=U({sin_:Poe});function zoe(e){let t={x:A(e,"x","sinh")};return V.runKernel(zc,t)}var p1=U({sinh_:zoe});function Loe(e,t,n){let r=A(e,"x","slice1d");return F(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),it(r,[t],[n])}var Jg=U({slice1d_:Loe});function Boe(e,t,n){let r=A(e,"x","slice2d");return F(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),it(r,t,n)}var h1=U({slice2d_:Boe});function Woe(e,t,n){let r=A(e,"x","slice3d");return F(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),it(r,t,n)}var Uh=U({slice3d_:Woe});function Voe(e,t,n){let r=A(e,"x","slice4d");return F(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),it(r,t,n)}var fp=U({slice4d_:Voe});function Uoe(e,t=-1){let n=A(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);let r={logits:n},a={dim:t};return V.runKernel(jc,r,a)}var sl=U({softmax_:Uoe});function joe(e){F(e.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);let t={input:e};return V.runKernel(zx,t)}var ey=U({fft_:joe});function Hoe(e){F(e.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);let t={input:e};return V.runKernel(Lx,t)}var mp=U({ifft_:Hoe});function Goe(e){let t=e.shape[e.shape.length-1],n=e.size/t,r;if(t<=2){let a=H(e,[n,t]);r=mp(a)}else{let a=[n,2*(t-1)],i=H(hp(e),[n,t]),s=H(Gg(e),[n,t]),o=Da(it(i,[0,1],[n,t-2]),1),l=j(Da(it(s,[0,1],[n,t-2]),1),Re(-1)),c=Et([i,o],1),u=Et([s,l],1),d=H(Os(c,u),[a[0],a[1]]);r=mp(d)}if(r=hp(r),e.rank===3&&e.shape[0]!==0){let a=r,i=e.shape[0];r=H(r,[i,r.shape[0]/i,r.shape[1]]),a.dispose()}return r}var f1=U({irfft_:Goe});function qoe(e,t,n=0){let r={x:A(e,"x","split")},a={numOrSizeSplits:t,axis:n};return V.runKernel(Nh,r,a)}var Wr=U({split_:qoe});function Koe(e,t){F(e.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let n=e.shape[e.shape.length-1],r=e.size/n,a;if(t!=null&&t<n){let f=e.shape.map(g=>0),m=e.shape.map(g=>g);m[e.shape.length-1]=t,a=it(e,f,m),n=t}else if(t!=null&&t>n){let f=e.shape.map(m=>m);f[e.shape.length-1]=t-n,a=Et([e,en(f)],e.shape.length-1),n=t}else a=e;let i=st(a),s=H(Os(a,i),[r,n]),o=ey(s),l=Math.floor(n/2)+1,c=hp(o),u=Gg(o),d=Wr(c,[l,n-l],c.shape.length-1),p=Wr(u,[l,n-l],u.shape.length-1),h=a.shape.slice();return h[a.shape.length-1]=l,H(Os(d[0],p[0]),h)}var ty=U({rfft_:Koe});function Xoe(e,t){let n=A(e,"a","squaredDifference"),r=A(t,"b","squaredDifference");[n,r]=nn(n,r),$t(n.shape,r.shape);let a={a:n,b:r},i={};return V.runKernel(Hc,a,i)}var m1=U({squaredDifference_:Xoe});function Yoe(e,t){let n=A(e,"x","squeeze","string_or_numeric");return H(n,rL(n.shape,t).newShape)}var ol=U({squeeze_:Yoe});function Zoe(e,t=0){let n=Um(e,"tensors","stack","string_or_numeric");F(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&F(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");let r=n,a={axis:t};return V.runKernel(bh,r,a)}var Fn=U({stack_:Zoe});function Qoe(e,t=0){let n={x:A(e,"x","step")},r={alpha:t};return V.runKernel(nl,n,r)}var Qc=U({step_:Qoe});function Joe(e,t,n,r,a=0,i=0,s=0,o=0,l=0){let c={x:A(e,"x","stridedSlice","string_or_numeric")},u={begin:t,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};return V.runKernel(Ah,c,u)}var q_=U({stridedSlice_:Joe});function ele(e){let t={x:A(e,"x","tan","float32")};return V.runKernel(qc,t)}var K_=U({tan_:ele});function It(e,t){$u(e);let n=Zi(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return rl(e,null,n,t)}function Xi(e,t,n){if($u(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");let r=Zi(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return rl(e,t,r,n)}function g1(e,t,n){if($u(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");let r=Zi(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return rl(e,t,r,n)}function Bo(e,t,n){if($u(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");let r=Zi(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return rl(e,t,r,n)}function $4(e,t,n){if($u(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");let r=Zi(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return rl(e,t,r,n)}function A4(e,t,n){if($u(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");let r=Zi(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,rl(e,t,r,n)}var y1={};He(y1,{calculateShapes:()=>R4,validateInput:()=>b1,validateUpdateShape:()=>X_});function X_(e,t,n){let r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${a}.`;if(n.rank<a)throw new Error(i+` update.rank < ${a}. `);if(e.length<r+(n.rank-a))throw new Error(i+` Output shape length < ${r+(n.rank-a)}`);if(n.rank!==a+e.length-r)throw new Error(i+` update.rank != ${a+e.length-r}`);for(let s=0;s<a;++s)if(n.shape[s]!==t.shape[s])throw new Error(i+` updates.shape[${s}] (${n.shape[s]}) != indices.shape[${s}] (${t.shape[s]}).`);for(let s=0;s<n.rank-a;++s)if(n.shape[s+a]!==e[s+r])throw new Error(i+` updates.shape[${s+a}] (${n.shape[s+a]}) != shape[${s+a}] (${e[s+a]})`)}function b1(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}X_(n,t,e)}function R4(e,t,n){let r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,s=1;for(let d=a;d<i;++d)s*=n[d];let o=a<1?1:a,l=Lt(t.shape)/o,c=[...Dp(n.slice(0,a)),1],u=Lt(n);return{sliceRank:a,numUpdates:l,sliceSize:s,strides:c,outputSize:u}}function tle(e,t,n){let r=A(e,"tensor","tensorScatterupdate"),a=A(t,"indices","tensorScatterupdate","int32"),i=A(n,"updates","tensorScatterupdate");if(b1(i,a,r.shape),r.dtype!==i.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${i.dtype}.`);let s={tensor:r,indices:a,updates:i},o={};return V.runKernel(Sh,s,o)}var F4=U({tensorScatterUpdate_:tle});function nle(e,t=1,n=!0){let r=A(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");let a=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>a)throw new Error(`'k' passed to topk() must be <= the last dimension (${a}) but got ${t}`);let i={x:r},s={k:t,sorted:n},[o,l]=V.runKernel(Rh,i,s);return{values:o,indices:l}}var Y_=U({topk_:nle});function rle(e,t=0,n=1,r,a){if(ga(e),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");let i=new j_(t,n,r,!0,a),s=et(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=i.nextValue();return s.toTensor()}var v1=U({truncatedNormal_:rle});function ale(e,t=0){let n=A(e,"x","unique","string_or_numeric");F(n.rank>0,()=>"The input tensor must be at least 1D");let r={x:n},a={axis:t},[i,s]=V.runKernel(Og,r,a);return{values:i,indices:s}}var Z_=U({unique_:ale});function ile(e,t,n){let r=A(e,"x","unsortedSegmentSum"),a=A(t,"segmentIds","unsortedSegmentSum","int32");F(sp(n),()=>"numSegments must be of dtype int");let i={x:r,segmentIds:a},s={numSegments:n};return V.runKernel(Pg,i,s)}var x1=U({unsortedSegmentSum_:ile});function sle(e,t=0){let n=A(e,"x","unstack","string_or_numeric");F(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);let r={value:n},a={axis:t};return V.runKernel(Dh,r,a)}var dn=U({unstack_:sle});function D4(e,t){return i1(e,t,"right")}function Q_(e,t=!0,n,r){return V.makeVariable(e,t,n,r)}function M4(e,t){let n=[];for(let i=0;i<t.length;i++)t[i]&&n.push(i);let r=et(e,"int32"),a=et([n.length,e.length],"int32");for(let i=0;i<n.length;i++){let s=r.indexToLoc(n[i]),o=i*e.length;a.values.set(s,o)}return a.toTensor()}async function ole(e){let t=A(e,"condition","whereAsync","bool"),n=await t.data(),r=M4(t.shape,n);return e!==t&&t.dispose(),r}var J_=ole;async function lle(e,t,n){let r=A(e,"tensor","boolMask"),a=A(t,"mask","boolMask","bool"),i=n??0,s=a.rank,o=r.shape;F(s>0,()=>"mask cannot be scalar"),$r(o.slice(i,i+s),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=i;m<i+s;m++)l*=o[m];let c=o.slice(0,i).concat([l],o.slice(i+s)),u=H(r,c),d=H(a,[-1]),p=await J_(d),h=ol(p,[1]),f=Wh(u,h,i);return e!==r&&r.dispose(),t!==a&&a.dispose(),h.dispose(),u.dispose(),d.dispose(),p.dispose(),f}var O4=lle;function ule(e,t,n){let r=A(e,"x","transpose");if(t==null&&(t=r.shape.map((s,o)=>o).reverse()),F(r.rank===t.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`),t.forEach(s=>{F(s>=0&&s<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${t}`)}),r.rank<=1)return r.clone();let a={x:r},i={perm:t};return r.dtype==="complex64"?G(()=>{let s=hp(r),o=Gg(r);return s=V.runKernel(Ts,{x:s},i),o=V.runKernel(Ts,{x:o},i),n&&(o=Bt(o)),Os(s,o)}):V.runKernel(Ts,a,i)}var Je=U({transpose_:ule});function cle(e,t,n,r,a=!0){let i=A(e,"v","movingAverage"),s=A(t,"x","movingAverage"),o=A(n,"decay","movingAverage");SL(i,s),F(Ws(i.shape,s.shape),()=>"Shape mismatch in v and x");let l=Re(1),c=we(l,o),u=j(we(s,i),c);if(a){F(r!=null,()=>"When using zeroDebias: true, step is required.");let d=A(r,"step","movingAverage");u=Ie(u,we(l,Ps(o,d)))}return re(i,u)}var P4=U({movingAverage_:cle});function dle(e,t,n){ga(n);let r=A(e,"indices","scatterND","int32"),a=A(t,"updates","scatterND");b1(a,r,n);let i={indices:r,updates:a},s={shape:n};return V.runKernel(kh,i,s)}var z4=U({scatterND_:dle});function ple(e,t,n,r){if(e.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);let a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);let s=t.size;if(!(t.rank===0||t.rank===1&&s===a))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${a}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}function hle(e,t,n,r=0){ga(n);let a=A(e,"sparseIndices","sparseToDense","int32"),i=A(t,"sparseValues","sparseToDense","string_or_numeric"),s=A(r,"defaultValue","sparseToDense",i.dtype);ple(a,i,n,s);let o={sparseIndices:a,sparseValues:i,defaultValue:s},l={outputShape:n};return V.runKernel($h,o,l)}var L4=U({sparseToDense_:hle});function fle(e,t){let n=A(t,"indices","gatherND","int32"),r={params:A(e,"x","gatherND","string_or_numeric"),indices:n};return V.runKernel(th,r)}var B4=U({gatherND_:fle});function mle(e,t){if(t==null)return e.shape.slice();if(Ws(e.shape,t))return t;if(e.shape.length===t.length){let n=[];for(let r=0;r<e.shape.length;r++)t[r]==null&&e.shape[r]!=null?n.push(e.shape[r]):n.push(t[r]);return n}return t}function gle(e,t,n,r){let a=A(e,"x","dropout");if(F(a.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${a.dtype} tensor instead.`),F(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof Ze?a.clone():a;let i=mle(a,n),s=1-t,o=Ie(Bh(re(il(i,0,1,"float32",r),s)),s);return j(a,o)}var eT=U({dropout_:gle});function tT(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function w1(e,t,n){let r=1-e%2,a=new Float32Array(e);for(let i=0;i<e;++i){let s=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(s)}return It(a,"float32")}async function yle(e,t,n=1){let r=A(e,"predictions","inTopK"),a=A(t,"targets","inTopK");F(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),F(r.rank-1===a.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${a.rank}`),$r(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");let i=r.shape[r.shape.length-1];F(n>0&&n<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${n}`);let s=await r.data(),o=await a.data(),[l,c]=[s.length/i,i],u=aL("bool",l);for(let d=0;d<l;d++){let p=d*c,h=s.subarray(p,p+c),f=[];for(let m=0;m<h.length;m++)f.push({value:h[m],index:m});f.sort((m,g)=>g.value-m.value),u[d]=0;for(let m=0;m<n;m++)if(f[m].index===o[d]){u[d]=1;break}}return e!==r&&r.dispose(),t!==a&&a.dispose(),Ir(u,a.shape,"bool")}var W4=yle,gp={};He(gp,{conv2d:()=>xle,depthwiseConv2d:()=>Ile,matMul:()=>_le});function ble(e,t,n,r,a,i="NHWC",s){let o=e;e.rank===3&&(o=H(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=H(t,[1,t.shape[0],t.shape[1],t.shape[2]])),F(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),F(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),F(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);let c=i==="NHWC"?o.shape[3]:o.shape[1],u=i==="NHWC"?l.shape[3]:l.shape[1];F(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),F(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),Ar("conv2dDerFilter",a,s);let d={x:o,dy:l},p={strides:r,pad:a,dataFormat:i,dimRoundingMode:s,filterShape:n};return V.runKernel(Dx,d,p)}var nT=U({conv2DBackpropFilter_:ble});function k1(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return j(e,Qc(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function S1(e,t){let n=t,r=In(e.shape,t.shape);return r.length>0&&(n=Te(n,r)),H(n,e.shape)}function I1(e,t,n,r){if(t==="linear")return e;if(t==="relu")return Ct(e);if(t==="elu")return zh(e);if(t==="relu6")return o1(e);if(t==="prelu")return Qg(e,n);if(t==="leakyrelu")return qg(e,r);if(t==="sigmoid")return ei(e);throw new Error(`Unknown fused activation ${t}.`)}var C1=(e,t)=>!(e>0)||t==="linear";function vle({x:e,filter:t,strides:n,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",C1(V.state.gradientDepth,l)===!1){F(a==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${a} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let S=_r(e,t,n,r,a,i,s);return o!=null&&(S=re(S,o)),I1(S,l,c,u)}let d=A(e,"x","conv2d","float32"),p=A(t,"filter","conv2d","float32"),h=d,f=!1;d.rank===3&&(f=!0,h=H(d,[1,d.shape[0],d.shape[1],d.shape[2]])),F(h.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${h.rank}.`),F(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),Ar("fused conv2d",r,s);let m=a==="NHWC"?h.shape[3]:h.shape[1];F(p.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${p.shape[2]}.`),F(ts(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let g=Ug(h.shape,p.shape,n,i,r,s),y;o!=null&&(y=A(o,"bias","fused conv2d"),[y]=nn(y,d),a==="NHWC"?$t(g.outShape,y.shape):(F(y.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`),F(y.shape.length===0||y.shape[0]===g.outChannels||y.shape[0]===1,()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let b;if(c!=null){let S=c.shape;if(F(S.length<=1||S.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${S.length}.`),S.length===1)F(S[0]===1||S[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the number of output channels (${g.outChannels}).`);else if(S.length===3)try{$t(S,g.outShape)}catch{let T=`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(T)}b=A(c,"prelu weights","fused conv2d")}let v=(S,C)=>{F(a==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${a} but only NHWC is currently supported.`);let[T,E,R,$]=C,_=k1(S,R,l);F(zo(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);let D=b_(E.shape,_,T,n,r),P=nT(E,_,T.shape,n,r),B=[D,P];if($!=null){let W=S1($,_);B.push(W)}return B},x={x:h,filter:p,bias:y,preluActivationWeights:b},w={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:s,activation:l,leakyreluAlpha:u};return o==null?Qi((S,C,T)=>{let E=V.runKernel(su,x,w);return T([C,S,E]),f&&(E=H(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:v}})(h,p):Qi((S,C,T,E)=>{let R=V.runKernel(su,x,w);return E([C,S,R,T]),f&&(R=H(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:v}})(h,p,y)}var xle=U({fusedConv2d_:vle});function wle(e,t,n,r,a,i=[1,1],s){let o=e;e.rank===3&&(o=H(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=H(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c={x:o,dy:l},u={strides:r,pad:a,dimRoundingMode:s,dilations:i,filterShape:n};return V.runKernel(Mx,c,u)}var V4=U({depthwiseConv2dNativeBackpropFilter_:wle});function kle(e,t,n,r,a,i=[1,1],s){let o=t,l=!1;t.rank===3&&(l=!0,o=H(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c={dy:o,filter:n},u={strides:r,pad:a,dimRoundingMode:s,dilations:i,inputShape:e},d=V.runKernel(Ox,c,u);return l?H(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var U4=U({depthwiseConv2dNativeBackpropInput_:kle});function Sle({x:e,filter:t,strides:n,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(C1(V.state.gradientDepth,l)===!1){let w=Yc(e,t,n,r,a,i,s);return o!=null&&(w=re(w,o)),I1(w,l,c,u)}let d=A(e,"x","depthwiseConv2d","float32"),p=A(t,"filter","depthwiseConv2d","float32"),h=d,f=!1;d.rank===3&&(f=!0,h=H(d,[1,d.shape[0],d.shape[1],d.shape[2]])),F(h.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${h.rank}.`),F(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),F(h.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${h.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),i==null&&(i=[1,1]),F(ts(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Ar("fused depthwiseConv2d",r,s);let m=Ug(h.shape,p.shape,n,i,r,s,!0),g;o!=null&&(g=A(o,"bias","fused conv2d"),[g]=nn(g,d),$t(m.outShape,g.shape));let y;c!=null&&(y=A(c,"prelu weights","fused depthwiseConv2d"));let b=(w,S)=>{F(zo(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);let[C,T,E,R]=S,$=k1(w,E,l),_=U4(T.shape,$,C,n,r,i,s),D=V4(T,$,C.shape,n,r,i,s);if(R!=null){let P=S1(g,$);return[_,D,P]}return[_,D]},v={x:h,filter:p,bias:g,preluActivationWeights:y},x={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:s,activation:l,leakyreluAlpha:u};return o==null?Qi((w,S,C)=>{let T=V.runKernel(ou,v,x);return C([S,w,T]),f&&(T=H(T,[T.shape[1],T.shape[2],T.shape[3]])),{value:T,gradFunc:b}})(h,p):Qi((w,S,C,T)=>{let E=V.runKernel(ou,v,x);return T([S,w,E,C]),f&&(E=H(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:b}})(h,p,g)}var Ile=U({fusedDepthwiseConv2d_:Sle});function Cle({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:a,activation:i="linear",preluActivationWeights:s,leakyreluAlpha:o=.2}){if(C1(V.state.gradientDepth,i)===!1){let R=Ye(e,t,n,r);return a!=null&&(R=re(R,a)),I1(R,i,s,o)}let l=A(e,"a","fused matMul"),c=A(t,"b","fused matMul");[l,c]=nn(l,c);let u=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?c.shape[c.rank-1]:c.shape[c.rank-2],p=n?l.shape[l.rank-1]:l.shape[l.rank-2],h=r?c.shape[c.rank-2]:c.shape[c.rank-1],f=l.shape.slice(0,-2),m=c.shape.slice(0,-2),g=Lt(f),y=Lt(m);F(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${r} must match.`);let b=$t(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([p,h]),v=n?H(l,[g,u,p]):H(l,[g,p,u]),x=r?H(c,[y,h,d]):H(c,[y,d,h]),w;a!=null&&(w=A(a,"bias","fused matMul"),[w]=nn(w,l),$t(b,w.shape));let S;s!=null&&(S=A(s,"prelu weights","fused matMul"));let C=(R,$)=>{let[_,D,P,B]=$,W=k1(H(R,P.shape),P,i),Y,O;if(!n&&!r?(Y=Ye(W,D,!1,!0),O=Ye(_,W,!0,!1)):!n&&r?(Y=Ye(W,D,!1,!1),O=Ye(W,_,!0,!1)):n&&!r?(Y=Ye(D,W,!1,!0),O=Ye(_,W,!1,!1)):(Y=Ye(D,W,!0,!0),O=Ye(W,_,!0,!0)),a!=null){let q=S1(B,W);return[Y,O,q]}else return[Y,O]},T={a:v,b:x,bias:w,preluActivationWeights:S},E={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:o};return a==null?Qi((R,$,_)=>{let D=V.runKernel(iu,T,E);return _([R,$,D]),{value:H(D,b),gradFunc:C}})(v,x):Qi((R,$,_,D)=>{let P=V.runKernel(iu,T,E);return D([R,$,P,_]),{value:H(P,b),gradFunc:C}})(v,x,w)}var _le=U({fusedMatMul_:Cle});function Tle(e){return w1(e,.54,.46)}var Nle=U({hammingWindow_:Tle});function Ele(e){return w1(e,.5,.5)}var j4=U({hannWindow_:Ele});function $le(e,t,n,r=!1,a=0){let i=0,s=[];for(;i+t<=e.size;)s.push(it(e,i,t)),i+=n;if(r)for(;i<e.size;){let o=i+t-e.size,l=Et([it(e,i,t-o),ua([o],a)]);s.push(l),i+=n}return s.length===0?Xi([],[0,t]):H(Et(s),[s.length,t])}var H4=U({frame_:$le});function Ale(e,t,n,r,a=j4){r==null&&(r=tT(t));let i=H4(e,t,n),s=j(i,a(t));return ty(s,r)}var Rle=U({stft_:Ale});function Fle(e,t,n,r,a="bilinear",i=0){let s=A(e,"image","cropAndResize"),o=A(t,"boxes","cropAndResize","float32"),l=A(n,"boxInd","cropAndResize","int32"),c=o.shape[0];F(s.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${s.rank}.`),F(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${o.shape}.`),F(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${o.shape}.`),F(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),F(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),F(a==="bilinear"||a==="nearest",()=>`method must be bilinear or nearest, but was ${a}`);let u={image:s,boxes:o,boxInd:l},d={method:a,extrapolationValue:i,cropSize:r};return V.runKernel(Kp,u,d)}var Dle=U({cropAndResize_:Fle});function Mle(e){let t=A(e,"image","flipLeftRight","float32");F(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);let n={image:t};return V.runKernel(Jp,n,{})}var Ole=U({flipLeftRight_:Mle});function Ple(e){let t=A(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];F(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),F(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);let a=new Array(t.rank);return a.fill(1,0,n),a[n]=3,aa(t,a)}var zle=U({grayscaleToRGB_:Ple});function Lle(e,t,n=0,r=.5){let a=A(e,"image","rotateWithOffset","float32");F(a.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${a.rank}.`);let i={image:a},s={radians:t,fillValue:n,center:r};return V.runKernel(Oh,i,s)}var Ble=U({rotateWithOffset_:Lle});function jh(e,t,n,r,a,i){r==null&&(r=.5),a==null&&(a=Number.NEGATIVE_INFINITY),i==null&&(i=0);let s=e.shape[0];return n=Math.min(n,s),F(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),F(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),F(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),F(t.rank===1,()=>"scores must be a 1D tensor"),F(t.shape[0]===s,()=>`scores has incompatible shape with boxes. Expected ${s}, but was ${t.shape[0]}`),F(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}function Wle(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY){let i=A(e,"boxes","nonMaxSuppression","float32"),s=A(t,"scores","nonMaxSuppression","float32"),o=jh(i,s,n,r,a);n=o.maxOutputSize,r=o.iouThreshold,a=o.scoreThreshold;let l={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return V.runKernel(fh,{boxes:i,scores:s},l)}var Vle=U({nonMaxSuppression_:Wle});function Ule(e,t,n){let r=jle(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function jle(e,t,n){return Gle(e,t,n||Hle)}function Hle(e,t){return e>t?1:e<t?-1:0}function Gle(e,t,n){let r=0,a=e.length,i=0,s=!1;for(;r<a;){i=r+(a-r>>>1);let o=n(t,e[i]);o>0?r=i+1:(a=i,s=!o)}return s?r:-r-1}function G4(e,t,n,r,a){return rT(e,t,n,r,a,0)}function q4(e,t,n,r,a,i){return rT(e,t,n,r,a,0,!1,i,!0)}function K4(e,t,n,r,a,i){return rT(e,t,n,r,a,i,!0)}function rT(e,t,n,r,a,i,s=!1,o=!1,l=!1){let c=[];for(let g=0;g<t.length;g++)t[g]>a&&c.push({score:t[g],boxIndex:g,suppressBeginIndex:0});c.sort(IF);let u=i>0?-.5/i:0,d=[],p=[];for(;d.length<n&&c.length>0;){let g=c.pop(),{score:y,boxIndex:b,suppressBeginIndex:v}=g;if(y<a)break;let x=!1;for(let w=d.length-1;w>=v;--w){let S=qle(e,b,d[w]);if(S>=r){x=!0;break}if(g.score=g.score*Kle(r,u,S),g.score<=a)break}g.suppressBeginIndex=d.length,x||(g.score===y?(d.push(b),p.push(g.score)):g.score>a&&Ule(c,g,IF))}let h=d.length,f=n-h;o&&f>0&&(d.push(...new Array(f).fill(0)),p.push(...new Array(f).fill(0)));let m={selectedIndices:d};return s&&(m.selectedScores=p),l&&(m.validOutputs=h),m}function qle(e,t,n){let r=e.subarray(t*4,t*4+4),a=e.subarray(n*4,n*4+4),i=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),u=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),p=Math.max(a[1],a[3]),h=(o-i)*(l-s),f=(d-c)*(p-u);if(h<=0||f<=0)return 0;let m=Math.max(i,c),g=Math.max(s,u),y=Math.min(o,d),b=Math.min(l,p),v=Math.max(y-m,0)*Math.max(b-g,0);return v/(h+f-v)}function Kle(e,t,n){let r=Math.exp(t*n*n);return n<=e?r:0}function IF(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}async function Xle(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY){let i=A(e,"boxes","nonMaxSuppressionAsync"),s=A(t,"scores","nonMaxSuppressionAsync"),o=jh(i,s,n,r,a);n=o.maxOutputSize,r=o.iouThreshold,a=o.scoreThreshold;let l=await Promise.all([i.data(),s.data()]),c=l[0],u=l[1],{selectedIndices:d}=G4(c,u,n,r,a);return i!==e&&i.dispose(),s!==t&&s.dispose(),It(d,"int32")}var Yle=Xle;function Zle(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=0){let s=A(e,"boxes","nonMaxSuppression"),o=A(t,"scores","nonMaxSuppression"),l=jh(s,o,n,r,a,i);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,i=l.softNmsSigma;let c={boxes:s,scores:o},u={maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i},d=V.runKernel(gh,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}var Qle=U({nonMaxSuppressionWithScore_:Zle});async function Jle(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=0){let s=A(e,"boxes","nonMaxSuppressionAsync"),o=A(t,"scores","nonMaxSuppressionAsync"),l=jh(s,o,n,r,a,i);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,i=l.softNmsSigma;let c=await Promise.all([s.data(),o.data()]),u=c[0],d=c[1],{selectedIndices:p,selectedScores:h}=K4(u,d,n,r,a,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:It(p,"int32"),selectedScores:It(h)}}var eue=Jle;function tue(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){let s=A(e,"boxes","nonMaxSuppression"),o=A(t,"scores","nonMaxSuppression"),l=jh(s,o,n,r,a,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,p={boxes:s,scores:o},h={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:i},f=V.runKernel(mh,p,h);return{selectedIndices:f[0],validOutputs:f[1]}}var nue=U({nonMaxSuppressionPadded_:tue});async function rue(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){let s=A(e,"boxes","nonMaxSuppressionAsync"),o=A(t,"scores","nonMaxSuppressionAsync"),l=jh(s,o,n,r,a,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[p,h]=await Promise.all([s.data(),o.data()]),{selectedIndices:f,validOutputs:m}=q4(p,h,c,u,d,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:It(f,"int32"),validOutputs:Re(m,"int32")}}var aue=rue;function iue(e,t,n=!1,r=!1){let a=A(e,"images","resizeBilinear");F(a.rank===3||a.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${a.rank}.`),F(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),F(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=a,s=!1;a.rank===3&&(s=!0,i=H(a,[1,a.shape[0],a.shape[1],a.shape[2]]));let o={images:i},l={alignCorners:n,halfPixelCenters:r,size:t},c=V.runKernel(Ac,o,l);return s?H(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var X4=U({resizeBilinear_:iue});function sue(e,t,n=!1,r=!1){let a=A(e,"images","resizeNearestNeighbor");F(a.rank===3||a.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${a.rank}.`),F(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),F(a.dtype==="float32"||a.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),F(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=a,s=!1;a.rank===3&&(s=!0,i=H(a,[1,a.shape[0],a.shape[1],a.shape[2]]));let o={images:i},l={alignCorners:n,halfPixelCenters:r,size:t},c=V.runKernel($c,o,l);return s?H(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var Y4=U({resizeNearestNeighbor_:sue});function oue(e,t="binary",n=!1,r=.5){let a=A(e,"image","threshold"),i=.2989,s=.587,o=.114,l=a.shape[0]*a.shape[1],c=j(It([r]),255),u,d,p,h;if(F(a.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${a.rank}.`),F(a.shape[2]===3||a.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${a.shape[2]}.`),F(a.dtype==="int32"||a.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${a.dtype}.`),F(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),a.shape[2]===3){[u,d,p]=Wr(a,[1,1,1],-1);let m=j(u,i),g=j(d,s),y=j(p,o);h=re(re(m,g),y)}else h=e;if(t==="otsu"){let m=p_(he(l1(h),"int32"),Ir([]),256);c=lue(m,l)}let f=n?al(h,c):Rr(h,c);return he(j(f,255),"int32")}function lue(e,t){let n=It([-1]),r=It([0]),a=It([0]),i,s,o,l,c,u;for(let d=0;d<e.size-1;d++){i=it(e,0,d+1),s=it(e,d+1),c=Ie(Te(i),t),u=Ie(Te(s),t);let p=Te(j(i,gu(0,i.size)));o=Ie(p,Te(i));let h=ua(s.shape,i.size),f=re(gu(0,s.size),h),m=j(s,f);l=Ie(Te(m),Te(s));let g=we(o,l),y=we(o,l),b=j(c,u);a=j(j(b,g),y);let v=Rr(a,r);r=Hn(v,a,r),n=Hn(v,It([d]),n)}return n}var uue=U({threshold_:oue});function cue(e,t,n="nearest",r="constant",a=0,i){let s=A(e,"image","transform","float32"),o=A(t,"transforms","transform","float32");F(s.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${s.rank}.`),F(o.rank===2&&(o.shape[0]===s.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),F(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);let l={image:s,transforms:o},c={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return V.runKernel(Fh,l,c)}var due=U({transform_:cue});function pue(e,t,n){let r=A(e,"a","bandPart");F(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);let a=r.shape,[i,s]=r.shape.slice(-2),o,l;typeof t=="number"?(F(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),F(t<=i,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${i}).`),o=A(t<0?i:t,"numLower","bandPart")):(F(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=Hn(dp(t,0),i,Lo(t,i))),typeof n=="number"?(F(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),F(n<=s,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${s}).`),l=A(n<0?s:n,"numUpper","bandPart")):(F(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Hn(dp(n,0),s,Lo(n,s)));let c=H(gu(0,i,1,"int32"),[-1,1]),u=gu(0,s,1,"int32"),d=we(c,u),p=ri(al(d,o),Us(d,Bt(l))),h=en([i,s],r.dtype);return H(Fn(dn(H(r,[-1,i,s])).map(f=>Hn(p,f,h))),a)}var hue=U({bandPart_:pue});function fue(e){let t;if(Array.isArray(e)){t=!1,F(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let a=e[0].shape[0];for(let i=1;i<e.length;++i)F(e[i].shape[0]===a,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[i].shape[0]} vs. ${a})`)}else t=!0,e=Wr(e,e.shape[0],0).map(a=>ol(a,[0]));F(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);let n=[],r=e;for(let a=0;a<e.length;++a)n.push(V.tidy(()=>{let i=r[a];if(a>0)for(let s=0;s<a;++s){let o=j(Te(j(n[s],i)),n[s]);i=we(i,o)}return Ie(i,Lh(i,"euclidean"))}));return t?Fn(n,0):n}var mue=U({gramSchmidt_:fue});function gue(e,t=!1){if(F(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return CF(e,t);{let n=e.shape.slice(0,e.shape.length-2).reduce((l,c)=>l*c),r=dn(H(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];r.forEach(l=>{let[c,u]=CF(l,t);a.push(c),i.push(u)});let s=H(Fn(a,0),e.shape),o=H(Fn(i,0),e.shape);return[s,o]}}function CF(e,t=!1){return V.tidy(()=>{F(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);let n=e.shape[0],r=e.shape[1],a=e1(n),i=Ki(e),s=Xi([[1]],[1,1]),o=Ki(s),l=n>=r?r:n;for(let c=0;c<l;++c){let u=i,d=o,p=a;[o,i,a]=V.tidy(()=>{let h=it(i,[c,c],[n-c,1]),f=Lh(h),m=it(i,[c,c],[1,1]),g=Hn(Rr(m,0),Xi([[-1]]),Xi([[1]])),y=we(m,j(g,f)),b=Ie(h,y);b.shape[0]===1?o=Ki(s):o=Et([s,it(b,[1,0],[b.shape[0]-1,b.shape[1]])],0);let v=Bt(Ie(Ye(g,y),f)),x=it(i,[c,0],[n-c,r]),w=j(v,o),S=Je(o);if(c===0)i=we(x,Ye(w,Ye(S,x)));else{let E=we(x,Ye(w,Ye(S,x)));i=Et([it(i,[0,0],[c,r]),E],0)}let C=Je(w),T=it(a,[0,c],[n,a.shape[1]-c]);if(c===0)a=we(T,Ye(Ye(T,o),C));else{let E=we(T,Ye(Ye(T,o),C));a=Et([it(a,[0,0],[n,c]),E],1)}return[o,i,a]}),je([u,d,p])}return!t&&n>r&&(a=it(a,[0,0],[n,r]),i=it(i,[0,0],[r,r])),[a,i]})}var yue=U({qr_:gue}),wr;(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(wr||(wr={}));function bue(e,t,n=wr.SUM_BY_NONZERO_WEIGHTS){let r=A(e,"losses","computeWeightedLoss"),a=null;t!=null&&(a=A(t,"weights","computeWeightedLoss"));let i=a==null?r:j(r,a);if(n===wr.NONE)return i;if(n===wr.SUM)return Te(i);if(n===wr.MEAN){if(a==null)return Jt(i);{let s=r.size/a.size,o=Ie(Te(i),Te(a));return s>1?Ie(o,Re(s)):o}}if(n===wr.SUM_BY_NONZERO_WEIGHTS){if(a==null)return Ie(Te(i),Re(r.size));{let s=j(a,ia(r.shape)),o=he(Te(mu(s,Re(0))),"float32");return Ie(Te(i),o)}}throw Error(`Unknown reduction: ${n}`)}var js=U({computeWeightedLoss_:bue});function vue(e,t,n,r=wr.SUM_BY_NONZERO_WEIGHTS){let a=A(e,"labels","absoluteDifference"),i=A(t,"predictions","absoluteDifference"),s=null;n!=null&&(s=A(n,"weights","absoluteDifference")),$r(a.shape,i.shape,"Error in absoluteDifference: ");let o=xn(we(a,i));return js(o,s,r)}var xue=U({absoluteDifference_:vue});function wue(e,t,n,r,a=wr.SUM_BY_NONZERO_WEIGHTS){let i=A(e,"labels","cosineDistance"),s=A(t,"predictions","cosineDistance"),o=null;r!=null&&(o=A(r,"weights","cosineDistance")),$r(i.shape,s.shape,"Error in cosineDistance: ");let l=Re(1),c=we(l,Te(j(i,s),n,!0));return js(c,o,a)}var kue=U({cosineDistance_:wue});function Sue(e,t,n,r=wr.SUM_BY_NONZERO_WEIGHTS){let a=A(e,"labels","hingeLoss"),i=A(t,"predictions","hingeLoss"),s=null;n!=null&&(s=A(n,"weights","hingeLoss")),$r(a.shape,i.shape,"Error in hingeLoss: ");let o=Re(1);a=we(j(Re(2),a),o);let l=Ct(we(o,j(a,i)));return js(l,s,r)}var Iue=U({hingeLoss_:Sue});function Cue(e,t,n,r=1,a=wr.SUM_BY_NONZERO_WEIGHTS){let i=A(e,"labels","huberLoss"),s=A(t,"predictions","huberLoss"),o=null;n!=null&&(o=A(n,"weights","huberLoss")),$r(i.shape,s.shape,"Error in huberLoss: ");let l=Re(r),c=xn(we(s,i)),u=Lo(c,l),d=we(c,u),p=re(j(Re(.5),Tt(u)),j(l,d));return js(p,o,a)}var _ue=U({huberLoss_:Cue});function Tue(e,t,n,r=1e-7,a=wr.SUM_BY_NONZERO_WEIGHTS){let i=A(e,"labels","logLoss"),s=A(t,"predictions","logLoss"),o=null;n!=null&&(o=A(n,"weights","logLoss")),$r(i.shape,s.shape,"Error in logLoss: ");let l=Re(1),c=Re(r),u=Bt(j(i,ha(re(s,c)))),d=j(we(l,i),ha(re(we(l,s),c))),p=we(u,d);return js(p,o,a)}var Nue=U({logLoss_:Tue});function Eue(e,t,n,r=wr.SUM_BY_NONZERO_WEIGHTS){let a=A(e,"labels","meanSquaredError"),i=A(t,"predictions","meanSquaredError"),s=null;n!=null&&(s=A(n,"weights","meanSquaredError")),$r(a.shape,i.shape,"Error in meanSquaredError: ");let o=m1(a,i);return js(o,s,r)}var $ue=U({meanSquaredError_:Eue});function Aue(e,t){let n=A(e,"labels","sigmoidCrossEntropyWithLogits"),r=A(t,"logits","sigmoidCrossEntropyWithLogits");$r(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");let a=Ct(r),i=j(r,n),s=Kg(Tr(Bt(xn(r))));return re(we(a,i),s)}function Rue(e,t,n,r=0,a=wr.SUM_BY_NONZERO_WEIGHTS){let i=A(e,"multiClassLabels","sigmoidCrossEntropy"),s=A(t,"logits","sigmoidCrossEntropy"),o=null;if(n!=null&&(o=A(n,"weights","sigmoidCrossEntropy")),$r(i.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){let c=Re(r),u=Re(1),d=Re(.5);i=re(j(i,we(u,c)),j(d,c))}let l=Aue(i,s);return js(l,o,a)}var Fue=U({sigmoidCrossEntropy_:Rue});function Due(e,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return Qi((r,a,i)=>{let s=r1(a,[n],!0),o=we(he(a,"float32"),s);i([r,o]);let l=Bt(j(o,r));return{value:Te(l,[n]),gradFunc:(c,u)=>{let[d,p]=u,h=fu(c.shape,[n]);return[j(H(c,h),we(he(d,"float32"),Tr(p))),j(H(c,h),we(Tr(p),he(d,"float32")))]}}})(e,t)}function Mue(e,t,n,r=0,a=wr.SUM_BY_NONZERO_WEIGHTS){let i=A(e,"onehotLabels","softmaxCrossEntropy"),s=A(t,"logits","softmaxCrossEntropy"),o=null;if(n!=null&&(o=A(n,"weights","softmaxCrossEntropy")),$r(i.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){let c=Re(r),u=Re(1),d=Re(i.shape[1]);i=re(j(i,we(u,c)),Ie(c,d))}let l=Due(i,s);return js(l,o,a)}var Oue=U({softmaxCrossEntropy_:Mue});function Pue(e,t,n,r){let a=A(e,"indices","sparseFillEmptyRows","int32"),i=A(t,"values","sparseFillEmptyRows"),s=A(n,"denseShape","sparseFillEmptyRows","int32"),o=A(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(a.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${a.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(s.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${s.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);let l={indices:a,values:i,denseShape:s,defaultValue:o},c=V.runKernel(Ng,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}var zue=U({sparseFillEmptyRows_:Pue});function Lue(e,t,n){let r=A(e,"inputIndices","sparseReshape","int32"),a=A(t,"inputShape","sparseReshape","int32"),i=A(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(a.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${a.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);let s={inputIndices:r,inputShape:a,newShape:i},o=V.runKernel(Eh,s);return{outputIndices:o[0],outputShape:o[1]}}var Bue=U({sparseReshape_:Lue});function Wue(e,t,n){let r=A(e,"data","sparseSegmentMean"),a=A(t,"indices","sparseSegmentMean","int32"),i=A(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${a.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);let s={data:r,indices:a,segmentIds:i};return V.runKernel(Eg,s)}var Vue=U({sparseSegmentMean_:Wue});function Uue(e,t,n){let r=A(e,"data","sparseSegmentSum"),a=A(t,"indices","sparseSegmentSum","int32"),i=A(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${a.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);let s={data:r,indices:a,segmentIds:i};return V.runKernel($g,s)}var jue=U({sparseSegmentSum_:Uue});function Hue(e,t,n,r,a,i,s,o){let l=A(e,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);let c=A(t,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");let u={separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:s,preserveShortSequences:o},d={data:l,dataSplits:c},p=V.runKernel(Fg,d,u);return{nGrams:p[0],nGramsSplits:p[1]}}var Gue=U({stringNGrams_:Hue});function que(e,t,n=!0){let r=A(e,"input","stringSplit","string"),a=A(t,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(a.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${a.shape}`);let i={skipEmpty:n},s={input:r,delimiter:a},o=V.runKernel(Dg,s,i);return{indices:o[0],values:o[1],shape:o[2]}}var Kue=U({stringSplit_:que});function Xue(e,t){let n=A(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");let a={input:n};return V.runKernel(Mg,a,r)}var Yue=U({stringToHashBucketFast_:Xue});function Zue(e,t,n,r=!0){let a=A(e,"input","staticRegexReplace","string"),i={pattern:t,rewrite:n,replaceGlobal:r};return V.runKernel(Rg,{x:a},i)}var Que=U({staticRegexReplace_:Zue}),Z4={fft:ey,ifft:mp,rfft:ty,irfft:f1},Q4={hammingWindow:Nle,hannWindow:j4,frame:H4,stft:Rle},Ia={flipLeftRight:Ole,grayscaleToRGB:zle,resizeNearestNeighbor:Y4,resizeBilinear:X4,rotateWithOffset:Ble,cropAndResize:Dle,nonMaxSuppression:Vle,nonMaxSuppressionAsync:Yle,nonMaxSuppressionWithScore:Qle,nonMaxSuppressionWithScoreAsync:eue,nonMaxSuppressionPadded:nue,nonMaxSuppressionPaddedAsync:aue,threshold:uue,transform:due},aT={bandPart:hue,gramSchmidt:mue,qr:yue},J4={absoluteDifference:xue,computeWeightedLoss:js,cosineDistance:kue,hingeLoss:Iue,huberLoss:_ue,logLoss:Nue,meanSquaredError:$ue,sigmoidCrossEntropy:Fue,softmaxCrossEntropy:Oue},eB={sparseFillEmptyRows:zue,sparseReshape:Bue,sparseSegmentMean:Vue,sparseSegmentSum:jue},tB={stringNGrams:Gue,stringSplit:Kue,stringToHashBucketFast:Yue,staticRegexReplace:Que},le={};He(le,{Serializable:()=>nB,SerializationMap:()=>$l,registerClass:()=>rB});var nB=class{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}},$l=class{constructor(){this.classNameMap={}}static getMap(){return $l.instance==null&&($l.instance=new $l),$l.instance}static register(e){$l.getMap().classNameMap[e.className]=[e,e.fromConfig]}};function rB(e){F(e.className!=null,()=>"Class being registered does not have the static className property defined."),F(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),F(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),$l.register(e)}var Hs=class extends nB{minimize(e,t=!1,n){let{value:r,grads:a}=this.computeGradients(e,n);if(n!=null){let i=n.map(s=>({name:s.name,tensor:a[s.name]}));this.applyGradients(i)}else this.applyGradients(a);return je(a),t?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return a4(e,t)}dispose(){this.iterations_!=null&&je(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Re(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}};Object.defineProperty(Hs,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});var iT=class extends Hs{static get className(){return"Adadelta"}constructor(e,t,n=null){super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],n==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=V.registeredVariables[t],a=!1;this.accumulatedGrads[n]==null&&(this.accumulatedGrads[n]={originalName:`${t}/accum_grad`,variable:G(()=>st(r).variable(a))}),this.accumulatedUpdates[n]==null&&(this.accumulatedUpdates[n]={originalName:`${t}/accum_var`,variable:G(()=>st(r).variable(a))});let i=Array.isArray(e)?e[n].tensor:e[t];if(i==null)return;let s=this.accumulatedGrads[n].variable,o=this.accumulatedUpdates[n].variable;G(()=>{let l=re(j(s,this.rho),j(Tt(i),1-this.rho)),c=j(Ie(ar(re(o,this.epsilon)),ar(re(s,this.epsilon))),i),u=re(j(o,this.rho),j(Tt(c),1-this.rho));s.assign(l),o.assign(u);let d=re(j(c,-this.learningRate),r);r.assign(d)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(je(this.accumulatedGrads.map(e=>e.variable)),je(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){let e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=e.length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.accumulatedUpdates=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}},sT=class extends Hs{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=V.registeredVariables[t];this.accumulatedGrads[n]==null&&(this.accumulatedGrads[n]={originalName:`${t}/accumulator`,variable:G(()=>ua(r.shape,this.initialAccumulatorValue).variable(!1))});let a=Array.isArray(e)?e[n].tensor:e[t];if(a==null)return;let i=this.accumulatedGrads[n].variable;G(()=>{let s=re(i,Tt(a));i.assign(s);let o=re(j(Ie(a,ar(re(s,V.backend.epsilon()))),-this.learningRate),r);r.assign(o)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&je(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=!1;this.accumulatedGrads=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}},oT=class extends Hs{static get className(){return"Adam"}constructor(e,t,n,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],G(()=>{this.accBeta1=Re(t).variable(),this.accBeta2=Re(n).variable()}),r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);G(()=>{let n=we(1,this.accBeta1),r=we(1,this.accBeta2);t.forEach((a,i)=>{let s=V.registeredVariables[a],o=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${a}/m`,variable:G(()=>st(s).variable(o))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${a}/v`,variable:G(()=>st(s).variable(o))});let l=Array.isArray(e)?e[i].tensor:e[a];if(l==null)return;let c=this.accumulatedFirstMoment[i].variable,u=this.accumulatedSecondMoment[i].variable,d=re(j(c,this.beta1),j(l,1-this.beta1)),p=re(j(u,this.beta2),j(Tt(l),1-this.beta2)),h=Ie(d,n),f=Ie(p,r);c.assign(d),u.assign(p);let m=re(j(Ie(h,re(ar(f),this.epsilon)),-this.learningRate),s);s.assign(m)}),this.accBeta1.assign(j(this.accBeta1,this.beta1)),this.accBeta2.assign(j(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&je(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&je(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),G(()=>{this.accBeta1.assign(Ps(this.beta1,this.iterations_+1)),this.accBeta2.assign(Ps(this.beta2,this.iterations_+1))});let t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}},lT=class extends Hs{static get className(){return"Adamax"}constructor(e,t,n,r=null,a=0){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],G(()=>{this.iteration=Re(0).variable(),this.accBeta1=Re(t).variable()}),r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(n=>n.name):Object.keys(e);G(()=>{let n=we(1,this.accBeta1),r=Ie(-this.learningRate,re(j(this.iteration,this.decay),1));t.forEach((a,i)=>{let s=V.registeredVariables[a],o=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${a}/m`,variable:st(s).variable(o)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${a}/v`,variable:st(s).variable(o)});let l=Array.isArray(e)?e[i].tensor:e[a];if(l==null)return;let c=this.accumulatedFirstMoment[i].variable,u=this.accumulatedWeightedInfNorm[i].variable,d=re(j(c,this.beta1),j(l,1-this.beta1)),p=j(u,this.beta2),h=xn(l),f=ns(p,h);c.assign(d),u.assign(f);let m=re(j(Ie(r,n),Ie(d,re(f,this.epsilon))),s);s.assign(m)}),this.iteration.assign(re(this.iteration,1)),this.accBeta1.assign(j(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&je(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&je(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}},_1=class extends Hs{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=Array.isArray(e)?e[n].tensor:e[t];if(r==null)return;let a=V.registeredVariables[t];G(()=>{let i=re(j(this.c,r),a);a.assign(i)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=An(Re(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}},uT=class extends _1{static get className(){return"Momentum"}constructor(e,t,n=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=Re(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=V.registeredVariables[t];this.accumulations[n]==null&&(this.accumulations[n]={originalName:`${t}/momentum`,variable:G(()=>st(r).variable(!1))});let a=this.accumulations[n].variable,i=Array.isArray(e)?e[n].tensor:e[t];i!=null&&G(()=>{let s,o=re(j(this.m,a),i);this.useNesterov?s=re(j(this.c,re(i,j(o,this.m))),r):s=re(j(this.c,o),r),a.assign(o),r.assign(s)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&je(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=!1;this.accumulations=e.map(n=>({originalName:n.name,variable:n.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}},cT=class extends Hs{static get className(){return"RMSProp"}constructor(e,t=.9,n=0,r=null,a=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,r==null&&(this.epsilon=V.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(t=>t.name):Object.keys(e)).forEach((t,n)=>{let r=V.registeredVariables[t],a=!1;this.accumulatedMeanSquares[n]==null&&(this.accumulatedMeanSquares[n]={originalName:`${t}/rms`,variable:G(()=>st(r).variable(a))}),this.accumulatedMoments[n]==null&&(this.accumulatedMoments[n]={originalName:`${t}/momentum`,variable:G(()=>st(r).variable(a))}),this.accumulatedMeanGrads[n]==null&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:`${t}/mg`,variable:G(()=>st(r).variable(a))});let i=Array.isArray(e)?e[n].tensor:e[t];if(i==null)return;let s=this.accumulatedMeanSquares[n].variable,o=this.accumulatedMoments[n].variable;G(()=>{let l=re(j(s,this.decay),j(Tt(i),1-this.decay));if(this.centered){let c=this.accumulatedMeanGrads[n].variable,u=re(j(c,this.decay),j(i,1-this.decay)),d=Ie(j(i,this.learningRate),ar(we(l,re(Tt(u),this.epsilon)))),p=re(j(o,this.momentum),d);s.assign(l),c.assign(u),o.assign(p);let h=we(r,p);r.assign(h)}else{let c=re(j(s,this.decay),j(Tt(i),1-this.decay)),u=re(j(o,this.momentum),Ie(j(i,this.learningRate),ar(re(c,this.epsilon))));s.assign(c),o.assign(u);let d=we(r,u);r.assign(d)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&je(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&je(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&je(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.accumulatedMoments=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(r=>({originalName:r.name,variable:r.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}},Jue=[iT,sT,oT,lT,uT,cT,_1];function ece(){for(let e of Jue)rB(e)}var tr={};He(tr,{CompositeArrayBuffer:()=>es,browserFiles:()=>oce,browserHTTPRequest:()=>pce,concatenateArrayBuffers:()=>Rre,copyModel:()=>eae,decodeWeights:()=>NL,encodeWeights:()=>Nre,fromMemory:()=>fce,fromMemorySync:()=>lB,getLoadHandlers:()=>Bre,getModelArtifactsForJSON:()=>ZC,getModelArtifactsForJSONSync:()=>$L,getModelArtifactsInfoForJSON:()=>Vg,getSaveHandlers:()=>Lre,getWeightSpecs:()=>AL,http:()=>pT,isHTTPScheme:()=>uI,listModels:()=>Qre,loadWeights:()=>lce,moveModel:()=>tae,registerLoadRouter:()=>zre,registerSaveRouter:()=>Pre,removeModel:()=>Jre,weightsLoaderFactory:()=>iB,withSaveHandler:()=>mce,withSaveHandlerSync:()=>gce});var tce="model",nce=".json",rce=".weights.bin";function _F(e){return new Promise(t=>setTimeout(t)).then(e)}var yp=class{constructor(e){if(!Q().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(yp.URL_SCHEME)&&(e=e.slice(yp.URL_SCHEME.length)),(e==null||e.length===0)&&(e=tce),this.modelJsonFileName=e+nce,this.weightDataFileName=e+rce}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");let t=es.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],a=EL(e,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),s=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(s.download=this.modelJsonFileName,s.href=i,await _F(()=>s.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){let o=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;o.download=this.weightDataFileName,o.href=n,await _F(()=>o.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Vg(e)}}}};yp.URL_SCHEME="downloads://";var ace=class{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{let n=new FileReader;n.onload=r=>{let a=JSON.parse(r.target.result),i=a.modelTopology;if(i==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(a.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}let s=ZC(a,o=>this.loadWeights(o));e(s)},n.onerror=r=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),n.readAsText(this.jsonFile)})}loadWeights(e){let t=[],n=[];for(let i of e)t.push(...i.weights),n.push(...i.paths);let r=this.checkManifestAndWeightFiles(e),a=n.map(i=>this.loadWeightsFile(i,r[i]));return Promise.all(a).then(i=>[t,i])}loadWeightsFile(e,t){return new Promise((n,r)=>{let a=new FileReader;a.onload=i=>{let s=i.target.result;n(s)},a.onerror=i=>r(`Failed to weights data from file of path '${e}'.`),a.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){let t=[],n=this.weightsFiles.map(a=>SF(a.name)),r={};for(let a of e)a.paths.forEach(i=>{let s=SF(i);if(t.indexOf(s)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${s}'`);if(t.push(s),n.indexOf(s)===-1)throw new Error(`Weight file with basename '${s}' is not provided.`);r[i]=this.weightsFiles[n.indexOf(s)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}},ice=e=>Q().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(yp.URL_SCHEME)?sce(e.slice(yp.URL_SCHEME.length)):null;rn.registerSaveRouter(ice);function sce(e="model"){return new yp(e)}function oce(e){return new ace(e)}function TF(e,t,n,r){s(e),n=n??0,r=r??1,o(n,r);let a=0,i=l=>(l.then(c=>{let u=n+ ++a/e.length*(r-n);return t(u),c}),l);function s(l){F(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,c){F(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),F(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),F(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(e.map(i))}async function aB(e,t){t==null&&(t={});let n=t.fetchFunc==null?Q().platform.fetch:t.fetchFunc,r=e.map(c=>n(c,t.requestInit,{isBinary:!0})),a=0,i=.5,s=(t.onProgress==null?await Promise.all(r):await TF(r,t.onProgress,a,i)).map(c=>c.arrayBuffer()),o=.5,l=1;return t.onProgress==null?await Promise.all(s):await TF(s,t.onProgress,o,l)}async function lce(e,t="",n,r){return iB(a=>aB(a,{requestInit:r}))(e,t,n)}function iB(e){return async(t,n="",r)=>{let a=t.map(()=>!1),i={},s=r!=null?r.map(()=>!1):[],o=[];if(t.forEach((h,f)=>{let m=0;h.weights.forEach(g=>{let y="quantization"in g?g.quantization.dtype:g.dtype,b=rI[y]*Lt(g.shape),v=()=>{a[f]=!0,i[f]==null&&(i[f]=[]),i[f].push({manifestEntry:g,groupOffset:m,sizeBytes:b})};r!=null?r.forEach((x,w)=>{x===g.name&&(v(),s[w]=!0)}):v(),o.push(g.name),m+=b})}),!s.every(h=>h)){let h=r.filter((f,m)=>!s[m]);throw new Error(`Could not find weights in manifest with names: ${h.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}let l=a.reduce((h,f,m)=>(f&&h.push(m),h),[]),c=[];l.forEach(h=>{t[h].paths.forEach(f=>{let m=n+(n.endsWith("/")?"":"/")+f;c.push(m)})});let u=await e(c),d={},p=0;return l.forEach(h=>{let f=t[h].paths.length,m=new es(u.slice(p,p+f));i[h].forEach(g=>{let y=m.slice(g.groupOffset,g.groupOffset+g.sizeBytes),b=NL(y,[g.manifestEntry]);for(let v in b)d[v]=b[v]}),p+=f}),d}}var uce="application/octet-stream",cce="application/json",dT=class{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(F(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=Q().platform.fetch,F(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&F(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;let n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=EL(e,n);if(t.body.append("model.json",new Blob([JSON.stringify(r)],{type:cce}),"model.json"),e.weightData!=null){let i=es.join(e.weightData);t.body.append("model.weights.bin",new Blob([i],{type:uce}),"model.weights.bin")}let a=await this.fetch(this.path,t);if(a.ok)return{modelArtifactsInfo:Vg(e),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async load(){let e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}let n=t.modelTopology,r=t.weightsManifest;if(n==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return ZC(t,a=>this.loadWeights(a))}async loadWeights(e){let t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=dce(t),a=this.weightPathPrefix||n,i=AL(e),s=[],o=[];for(let c of e)for(let u of c.paths)this.weightUrlConverter!=null?o.push(this.weightUrlConverter(u)):s.push(a+u+r);this.weightUrlConverter&&s.push(...await Promise.all(o));let l=await aB(s,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[i,l]}};dT.URL_SCHEME_REGEX=/^https?:\/\//;function dce(e){let t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),a=n>t?e.substring(n):"";return[r+"/",a]}function uI(e){return e.match(dT.URL_SCHEME_REGEX)!=null}var sB=(e,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(e)?n=e.every(r=>uI(r)):n=uI(e),n)return pT(e,t)}return null};rn.registerSaveRouter(sB);rn.registerLoadRouter(sB);function pT(e,t){return new dT(e,t)}function pce(e,t){return pT(e,t)}var lk=class{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}},oB=class{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}},hce=class{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}};function fce(e,t,n,r){let a=arguments;return new hce(lB(...a))}function lB(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new lk(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new lk({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new lk({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function mce(e){return new oB(e)}function gce(e){return new oB(e)}var uB={};He(uB,{confusionMatrix:()=>bce});function yce(e,t,n){let r=A(e,"labels","confusionMatrix"),a=A(t,"predictions","confusionMatrix");F(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),F(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),F(a.rank===1,()=>`Expected the rank of predictions to be 1, but got ${a.rank}`),F(r.shape[0]===a.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${a.shape[0]}. Labels and predictions should have the same number of elements.`),F(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);let i=pp(he(r,"int32"),n),s=pp(he(a,"int32"),n),o=Je(i),l=Ye(o,s);return he(l,"int32")}var bce=U({confusionMatrix_:yce}),ny={};He(ny,{draw:()=>_ce,fromPixels:()=>Tce,fromPixelsAsync:()=>Sce,toPixels:()=>Cce});var bl,NF=!1;function cB(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,a=!1,i=!1,s=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)i=!0;else if(e.getContext!=null)s=!0;else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);if(Qb(Zb,V.backendName)!=null){let p={pixels:e},h={numChannels:t};return V.runKernel(Zb,p,h)}let[l,c]=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],u;if(s)u=e.getContext("2d").getImageData(0,0,l,c).data;else if(r||n)u=e.data;else if(i||a||o){if(bl==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")bl=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else bl=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});bl.canvas.width=l,bl.canvas.height=c,bl.drawImage(e,0,0,l,c),u=bl.getImageData(0,0,l,c).data}let d;if(t===4)d=new Int32Array(u);else{let p=l*c;d=new Int32Array(p*t);for(let h=0;h<p;h++)for(let f=0;f<t;++f)d[h*t+f]=u[h*4+f]}return g1(d,[c,l,t],"int32")}function vce(e){return e!=null&&e.data instanceof Uint8Array}function xce(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function wce(e){return e!=null&&e.width!==0&&e.height!==0}function kce(e){return xce()&&!(e instanceof ImageBitmap)&&wce(e)&&!vce(e)}async function Sce(e,t=3){let n=null;if(Q().getBool("WRAP_TO_IMAGEBITMAP")&&kce(e)){let r;try{r=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===e.width&&r.height===e.height?n=r:n=e}else n=e;return cB(n,t)}function dB(e){if(e.rank!==2&&e.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);let t=e.rank===2?1:e.shape[2];if(t>4||t===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${t}`);if(e.dtype!=="float32"&&e.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`)}function Ice(e){let t=(e==null?void 0:e.alpha)||1;if(t>1||t<0)throw new Error(`Alpha value ${t} is suppoed to be in range [0 - 1].`)}async function Cce(e,t){let n=A(e,"img","toPixels");if(!(e instanceof Ze)){let c=n;n=he(c,"int32"),c.dispose()}dB(n);let[r,a]=n.shape.slice(0,2),i=n.rank===2?1:n.shape[2],s=await n.data(),o=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(a*r*4);for(let c=0;c<r*a;++c){let u=[0,0,0,255];for(let p=0;p<i;p++){let h=s[c*i+p];if(n.dtype==="float32"){if(h<0||h>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${h}.`)}else if(n.dtype==="int32"&&(h<0||h>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${h}.`);i===1?(u[0]=h*o,u[1]=h*o,u[2]=h*o):u[p]=h*o}let d=c*4;l[d+0]=Math.round(u[0]),l[d+1]=Math.round(u[1]),l[d+2]=Math.round(u[2]),l[d+3]=Math.round(u[3])}if(t!=null){NF||(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),NF=!0),t.width=a,t.height=r;let c=t.getContext("2d"),u=new ImageData(l,a,r);c.putImageData(u,0,0)}return n!==e&&n.dispose(),l}function _ce(e,t,n){let r=A(e,"img","draw");if(!(e instanceof Ze)){let s=r;r=he(s,"int32"),s.dispose()}dB(r),Ice(n==null?void 0:n.imageOptions);let a={image:r},i={canvas:t,options:n};V.runKernel(GC,a,i)}var Tce=U({fromPixels_:cB}),hT={};He(hT,{prepareAndValidate:()=>pB});function pB(e,t){let n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(Lt(e.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);let a=t.shape,i=a[a.length-1],s=1;for(let d=0;d<a.length-1;++d)s*=a[d];let o=e.shape,l=a.slice();l.pop();let c=1;for(let d=i;d<n;++d)c*=o[d],l.push(o[d]);let u=[...Dp(e.shape).map(d=>d/c),1].slice(0,i);return[l,s,c,u]}var Dn={};He(Dn,{assertParamsValid:()=>Ece,computeFlatOffset:()=>Dce,computeOutShape:()=>Ace,getNormalizedAxes:()=>Rce,isSliceContinous:()=>Fce,maskToAxes:()=>$ce,parseSliceParams:()=>wB,sliceInfo:()=>Mce,startForAxis:()=>vB,startIndicesWithElidedDims:()=>gB,stopForAxis:()=>xB,stopIndicesWithElidedDims:()=>yB,stridesForAxis:()=>bB,stridesWithElidedDims:()=>hB});var cI=-2,Nce=-1;function Ece(e,t,n){let r=e.shape.length;F(r===t.length,()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`),F(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let a=0;a<r;++a)F(t[a]+n[a]<=e.shape[a],()=>`Error in slice${r}D: begin[${a}] + size[${a}] (${t[a]+n[a]}) would overflow input.shape[${a}] (${e.shape[a]})`)}function $ce(e){let t=[],n=0;for(;e>0;)e&1&&t.push(n),e/=2,n++;return t}function Ace(e,t,n){let r=[];for(let a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function hB(e,t,n,r){let a=[...e];for(let i=a.length;i<r.length;i++)a.push(1);for(let i=0;i<n;i++)i===0?a[t]=1:(a.splice(t,0,1),a.pop());return a}function fB(e,t,n){return n<=e?n:n-(t-1)}function mB(e,t){let n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function Rce(e,t,n,r,a,i,s,o,l){let c=e.length,u=new Array(c),d=new Array(c),p=new Array(c);if(t.length&&n>0){let h=t[0],f=n+1;u=gB(s,h,f,r,e),d=yB(o,h,f,a,e),p=hB(i,h,f,e)}else for(let h=0;h<c;h++)u[h]=vB(s,r,i,e,h,l),d[h]=xB(o,a,i,e,h,l),p[h]=bB(i,h,l);return{begin:u,end:d,strides:p}}function gB(e,t,n,r,a){let i=[...a],s=mB(n,t);for(let o=0;o<i.length;o++)if(s.indexOf(o)>-1)i[o]=0;else{let l=fB(t,n,o),c=r[l];e&1<<l&&(c=0),i[o]=c}return i}function yB(e,t,n,r,a){let i=[...a],s=mB(n,t);for(let o=0;o<i.length;o++)if(s.indexOf(o)>-1)i[o]=Number.MAX_SAFE_INTEGER;else{let l=fB(t,n,o),c=r[l];e&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[o]=c}for(let o=0;o<i.length;o++){let l=a[o];i[o]<0&&(i[o]+=l),i[o]=Lm(0,i[o],a[o])}return i}function bB(e,t,n){let r=e[t];return(n&1<<t||r==null)&&(r=1),r}function vB(e,t,n,r,a,i){let s=t[a],o=n[a]||1;(e&1<<a||i&1<<a||s==null)&&(o>0?s=Number.MIN_SAFE_INTEGER:s=Number.MAX_SAFE_INTEGER);let l=r[a];return s<0&&(s+=l),s=Lm(0,s,l-1),s}function xB(e,t,n,r,a,i){let s=t[a],o=n[a]||1;(e&1<<a||i&1<<a||s==null)&&(o>0?s=Number.MAX_SAFE_INTEGER:s=Number.MIN_SAFE_INTEGER);let l=r[a];return s<0&&(s+=l),o>0?s=Lm(0,s,l):s=Lm(-1,s,l-1),s}function Fce(e,t,n){let r=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(let a=r+1;a<n.length;a++)if(t[a]>0||n[a]!==e[a])return!1;return!0}function Dce(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function wB(e,t,n){let r,a=e.shape.length;typeof t=="number"?r=[t,...new Array(a-1).fill(0)]:t.length<a?r=t.concat(new Array(a-t.length).fill(0)):r=t.slice(),r.forEach(s=>{F(s!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(a).fill(-1):typeof n=="number"?i=[n,...new Array(a-1).fill(-1)]:n.length<a?i=n.concat(new Array(a-n.length).fill(-1)):i=n,i=i.map((s,o)=>s>=0?s:(F(s===-1,()=>`Negative size values should be exactly -1 but got ${s} for the slice() size at index ${o}.`),e.shape[o]-r[o])),[r,i]}function Mce(e,t,n,r,a,i,s,o,l){let c;if(r==null?(c=new Array(t.length),c.fill(1)):c=r,s!=null&&s&s-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1,d={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:a,endMask:i,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)u&&1<<b&o&&d.numAddAxisAfterEllipsis++,1<<b&s&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);let p={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};Oce(d,p);let h=!0,f=!0,m=!0,g=[],y=[];for(let b=0;b<e.length;++b){if(p.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);let v=!!(p.shrinkAxisMask&1<<b),x=e[b];if(x===-1){g.push(v?1:-1);continue}let w=[p.beginMask&1<<b,p.endMask&1<<b],S=[p.strides[b]>0?0:-1,p.strides[b]>0?x:x-1];if(v&&p.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&p.strides[b]===1;let C=!!(p.beginMask&1<<b&&p.endMask&1<<b);if(p.beginValid&&p.endValid){if(v){let $=p.begin[b]<0?x+p.begin[b]:p.begin[b];if(p.begin[b]=$,p.end[b]=p.begin[b]+1,$<0||$>=x)throw Error(`slice index ${p.begin[b]} of dimension ${b} out of bounds.`)}else p.begin[b]=EF(p.begin[b],0,p.strides[b],x,w,S),p.end[b]=EF(p.end[b],1,p.strides[b],x,w,S);let R=p.strides[b]===1&&p.begin[b]===0&&p.end[b]===x;h=h&&R,f=f&&(b===0&&p.strides[b]===1||R)}else h=h&&p.strides[b]===1&&C,f=f&&(b===0&&p.strides[b]===1||C);let T,E=!1;if(p.beginValid&&p.endValid?(T=p.end[b]-p.begin[b],E=!0):v?(T=1,E=!0):C&&x>=0&&(p.strides[b]<0?T=-x:T=x,E=!0),E){let R;T===0||T<0!=p.strides[b]<0?R=0:R=Math.trunc(T/p.strides[b])+(T%p.strides[b]!==0?1:0),g.push(R)}else g.push(-1)}for(let b=0;b<p.finalShapeGatherIndices.length;++b){let v=p.finalShapeGatherIndices[b];v>=0?y.push(g[v]):v===cI&&y.push(1)}return{finalShapeSparse:y.filter((b,v)=>p.finalShapeGatherIndices[v]!==cI),finalShape:y,isIdentity:h,sliceDim0:f,isSimpleSlice:m,begin:p.begin,end:p.end,strides:p.strides}}function Oce(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){let a=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<a;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(cI),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[n]=e.begin[r]),e.end!=null&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(Nce),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}function EF(e,t,n,r,a,i){if(a[t])return n>0?i[t]:i[t+1&1];{let s=e<0?r+e:e;return s<i[0]?i[0]:s>i[1]?i[1]:s}}var Pce="4.7.0",kB=class{static sgd(e){return new _1(e)}static momentum(e,t,n=!1){return new uT(e,t,n)}static rmsprop(e,t=.9,n=0,r=null,a=!1){return new cT(e,t,n,r,a)}static adam(e=.001,t=.9,n=.999,r=null){return new oT(e,t,n,r)}static adadelta(e=.001,t=.95,n=null){return new iT(e,t,n)}static adamax(e=.002,t=.9,n=.999,r=null,a=0){return new lT(e,t,n,r,a)}static adagrad(e,t=.1){return new sT(e,t)}},_l=kB,zce=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:e=>e())();function fT(){return new Promise(e=>zce(()=>e()))}var N={};He(N,{ERF_A1:()=>Jce,ERF_A2:()=>ede,ERF_A3:()=>tde,ERF_A4:()=>nde,ERF_A5:()=>rde,ERF_P:()=>Qce,PARALLELIZE_THRESHOLD:()=>mT,RowPartitionType:()=>zi,SELU_SCALE:()=>IB,SELU_SCALEALPHA:()=>SB,applyActivation:()=>I1,assertAndGetBroadcastShape:()=>$t,assertAxesAreInnerMostDims:()=>Bie,assertParamsConsistent:()=>Lce,assignToTypedArray:()=>ude,axesAreInnerMostDims:()=>__,calculateShapes:()=>R4,checkEinsumDimSizes:()=>mde,checkPadOnDimRoundingMode:()=>Ar,combineLocations:()=>JL,combineRaggedTensorToTensorShapes:()=>Wce,complexWithEvenIndex:()=>sde,complexWithOddIndex:()=>ode,computeConv2DInfo:()=>Ug,computeConv3DInfo:()=>UL,computeDefaultPad:()=>o_,computeDilation2DInfo:()=>zae,computeOptimalWindowSize:()=>Hce,computeOutAndReduceShapes:()=>e4,computeOutShape:()=>Bce,computePool2DInfo:()=>VL,computePool3DInfo:()=>Lae,convertConv2DDataFormat:()=>jL,decodeEinsumEquation:()=>hde,eitherStridesOrDilationsAreOne:()=>ts,expandShapeToKeepDim:()=>fu,exponent:()=>dde,exponents:()=>cde,fromStringArrayToUint8:()=>Ode,fromUint8ToStringArray:()=>Mde,getAxesPermutation:()=>t4,getBroadcastDims:()=>YL,getComplexWithIndex:()=>lde,getEinsumComputePath:()=>gde,getEinsumPermutation:()=>fde,getFusedBiasGradient:()=>S1,getFusedDyActivation:()=>k1,getImageCenter:()=>Gce,getInnerMostAxes:()=>Wie,getPermuted:()=>Kce,getRaggedRank:()=>Uce,getReductionAxes:()=>In,getReshaped:()=>qce,getReshapedPermuted:()=>Xce,getRowPartitionTypesHelper:()=>Vce,getSliceBeginCoords:()=>Yce,getSliceSize:()=>Zce,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>xde,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>wde,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>kde,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>Cde,getSparseReshapeInputOutputMismatchErrorMessage:()=>Tde,getSparseReshapeInputOutputMultipleErrorMessage:()=>_de,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>Sde,getSparseReshapeNegativeOutputDimErrorMessage:()=>Ide,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>Ade,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>Nde,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>Ede,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>$de,getUndoAxesPermutation:()=>T_,isIdentityPermutation:()=>yde,log:()=>Zne,mergeRealAndImagArrays:()=>ade,prepareAndValidate:()=>pB,prepareSplitSize:()=>vde,segment_util:()=>CB,shouldFuse:()=>C1,slice_util:()=>Dn,splitRealAndImagArrays:()=>ide,stridesOrDilationsArePositive:()=>pu,tupleValuesAreOne:()=>zo,upcastType:()=>Fa,validateDefaultValueShape:()=>jce,validateInput:()=>b1,validateUpdateShape:()=>X_,warn:()=>lo});function Lce(e,t){let n=e[0].length;e.forEach((a,i)=>{F(a.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),F(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);let r=e[0];e.forEach((a,i)=>{for(let s=0;s<n;s++)F(s===t||a[s]===r[s],()=>`Error in concat${n}D: Shape of tensors[${i}] (${a}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function Bce(e,t){let n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}var zi;(function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"})(zi||(zi={}));function Wce(e,t,n){let r=new Array;if(n==null&&t==null)return r;if(t==null)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(n==null)return r;if(e+n.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let a=1;a<n.length;++a){let i=n[a],s=r[r.length-n.length+a],o=r[s];if(i>=0)if(o>=0){if(o!==i)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${a+e}] = ${i} but shape[${a+e}] = ${o}`)}else r[s]=i}return r}function Vce(e){let t={FIRST_DIM_SIZE:zi.FIRST_DIM_SIZE,VALUE_ROWIDS:zi.VALUE_ROWIDS,ROW_LENGTHS:zi.ROW_LENGTHS,ROW_SPLITS:zi.ROW_SPLITS,ROW_LIMITS:zi.ROW_LIMITS,ROW_STARTS:zi.ROW_STARTS},n=[];for(let r of e)if(r in t)n.push(t[r]);else break;return n}function Uce(e){return e.length===0?0:e[0]===zi.FIRST_DIM_SIZE?e.length-1:e.length}function jce(e,t){if(e==null||t==null)return;let n=e.length,r=t.length;if(n>=r)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let a=0;a<Math.min(n,r-1);++a){let i=e[a],s=t[a+1];if(i>=0&&s>=0&&i!==1&&i!==s)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${a-e.length}] = ${i} but ragged tensor input.flatValues.shape[${a-e.length}] = ${s}`)}}var mT=30;function Hce(e){return e<=mT?e:Yb(e,Math.floor(Math.sqrt(e)))}function Gce(e,t,n){let r=n*(typeof e=="number"?e:e[0]),a=t*(typeof e=="number"?e:e[1]);return[r,a]}function qce(e,t,n,r=!0){let a=[];if(r)a=a.concat(t.slice(0)),a.push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);let i=t.length;for(let s=0;s<i;++s)a=a.concat([e[s+1]/t[s],t[s]]);a=a.concat(e.slice(i+1))}return a}function Kce(e,t,n=!0){let r=[];if(n){r.push(t);for(let a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{let a=[],i=[];for(let s=1;s<e;++s)s>=t*2+1||s%2===1?i.push(s):a.push(s);r.push(...a),r.push(0),r.push(...i)}return r}function Xce(e,t,n,r=!0){let a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(let i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function Yce(e,t){let n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function Zce(e,t,n){let r=e.slice(0,1);for(let a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}var SB=1.7580993408473768,IB=1.0507009873554805,Qce=.3275911,Jce=.254829592,ede=-.284496736,tde=1.421413741,nde=-1.453152027,rde=1.061405429;function ade(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);let n=new Float32Array(e.length*2);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function ide(e){let t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function sde(e){let t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function ode(e){let t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function lde(e,t){let n=e[t*2],r=e[t*2+1];return{real:n,imag:r}}function ude(e,t,n,r){e[r*2]=t,e[r*2+1]=n}function cde(e,t){let n=new Float32Array(e/2),r=new Float32Array(e/2);for(let a=0;a<Math.ceil(e/2);a++){let i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function dde(e,t,n){let r=(n?2:-2)*Math.PI*(e/t),a=Math.cos(r),i=Math.sin(r);return{real:a,imag:i}}var uk="->",pde=/->/g,$F=",",AF="...";function hde(e,t){e=e.replace(/\s/g,"");let n=(e.length-e.replace(pde,"").length)/uk.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${uk}").`);let[r,a]=e.split(uk);F(r.indexOf(AF)===-1,()=>`The ellipsis notation ("${AF}") is not supported yet.`);let i=r.split($F),s=i.length;if(t!==s)throw new Error(`Expected ${s} input tensors, received ${t}`);if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");let o=[];for(let p=0;p<a.length;++p){let h=a[p];if(!i.some(f=>f.indexOf(h)!==-1))throw new Error(`Output subscripts contain the label ${h} not present in the input subscripts.`);o.indexOf(h)===-1&&o.push(h)}for(let p=0;p<r.length;++p){let h=r[p];o.indexOf(h)===-1&&h!==$F&&o.push(h)}let l=new Array(i.length);for(let p=0;p<s;++p){if(new Set(i[p].split("")).size!==i[p].length)throw new Error(`Found duplicate axes in input component ${i[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let h=0;h<i[p].length;++h)l[p].push(o.indexOf(i[p][h]))}let c=o.length,u=a.length,d=[];for(let p=u;p<c;++p)d.push(p);return{allDims:o,summedDims:d,idDims:l}}function fde(e,t){let n=new Array(e);n.fill(-1);for(let a=0;a<t.length;++a)n[t[a]]=a;let r=[];for(let a=0;a<e;++a)n[a]===-1&&r.push(a);return n=n.filter(a=>a!==-1),{permutationIndices:n,expandDims:r}}function mde(e,t,n){let r=new Array(e);for(let a=0;a<n.length;++a){let i=n[a].shape;for(let s=0;s<t[a].length;++s)r[t[a][s]]===void 0?r[t[a][s]]=i[s]:F(r[t[a][s]]===i[s],()=>`Expected dimension ${r[t[a][s]]} at axis ${s} of input shaped ${JSON.stringify(i)}, but got dimension ${i[s]}`)}}function gde(e,t){let n=e,r=[],a=0;e.length===0&&n.push(-1),a=e.length+1;for(let s=0;s<a;++s)r.push([]);let i=[];for(let s=0;s<n.length;++s){let o=n[s],l=bde(t,o);for(let c of l)i.indexOf(c)===-1&&(r[s].push(c),i.push(c))}return{path:n,steps:r}}function yde(e){return e.every((t,n)=>t===n)}function bde(e,t){let n=[];for(let r=0;r<e.length;++r)(e[r].length===0||e[r].indexOf(t)!==-1||t===-1)&&n.push(r);return n}function vde(e,t,n=0){let r=[];if(typeof t=="number")F(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(e.shape[n]/t);else{let a=t.reduce((s,o)=>(o===-1&&(s+=1),s),0);F(a<=1,()=>"There should be only one negative value in split array.");let i=t.indexOf(-1);if(i!==-1){let s=t.reduce((o,l)=>l>0?o+l:o);t[i]=e.shape[n]-s}F(e.shape[n]===t.reduce((s,o)=>s+o),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}function xde(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function wde(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function kde(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}function Sde(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function Ide(e,t){return`size ${e} must be non-negative, not ${t}`}function Cde(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function _de(e,t){let n=Lt(e),r=Lt(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${e} outputShape= ${t}`}function Tde(e,t){let n=Lt(e),r=Lt(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${e} outputShape=${t}`}function Nde(){return"segment ids must be >= 0"}function Ede(){return"segment ids are not increasing"}function $de(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function Ade(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}var CB={};He(CB,{collectGatherOpShapeInfo:()=>Dde,computeOutShape:()=>Fde,segOpComputeOptimalWindowSize:()=>Rde});function Rde(e,t){let n=!1,r;for(e<=mT?(r=e,n=!0):r=Yb(e,Math.floor(Math.sqrt(e)));!n;)r>t||r===e?n=!0:r=Yb(e,r+1);return r}function Fde(e,t,n){let r=[],a=e.length;for(let i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}function Dde(e,t,n,r){let a=t.shape.length,i=e.shape.length;if(r!==0&&(r<-a||r>a))throw new Error(`Expect batchDims in the range of [-${a}, ${a}], but got ${r}`);if(r<0&&(r+=a),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(e.shape[d]!==t.shape[d])throw new Error(`x.shape[${d}]: ${e.shape[d]} should be equal to indices.shape[${d}]: ${t.shape[d]}.`);let s=e.shape[n],o=[],l=1,c=1,u=1;for(let d=0;d<r;++d)o.push(e.shape[d]),l*=e.shape[d];for(let d=r;d<n;d++)o.push(e.shape[d]),c*=e.shape[d];for(let d=r;d<a;d++)o.push(t.shape[d]);for(let d=n+1;d<i;d++)o.push(e.shape[d]),u*=e.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:s,outputShape:o}}function Mde(e){try{return e.map(t=>ev(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function Ode(e){return e.map(t=>Bg(t))}var rs={};He(rs,{nonMaxSuppressionV3Impl:()=>G4,nonMaxSuppressionV4Impl:()=>q4,nonMaxSuppressionV5Impl:()=>K4,whereImpl:()=>M4});ece();var _B={kernelName:Mp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(e,Qc(he(n,"float32"),-1))}}},Pde={kernelName:Au,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=Tt(he(n,"float32")),a=ar(we(Re(1),r));return Bt(Ie(e,a))}}}},zde={kernelName:Ru,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=ar(we(Tt(he(n,"float32")),1));return Ie(e,r)}}}},Lde={kernelName:Jo,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=$t(n.shape,r.shape);return{a:()=>{let i=e,s=In(n.shape,a);return s.length>0&&(i=Te(i,s)),H(i,n.shape)},b:()=>{let i=e,s=In(r.shape,a);return s.length>0&&(i=Te(i,s)),H(i,r.shape)}}}},Bde={kernelName:Fu,saveAllInputs:!0,gradFunc:(e,t)=>{let n={};return t.forEach((r,a)=>{n[a]=()=>e.clone()}),n}},Wde={kernelName:zp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>st(n)}}},Vde={kernelName:Lp,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>st(n)}}},Ude={kernelName:Du,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Ie(e,ar(we(Re(1),Tt(he(n,"float32")))))}}},jde={kernelName:Mu,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=ar(re(Re(1),Tt(he(n,"float32"))));return Ie(e,r)}}}},Hde={kernelName:zu,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=$t(n.shape,r.shape);return{a:()=>{let i=re(Tt(n),Tt(r)),s=j(e,Ie(r,i)),o=In(n.shape,a);return o.length>0&&(s=Te(s,o)),H(s,n.shape)},b:()=>{let i=re(Tt(n),Tt(r)),s=Bt(j(e,Ie(n,i))),o=In(r.shape,a);return o.length>0&&(s=Te(s,o)),H(s,r.shape)}}}},Gde={kernelName:Ou,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Ie(e,re(Tt(he(n,"float32")),1))}}},qde={kernelName:Pu,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Ie(e,we(Re(1),Tt(he(n,"float32"))))}}};function Kde(e,t,n,r,a,i){let s=A(e,"dy","avgPool3dGrad"),o=A(t,"input","avgPool3dGrad"),l=s,c=o,u=!1;o.rank===4&&(u=!0,l=H(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),c=H(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),F(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),F(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),Ar("avgPool3dGrad",a,i);let d={dy:l,input:c},p={filterSize:n,strides:r,pad:a,dimRoundingMode:i},h=V.runKernel(bg,d,p);return u?H(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}var Xde=U({avgPool3dGrad_:Kde}),Yde={kernelName:Bp,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{filterSize:a,strides:i,pad:s,dimRoundingMode:o}=n;return{x:()=>Xde(e,r,a,i,s,o)}}};function Zde(e,t,n,r,a){let i=A(e,"dy","avgPoolGrad"),s=A(t,"input","avgPoolGrad");F(s.rank===i.rank,()=>`Rank of input (${s.rank}) does not match rank of dy (${i.rank})`);let o=s,l=i,c=!1;s.rank===3&&(c=!0,o=H(s,[1,s.shape[0],s.shape[1],s.shape[2]]),l=H(i,[1,i.shape[0],i.shape[1],i.shape[2]])),F(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),F(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);let u={dy:l,input:o},d={filterSize:n,strides:r,pad:a},p=V.runKernel(yg,u,d);return c?H(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var Qde=U({avgPoolGrad_:Zde}),Jde={kernelName:Lu,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{filterSize:a,strides:i,pad:s}=n;return{x:()=>Qde(e,r,a,i,s)}}},epe={kernelName:Bu,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{let[r,a]=t,{transposeA:i,transposeB:s}=n;return!i&&!s?{a:()=>Ye(e,a,!1,!0),b:()=>Ye(r,e,!0,!1)}:!i&&s?{a:()=>Ye(e,a,!1,!1),b:()=>Ye(e,r,!0,!1)}:i&&!s?{a:()=>Ye(a,e,!1,!0),b:()=>Ye(r,e,!1,!1)}:{a:()=>Ye(a,e,!0,!0),b:()=>Ye(e,r,!0,!0)}}},tpe={kernelName:Wp,gradFunc:(e,t,n)=>{let{blockShape:r,crops:a}=n;return{x:()=>Zg(e,r,a)}}},npe={kernelName:hL,gradFunc:(e,t,n)=>{let r=n,a=r.inputShape,i=r.shape,s=Array.from(i);for(let l=a.length-1;l>=0;l--)if(a[l]===i[l])s[l]=1;else if(a[l]!==1)throw new Error(`broadcastTo(): [${a}] cannot be broadcast to [${i}].`);let o=[];for(let l=0;l<s.length;l++)s[l]>1&&o.push(l);return{x:()=>Te(e,o,!0)}}},rpe={kernelName:Wu,gradFunc:e=>({x:()=>e.clone()})},ape={kernelName:Vu,gradFunc:e=>({x:()=>st(e)})},ipe={kernelName:el,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{clipValueMin:a,clipValueMax:i}=n;return{x:()=>Hn(ri(Us(r,a),al(r,i)),e,st(e))}}},spe={kernelName:xg,inputsToSave:["x"],gradFunc:_B.gradFunc},ope={kernelName:jp,saveAllInputs:!0,gradFunc:(e,t,n)=>{let r=t.map(o=>o.shape),{axis:a}=n,i=si(a,t[0].shape)[0],s=r.map(o=>o[i]);return Wr(e,s,i).map(o=>()=>o)}},lpe={kernelName:Uu,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[r,a]=t,{dilations:i,strides:s,pad:o,dataFormat:l}=n;return F(zo(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>b_(r.shape,e,a,s,o,l),filter:()=>nT(r,e,a.shape,s,o,l)}}},upe={kernelName:ju,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{let[r,a]=t,{strides:i,pad:s,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>_r(e,a,i,s,o,1,l),filter:()=>nT(e,r,a.shape,i,s,o,l)}}};function cpe(e,t,n,r,a){let i=e;e.rank===4&&(i=H(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let s=t;s.rank===4&&(s=H(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),F(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),F(s.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${s.shape}.`),F(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),F(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),F(s.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${s.shape[4]}) must match output depth for filter (${n[4]}).`);let o={x:i,dy:s},l={strides:r,pad:a,filterShape:n};return V.runKernel(Hp,o,l)}var dpe=U({conv3DBackpropFilter_:cpe}),ppe={kernelName:Hu,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:r,strides:a,pad:i}=n;F(zo(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);let[s,o]=t;return{x:()=>KL(s.shape,e,o,a,i),filter:()=>dpe(s,e,o.shape,a,i)}}},hpe={kernelName:Gu,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(Bt(d1(he(n,"float32"))),e)}}},fpe={kernelName:qu,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(p1(he(n,"float32")),e)}}},mpe={kernelName:Ku,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:a,exclusive:i,reverse:s}=n;return{x:()=>{let o=t4([a],r.rank),l=Jx(e,a,i,!s);return o!=null&&(l=Je(l,o)),l}}}},gpe={kernelName:Xu,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let{dilations:r,strides:a,pad:i,dimRoundingMode:s}=n,o=r??[1,1];F(zo(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);let[l,c]=t;return F(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),F(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),F(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),F(ts(a,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${a} and dilations '${o}'.`),Ar("depthwiseConv2d",i,s),{x:()=>U4(l.shape,e,c,a,i,o,s),filter:()=>V4(l,e,c.shape,a,i,o,s)}}},ype={kernelName:Yu,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{let[r,a]=t,i={x:r,filter:a,dy:e},s={x:r,filter:a,dy:e};return{x:()=>V.runKernel(op,i,n),filter:()=>V.runKernel(lp,s,n)}}},bpe={kernelName:Qu,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t,r={dy:e,y:n};return{x:()=>V.runKernel(Yp,r)}}},vpe={kernelName:Ju,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,r=j(Tr(Bt(Tt(n))),2/Math.sqrt(Math.PI));return{x:()=>j(e,r)}}},xpe={kernelName:ec,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(e,n)}}},wpe={kernelName:Qp,inputsToSave:["input"],gradFunc:(e,t)=>{let[n]=t;return{input:()=>H(e,n.shape)}}},kpe={kernelName:tc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(e,Tr(n))}}},Spe={kernelName:nc,gradFunc:e=>({x:()=>st(e)})},Ipe={kernelName:rc,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=$t(n.shape,r.shape);return{a:()=>{let i=Ie(e,he(r,"float32")),s=In(n.shape,a);return s.length>0?H(Te(i,s),n.shape):i},b:()=>{let i=j(e,he(n,"float32")),s=In(r.shape,a);s.length>0&&(i=H(Te(i,s),r.shape));let o=Tt(r);return Bt(Ie(i,he(o,"float32")))}}}},Cpe={kernelName:ac,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{let{varianceEpsilon:r}=n,[a,i,s,o]=t,l=o??Re(1),c=In(i.shape,a.shape),u=[];if(i.rank===1){for(let m=0;m<a.shape.length-1;++m)u.push(a.shape[m]);u.push(1)}let d=we(a,i),p=j(e,l),h=u1(re(s,Re(r))),f=j(j(j(h,h),h),Re(-.5));return{x:()=>i.rank===1?H(j(j(e,aa(H(h,[1,1,1,i.shape[0]]),u)),l),a.shape):H(j(j(e,h),l),a.shape),mean:()=>{let m=j(j(h,Re(-1)),p);return i.rank===1&&(m=Te(m,c)),H(m,i.shape)},variance:()=>{let m=j(j(f,d),p);return i.rank===1&&(m=Te(m,c)),H(m,i.shape)},scale:()=>{let m=j(d,h),g=j(e,m);return i.rank===1&&(g=Te(g,c)),H(g,i.shape)},offset:()=>{let m=e;return i.rank===1&&(m=Te(m,c)),H(m,i.shape)}}}},_pe={kernelName:eh,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{let[r,a]=t,{axis:i}=n,s=si(i,r.shape)[0];return{x:()=>{let o=r.shape,l=a.size,c=o.slice(0,s),u=c.length,d=o.slice(i,o.length).slice(1),p=d.length,h=RF(0,u),f=RF(u+1,u+1+p),m=FF([c,[l],d]),g=H(e,m),y=H(a,[l]),b=FF([[u],h,f]),v=Je(g,b),x=x1(v,y,r.shape[s]),w=T_(b);return x=Je(x,w),x},indices:()=>a}}};function RF(e,t){let n=[];for(let r=e;r<t;++r)n.push(r);return n}function FF(e){let t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Tpe={kernelName:ic,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>st(n),b:()=>st(r)}}},Npe={kernelName:sc,gradFunc:e=>({x:()=>he(e,"float32")})},Epe={kernelName:oc,gradFunc:e=>({x:()=>st(e)})},$pe={kernelName:lc,gradFunc:e=>({x:()=>st(e)})},Ape={kernelName:uc,gradFunc:e=>({x:()=>st(e)})},Rpe={kernelName:cc,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{alpha:a}=n,i=Rr(r,0);return{x:()=>Hn(i,e,j(e,a))}}},Fpe={kernelName:pc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Ie(e,re(n,1))}}},Dpe={kernelName:dc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Ie(e,he(n,"float32"))}}},Mpe={kernelName:mL,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r]=t,{axis:a}=n;return{logits:()=>{let i=Tr(r);return we(e,j(Te(e,a,!0),i))}}}};function Ope(e,t,n,r=5,a=1,i=1,s=.5){let o={x:e,y:t,dy:n},l={depthRadius:r,bias:a,alpha:i,beta:s};return V.runKernel(uh,o,l)}var Ppe=U({localResponseNormalizationBackprop_:Ope}),zpe={kernelName:hc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,a]=t,{depthRadius:i,bias:s,alpha:o,beta:l}=n;return{x:()=>Ppe(r,a,e,i,s,o,l)}}};function TB(e,t,n,r){return t.rank<n.rank&&(t=H(t,fu(t.shape,r))),e.rank<n.rank&&(e=H(e,fu(e.shape,r))),{x:()=>j(e,he(pa(n,t),e.dtype))}}var DF={kernelName:fc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let r=n,{reductionIndices:a}=r,i=t[0],s=t[1],o=si(a,i.shape),l=TB(e,s,i,o);return{x:()=>l.x()}}},Lpe={kernelName:mc,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>j(e,he(Us(n,r),"float32")),b:()=>j(e,he(dp(n,r),"float32"))}}};function Bpe(e,t,n,r,a,i,s){let o=A(e,"dy","maxPool3dGrad"),l=A(t,"input","maxPool3dGrad"),c=A(n,"output","maxPool3dGrad"),u=o,d=l,p=c,h=!1;l.rank===4&&(h=!0,u=H(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=H(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=H(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),F(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),F(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),F(p.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),Ar("maxPool3dGrad",i,s);let f={dy:u,input:d,output:p},m={filterSize:r,strides:a,pad:i,dimRoundingMode:s},g=V.runKernel(Cg,f,m);return h?H(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}var Wpe=U({maxPool3dGrad_:Bpe}),Vpe={kernelName:ch,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,a]=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=n;return{x:()=>Wpe(e,r,a,i,s,o,l)}}};function Upe(e,t,n,r,a,i,s){let o=A(e,"dy","maxPoolGrad"),l=A(t,"input","maxPoolGrad"),c=A(n,"output","maxPoolGrad");F(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),F(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),F(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Ar("maxPoolGrad",i,s);let u={dy:o,input:l,output:c},d={filterSize:r,strides:a,pad:i,dimRoundingMode:s};return V.runKernel(Ig,u,d)}var jpe=U({maxPoolGrad_:Upe}),Hpe={kernelName:gc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,a]=t,{filterSize:i,strides:s,pad:o}=n;return{x:()=>jpe(e,r,a,i,s,o)}}},Gpe={kernelName:yc,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:a}=n,i=si(a,r.shape),s=e4(r.shape,i)[1],o=Lt(s);return{x:()=>{let l=r.shape.slice();i.forEach(u=>{l[u]=1});let c=H(e,l);return Ie(j(c,ia(r.shape,"float32")),o)}}}},qpe={kernelName:bc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{let r=n,{axis:a}=r,[i,s]=t,o=si(a,i.shape),l=TB(e,s,i,o);return{x:()=>l.x()}}},Kpe={kernelName:vc,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>j(e,he(al(n,r),"float32")),b:()=>j(e,he(Rr(n,r),"float32"))}}},Xpe={kernelName:xc,inputsToSave:["x"],gradFunc:(e,t,n)=>{let r=t[0],{paddings:a}=n,i=a.map(s=>s[0]);return{x:()=>it(e,i,r.shape)}}},Ype={kernelName:wc,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=$t(n.shape,r.shape);return{a:()=>{let i=In(n.shape,a);return i.length>0?H(Te(e,i),n.shape):e},b:()=>{let i=j(e,Bt(Bh(Ie(n,r)))),s=In(r.shape,a);return s.length>0?H(Te(i,s),r.shape):i}}}},Zpe={kernelName:kc,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=$t(n.shape,r.shape);return{a:()=>{let i=j(e,he(r,"float32")),s=In(n.shape,a);return s.length>0?H(Te(i,s),n.shape):i},b:()=>{let i=j(e,he(n,"float32")),s=In(r.shape,a);return s.length>0?H(Te(i,s),r.shape):i}}}},Qpe={kernelName:ph,gradFunc:e=>({x:()=>Bt(e)})},Jpe={kernelName:Sc,inputsToSave:["indices"],gradFunc:(e,t)=>{let n=t[0];return{indices:()=>en(n.shape,"float32")}}},ehe={kernelName:yh,gradFunc:e=>({x:()=>st(e)})},the={kernelName:bh,saveAllInputs:!0,gradFunc:(e,t,n)=>{let{axis:r}=n;return dn(e,r).map(a=>()=>a)}},MF={kernelName:Ic,inputsToSave:["x"],gradFunc:(e,t,n)=>{let r=t[0],{paddings:a}=n,i=a.map(s=>s[0]);return{x:()=>it(e,i,r.shape)}}},nhe={kernelName:Cc,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{let[n,r,a]=t,i=n,s=r,o=$t(i.shape,s.shape);return{a:()=>{let l=he(s,"float32"),c=j(e,j(l,Ps(i,we(l,Re(1))))),u=In(i.shape,o);return u.length>0&&(c=Te(c,u)),H(c,i.shape)},b:()=>{let l=Rr(i,0),c=Hn(l,ha(i),st(i)),u=j(e,j(a,c)),d=In(s.shape,o);return d.length>0&&(u=Te(u,d)),H(u,s.shape)}}}},rhe={kernelName:_c,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{let[n,r]=t,a=Rr(n,0);return{x:()=>Hn(a,e,j(e,r)),alpha:()=>{let i=Hn(a,st(e),j(e,n)),s=In(r.shape,e.shape);return s.length>0&&(i=Te(i,s)),H(i,r.shape)}}}};function ahe(e,t,n){let r=e.shape.slice();r[n]=1;let a=H(t,r),i=qm(e,n,!0,!1),s=qm(e,n,!0,!0),o=j(i,s);return j(a,o)}function ihe(e,t,n){let r=e.shape.length,a=r-n.length,i=N.getAxesPermutation(n,r),s=e;i!=null&&(s=Je(e,i));let o=s.shape.slice(),l=o.splice(r-n.length,n.length).reduce((d,p)=>d*p,1);o.push(l);let c=s.reshape(o),u=ahe(c,t,a);if(u=u.reshape(s.shape),i!=null){let d=N.getUndoAxesPermutation(i);u=Je(u,d)}return u}var she={kernelName:Tc,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{axis:a}=n,i=[];return a==null?i=r.shape.map((s,o)=>o):typeof a=="number"?i=[a]:i=a,{x:()=>ihe(r,e,i)}}},ohe={kernelName:Zu,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=$t(n.shape,r.shape);return{a:()=>{let i=Ie(e,he(r,"float32")),s=In(n.shape,a);return s.length>0?H(Te(i,s),n.shape):i},b:()=>{let i=j(e,he(n,"float32")),s=In(r.shape,a);s.length>0&&(i=H(Te(i,s),r.shape));let o=Tt(r);return Bt(Ie(i,he(o,"float32")))}}}},lhe={kernelName:Nc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Ie(e,Bt(Tt(n)))}}},uhe={kernelName:Rc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t,r=j(al(n,6),Qc(n));return{x:()=>j(e,he(r,"float32"))}}},che={kernelName:Ec,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(e,he(Qc(n),"float32"))}}},dhe={kernelName:vh,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>H(e,n.shape)}}},phe={kernelName:Ac,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[r]=t,a={dy:e,images:r};return{images:()=>V.runKernel(wh,a,n)}}},hhe={kernelName:$c,inputsToSave:["images"],gradFunc:(e,t,n)=>{let[r]=t,a={dy:e,images:r};return{images:()=>V.runKernel(xh,a,n)}}},fhe={kernelName:Fc,gradFunc:(e,t,n)=>{let{dims:r}=n,a=si(r,e.shape);return{x:()=>Da(e,a)}}},mhe={kernelName:Dc,gradFunc:e=>({x:()=>st(e)})},ghe={kernelName:Mc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Bt(Ie(e,j(Ps(n,1.5),2)))}}},yhe={kernelName:Ch,inputsToSave:["condition"],gradFunc:(e,t)=>{let[n]=t;return{condition:()=>he(st(n),"float32"),t:()=>j(e,he(n,e.dtype)),e:()=>j(e,he(Xg(n),e.dtype))}}},bhe={kernelName:Oc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let r=Rr(n,Re(0)),a=Re(SB),i=Re(IB),s=j(e,i),o=j(j(e,a),Tr(he(n,"float32")));return Hn(r,s,o)}}}},vhe={kernelName:Bc,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(e,j(n,we(Re(1),n)))}}},xhe={kernelName:Lc,gradFunc:e=>({x:()=>st(e)})},whe={kernelName:Pc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(Hg(he(n,"float32")),e)}}},khe={kernelName:zc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(Qx(he(n,"float32")),e)}}},She={kernelName:_h,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{begin:a,size:i}=n,s=r.shape,[o,l]=wB(r,a,i),c=[];for(let u=0;u<e.rank;u++)c.push([o[u],s[u]-o[u]-l[u]]);return{x:()=>Ti(e,c)}}},Ihe={kernelName:jc,outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r]=t,{dim:a}=n,i=!0,s=j(e,r);return{logits:()=>we(s,j(Te(s,[a],i),r))}}},Che={kernelName:Wc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(e,ei(n))}}},OF={kernelName:Th,gradFunc:(e,t,n)=>{let{blockShape:r,paddings:a}=n;return{x:()=>jg(e,r,a)}}},PF={kernelName:Nh,gradFunc:(e,t,n)=>{let{axis:r}=n;return{x:()=>Et(e,r)}}},_he={kernelName:Vc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Ie(e,j(ar(he(n,"float32")),2))}}},The={kernelName:Ag,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(e,j(he(n,"float32"),2))}}},Nhe={kernelName:Hc,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=Re(2);return{a:()=>j(e,j(a,we(n,r))),b:()=>j(e,j(a,we(r,n)))}}},Ehe={kernelName:nl,gradFunc:e=>({x:()=>st(e)})},$he={kernelName:Gc,inputsToSave:["a","b"],gradFunc:(e,t)=>{let[n,r]=t,a=$t(n.shape,r.shape);return{a:()=>{let i=e,s=In(n.shape,a);return s.length>0&&(i=Te(i,s)),H(i,n.shape)},b:()=>{let i=e,s=In(r.shape,a);return s.length>0&&(i=Te(i,s)),H(Bt(i),r.shape)}}}},Ahe={kernelName:Uc,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,a=r.shape.slice(),{axis:i}=n;si(i,r.shape).forEach(l=>{a[l]=1});let s=H(e,a),o=j(s,ia(r.shape,"float32"));return{x:()=>o}}},Rhe={kernelName:qc,inputsToSave:["x"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Ie(e,Tt(Hg(n)))}}},Fhe={kernelName:Kc,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>j(we(Re(1),Tt(n)),e)}}},Dhe={kernelName:tl,inputsToSave:["x"],gradFunc:(e,t,n)=>{let[r]=t,{reps:a}=n;return{x:()=>{let i=st(r);if(r.rank===1)for(let s=0;s<a[0];++s)i=re(i,it(e,[s*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let s=0;s<a[0];++s)for(let o=0;o<a[1];++o)i=re(i,it(e,[s*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let s=0;s<a[0];++s)for(let o=0;o<a[1];++o)for(let l=0;l<a[2];++l)i=re(i,it(e,[s*r.shape[0],o*r.shape[1],l*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let s=0;s<a[0];++s)for(let o=0;o<a[1];++o)for(let l=0;l<a[2];++l)for(let c=0;c<a[3];++c)i=re(i,it(e,[s*r.shape[0],o*r.shape[1],l*r.shape[2],c*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return i}}}},Mhe={kernelName:Ts,gradFunc:(e,t,n)=>{let r=n,{perm:a}=r,i=T_(a);return{x:()=>Je(e,i)}}},Ohe={kernelName:Dh,gradFunc:(e,t,n)=>{let r=n,{axis:a}=r;return{value:()=>Fn(e,a)}}},Phe={kernelName:Pg,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{let[n]=t;return{x:()=>zhe(e,n)}}};function zhe(e,t){let n=ns(t,st(t)),r=Wh(e,n),a=Us(t,Re(0,"int32")),i=r.rank-a.rank;for(let o=0;o<i;++o)a=Qn(a,o+1);a=ri(a,ia(r.shape,"bool"));let s=st(r);return Hn(a,r,s)}var Lhe={kernelName:Mh,gradFunc:e=>({x:()=>st(e)})},Bhe=[_B,Pde,zde,Lde,Bde,Wde,Vde,Ude,jde,Hde,Gde,qde,Yde,Jde,epe,tpe,npe,rpe,ape,ipe,spe,ope,upe,lpe,ppe,hpe,fpe,mpe,gpe,ype,ohe,bpe,vpe,xpe,wpe,kpe,Ipe,Spe,Cpe,_pe,Tpe,Npe,Epe,$pe,Ape,Rpe,Fpe,Dpe,Mpe,zpe,DF,DF,Lpe,Vpe,Hpe,Gpe,qpe,Kpe,Xpe,Ype,Zpe,Qpe,Jpe,ehe,the,MF,MF,nhe,rhe,she,lhe,uhe,che,dhe,phe,hhe,fhe,mhe,ghe,yhe,bhe,vhe,xhe,whe,khe,She,Ihe,Che,OF,OF,PF,PF,_he,Nhe,The,Ehe,$he,Ahe,Rhe,Fhe,Dhe,Mhe,Ohe,Phe,Lhe];for(let e of Bhe)gL(e);ae().prototype.abs=function(){return this.throwIfDisposed(),xn(this)};ae().prototype.acos=function(){return this.throwIfDisposed(),JC(this)};ae().prototype.acosh=function(){return this.throwIfDisposed(),e_(this)};ae().prototype.add=function(e){return this.throwIfDisposed(),re(this,e)};ae().prototype.all=function(e,t){return this.throwIfDisposed(),Xx(this,e,t)};ae().prototype.any=function(e,t){return this.throwIfDisposed(),jm(this,e,t)};ae().prototype.argMax=function(e){return this.throwIfDisposed(),du(this,e)};ae().prototype.argMin=function(e){return this.throwIfDisposed(),t_(this,e)};ae().prototype.asScalar=function(){return this.throwIfDisposed(),F(this.size===1,()=>"The array must have only 1 element."),H(this,[])};ae().prototype.asType=function(e){return this.throwIfDisposed(),he(this,e)};ae().prototype.as1D=function(){return this.throwIfDisposed(),H(this,[this.size])};ae().prototype.as2D=function(e,t){return this.throwIfDisposed(),H(this,[e,t])};ae().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),H(this,[e,t,n])};ae().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),H(this,[e,t,n,r])};ae().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),H(this,[e,t,n,r,a])};ae().prototype.asin=function(){return this.throwIfDisposed(),n_(this)};ae().prototype.asinh=function(){return this.throwIfDisposed(),r_(this)};ae().prototype.atan=function(){return this.throwIfDisposed(),a_(this)};ae().prototype.atan2=function(e){return this.throwIfDisposed(),i_(this,e)};ae().prototype.atanh=function(){return this.throwIfDisposed(),s_(this)};ae().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),Vs(this,e,t,n,r)};ae().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),jg(this,e,t)};ae().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),Xc(this,e,t,n,r,a)};ae().prototype.broadcastTo=function(e){return this.throwIfDisposed(),Hl(this,e)};ae().prototype.cast=function(e){return this.throwIfDisposed(),he(this,e)};ae().prototype.ceil=function(){return this.throwIfDisposed(),h_(this)};ae().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),hr(this,e,t)};ae().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof Ze&&(e=[e]),Et([this,...e],t)};ae().prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Yx(this,e,t,n,r,a,i)};ae().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),Zx(this,e,t,n,r,a)};ae().prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),_r(this,e,t,n,r,a,i)};ae().prototype.cos=function(){return this.throwIfDisposed(),Hg(this)};ae().prototype.cosh=function(){return this.throwIfDisposed(),Qx(this)};ae().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),qm(this,e,t,n)};ae().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),Jx(this,e,t,n)};ae().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),w_(this,e,t)};ae().prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Yc(this,e,t,n,r,a,i)};ae().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),k_(this,e,t,n,r,a)};ae().prototype.divNoNan=function(e){return this.throwIfDisposed(),S_(this,e)};ae().prototype.div=function(e){return this.throwIfDisposed(),Ie(this,e)};ae().prototype.dot=function(e){return this.throwIfDisposed(),I_(this,e)};ae().prototype.elu=function(){return this.throwIfDisposed(),zh(this)};ae().prototype.equal=function(e){return this.throwIfDisposed(),pa(this,e)};ae().prototype.erf=function(){return this.throwIfDisposed(),C_(this)};ae().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),N_(this,e,t)};ae().prototype.exp=function(){return this.throwIfDisposed(),Tr(this)};ae().prototype.expandDims=function(e){return this.throwIfDisposed(),Qn(this,e)};ae().prototype.expm1=function(){return this.throwIfDisposed(),E_(this)};ae().prototype.fft=function(){return this.throwIfDisposed(),ey(this)};ae().prototype.flatten=function(){return this.throwIfDisposed(),H(this,[this.size])};ae().prototype.floor=function(){return this.throwIfDisposed(),Bh(this)};ae().prototype.floorDiv=function(e){return this.throwIfDisposed(),Kx(this,e)};ae().prototype.gather=function(e,t,n){return this.throwIfDisposed(),Wh(this,e,t,n)};ae().prototype.greaterEqual=function(e){return this.throwIfDisposed(),Us(this,e)};ae().prototype.greater=function(e){return this.throwIfDisposed(),Rr(this,e)};ae().prototype.ifft=function(){return this.throwIfDisposed(),mp(this)};ae().prototype.irfft=function(){return this.throwIfDisposed(),f1(this)};ae().prototype.isFinite=function(){return this.throwIfDisposed(),$_(this)};ae().prototype.isInf=function(){return this.throwIfDisposed(),A_(this)};ae().prototype.isNaN=function(){return this.throwIfDisposed(),R_(this)};ae().prototype.leakyRelu=function(e){return this.throwIfDisposed(),qg(this,e)};ae().prototype.lessEqual=function(e){return this.throwIfDisposed(),al(this,e)};ae().prototype.less=function(e){return this.throwIfDisposed(),dp(this,e)};ae().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),F_(this,e,t,n,r)};ae().prototype.logSigmoid=function(){return this.throwIfDisposed(),D_(this)};ae().prototype.logSoftmax=function(e){return this.throwIfDisposed(),n1(this,e)};ae().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),r1(this,e,t)};ae().prototype.log=function(){return this.throwIfDisposed(),ha(this)};ae().prototype.log1p=function(){return this.throwIfDisposed(),Kg(this)};ae().prototype.logicalAnd=function(e){return this.throwIfDisposed(),ri(this,e)};ae().prototype.logicalNot=function(){return this.throwIfDisposed(),Xg(this)};ae().prototype.logicalOr=function(e){return this.throwIfDisposed(),a1(this,e)};ae().prototype.logicalXor=function(e){return this.throwIfDisposed(),M_(this,e)};ae().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Ye(this,e,t,n)};ae().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Ln(this,e,t,n,r)};ae().prototype.max=function(e,t){return this.throwIfDisposed(),$a(this,e,t)};ae().prototype.maximum=function(e){return this.throwIfDisposed(),ns(this,e)};ae().prototype.mean=function(e,t){return this.throwIfDisposed(),Jt(this,e,t)};ae().prototype.min=function(e,t){return this.throwIfDisposed(),cp(this,e,t)};ae().prototype.minimum=function(e){return this.throwIfDisposed(),Lo(this,e)};ae().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),P_(this,e,t)};ae().prototype.mod=function(e){return this.throwIfDisposed(),z_(this,e)};ae().prototype.mul=function(e){return this.throwIfDisposed(),j(this,e)};ae().prototype.neg=function(){return this.throwIfDisposed(),Bt(this)};ae().prototype.norm=function(e,t,n){return this.throwIfDisposed(),Lh(this,e,t,n)};ae().prototype.notEqual=function(e){return this.throwIfDisposed(),mu(this,e)};ae().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),pp(this,e,t,n)};ae().prototype.onesLike=function(){return this.throwIfDisposed(),fa(this)};ae().prototype.pad=function(e,t){return this.throwIfDisposed(),Ti(this,e,t)};ae().prototype.pool=function(e,t,n,r,a,i){return this.throwIfDisposed(),L_(this,e,t,n,r,a,i)};ae().prototype.pow=function(e){return this.throwIfDisposed(),Ps(this,e)};ae().prototype.prelu=function(e){return this.throwIfDisposed(),Qg(this,e)};ae().prototype.prod=function(e,t){return this.throwIfDisposed(),B_(this,e,t)};ae().prototype.reciprocal=function(){return this.throwIfDisposed(),H_(this)};ae().prototype.relu=function(){return this.throwIfDisposed(),Ct(this)};ae().prototype.relu6=function(){return this.throwIfDisposed(),o1(this)};ae().prototype.reshapeAs=function(e){return this.throwIfDisposed(),H(this,e.shape)};ae().prototype.reshape=function(e){return this.throwIfDisposed(),H(this,e)};ae().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),X4(this,e,t,n)};ae().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),Y4(this,e,t,n)};ae().prototype.reverse=function(e){return this.throwIfDisposed(),Da(this,e)};ae().prototype.rfft=function(){return this.throwIfDisposed(),ty(this)};ae().prototype.round=function(){return this.throwIfDisposed(),l1(this)};ae().prototype.rsqrt=function(){return this.throwIfDisposed(),u1(this)};ae().prototype.selu=function(){return this.throwIfDisposed(),c1(this)};ae().prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Vh(this,e,t,n,r,a,i)};ae().prototype.sigmoid=function(){return this.throwIfDisposed(),ei(this)};ae().prototype.sign=function(){return this.throwIfDisposed(),G_(this)};ae().prototype.sin=function(){return this.throwIfDisposed(),d1(this)};ae().prototype.sinh=function(){return this.throwIfDisposed(),p1(this)};ae().prototype.slice=function(e,t){return this.throwIfDisposed(),it(this,e,t)};ae().prototype.softmax=function(e){return this.throwIfDisposed(),sl(this,e)};ae().prototype.softplus=function(){return this.throwIfDisposed(),Zc(this)};ae().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Zg(this,e,t)};ae().prototype.split=function(e,t){return this.throwIfDisposed(),Wr(this,e,t)};ae().prototype.sqrt=function(){return this.throwIfDisposed(),ar(this)};ae().prototype.square=function(){return this.throwIfDisposed(),Tt(this)};ae().prototype.squaredDifference=function(e){return this.throwIfDisposed(),m1(this,e)};ae().prototype.squeeze=function(e){return this.throwIfDisposed(),ol(this,e)};ae().prototype.stack=function(e,t){this.throwIfDisposed();let n=e instanceof Ze?[this,e]:[this,...e];return Fn(n,t)};ae().prototype.step=function(e){return this.throwIfDisposed(),Qc(this,e)};ae().prototype.stridedSlice=function(e,t,n,r,a,i,s,o){return this.throwIfDisposed(),q_(this,e,t,n,r,a,i,s,o)};ae().prototype.sub=function(e){return this.throwIfDisposed(),we(this,e)};ae().prototype.sum=function(e,t){return this.throwIfDisposed(),Te(this,e,t)};ae().prototype.tan=function(){return this.throwIfDisposed(),K_(this)};ae().prototype.tanh=function(){return this.throwIfDisposed(),hu(this)};ae().prototype.tile=function(e){return this.throwIfDisposed(),aa(this,e)};ae().prototype.toBool=function(){return this.throwIfDisposed(),he(this,"bool")};ae().prototype.toFloat=function(){return this.throwIfDisposed(),he(this,"float32")};ae().prototype.toInt=function(){return this.throwIfDisposed(),he(this,"int32")};ae().prototype.topk=function(e,t){return this.throwIfDisposed(),Y_(this,e,t)};ae().prototype.transpose=function(e){return this.throwIfDisposed(),Je(this,e)};ae().prototype.unique=function(e){return this.throwIfDisposed(),Z_(this,e)};ae().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),x1(this,e,t)};ae().prototype.unstack=function(e){return this.throwIfDisposed(),dn(this,e)};ae().prototype.where=function(e,t){return this.throwIfDisposed(),Hn(e,this,t)};ae().prototype.zerosLike=function(){return this.throwIfDisposed(),st(this)};var ms=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ms.prototype)}},gi=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,gi.prototype)}},K=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,K.prototype)}},Qe=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Qe.prototype)}},NB=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,NB.prototype)}},EB=class{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){let n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){let n=this.cache.keys().next().value;this.cache.delete(n)}this.maxEntries=e}};function yu(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}else{let n=new Array(t);return n.fill(e),n}}function Li(e,t){if(!e)throw new NB(t)}function zF(e,t){let n=0;for(let r of e)r===t&&n++;return n}function Lr(e){return e.length===1?e[0]:e}function Vt(e){return Array.isArray(e)?e:[e]}function gs(e){let t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function Al(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}var Va={};function gT(e){if(e==null)return null;let t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function dI(e){if(!(e==null||typeof e!="object"))if(Array.isArray(e))e.forEach(t=>dI(t));else{let t=Object.keys(e);for(let n of t){let r=e[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?e[n]=r.value:dI(r))}}}function ry(e,t={},n={},r="object",a=!1){if(typeof e=="string"){let i=e,s;if(i in n)s=n[i];else if(i in Va)s=Va[i];else if(s=t[i],s==null)throw new K(`Unknown ${r}: ${e}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return s}else{let i=e;if(i.className==null||i.config==null)throw new K(`${r}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);let s=i.className,o,l;if(s in n?[o,l]=n[s]:s in Va?[o,l]=Va.className:s in t&&([o,l]=t[s]),o==null)throw new K(`Unknown ${r}: ${s}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){let c={};for(let h of Object.keys(Va))c[h]=Va[h];for(let h of Object.keys(n))c[h]=n[h];let u=i.config;u.customObjects=c;let d=Object.assign({},Va);for(let h of Object.keys(n))Va[h]=n[h];dI(i.config);let p=l(o,i.config,n,a);return Va=Object.assign({},d),p}else{let c=Object.assign({},Va);for(let d of Object.keys(n))Va[d]=n[d];let u=new o(i.config);return Va=Object.assign({},c),u}}}function Whe(e,t){return e<t?-1:e>t?1:0}function f0(e,t){return-1*Whe(e,t)}function _o(e){if(e==null)return e;let t=[];for(let n of e)t.indexOf(n)===-1&&t.push(n);return t}function Vhe(e){if(e==null)throw new K(`Invalid value in obj: ${JSON.stringify(e)}`);for(let t in e)if(e.hasOwnProperty(t))return!1;return!0}function Jc(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new K(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function yT(e,t,n=0,r=1/0){return Li(n>=0),Li(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(a=>typeof a===t)}function jn(e,t){Array.isArray(e)?(k.assert(e.length>0,()=>`${t} is unexpectedly an empty array.`),e.forEach((n,r)=>jn(n,`element ${r+1} of ${t}`))):k.assert(Number.isInteger(e)&&e>0,()=>`Expected ${t} to be a positive integer, but got ${$B(e)}.`)}function $B(e){return e===null?"null":Array.isArray(e)?"["+e.map(t=>$B(t)).join(",")+"]":typeof e=="string"?`"${e}"`:`${e}`}function Uhe(e,t,n){let r=n!=null?n():k.now(),a;return(...i)=>{let s=n!=null?n():k.now();return s-r<t||(r=s,a=e(...i)),a}}function AB(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}var jhe=0;function RB(){return jhe++}var m0={};function T1(e=""){return e in m0||(m0[e]=0),m0[e]+=1,e+m0[e].toString()}var Hhe=["channelsFirst","channelsLast"],Ghe=["nearest","bilinear"],qhe=["valid","same","causal"],Khe=["max","avg"],Xhe=["sum","mul","concat","ave"],md=new Map;function mn(e){Jc(Hhe,"DataFormat",e)}function Yhe(e){Jc(Ghe,"InterpolationFormat",e)}function za(e){Jc(qhe,"PaddingMode",e)}function FB(e){Jc(Khe,"PoolMode",e)}var im=[],LF="/";function Gl(e,t){im.push(e);try{let n=t();return im.pop(),n}catch(n){throw im.pop(),n}}function Zhe(){return im.length===0?"":im.join(LF)+LF}function DB(e){if(!OB(e))throw new Error("Not a valid tensor name: '"+e+"'");return Zhe()+e}function MB(e){if(!OB(e))throw new Error("Not a valid tensor name: '"+e+"'");md.has(e)||md.set(e,0);let t=md.get(e);if(md.set(e,md.get(e)+1),t>0){let n=`${e}_${t}`;return md.set(n,1),n}else return e}var Qhe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function OB(e){return!!e.match(Qhe)}function Jhe(e){return e===parseInt(e.toString(),10)}function To(e,t,n){t==null&&(t=0),n==null&&(n=e.length);let r=1;for(let a=t;a<n;++a)r*=e[a];return r}function bp(e){if(e.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){let r=e[n];r<t&&(t=r)}return t}function Wo(e){if(e.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){let r=e[n];r>t&&(t=r)}return t}function Ii(e,t){if(t<e)throw new K(`end (${t}) < begin (${e}) is forbidden.`);let n=[];for(let r=e;r<t;++r)n.push(r);return n}var ck;function Rn(){return ck==null&&(ck=BL().epsilon()),ck}function Ci(){return"channelsLast"}function zs(e,t){return he(e,t)}function ay(e,t=-1){let n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),H(e,n)}function efe(e,t){return G(()=>{if(e.shape.length!==2)throw new K(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);let n=ay(e,1);return pI(n,[1,t,1])})}function tfe(e){let t=[To(e.shape)];return H(e,t)}function nfe(e){if(e.rank<=1)throw new K(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);let t=[e.shape[0],To(e.shape,1)];return H(e,t)}function ql(e,t,n){return G(()=>{switch(e.rank){case 1:return Jg(e,t,n);case 2:return h1(e,[t,0],[n,e.shape[1]]);case 3:return Uh(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return fp(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return it(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return it(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new K(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}})}function dk(e,t,n){return G(()=>{switch(e.rank){case 1:return Jg(e,t,n);case 2:return h1(e,[0,t],[e.shape[0],n]);case 3:return Uh(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return fp(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new K(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function g0(e,t,n,r){return G(()=>{switch(e.rank){case 1:return Jg(e,t,n);case 2:switch(r){case 1:return ql(e,t,n);case 2:return dk(e,t,n);default:throw new K(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return ql(e,t,n);case 2:return Uh(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return dk(e,t,n);default:throw new K(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return ql(e,t,n);case 2:return fp(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return fp(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return dk(e,t,n);default:throw new K(`The axis is not within the rank of the tensor ${r}`)}default:throw new K(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function bT(e,t=-1){let n;return t<0&&(n=e[0].rank,n!==0?t=n:t=0),t===e[0].rank&&(t=-1),Et(e,t)}function BF(e,t){switch(e.rank){case 1:return f_([e,t]);case 2:return m_([e,t],0);case 3:return g_([e,t],0);case 4:return y_([e,t],0);default:throw new K(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function pI(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new K(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return aa(e,t)}function N1(e,t=0,n=1,r,a){return s1(e,t,n,r,a)}function Yi(e,t,n,r){if(e.rank<2||t.rank<2)throw new Qe(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){let a=e.shape.slice(-1)[0],i=t.shape.slice(-2)[0];if(a!==i)throw new Qe(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(e.rank===2&&t.rank===2)return gp.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?hI(e.rank,r,Ci()):null,activation:n});{let a=e.shape.slice(),i=a.pop();e=H(e,[-1,i]);let s=t.shape.slice(),o=s.pop(),l=s.pop(),c=[...s,o],u=Array.from({length:t.rank},(f,m)=>m===0?t.rank-2:m<=t.rank-2?m-1:m);t=H(Je(t,u),[l,-1]);let d=[...a,...c],p=!1,h=!1;return H(gp.matMul({a:e,b:t,transposeA:p,transposeB:h,bias:r?hI(e.rank,r,Ci()):null,activation:n}),d)}}function PB(e,t,n){return G(()=>(Array.isArray(t)?t=It(t,"int32"):t=he(t,"int32"),Wh(e,t,n)))}function iy(e){return j(e,e)}function hI(e,t,n){let r=t.shape;if(t.rank!==1&&t.rank!==e)throw new K(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(e===5){if(n==="channelsFirst")return r.length===1?H(t,[1,r[0],1,1,1]):H(t,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?H(t,[1,1,1,1,r[0]]):H(t,[1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?H(t,[1,r[0],1,1]):H(t,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?H(t,[1,1,1,r[0]]):H(t,[1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?H(t,[1,r[0],1]):H(t,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?H(t,[1,1,r[0]]):H(t,[1].concat(r))}else if(e<3)return t;throw new K(`Unsupported input rank by biasAdd: ${t.rank}`)}function Ni(e,t,n){return G(()=>(n==null&&(n=Ci()),mn(n),re(e,hI(e.rank,t,n))))}function rfe(e,t=1){if(t!==1)throw new Qe(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return zh(e)}function afe(e){return G(()=>Ie(e,re(xn(e),1)))}function zB(e,t,n,r){return G(()=>eT(e,t,n,r))}function ife(e){return G(()=>{let t=re(.5,j(.2,e));return hr(t,0,1)})}function sy(e,t,n=!1){return n?e():t()}var sfe=["fanIn","fanOut","fanAvg"],ofe=["normal","uniform","truncatedNormal"];function lfe(e){Jc(sfe,"FanMode",e)}function ufe(e){Jc(ofe,"Distribution",e)}var oi=class extends le.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}},vT=class extends oi{apply(e,t){return en(e,t)}};vT.className="Zeros";le.registerClass(vT);var E1=class extends oi{apply(e,t){return ia(e,t)}};E1.className="Ones";le.registerClass(E1);var xT=class extends oi{constructor(e){if(super(),typeof e!="object")throw new K(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new K(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return G(()=>j(Re(this.value),ia(e,t)))}getConfig(){return{value:this.value}}};xT.className="Constant";le.registerClass(xT);var wT=class extends oi{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return il(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}};wT.className="RandomUniform";le.registerClass(wT);var kT=class extends oi{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Qe(`randomNormal does not support dType ${t}.`);return N1(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};kT.className="RandomNormal";le.registerClass(kT);var ST=class extends oi{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Qe(`truncatedNormal does not support dType ${t}.`);return v1(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};ST.className="TruncatedNormal";le.registerClass(ST);var IT=class extends oi{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return G(()=>{if(e.length!==2||e[0]!==e[1])throw new K("Identity matrix initializer can only be used for 2D square matrices.");return j(this.gain,e1(e[0]))})}getConfig(){return{gain:this.gain}}};IT.className="Identity";le.registerClass(IT);function cfe(e,t="channelsLast"){let n,r;if(mn(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1){if(t==="channelsFirst"){let a=To(e,2);n=e[1]*a,r=e[0]*a}else if(t==="channelsLast"){let a=To(e,0,e.length-2);n=e[e.length-2]*a,r=e[e.length-1]*a}}else{let a=To(e);n=Math.sqrt(a),r=Math.sqrt(a)}return[n,r]}var jr=class extends oi{constructor(e){if(super(),e.scale<0)throw new K(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,lfe(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,ufe(this.distribution),this.seed=e.seed}apply(e,t){let n=cfe(e),r=n[0],a=n[1],i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,r):this.mode==="fanOut"?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),this.distribution==="normal"){let s=Math.sqrt(i);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Qe(`${this.getClassName()} does not support dType ${t}.`);return v1(e,0,s,t,this.seed)}else{let s=Math.sqrt(3*i);return il(e,-s,s,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}};jr.className="VarianceScaling";le.registerClass(jr);var $1=class extends jr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return jr.className}};$1.className="GlorotUniform";le.registerClass($1);var A1=class extends jr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return jr.className}};A1.className="GlorotNormal";le.registerClass(A1);var R1=class extends jr{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return jr.className}};R1.className="HeNormal";le.registerClass(R1);var F1=class extends jr{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return jr.className}};F1.className="HeUniform";le.registerClass(F1);var D1=class extends jr{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return jr.className}};D1.className="LeCunNormal";le.registerClass(D1);var M1=class extends jr{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return jr.className}};M1.className="LeCunUniform";le.registerClass(M1);var CT=class extends oi{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return G(()=>{if(e.length<2)throw new Qe("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;let n=k.sizeFromShape(e.slice(0,-1)),r=e[e.length-1],a=n*r;a>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${a}) elements: Slowness may result.`);let i=[Math.max(r,n),Math.min(r,n)],s=N1(i,0,1,t,this.seed),o=aT.qr(s,!1),l=o[0],c=o[1].flatten().stridedSlice([0],[Math.min(r,n)*Math.min(r,n)],[Math.min(r,n)+1]);return l=j(l,c.sign()),n<r&&(l=l.transpose()),j(Re(this.gain),l.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}};CT.className="Orthogonal";le.registerClass(CT);var WF={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function VF(e,t={}){return ry(e,le.SerializationMap.getMap().classNameMap,t,"initializer")}function tn(e){return gT(e)}function Kt(e){if(typeof e=="string"){let t=e in WF?WF[e]:e;if(t==="GlorotNormal")return new A1;if(t==="GlorotUniform")return new $1;if(t==="HeNormal")return new R1;if(t==="HeUniform")return new F1;if(t==="LeCunNormal")return new D1;if(t==="LeCunUniform")return new M1;{let n={};return n.className=t,n.config={},VF(n)}}else return e instanceof oi?e:VF(e)}function fI(e){return Array.isArray(e)&&Array.isArray(e[0])}function av(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function We(e){let t;if(Array.isArray(e)){if(e.length!==1)throw new K(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function gt(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return e=e,e[0];throw new K(`Expected exactly 1 Shape; got ${e.length}`)}else return e}function iv(e){let t=0;for(let n of e)n.shape.length===0?t+=1:t+=n.shape.reduce((r,a)=>r*a);return t}var UF="Variable",LB=class{constructor(e,t="float32",n=UF,r=!0,a=null){this.dtype=t??"float32",this.shape=e.shape,this.id=RB(),n=n??UF,this.originalName=DB(n),this.name=MB(this.originalName),this.trainable_=r,this.constraint=a,this.val=Q_(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),dfe(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}};function dfe(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function mI(e){return e.map(t=>t.read())}function _T(e){e.forEach(t=>{t[0].write(t[1])})}var kn=class{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}},yi=class{constructor(e,t,n,r,a,i,s){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=a,this.outputTensorIndex=s,this.id=RB(),i!=null&&(this.originalName=DB(i),this.name=MB(this.originalName)),this.rank=t.length}},pfe=0,O1=class{constructor(e,t){this.callArgs=t,this.id=pfe++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(let n of e.inboundLayers)n!=null&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){let e=[];for(let t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},hfe=0,tt=class extends le.Serializable{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=hfe++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){let n=this.getClassName();t=gs(n)+"_"+T1(n)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let n;if(e.batchInputShape!=null)n=e.batchInputShape;else if(e.inputShape!=null){let a=null;e.batchSize!=null&&(a=e.batchSize),n=[a].concat(e.inputShape)}this.batchInputShape=n;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new gi(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new K(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Lr(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Lr(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new ms(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new ms(`Layer ${this.name} is not connected, no input to return.`);return Lr(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new ms(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new ms(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Lr(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){if(e=Vt(e),this.inputSpec==null||this.inputSpec.length===0)return;let t=Vt(this.inputSpec);if(e.length!==t.length)throw new K(`Layer ${this.name} expects ${t.length} inputs, but it received ${e.length} input tensors. Input received: ${e}`);for(let n=0;n<e.length;n++){let r=e[n],a=t[n];if(a==null)continue;let i=r.rank;if(a.ndim!=null&&i!==a.ndim)throw new K(`Input ${n} is incompatible with layer ${this.name}: expected ndim=${a.ndim}, found ndim=${i}`);if(a.maxNDim!=null&&i>a.maxNDim)throw new K(`Input ${n} is incompatible with layer ${this.name}: expected max_ndim=${a.maxNDim}, found ndim=${i}`);if(a.minNDim!=null&&i<a.minNDim)throw new K(`Input ${n} is incompatible with layer ${this.name}: expected min_ndim=${a.minNDim}, found ndim=${i}.`);if(a.dtype!=null&&r.dtype!==a.dtype)throw new K(`Input ${n} is incompatible with layer ${this.name} : expected dtype=${a.dtype}, found dtype=${r.dtype}.`);if(a.axes){let s=r.shape;for(let o in a.axes){let l=Number(o),c=a.axes[o],u=l>=0?s[l]:s[s.length+l];if(c!=null&&[c,null].indexOf(u)===-1)throw new K(`Input ${n} is incompatible with layer ${this.name}: expected axis ${l} of input shape to have value ${c} but got shape ${s}.`)}}if(a.shape!=null)for(let s=0;s<a.shape.length;++s){let o=a.shape[s],l=r.shape[s];if(o!=null&&l!=null&&o!==l)throw new K(`Input ${n} is incompatible with layer ${this.name}: expected shape=${a.shape}, found shape=${r.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();let n=Vt(e),r=!0;for(let i of n)if(!(i instanceof yi)){r=!1;break}let a=!0;for(let i of n)if(i instanceof yi){a=!1;break}if(r===a)throw new K("Arguments to apply() must be all SymbolicTensors or all Tensors");return Gl(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);let i=[];for(let s of Vt(e))i.push(s.shape);this.build(Lr(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&a&&(this._refCount=1)}if(this.assertInputCompatibility(e),a){let i=this.call(e,t),s=Vt(i),o=[];for(let l of s)n.indexOf(l)!==-1&&(l=l.clone()),o.push(l);if(i=Lr(o),this.activityRegularizer!=null)throw new Qe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{let i=ffe(e),s=this.computeOutputShape(i),o,l=mfe(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),s!=null&&s.length>0&&Array.isArray(s[0])?o=s.map((c,u)=>new yi(l,c,this,Vt(e),t,this.name,u)):o=new yi(l,s,this,Vt(e),t,this.name),this.addInboundNode(e,o,null,null,i,s,t),this._refCount++,this.activityRegularizer!=null)throw new Qe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((n,r)=>{n!=null&&e[r]!=null&&e[r]!==n&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new ms(`The layer ${this.name} has never been called and thus has no defined output shape.`);let e=[];for(let t of this.inboundNodes){let n=JSON.stringify(t.outputShapes);e.indexOf(n)===-1&&e.push(n)}if(e.length===1){let t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new ms(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new gi(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return iv(this.weights)}build(e){this.built=!0}getWeights(e=!1){return mI(e?this.trainableWeights:this.weights)}setWeights(e){G(()=>{let t=this.weights;if(t.length!==e.length)throw new K(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;let n=[],r=mI(t);for(let a=0;a<r.length;++a){let i=r[a],s=t[a],o=e[a];if(!k.arraysEqual(i.shape,o.shape))throw new K(`Layer weight shape ${i.shape} not compatible with provided weight shape ${o.shape}`);n.push([s,o])}_T(n)})}addWeight(e,t,n,r,a,i,s,o){if(this._addedWeightNames.indexOf(e)!==-1)throw new K(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),n==null&&(n="float32"),this.fastWeightInitDuringBuild&&(r=o!=null?o():Kt("zeros"));let l=r.apply(t,n),c=new LB(l,n,e,i,s);return l.dispose(),a!=null&&this.addLoss(()=>a.apply(c.read())),i==null&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Vt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(n=>{if(n!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}addInboundNode(e,t,n,r,a,i,s=null){let o=Vt(e);t=Vt(t),n=Vt(n),r=Vt(r),a=av(a),i=av(i);let l=[],c=[],u=[];for(let d of o)l.push(d.sourceLayer),c.push(d.nodeIndex),u.push(d.tensorIndex);new O1({outboundLayer:this,inboundLayers:l,nodeIndices:c,tensorIndices:u,inputTensors:o,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},s);for(let d=0;d<t.length;d++)t[d].sourceLayer=this,t[d].nodeIndex=this.inboundNodes.length-1,t[d].tensorIndex=d}getConfig(){let e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}};function ffe(e){e=Vt(e);let t=[];for(let n of e)t.push(n.shape);return Lr(t)}function mfe(e){return"float32"}function BB(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];{let r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{let a=[];for(let i=0;i<r.inboundLayers.length;i++){let s=r.inputTensors[i],o=r.inboundLayers[i],l=r.nodeIndices[i],c=BB(s,o,l);for(let u of c)a.indexOf(u)===-1&&a.push(u)}return a}}}var Hh=class extends tt{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:T1("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new K("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new K("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new K("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];let r=new yi(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new O1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new K(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}};Hh.className="InputLayer";le.registerClass(Hh);function WB(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new K("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));let n=e.dtype;return n==null&&(n="float32"),new Hh({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}function gfe(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return he(t,e.dtype)}catch{throw new K(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}var Wl=class{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Wl)for(let t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(let t of e)this.add(t.key,t.value)}}add(e,t,n){if(this.id2Value[e.id]==null)this.id2Value[e.id]=gfe(e,t),this.name2Id[e.name]=e.id,n!=null&&(this.id2Mask[e.id]=n);else throw new K(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof yi){if(this.id2Value[e.id]==null)throw new K(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{let t=this.name2Id[e];if(t==null)throw new K(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof yi){if(this.id2Value[e.id]==null)throw new K(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{let t=this.name2Id[e];if(t==null)throw new K(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&je(this.id2Mask)}},sv=new EB,ov=new EB;function yfe(e){sv!=null&&sv.setMaxEntries(e),ov!=null&&ov.setMaxEntries(e)}function Rf(e,t,n,r){let a=n==null?!1:n.training,i=Array.isArray(e),s=i?e:[e],o=s.map(f=>f.name),l=[],c=t.names();for(let f of o)c.indexOf(f)!==-1?l.push(t.getValue(f)):l.push(null);r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);let u=o.join(",")+"|"+t.names().sort().join(","),d=sv.get(u),p;if(d==null){let f=bfe(s,t);d=f.sorted,p=f.recipientCounts,sv.put(u,d),ov.put(u,p)}p={},a||Object.assign(p,ov.get(u));let h=new Wl(t);for(let f=0;f<d.length;++f){if(r!=null){let E=nv().numTensors;E>r.maxNumTensors&&(r.maxNumTensors=E),E<r.minNumTensors&&(r.minNumTensors=E)}let m=d[f],g=m.sourceLayer;if(g instanceof Hh)continue;let y=[],b=[],v=[],x=!1;for(let E of m.inputs){let R=h.getValue(E),$=h.getMask(E);y.push(R),b.push($),$!=null&&(x=!0),a||(p[E.name]--,p[E.name]===0&&!t.hasKey(E)&&o.indexOf(E.name)===-1&&!R.isDisposed&&E.sourceLayer.stateful!==!0&&v.push(R))}x&&(n=n||{},n.mask=b[0]);let w=Vt(g.apply(y,n)),S=null;g.supportsMasking&&(S=g.computeMask(y,b));let C=xfe(m),T=Array.isArray(C)?C:[C];for(let E=0;E<T.length;++E){h.hasKey(T[E])||h.add(T[E],w[E],Array.isArray(S)?S[0]:S);let R=o.indexOf(T[E].name);R!==-1&&(l[R]=w[E])}a||je(v)}return h.disposeMasks(),i?l:l[0]}function bfe(e,t){k.assert(e!=null&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(e.length===1){let a=jF(e[0],t);n=a.sorted,r=a.recipientMap}else{let a=new Set;for(let i of e){let{sorted:s,recipientMap:o}=jF(i,t);for(let l of s)a.has(l.name)||(n.push(l),a.add(l.name));for(let l in o)r[l]==null&&(r[l]=new Set),o[l].forEach(c=>r[l].add(c))}}return{sorted:n,recipientCounts:vfe(r)}}function vfe(e){let t={};for(let n in e)t[n]=e[n].size;return t}function jF(e,t){let n=new Set,r=[],a={};for(let o of t.names())n.add(o);let i=[],s=[];for(i.push(e);i.length>0;){let o=i[i.length-1];if(n.has(o.name)){i.pop();continue}let l=s[s.length-1]===i.length-1;if(o.inputs.length===0||l)i.pop(),r.push(o),n.add(o.name),l&&s.pop();else{s.push(i.length-1);for(let c of o.inputs)a[c.name]==null&&(a[c.name]=new Set),a[c.name].add(o.name),!n.has(c.name)&&i.push(c)}}return{sorted:r,recipientMap:a}}function xfe(e){let t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{let n=null;for(let r=0;r<e.sourceLayer.inboundNodes.length;++r)for(let a of e.sourceLayer.inboundNodes[r].outputTensors)if(a.id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}var wfe=Q();wfe.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,yfe);var VB={};He(VB,{maxNorm:()=>kfe,minMaxNorm:()=>Cfe,nonNeg:()=>Ife,unitNorm:()=>Sfe});function TT(e,t){return G(()=>ar(Te(j(e,e),t,!0)))}var oy=class extends le.Serializable{getConfig(){return{}}},NT=class extends oy{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return G(()=>{let t=TT(e,this.axis),n=hr(t,0,this.maxValue);return j(e,Ie(n,re(Rn(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}};NT.className="MaxNorm";le.registerClass(NT);var ET=class extends oy{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return G(()=>Ie(e,re(Rn(),TT(e,this.axis))))}getConfig(){return{axis:this.axis}}};ET.className="UnitNorm";le.registerClass(ET);var $T=class extends oy{apply(e){return Ct(e)}};$T.className="NonNeg";le.registerClass($T);var AT=class extends oy{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return G(()=>{let t=TT(e,this.axis),n=re(j(this.rate,hr(t,this.minValue,this.maxValue)),j(1-this.rate,t));return j(e,Ie(n,re(Rn(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}};AT.className="MinMaxNorm";le.registerClass(AT);var HF={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Mn(e){return gT(e)}function GF(e,t={}){return ry(e,le.SerializationMap.getMap().classNameMap,t,"constraint")}function On(e){if(e==null)return null;if(typeof e=="string"){let t={className:e in HF?HF[e]:e,config:{}};return GF(t)}else return e instanceof oy?e:GF(e)}function kfe(e){return new NT(e)}function Sfe(e){return new ET(e)}function Ife(){return new $T}function Cfe(e){return new AT(e)}var UB={};He(UB,{constant:()=>Nfe,glorotNormal:()=>Mfe,glorotUniform:()=>Dfe,heNormal:()=>Ofe,heUniform:()=>Pfe,identity:()=>Rfe,leCunNormal:()=>zfe,leCunUniform:()=>Lfe,ones:()=>Tfe,orthogonal:()=>Bfe,randomNormal:()=>$fe,randomUniform:()=>Efe,truncatedNormal:()=>Afe,varianceScaling:()=>Ffe,zeros:()=>_fe});function _fe(){return new vT}function Tfe(){return new E1}function Nfe(e){return new xT(e)}function Efe(e){return new wT(e)}function $fe(e){return new kT(e)}function Afe(e){return new ST(e)}function Rfe(e){return new IT(e)}function Ffe(e){return new jr(e)}function Dfe(e){return new $1(e)}function Mfe(e){return new A1(e)}function Ofe(e){return new R1(e)}function Pfe(e){return new F1(e)}function zfe(e){return new D1(e)}function Lfe(e){return new M1(e)}function Bfe(e){return new CT(e)}var jB={};He(jB,{Layer:()=>tt,RNN:()=>as,RNNCell:()=>py,activation:()=>fge,add:()=>Sge,alphaDropout:()=>sye,average:()=>Ige,averagePooling1d:()=>VN,averagePooling2d:()=>UN,averagePooling3d:()=>jN,avgPool1d:()=>Fge,avgPool2d:()=>Mge,avgPool3d:()=>Pge,avgPooling1d:()=>Dge,avgPooling2d:()=>Oge,avgPooling3d:()=>zge,batchNormalization:()=>$ge,bidirectional:()=>Qge,categoryEncoding:()=>dye,centerCrop:()=>uye,concatenate:()=>Cge,conv1d:()=>ige,conv2d:()=>sge,conv2dTranspose:()=>oge,conv3d:()=>lge,conv3dTranspose:()=>uge,convLstm2d:()=>Kge,convLstm2dCell:()=>Xge,cropping2D:()=>dge,dense:()=>mge,depthwiseConv2d:()=>hge,dot:()=>Ege,dropout:()=>gge,elu:()=>Jme,embedding:()=>kge,flatten:()=>bge,gaussianDropout:()=>iye,gaussianNoise:()=>aye,globalAveragePooling1d:()=>Lge,globalAveragePooling2d:()=>Bge,globalMaxPool1d:()=>eye,globalMaxPool2d:()=>tye,globalMaxPooling1d:()=>PW,globalMaxPooling2d:()=>zW,gru:()=>Vge,gruCell:()=>Uge,input:()=>lW,inputLayer:()=>Qme,layerNormalization:()=>Age,leakyReLU:()=>tge,lstm:()=>jge,lstmCell:()=>Hge,masking:()=>oye,maxPool1d:()=>nye,maxPool2d:()=>rye,maxPooling1d:()=>LW,maxPooling2d:()=>BW,maxPooling3d:()=>Wge,maximum:()=>_ge,minimum:()=>Tge,multiply:()=>Nge,permute:()=>wge,prelu:()=>nge,randomWidth:()=>pye,reLU:()=>ege,repeatVector:()=>vge,rescaling:()=>lye,reshape:()=>xge,resizing:()=>cye,rnn:()=>Yge,separableConv2d:()=>cge,simpleRNN:()=>Gge,simpleRNNCell:()=>qge,softmax:()=>rge,spatialDropout1d:()=>yge,stackedRNNCells:()=>Zge,thresholdedReLU:()=>age,timeDistributed:()=>Jge,upSampling2d:()=>pge,zeroPadding2d:()=>Rge});async function Js(e){if(e==null)return;let t=[],n=[],r=[];for(let a in e){let i=e[a];if(typeof i!="number"){let s=i;t.push(s.data()),n.push(a),r.push(s)}}if(t.length>0){let a=await Promise.all(t);for(let i=0;i<a.length;++i)e[n[i]]=a[i][0];je(r)}}function HB(e){if(e!=null)for(let t in e){let n=e[t];typeof n!="number"&&n.dispose()}}var qF;(function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"})(qF||(qF={}));var Wfe=125,vp=class{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}},GB=class{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(let t of this.callbacks)t.setParams(e)}setModel(e){for(let t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(let n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(let t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(let t of this.callbacks)await t.onTrainEnd(e)}},Vfe=class extends vp{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});let n=t.size==null?0:t.size;this.seen+=n;for(let r in t){let a=t[r];if(typeof a=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+a*n;else{let i;r in this.totals?i=this.totals[r]:this.totals[r]=0;let s=G(()=>re(this.totals[r],j(a,n)));this.totals[r]=s,i!=null&&i.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(let n of this.params.metrics)this.totals[n]!=null&&(typeof this.totals[n]=="number"?t[n]=this.totals[n]/this.seen:G(()=>{let r=j(Ie(1,this.seen),this.totals[n]);t[n]=r,this.totals[n].dispose(),An(t[n])}))}},qB=class extends vp{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(let n in t)this.history[n]==null&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){let e=[],t=[],n=[];for(let a in this.history){let i=this.history[a];for(let s=0;s<i.length;++s)if(typeof i[s]!="number"){let o=i[s];e.push(o.data()),t.push(a),n.push(s)}}let r=await Promise.all(e);for(let a=0;a<r.length;++a)this.history[t[a]][n[a]].dispose(),this.history[t[a]][n[a]]=r[a][0]}},KB=class extends vp{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||fT,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Wfe),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");k.isNumber(this.yieldEvery)&&(this.maybeWait=Uhe(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){let r=[];this.yield!=null&&(await Js(n),r.push(this.yield(e,t,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await Js(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){let n=[];this.epochEnd!=null&&(await Js(t),n.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){this.batchBegin!=null&&(await Js(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){let n=[];this.batchEnd!=null&&(await Js(t),n.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?n.push(this.nextFrameFunc()):k.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){this.trainBegin!=null&&(await Js(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Js(e),await this.trainEnd(e))}};function XB(e,t){return e==null&&(e={}),e instanceof vp?[e]:Array.isArray(e)&&e[0]instanceof vp?e:Vt(e).map(n=>new KB(n,t))}var Ha=class{constructor(){}static registerCallbackConstructor(e,t){k.assert(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),Ha.checkForDuplicate(t),Ha.constructors[e]==null&&(Ha.constructors[e]=[]),Ha.constructors[e].push(t)}static checkForDuplicate(e){for(let t in Ha.constructors)Ha.constructors[+t].forEach(n=>{if(n===e)throw new K("Duplicate callback constructor.")})}static clear(){Ha.constructors={}}static createCallbacks(e){let t=[];for(let n in Ha.constructors){let r=+n;e>=r&&t.push(...Ha.constructors[r])}return t.map(n=>new n)}};Ha.constructors={};function YB(e,t,n,r,a,i,s,o,l){let c=new qB,u=[new Vfe,...Ha.createCallbacks(t)];e!=null&&u.push(...e),u.push(c);let d=new GB(u);return d.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:s,verbose:t,doValidation:o,metrics:l}),{callbackList:d,history:c}}function wi(e,t={},n=!1){return ry(e,le.SerializationMap.getMap().classNameMap,t,"layer",n)}function lv(e,t){return G(()=>{e.dtype!=="float32"&&(e=he(e,"float32"));let n=Te(iy(e),t,!0),r=ua(n.shape,Rn()),a=ar(ns(n,r));return Ie(e,a)})}function ed(e,t){return G(()=>Jt(iy(we(t,e)),-1))}function P1(e,t){return G(()=>Jt(xn(we(t,e)),-1))}function Gh(e,t){return G(()=>{let n=we(e,t),r=hr(xn(e),Rn(),Number.MAX_VALUE),a=xn(Ie(n,r));return j(100,Jt(a,-1))})}function Ufe(e,t){return G(()=>{let n=hr(t,Rn(),Number.MAX_VALUE),r=ha(re(1,n)),a=hr(e,Rn(),Number.MAX_VALUE),i=ha(re(1,a));return Jt(iy(we(r,i)),-1)})}function jfe(e,t){return G(()=>{let n=ns(0,we(1,j(e,t)));return Jt(iy(n),-1)})}function Hfe(e,t){return G(()=>{let n=ns(0,we(1,j(e,t)));return Jt(n,-1)})}function Gfe(e,t){return G(()=>{let n=Te(j(e,t),-1),r=$a(j(we(1,e),t),-1);return ns(0,re(1,we(r,n)))})}function qfe(e,t){return G(()=>{let n=Math.log(2),r=we(t,e),a=we(re(r,Zc(j(-2,r))),n);return Jt(a,-1)})}function Km(e,t,n=!1){return G(()=>{if(n)t=sl(t);else{let r=Te(t,t.shape.length-1,!0);t=Ie(t,r)}return t=hr(t,Rn(),1-Rn()),Bt(Te(j(he(e,"float32"),ha(t)),t.shape.length-1))})}function uv(e,t,n=!1){return G(()=>{let r=he(Bh(tfe(e)),"int32");t=hr(t,Rn(),1-Rn());let a=t.shape,i=H(pp(r,a[a.length-1]),a);return Km(i,t,n)})}function Kfe(e,t){if(!k.arraysEqual(e.shape,t.shape))throw new K(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return G(()=>{let n=Ct(t),r=Bt(xn(t));return re(we(n,j(t,e)),Kg(Tr(r)))})}function z1(e,t){return G(()=>{let n;return n=hr(t,Rn(),1-Rn()),n=ha(Ie(n,we(1,n))),Jt(Kfe(e,n),-1)})}function Xfe(e,t){return G(()=>{let n=hr(e,Rn(),1),r=hr(t,Rn(),1);return Te(j(e,ha(Ie(n,r))),-1)})}function Yfe(e,t){return G(()=>{let n=ha(re(Rn(),t));return Jt(we(t,j(e,n)),-1)})}function RT(e,t){return G(()=>{let n=lv(e,-1),r=lv(t,-1),a=j(n,r);return Bt(Te(a,-1))})}var cv={meanSquaredError:ed,meanAbsoluteError:P1,meanAbsolutePercentageError:Gh,meanSquaredLogarithmicError:Ufe,squaredHinge:jfe,hinge:Hfe,categoricalHinge:Gfe,logcosh:qfe,categoricalCrossentropy:Km,sparseCategoricalCrossentropy:uv,binaryCrossentropy:z1,kullbackLeiblerDivergence:Xfe,poisson:Yfe,cosineProximity:RT};function pk(e){if(typeof e=="string"){if(e in cv)return cv[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new K(t)}else return e}function FT(e,t){return G(()=>{let n=j(.5,fa(t)),r=zs(Rr(t,n),e.dtype);return Jt(pa(e,r),-1)})}function DT(e,t){return G(()=>zs(pa(du(e,-1),du(t,-1)),"float32"))}function ZB(e,t){return G(()=>he(Te(ri(pa(e,1),pa(t,1))),"float32"))}function Zfe(e,t){return G(()=>he(Te(ri(pa(e,1),pa(t,0))),"float32"))}function Qfe(e,t){return G(()=>he(Te(ri(pa(e,0),pa(t,1))),"float32"))}function QB(e,t){return G(()=>{let n=ZB(e,t),r=Qfe(e,t),a=re(n,r);return he(Hn(Rr(a,0),Ie(n,a),0),"float32")})}function Jfe(e,t){return G(()=>{let n=ZB(e,t),r=Zfe(e,t),a=re(n,r);return he(Hn(Rr(a,0),Ie(n,a),0),"float32")})}function JB(e,t){return z1(e,t)}function eW(e,t){return e.rank===t.rank&&(e=ol(e,[e.rank-1])),t=du(t,-1),t.dtype!==e.dtype&&(t=he(t,e.dtype)),he(pa(e,t),"float32")}var eme=ed,tme=ed,nme=P1,rme=P1,ame=Gh,ime=Gh,MT=Km,sme=RT,tW=uv,dv={binaryAccuracy:FT,categoricalAccuracy:DT,precision:QB,categoricalCrossentropy:MT,sparseCategoricalCrossentropy:tW,mse:eme,MSE:tme,mae:nme,MAE:rme,mape:ame,MAPE:ime,cosine:sme};function ome(e){if(typeof e=="string"&&e in dv)return dv[e];if(typeof e!="string"&&e!=null)return e;throw new K(`Unknown metric ${e}`)}function y0(e){if(Li(e!==null,`Unknown LossOrMetricFn ${e}`),typeof e=="string")return e;{let t;for(let n of Object.keys(cv))if(cv[n]===e){t=n;break}if(t!==void 0)return t;for(let n of Object.keys(dv))if(dv[n]===e){t=n;break}return t!==void 0?t:e.name}}function lme(e){let t={Adagrad:()=>_l.adagrad(.01),Adadelta:()=>_l.adadelta(1,.95,Rn()),Adam:()=>_l.adam(.001,.9,.999,Rn()),Adamax:()=>_l.adamax(.002,.9,.999,Rn(),0),RMSProp:()=>_l.rmsprop(.001,.9,0,Rn()),SGD:()=>_l.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new K(`Unknown Optimizer ${e}`)}function KF(e,t,n=!1){if(e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!gI(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){let r=JSON.stringify(e);r.length>1048576&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function gI(e){if(e===null)return!0;if(typeof e=="object")if(Object.getPrototypeOf(e)===Object.prototype){let t=Object.keys(e);for(let n of t)if(typeof n!="string"||!gI(e[n]))return!1;return!0}else if(Array.isArray(e)){for(let t of e)if(!gI(t))return!1;return!0}else return!1;else{let t=typeof e;return t==="string"||t==="number"||t==="boolean"}}function ume(e,t,n,r=console.log){let a=dme(e),i=["Layer (type)","Input Shape","Output shape","Param #"];a?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(t*u)));let s;if(!a){i.push("Receives inputs"),s=[];for(let u in e.nodesByDepth)s.push(...e.nodesByDepth[u])}r("_".repeat(t)),pv(i,n,r),r("=".repeat(t));let o=e.layers;for(let u=0;u<o.length;++u)a?pme(o[u],n,r):hme(o[u],n,s,r),r((u===o.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();let l=cme(e),c=iv(e.nonTrainableWeights);r(`Total params: ${l+c}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${c}`),r("_".repeat(t))}function cme(e){let t;return e.collectedTrainableWeights!=null?t=iv(e.collectedTrainableWeights):t=iv(e.trainableWeights),t}function dme(e){let t=!0,n=[],r=[];for(let a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(let a of n){if(a.length>1||a.length===1&&a[0].inboundLayers.length>1){t=!1;break}r.push(...a)}if(t)for(let a of e.layers){let i=!1;for(let s of a.inboundNodes)if(r.indexOf(s)!==-1)if(i){t=!1;break}else i=!0;if(!t)break}return t}function pv(e,t,n=console.log){let r="";for(let a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r+=e[a],r=r.slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function pme(e,t,n){let r,a;try{a=e.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{a="multiple"}try{r=JSON.stringify(e.outputShape)}catch{r="multiple"}let i=e.name,s=e.getClassName(),o=[`${i} (${s})`,a,r,e.countParams().toString()];pv(o,t,n)}function hme(e,t,n,r){let a,i;try{i=e.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{i="multiple"}try{a=JSON.stringify(e.outputShape)}catch{a="multiple"}let s=[];for(let d of e.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let p=0;p<d.inboundLayers.length;++p){let h=d.inboundLayers[p].name,f=d.nodeIndices[p],m=d.tensorIndices[p];s.push(`${h}[${f}][${m}]`)}let o=e.name,l=e.getClassName(),c=s.length===0?"":s[0],u=[`${o} (${l})`,i,a,e.countParams().toString(),c];pv(u,t,r);for(let d=1;d<s.length;++d)pv(["","","","",s[d]],t,r)}function nW(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function Xm(e,t){if(e===null)return null;if(typeof e=="string")return Al(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){let n=[],r=e.length;for(let a=0;a<r;++a){let i=e[a];nW(t,a,i)?n.push(i):n.push(Xm(i,t))}return n}else{let n={};for(let r of Object.keys(e)){let a=e[r];if(r==="name"&&typeof a=="string")n[r]=a;else{let i=Al(r);n[i]=Xm(a,i)}}return n}}function yI(e,t){if(e==null)return null;if(typeof e=="string")return gs(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){let n=[],r=e.length;for(let a=0;a<r;++a){let i=e[a];nW(t,a,i)?n.push(i):n.push(yI(i,t))}return n}else{let n={};for(let r of Object.keys(e)){let a=e[r],i=gs(r);(r==="name"||r==="className")&&typeof a=="string"?n[i]=a:n[i]=yI(a,r)}return n}}var OT="4.7.0",Ri=class extends tt{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){let y=this.getClassName().toLowerCase();this.name=T1(y)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],_o(this.inputs).length!==this.inputs.length)throw new K(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(y=>y.name)}`);_o(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(y=>y.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(let y of this.outputs){let b=y.sourceLayer,v=y.nodeIndex,x=y.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(v),this.outputLayersTensorIndices.push(x)}for(let y of this.inputs){let b=y.sourceLayer,v=y.nodeIndex,x=y.tensorIndex;Li(v===0,"input layer has >1 nodes"),Li(x===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(v),this.inputLayersTensorIndices.push(x)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){let b=this.inputLayers[y];if(!(b instanceof Hh))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${y} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(let y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(y=>y.shape),this.internalOutputShapes=this.outputs.map(y=>y.shape);let t={},n={},r={},a={},i={},s=[],o=(y,b,v,x,w,S)=>{(x==null||w==null||S==null)&&(x=y.sourceLayer,w=y.nodeIndex,S=y.tensorIndex);let C=x.inboundNodes[w];if(v.indexOf(C)!==-1)throw new gi(`The tensor ${y.name} at layer "${x.name}" is part of a cycle.`);if(b.indexOf(C)!==-1)return;this.containerNodes.add(Ri.nodeKey(x,w)),x.id in i||(i[x.id]=Object.keys(i).length),v.indexOf(C)===-1&&v.push(C);let T=C.inboundLayers.length;for(let E=0;E<T;E++){let R=C.inputTensors[E],$=C.inboundLayers[E],_=C.nodeIndices[E],D=C.tensorIndices[E];o(R,b,v,$,_,D)}for(b.push(C);v.indexOf(C)>=0;)v.splice(v.indexOf(C),1);s.push(C)},l=[],c=[];for(let y of this.outputs)o(y,l,c);let u=s.slice().reverse();for(let y of u){n[y.id]=y,y.id in t||(t[y.id]=0);let b=t[y.id],v=r[y.outboundLayer.id]==null?0:r[y.outboundLayer.id];b=Math.max(b,v),r[y.outboundLayer.id]=b,a[y.outboundLayer.id]=y.outboundLayer,t[y.id]=b;for(let x=0;x<y.inboundLayers.length;x++){let w=y.inboundLayers[x],S=y.nodeIndices[x],C=w.inboundNodes[S],T=t[C.id]==null?0:t[C.id];t[C.id]=Math.max(b+1,T),n[C.id]=C}}let d={};for(let y in t){let b=t[y];b in d||(d[b]=[]),d[b].push(n[y])}let p={};for(let y in r){let b=r[y];b in p||(p[b]=[]),p[b].push(a[y])}let h=Object.keys(p).map(y=>parseInt(y,10)).sort(f0);this.layers=[];for(let y of h){let b=p[y];b.sort((v,x)=>{let w=i[v.id],S=i[x.id];return w<S?-1:w>S?1:0});for(let v of b)v instanceof Ri&&this.internalContainerRefs.push(v),this.layers.push(v)}this.layersByDepth=p,h=Object.keys(d).map(y=>parseInt(y,10)).sort(f0);let f=this.inputs.slice(),m=[];for(let y of h)for(let b of d[y]){let v=b.outboundLayer;if(v!=null){for(let x of b.inputTensors)if(f.indexOf(x)===-1)throw new gi(`Graph disconnected: cannot obtain value for tensor ${x} at layer "${v.name}". The following previous layers were accessed without issue: ${m}`);for(let x of b.outputTensors)f.push(x);m.push(v.name)}}this.nodesByDepth=d;let g=this.layers.map(y=>y.name);for(let y of g){let b=g.filter(v=>v===y).length;if(b!==1)throw new gi(`The name "${y}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new O1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(y=>null),outputMasks:this.outputs.map(y=>null),inputShapes:this.inputs.map(y=>y.shape),outputShapes:this.outputs.map(y=>y.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();let e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(let t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(let t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(n=>n.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new K("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(let t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let n of this.layers)t.push(...n.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){let n={},r=0;for(let i of this.layers)for(let s of i.weights){if(n[s.originalName]!=null)throw new K(`Duplicate weight name: ${s.originalName}`);n[s.originalName]=s,r++}let a=[];for(let i in e){let s=i;if(n[i]==null){let o=i.split("/");s=o.slice(0,-2).concat([o[o.length-1]]).join("/")}if(n[s]!=null)a.push([n[s],e[i]]);else if(t)throw new K(`Provided weight data has no target variable: ${i}`);delete n[s]}if(t){let i=[];for(let s in n)i.push(s);if(i.length>0)throw new K(`${i.length} of ${r} weights are not set: ${i}`)}_T(a)}updatedConfig(){let e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${OT}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){let n=yI(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return G(()=>{e=Vt(e);let n=new Wl;for(let r=0;r<this.inputs.length;++r)n.add(this.inputs[r],e[r]);return Rf(this.outputs,n,t)})}computeMask(e,t){return G(()=>{e=Vt(e);let n;return t==null?n=yu(null,e.length):n=Vt(t),this.runInternalGraph(e,n)[1]})}computeOutputShape(e){let t=av(e);if(t.length!==this.inputLayers.length)throw new K(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);let n={};for(let s=0;s<t.length;s++){let o=this.inputLayers[s],l=t[s],c=o.name+"_0_0";n[c]=l}let r=Object.keys(this.nodesByDepth).map(s=>parseInt(s,10)).sort(f0);if(r.length>1)for(let s of r){let o=this.nodesByDepth[s];for(let l of o){let c=l.outboundLayer;if(this.inputLayers.map(f=>f.id).indexOf(c.id)!==-1)continue;let u=[];for(let f=0;f<l.inboundLayers.length;f++){let m=l.inboundLayers[f],g=l.nodeIndices[f],y=l.tensorIndices[f],b=`${m.name}_${g}_${y}`,v=n[b];u.push(v)}let d=c.computeOutputShape(Lr(u)),p=av(d),h=c.inboundNodes.indexOf(l);for(let f=0;f<p.length;f++){let m=`${c.name}_${h}_${f}`;n[m]=p[f]}}}let a=[],i=[];for(let s=0;s<this.outputLayers.length;s++){let o=this.outputLayers[s],l=this.outputLayersNodeIndices[s],c=this.outputLayersTensorIndices[s],u=`${o.name}_${l}_${c}`;i.push(u)}for(let s=0;s<i.length;s++){let o=i[s];Li(o in n),a.push(n[o])}return Lr(a)}runInternalGraph(e,t){t==null&&(t=yu(null,e.length));let n={};for(let o=0;o<this.inputs.length;++o){let l=this.inputs[o],c=e[o],u=t[o];n[l.id]=[c,u]}let r=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(f0);for(let o of r){let l=this.nodesByDepth[o];for(let c of l){let u=c.outboundLayer,d=c.inputTensors,p=c.outputTensors,h=new Array;for(let f of d)f.id in n&&h.push(n[f.id]);if(h.length===d.length){let f={},m,g,y,b;if(c.callArgs!=null&&(f=c.callArgs),h.length===1){let[v,x]=h[0];f.mask==null&&(f.mask=x),y=Vt(u.call(v,f)),b=Vt(u.computeMask(v,x)),m=[v],g=[x]}else m=h.map(v=>v[0]),g=h.map(v=>v[1]),f.mask==null&&(f.mask=g),y=Vt(u.call(m,f)),b=Vt(u.computeMask(m,g));if(u.activityRegularizer)throw new Qe("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let v=0;v<p.length;++v){let x=p[v],w=y[v],S=b[v];n[x.id]=[w,S]}}}}let a=[],i=[],s=[];for(let o of this.outputs){Li(o.id in n,`Could not compute output ${o.name} : ${o.id}`);let[l,c]=n[o.id];s.push(l.shape),a.push(l),i.push(c)}return[a,i,s]}buildNodeConversionMap(e){let t={},n;for(let r of this.layers){n=r instanceof Ri?1:0;for(let a=0;a<r.inboundNodes.length;a++){let i=Ri.nodeKey(r,a);this.containerNodes.has(i)&&(t[i]=n,n+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new K("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(let n of this.layers)if(n.name===e)return n;throw new K(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new K(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return G(()=>{let e=[];for(let t of this.layers)for(let n=0;n<t.inboundNodes.length;++n){let r=Ri.nodeKey(t,n);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e})}getConfig(){let e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[];for(let i of this.layers){let s=i.getClassName(),o=i.getConfig(),l=[];for(let u=0;u<i.inboundNodes.length;u++){let d=i.inboundNodes[u],p=Ri.nodeKey(i,u),h={};if(this.containerNodes.has(p)){if(d.callArgs)try{JSON.stringify(d.callArgs),h=d.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),h={}}if(d.inboundLayers.length>0){let f=[];for(let m=0;m<d.inboundLayers.length;m++){let g=d.inboundLayers[m],y=d.nodeIndices[m],b=d.tensorIndices[m],v=Ri.nodeKey(g,y),x=t[v];x==null&&(x=0),f.push([g.name,x,b,h])}l.push(f)}}}let c={};c.name=i.name,c.className=s,c.config=o,c.inboundNodes=l,n.push(c)}e.layers=n;let r=[];for(let i=0;i<this.inputLayers.length;i++){let s=this.inputLayers[i],o=this.inputLayersNodeIndices[i],l=Ri.nodeKey(s,o);if(!this.containerNodes.has(l))continue;let c=t[l];c==null&&(c=0);let u=this.inputLayersTensorIndices[i];r.push([s.name,c,u])}e.inputLayers=r;let a=[];for(let i=0;i<this.outputLayers.length;i++){let s=this.outputLayers[i],o=this.outputLayersNodeIndices[i],l=Ri.nodeKey(s,o);if(!this.containerNodes.has(l))continue;let c=t[l];c==null&&(c=0);let u=this.outputLayersTensorIndices[i];a.push([s.name,c,u])}return e.outputLayers=a,e}static fromConfig(e,t,n={},r=!1){let a={},i={};function s(m,g){m.name in i?i[m.name].push(g):i[m.name]=[g]}function o(m,g){let y=[],b;for(let v of g){let x=v[0],w=v[1],S=v[2];if(b=v[3]==null?{}:v[3],!(x in a)){s(m,g);return}let C=a[x];if(C.inboundNodes.length<=w){s(m,g);return}let T=C.inboundNodes[w];y.push(T.outputTensors[S])}y.length>0&&m.apply(Lr(y),b)}function l(m){let g=m.name,y=wi(m,t.customObjects!=null?t.customObjects:{});y.setFastWeightInitDuringBuild(r),a[g]=y,m.inboundNodes.forEach(b=>{if(!(b instanceof Array))throw new K(`Corrupted configuration, expected array for nodeData: ${b}`);s(y,b)})}let c=t.name,u=t.layers;for(let m of u)l(m);for(;!Vhe(i);)for(let m of u){let g=a[m.name];if(g.name in i){let y=i[g.name];delete i[g.name];for(let b of y)o(g,b)}}let d=[],p=[],h=t.inputLayers;for(let m of h){let g=m[0],y=m[1],b=m[2];Li(g in a);let v=a[g].inboundNodes[y].outputTensors;d.push(v[b])}let f=t.outputLayers;for(let m of f){let g=m[0],y=m[1],b=m[2];Li(g in a);let v=a[g].inboundNodes[y].outputTensors;p.push(v[b])}return new e({inputs:d,outputs:p,name:c})}get stateful(){if(this._stateful)throw new K("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(let e of this.layers)if(e.stateful)return!0;return!1}resetStates(){G(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}};function fme(e,t,n){let r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(a=>null);if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}else if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){let a=[];return t.forEach(i=>{i in e?a.push(e[i]):a.push(null)}),a}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}function rW(e,t){return fme(e,t,"classWeight")}async function aW(e,t,n,r){if(t!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){let a=G(()=>{if(e.shape.length===1)return Ki(e);if(e.shape.length===2){if(e.shape[1]>1)return du(e,1);if(e.shape[1]===1)return H(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await a.data());je(a);let s=[];return i.forEach(o=>{if(n[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);s.push(n[o])}),It(s,"float32")}else return null}function mme(e,t){return j(e,t)}var gme=32;function iW(e,t){let n,r,a=t;n=a.xs,r=a.ys,k.assert(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);let i=XF("input",e.inputNames,n),s=XF("output",e.outputNames,r),o=i[0].shape[0];k.assert(i.length===e.inputs.length,()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`),k.assert(s.length===e.outputs.length,()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${s.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`);for(let l=0;l<i.length;l++)k.assert(i[l].shape[0]===o,()=>`Batch size mismatch: input ${e.inputNames[l]} has ${i[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);for(let l=0;l<s.length;l++)k.assert(s[l].shape[0]===o,()=>`Batch size mismatch: output ${e.outputNames[l]} has ${s[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);return{xs:i,ys:s}}function XF(e,t,n){if(n instanceof Ze)return[n];if(Array.isArray(n))return k.assert(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`),n;{let r=[];for(let a of t){if(n[a]==null)throw new K(`The feature data generated by the dataset lacks the required ${e} key '${a}'.`);r.push(n[a])}return r}}function yme(e){if(e.length===3)throw new Qe("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}async function bme(e,t,n){let r=n.batchesPerEpoch!=null;if(k.assert(e.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),k.assert(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),k.assert(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),k.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),k.assert(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{let a=n.validationData!=null,i,s;if(a)if(YF(n.validationData))k.assert(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{let g=yme(n.validationData);i=g.xs,s=g.ys}let o=e.makeTrainFunction(),l=e.getDedupedMetricsNames(),c;a?c=l.slice().concat(l.map(g=>"val_"+g)):c=l.slice();let u=XB(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:p,history:h}=YB(u,d,n.epochs,null,null,vme(t,n),null,a,c);p.setModel(e),e.history=h,await p.onTrainBegin(),e.stopTraining_=!1;let f=n.initialEpoch==null?0:n.initialEpoch,m=await t.iterator();for(;f<n.epochs;){let g={};await p.onEpochBegin(f);let y=0,b=0;for(r||(m=await t.iterator());!r||y<n.batchesPerEpoch;){let v=await m.next();if(r&&v.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${y} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(v.value!=null){let{xs:x,ys:w}=iW(e,v.value),S={};S.batch=b,S.size=x[0].shape[0],await p.onBatchBegin(b,S);let C=[];if(n.classWeight!=null){let R=rW(n.classWeight,e.outputNames);for(let $=0;$<R.length;++$)C.push(await aW(w[$],null,R[$]))}let T=x.concat(w).concat(C),E=o(T);je(T);for(let R=0;R<l.length;++R){let $=l[R],_=E[R];S[$]=_,An(_)}await p.onBatchEnd(b,S),HB(S),b++,y++}if(r?y>=n.batchesPerEpoch:v.done){if(a){let x;YF(n.validationData)?x=Vt(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):x=Vt(e.evaluate(i,s,{batchSize:n.validationBatchSize==null?gme:n.validationBatchSize,verbose:0}));for(let w=0;w<e.metricsNames.length;++w)g[`val_${e.metricsNames[w]}`]=x[w]}break}if(e.stopTraining_)break}if(await p.onEpochEnd(f,g),f++,e.stopTraining_)break}return await p.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function vme(e,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function YF(e){return typeof e.iterator=="function"}function xme(e){return typeof e.next=="function"}async function wme(e,t,n){n=n||{};let r=n.batches!=null,a=e.testFunction,i=[];if(n.verbose>0)throw new Qe("Verbose mode is not implemented yet.");k.assert(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);let s=xme(t)?t:await t.iterator(),o=0,l=0;for(;!r||l<n.batches;){let c=await s.next();if(i=G(()=>{if(c.value){let{xs:u,ys:d}=iW(e,c.value),p=u.concat(d),h=G(()=>a(p));if(je(p),l===0)for(let m=0;m<h.length;++m)i.push(Re(0));let f=p[0].shape[0];for(let m=0;m<h.length;++m){let g=h[m],y=i[m];i[m]=G(()=>re(i[m],j(f,g))),l>0&&je(y)}je(h),o+=f,++l}return i}),c.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<i.length;++c){let u=i[c];i[c]=Ie(i[c],o),je(u)}return Lr(i)}function hk(e){k.assert(e>0&&Number.isInteger(e),()=>`batchSize is required to be a positive integer, but got ${e}`)}function xf(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(r=>ql(r,t,n-t)):ql(e,t,n-t)}function bI(e,t){return G(()=>e==null?null:Array.isArray(e)?e.map(n=>bI(n,t)):PB(e,t.dtype==="int32"?t:he(t,"int32")))}function fk(e,t){let n=[],r=0,a=null;for(;r<e;)a=r+t,a>=e&&(a=e),n.push([r,a]),r=a;return n}function sW(e){let t=[];e instanceof Ze&&(e=[e]);for(let n=0;n<e.length;++n){let r=e[n];if(r.rank===1)t.push(ay(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function di(e,t){if(e==null)return;let n=[];if(t instanceof Ze)n.push(t.id);else if(Array.isArray(t))t.forEach(a=>n.push(a.id));else if(t!=null)for(let a in t){let i=t[a];n.push(i.id)}let r=[];if(e instanceof Ze)n.indexOf(e.id)===-1&&r.push(e);else if(Array.isArray(e))e.forEach(a=>{n.indexOf(a.id)===-1&&r.push(a)});else if(e!=null)for(let a in e){let i=e[a];n.indexOf(i.id)===-1&&r.push(i)}r.forEach(a=>{a.isDisposed||a.dispose()})}function kme(e){return e instanceof Ze}function vI(e){return Array.isArray(e)}function ZF(e){return!kme(e)&&!vI(e)}function QF(e,t,n,r=!0,a=""){if(t==null||t.length===0){if(e!=null){let s=!1;if(vI(e)&&e.length>0)s=!0;else if(ZF(e)){for(let o in e)if(e.hasOwnProperty(o)){s=!0;break}}else s=!0;if(s)throw new K(`Error when checking model ${a} expected no data, but got ${e}`)}return[]}if(e==null)return t.map(s=>null);let i;if(ZF(e)){e=e,i=[];for(let s of t){if(e[s]==null)throw new K(`No data provided for "${s}". Need data for each key in: ${t}`);i.push(e[s])}}else if(vI(e)){if(e=e,e.length!==t.length)throw new K(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);i=e}else{if(e=e,t.length>1)throw new K(`The model ${a} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);i=[e]}if(i=sW(i),n!=null)for(let s=0;s<t.length;++s){if(n[s]==null)continue;let o=i[s];if(o.shape.length!==n[s].length)throw new K(`Error when checking ${a}: expected ${t[s]} to have ${n[s].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<n[s].length;++l){if(l===0&&!r)continue;let c=o.shape[l],u=n[s][l];if(u!=null&&u>=0&&c!==u)throw new K(`${a} expected a batch of elements where each example has shape [${n[s].slice(1,n[s].length)}] (i.e.,tensor shape [*,${n[s].slice(1,n[s].length)}]) but the ${a} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return i}function Sme(e,t,n){let r=_o(e.map(i=>i.shape[0]));r.sort();let a=_o(t.map(i=>i.shape[0]));if(a.sort(),r.length>1)throw new K(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(a.length>1)throw new K(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(r.length>0&&a.length>0&&!k.arraysEqual(r,a))throw new K(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${a[0]} target sample(s).`)}function Ime(e,t,n){let r=[ed,z1,Km];for(let a=0;a<e.length;++a){let i=e[a],s=t[a],o=n[a];if(s!=null){if(s===Km&&i.shape[i.shape.length-1]===1)throw new K(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(s)!==-1){let l=i.shape.slice(1),c=o.slice(1);for(let u=0;u<l.length;++u){let d=l[u],p=c[u];if(p!=null&&d!==p)throw new K(`A target Tensor with shape ${i.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function JF(e,t,n,r=!0,a=""){let i;if(Array.isArray(e)){if(e.length!==t.length)throw new K(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);i=e}else{if(t.length>1)throw new K(`The model expects ${t.length} ${a} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);i=[e]}if(n!=null)for(let s=0;s<t.length;++s){if(n[s]==null)continue;let o=i[s];if(o.shape.length!==n[s].length)throw new K(`Error when checking ${a}: expected ${t[s]} to have ${n[s].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<n[s].length;++l){if(l===0&&!r)continue;let c=o.shape[l],u=n[s][l];if(u!=null&&u!==c)throw new K(`Error when checking ${a}: expected ${t[s]} to have shape ${JSON.stringify(n[s])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function Cme(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(r=>[]);let n;if(typeof e=="string"||typeof e=="function")n=[e];else if(Array.isArray(e)||typeof e=="object")n=e;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);if(Array.isArray(n))return t.map(r=>n);{let r=[];for(let a of t){let i=n.hasOwnProperty(a)?n[a]:[];Array.isArray(i)||(i=[i]),r.push(i)}return r}}var _me="layers-model",Ns=class extends Ri{constructor(e){super(e),this.isTraining=!1}summary(e,t,n=console.log){if(!this.built)throw new K("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");ume(this,e,t,n)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=lme(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Hs))throw new K("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(let i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new K(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(let i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),t.push(pk(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new K(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(i=>pk(i))}else{let i=pk(e.loss);this.outputs.forEach(s=>{t.push(i)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){let s=this.internalOutputShapes[i],o=this.outputNames[i];this.feedOutputNames.push(o),this.feedOutputShapes.push(s),this.feedLossFns.push(this.lossFunctions[i])}let n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Gl("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(n.indexOf(i)!==-1)continue;let s=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([s,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});let r=Cme(e.metrics,this.outputNames),a=(i,s,o)=>{this.outputNames.length>1&&(s=this.outputNames[i]+"_"+s),this.metricsNames.push(s),this.metricsTensors.push([o,i])};Gl("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(n.indexOf(i)!==-1)continue;let s=r[i];(o=>{let l="",c,u,d;for(let p of o){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){let f=this.internalOutputShapes[i];f[f.length-1]===1||this.lossFunctions[i]===z1?["accuracy","acc"].indexOf(p)!==-1?u=FT:["crossentropy","ce"].indexOf(p)!==-1&&(u=JB):this.lossFunctions[i]===uv?["accuracy","acc"].indexOf(p)!==-1?u=eW:["crossentropy","ce"].indexOf(p)!==-1&&(u=tW):["accuracy","acc"].indexOf(p)!==-1?u=DT:["crossentropy","ce"].indexOf(p)!==-1&&(u=MT);let m;["accuracy","acc"].indexOf(p)!==-1?m="acc":["crossentropy","ce"].indexOf(p)!==-1&&(m="ce"),d=u,c=l+m}else d=ome(p),c=l+y0(p);let h;Gl(c,()=>{h=d}),a(i,c,h)}})(s)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,n={}){let r=n.batchSize==null?32:n.batchSize;hk(r);let a=!0,i=this.standardizeUserDataXY(e,t,a,r);try{let s=i[0].concat(i[1]);this.makeTestFunction();let o=this.testFunction,l=this.testLoop(o,s,r,n.verbose,n.steps);return Lr(l)}finally{di(i[0],e),di(i[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),wme(this,e,t)}checkNumSamples(e,t,n,r="steps"){let a;if(n!=null){if(a=null,t!=null)throw new K(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?a=e[0].shape[0]:a=e.shape[0];else throw new K(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return a}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new K("`outputs` is an empty Array, which is not allowed.");let n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),i=new Wl;if(e instanceof Ze&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new K(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let o=0;o<this.inputs.length;++o)i.add(this.inputs[o],e[o])}else for(let o of this.inputs){let l=e[o.name];if(l==null)throw new K(`No value is provided for the model's input ${o.name}`);i.add(o,l)}let s=Rf(a,i);return n?s:s[0]}retrieveSymbolicTensors(e){let t=yu(null,e.length),n=e.length;for(let r of this.layers){let a=Array.isArray(r.output)?r.output:[r.output],i=a.map(s=>s.name);for(let s=0;s<e.length;++s){let o=i.indexOf(e[s]);if(o!==-1&&(t[s]=a[o],n--),n===0)break}if(n===0)break}if(n>0){let r=[];throw t.forEach((a,i)=>{a==null&&r.push(e[i])}),new K(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return t}predictLoop(e,t=32,n=!1){return G(()=>{let r=this.checkNumSamples(e);if(n)throw new Qe("Verbose predictLoop() is not implemented yet.");let a=fk(r,t),i=this.outputs.map(s=>[]);for(let s=0;s<a.length;++s)G(()=>{let o=a[s][0],l=a[s][1],c=xf(e,o,l),u=[];if(Array.isArray(c))for(let p=0;p<c.length;++p)u.push({key:this.inputs[p],value:c[p]});else u.push({key:this.inputs[0],value:c});let d=new Wl(u);return Rf(this.outputs,d)}).forEach((o,l)=>i[l].push(o));return Lr(i.map(s=>Et(s,0)))})}predict(e,t={}){let n=sW(e);JF(n,this.inputNames,this.feedInputShapes,!1);try{let r=t.batchSize==null?32:t.batchSize;return hk(r),this.predictLoop(n,r)}finally{di(n,e)}}predictOnBatch(e){JF(e,this.inputNames,this.feedInputShapes,!0);let t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,n=!0,r){if(this.optimizer_==null)throw new gi("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");let a=[];for(let i=0;i<this.feedOutputShapes.length;++i){let s=this.feedOutputShapes[i];this.feedLossFns[i]===uv?a.push(s.slice(0,s.length-1).concat([1])):a.push(s)}if(e=QF(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=QF(t,this.feedOutputNames,a,!1,"target"),Sme(e,t),Ime(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new K(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,n,r,a=!0,i){let[s,o]=this.standardizeUserDataXY(e,t,a,i);if(n!=null)throw new Error("sample weight is not supported yet.");let l=null;if(r!=null){let c=rW(r,this.outputNames);l=[];for(let u=0;u<c.length;++u)l.push(await aW(o[u],null,c[u]))}return[s,o,l]}testLoop(e,t,n,r=0,a){return G(()=>{let i=this.checkNumSamples(t,n,a,"steps"),s=[];if(r>0)throw new Qe("Verbose mode is not implemented yet.");if(a!=null)throw new Qe("steps mode in testLoop() is not implemented yet");{let o=fk(i,n),l=It(Ii(0,i));for(let c=0;c<o.length;++c){let u=o[c][0],d=o[c][1],p=ql(l,u,d-u),h=bI(t,p),f=e(h);if(c===0)for(let m=0;m<f.length;++m)s.push(Re(0));for(let m=0;m<f.length;++m){let g=f[m];s[m]=re(s[m],j(d-u,g))}}for(let c=0;c<s.length;++c)s[c]=Ie(s[c],i)}return s})}getDedupedMetricsNames(){let e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){let r=e[n],a=r;if(zF(e,r)>1){let i=zF(e.slice(0,n),r);a+=`_${i}`}t.push(a)}return t}makeTrainFunction(){return e=>{let t=[],n=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],s=()=>{let c=[];for(let h=0;h<this.inputs.length;++h)c.push({key:this.inputs[h],value:n[h]});let u=new Wl(c),d=Rf(this.outputs,u,{training:!0}),p;for(let h=0;h<this.lossFunctions.length;++h){let f=this.lossFunctions[h],m=f(r[h],d[h]);a[h]!=null&&(m=mme(m,a[h]));let g=Jt(m);t.push(g),h===0?p=m:p=re(p,m)}for(let h=0;h<this.metricsTensors.length;++h){let f;if(this.outputs.length>1&&h<this.outputs.length)f=t[h];else{let m=this.metricsTensors[h][0],g=this.metricsTensors[h][1];f=Jt(m(r[g],d[g]))}An(f),i.push(f)}return p=Jt(p),this.calculateLosses().forEach(h=>{p=re(p,h)}),p},o=this.collectedTrainableWeights.map(c=>c.read()),l=!0;return[this.optimizer_.minimize(s,l,o)].concat(i)}}makeTestFunction(){this.testFunction=e=>G(()=>{let t=[],n,r=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let l=0;l<this.inputs.length;++l)i.push({key:this.inputs[l],value:r[l]});let s=new Wl(i),o=Rf(this.outputs,s);for(let l=0;l<this.lossFunctions.length;++l){let c=this.lossFunctions[l],u=Jt(c(a[l],o[l]));l===0?n=u:n=re(n,u),t.push(n)}for(let l=0;l<this.metricsTensors.length;++l){let c=this.metricsTensors[l][0],u=this.metricsTensors[l][1],d=Jt(c(a[u],o[u]));t.push(d)}return t})}async fit(e,t,n={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,a,i,s,o,l,c,u,d;try{let p=n.batchSize==null?32:n.batchSize;hk(p);let h=!1,f=await this.standardizeUserData(e,t,n.sampleWeight,n.classWeight,h,p);r=f[0],a=f[1],d=f[2];let m=!1,g;if(n.validationData!=null&&n.validationData.length>0){if(m=!0,n.validationData.length===2)o=n.validationData[0],l=n.validationData[1];else throw n.validationData.length===3?new Qe("validationData including sample weights is not supported yet."):new K(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${n.validationData} is invalid.`);let C=!0,T=await this.standardizeUserData(o,l,null,null,C,p);c=T[0],u=T[1],g=c.concat(u)}else if(n.validationSplit!=null&&n.validationSplit>0&&n.validationSplit<1){m=!0;let C=Math.floor(r[0].shape[0]*(1-n.validationSplit)),T=r[0].shape[0];c=xf(r,C,T),i=r,r=xf(r,0,C),u=xf(a,C,T),s=a,a=xf(a,0,C),g=c.concat(u)}else n.validationSteps!=null&&(m=!0);let y=r.concat(a).concat(d);this.checkTrainableWeightsConsistency();let b=this.makeTrainFunction(),v=this.getDedupedMetricsNames(),x,w;m?(this.makeTestFunction(),x=this.testFunction,w=v.slice().concat(v.map(C=>"val_"+C))):(x=null,g=[],w=v.slice());let S=XB(n.callbacks,n.yieldEvery);return await this.fitLoop(b,y,v,p,n.epochs,n.verbose,S,x,g,n.shuffle,w,n.initialEpoch,null,null)}finally{this.isTraining=!1,di(r,e),di(a,t),di(i,e),di(s,t),di(c,o),di(u,l),d!=null&&je(d)}}async fitLoop(e,t,n,r,a,i,s,o,l,c,u,d,p,h){r==null&&(r=32),a==null&&(a=1),c==null&&(c=!0),d==null&&(d=0);let f=!1;if(o!=null&&l!=null&&(f=!0),h!=null&&(f=!0,p==null))throw new K("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let m=this.checkNumSamples(t,r,p,"steps_per_epoch"),g;m!=null&&(g=Ii(0,m)),i==null&&(i=1);let{callbackList:y,history:b}=YB(s,i,a,d,m,p,r,f,u);y.setModel(this),this.history=b,await y.onTrainBegin(),this.stopTraining_=!1;for(let v=d;v<a;++v){await y.onEpochBegin(v);let x={};if(p!=null)throw new Qe("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new Qe("batch shuffling is not implemneted yet");c&&k.shuffle(g);let w=It(g),S=fk(m,r);for(let C=0;C<S.length;++C){let T={};if(await y.onBatchBegin(C,T),G(()=>{let E=S[C][0],R=S[C][1],$=ql(w,E,R-E);T.batch=C,T.size=R-E;let _=bI(t,$),D=e(_);for(let P=0;P<n.length;++P){let B=n[P],W=D[P];T[B]=W,An(W)}if(C===S.length-1&&f){let P=this.testLoop(o,l,r);for(let B=0;B<n.length;++B){let W=n[B],Y=P[B];An(Y),x["val_"+W]=Y}}}),await y.onBatchEnd(C,T),HB(T),this.stopTraining_)break}w.dispose()}if(await y.onEpochEnd(v,x),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return bme(this,e,t)}async trainOnBatch(e,t){let n=await this.standardizeUserData(e,t),r=n[0],a=n[1],i=this.makeTrainFunction()(r.concat(a)),s=[];for(let o of i){let l=await o.data();s.push(l[0])}return je(i),di(n[0],e),di(n[1],t),Lr(s)}getNamedWeights(e){let t=[],n=e!=null&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n);for(let i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){let e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){let t=nv().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-nv().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=gs(this.loss);else if(Array.isArray(this.loss)){for(let t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>gs(t))}else{let t=Object.keys(this.loss);e={};let n=this.loss;for(let r of t)if(typeof n[r]=="string")e[r]=gs(n[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[gs(y0(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>gs(y0(e)));{let e={};for(let t in this.metrics)e[t]=gs(y0(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");let t=Xm(e.optimizer_config),n=wi(t),r;if(typeof e.loss=="string")r=Al(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(i=>Al(i));else if(e.loss!=null){r={};for(let i in e.loss)r[i]=Al(e.loss[i])}let a;if(Array.isArray(e.metrics))a=e.metrics.map(i=>Al(i));else if(e.metrics!=null){a={};for(let i in e.metrics)a[i]=Al(e.metrics[i])}this.compile({loss:r,metrics:a,optimizer:n})}async save(e,t){if(typeof e=="string"){let s=tr.getSaveHandlers(e);if(s.length===0)throw new K(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new K(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new K("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let n=await tr.encodeWeights(this.getNamedWeights(t)),r=!1,a=null,i={modelTopology:this.toJSON(a,r),format:_me,generatedBy:`TensorFlow.js tfjs-layers v${OT}`,convertedBy:null};if(t!=null&&t.includeOptimizer&&this.optimizer!=null){i.trainingConfig=this.getTrainingConfig();let s="optimizer",{data:o,specs:l}=await tr.encodeWeights(await this.optimizer.getWeights(),s);n.specs.push(...l),n.data=tr.concatenateArrayBuffers([n.data,o])}return this.userDefinedMetadata!=null&&(KF(this.userDefinedMetadata,this.name,!0),i.userDefinedMetadata=this.userDefinedMetadata),i.weightData=n.data,i.weightSpecs=n.specs,e.save(i)}setUserDefinedMetadata(e){KF(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}};Ns.className="Model";le.registerClass(Ns);var oW=class extends Ns{};oW.className="Functional";le.registerClass(oW);async function Tme(e,t){"modelTopology"in e||(e={modelTopology:e}),e=e;let n=e.modelTopology;n.model_config!=null&&(n=n.model_config);let r=Xm(n),a=wi(r,t);if(e.weightsManifest!=null){let i=await tr.loadWeights(e.weightsManifest,e.pathPrefix,a.weights.map(o=>o.originalName)),s={};for(let o of a.weights)s[o.originalName]=i[o.originalName];a.loadWeights(s),je(i)}return a}async function Nme(e,t){if(t==null&&(t={}),typeof e=="string"){let n=tr.getLoadHandlers(e,t);if(n.length===0)n.push(tr.browserHTTPRequest(e,t));else if(n.length>1)throw new K(`Found more than one (${n.length}) load handlers for URL '${e}'`);e=n[0]}return Eme(e,void 0,t)}async function Eme(e,t,n){if(n==null&&(n={}),e.load==null)throw new K("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let r=await e.load(),a=r.modelTopology;a.model_config!=null&&(a=a.model_config);let i=n.strict==null?!0:n.strict,s=r.weightData!=null&&r.weightSpecs!=null&&i,o=wi(Xm(a),t,s),l=r.trainingConfig;if(l!=null&&o.loadTrainingConfig(l),r.userDefinedMetadata!=null&&o.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData!=null){if(r.weightSpecs==null)throw new K("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");let{modelWeights:c,optimizerWeights:u}=$me(r.weightData,r.weightSpecs);o.loadWeights(c,i),o.optimizer!=null&&u.length>0&&await o.optimizer.setWeights(u),je(c),je(u.map(d=>d.tensor))}return o}function $me(e,t){let n=tr.decodeWeights(e,t),r={},a=[];return t.forEach(i=>{i.group==="optimizer"?a.push({name:i.name,tensor:n[i.name]}):r[i.name]=n[i.name]}),{modelWeights:r,optimizerWeights:a}}var xp=class extends Ns{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:T1("sequential_"),e.layers!=null)for(let t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(t=>t<0))throw new K(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){let t=e instanceof xp||e instanceof Ns,n;if(t){if(n=e,n.outputs.length!==1)throw new K("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(n.inputs.length!==1)throw new K("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new K("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let r=WB({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(t)this.outputs=n.outputs,this.inputs=n.inputs;else{if(e.inboundNodes.length!==1)throw new K(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new K("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=BB(this.outputs[0])}this.inboundNodes=[],new O1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:yu(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{let r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(gt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Ns({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,n=console.log){this.built||this.build(),super.summary(e,t,n)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,n={}){if(!this.built)throw new gi("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new gi("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,n={}){if(!this.built)throw new gi("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new gi("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,n={},r=!1){let a,i={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new K("Legacy serialization format not supported yet.");a=t}else k.assert(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=t.layers,delete t.layers,i=t;let s=new e(i);if(!(s instanceof xp))throw new Qe(`Sequential.fromConfig called on non-Sequential input: ${s}`);for(let o of a){let l=wi(o,void 0,r);r&&l.setFastWeightInitDuringBuild(!0),s.add(l)}return s}set stopTraining(e){if(this.model==null)throw new K("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new K("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let e=[];for(let t of this.layers){let n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}};xp.className="Sequential";le.registerClass(xp);function Ame(e){return new Ns(e)}function Rme(e){return new xp(e)}function lW(e){return WB(e)}function Fme(e,t){Ha.registerCallbackConstructor(e,t)}var Yr=class extends le.Serializable{getConfig(){return{}}},uW=class extends Yr{apply(e,t=1){return rfe(e,t)}};uW.className="elu";le.registerClass(uW);var cW=class extends Yr{apply(e){return c1(e)}};cW.className="selu";le.registerClass(cW);var dW=class extends Yr{apply(e){return Ct(e)}};dW.className="relu";le.registerClass(dW);var pW=class extends Yr{apply(e){return G(()=>Lo(6,Ct(e)))}};pW.className="relu6";le.registerClass(pW);var hW=class extends Yr{apply(e){return e}};hW.className="linear";le.registerClass(hW);var fW=class extends Yr{apply(e){return ei(e)}};fW.className="sigmoid";le.registerClass(fW);var mW=class extends Yr{apply(e){return ife(e)}};mW.className="hardSigmoid";le.registerClass(mW);var gW=class extends Yr{apply(e){return Zc(e)}};gW.className="softplus";le.registerClass(gW);var yW=class extends Yr{apply(e){return afe(e)}};yW.className="softsign";le.registerClass(yW);var bW=class extends Yr{apply(e){return hu(e)}};bW.className="tanh";le.registerClass(bW);var PT=class extends Yr{apply(e,t=-1){return sl(e,t)}};PT.className="softmax";le.registerClass(PT);var vW=class extends Yr{apply(e,t=-1){return n1(e,t)}};vW.className="logSoftmax";le.registerClass(vW);var xW=class extends Yr{apply(e,t=1){return G(()=>j(ei(j(e,t)),e))}};xW.className="swish";le.registerClass(xW);var wW=class extends Yr{apply(e){return G(()=>j(e,hu(Zc(e))))}};wW.className="mish";le.registerClass(wW);function Vo(e){return e.getClassName()}function mk(e,t={}){return ry(e,le.SerializationMap.getMap().classNameMap,t,"activation")}function Uo(e){if(e==null){let t={};return t.className="linear",t.config={},mk(t)}if(typeof e=="string"){let t={};return t.className=e,t.config={},mk(t)}else return e instanceof Yr?e:mk(e)}function zT(e){if(e!=null&&typeof e!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}var kW=class extends le.Serializable{},ly=class extends kW{constructor(e){super(),zT(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return G(()=>{let t=en([1]);return this.hasL1&&(t=re(t,Te(j(this.l1,xn(e))))),this.hasL2&&(t=re(t,Te(j(this.l2,iy(e))))),H(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}};ly.className="L1L2";le.registerClass(ly);function Dme(e){return zT(e),new ly({l1:e!=null?e.l1:null,l2:0})}function Mme(e){return zT(e),new ly({l2:e!=null?e.l2:null,l1:0})}var eD={l1l2:"L1L2"};function Dt(e){return gT(e)}function tD(e,t={}){return ry(e,le.SerializationMap.getMap().classNameMap,t,"regularizer")}function Xt(e){if(e==null)return null;if(typeof e=="string"){let t={className:e in eD?eD[e]:e,config:{}};return tD(t)}else return e instanceof kW?e:tD(e)}var LT=class extends tt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=We(e);let n=Ct(e);return this.maxValue!=null&&(n=hr(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){let e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}};LT.className="ReLU";le.registerClass(LT);var BT=class extends tt{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=We(e);return qg(n,this.alpha)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};BT.className="LeakyReLU";le.registerClass(BT);var WT=class extends tt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Kt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Xt(e.alphaRegularizer),this.alphaConstraint=On(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new K(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=gt(e);let t=e.slice(1);if(this.sharedAxes!=null)for(let r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let n={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)n[r]=e[r];this.inputSpec=[new kn({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=We(e),Qg(e,this.alpha.read())}getConfig(){let e={alphaInitializer:tn(this.alphaInitializer),alphaRegularizer:Dt(this.alphaRegularizer),alphaConstraint:Mn(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}};WT.className="PReLU";le.registerClass(WT);var VT=class extends tt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Qe(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=We(e);return zh(n)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};VT.className="ELU";le.registerClass(VT);var UT=class extends tt{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){let n=We(e);return j(n,he(Rr(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){let e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}};UT.className="ThresholdedReLU";le.registerClass(UT);var jT=class extends tt{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new PT().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){let n=We(e);return this.softmax(n,this.axis)}computeOutputShape(e){return e}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};jT.className="Softmax";le.registerClass(jT);function Kd(e,t,n){if(typeof e=="number")return yu(e,t);if(e.length!==t)throw new K(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let r=0;r<t;++r){let a=e[r];if(!Jhe(a))throw new K(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${a}`)}return e}function ki(e,t,n,r,a=1){if(e==null)return e;let i=t+(t-1)*(a-1),s;return n==="same"?s=e:s=e-i+1,Math.floor((s+r-1)/r)}function Bi(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+Wo([n-t,0]);else if(r==="same")e=e*t;else throw new K(`Unsupport padding mode: ${r}.`);return e}function HT(e,t){return G(()=>(mn(t),t==="channelsFirst"?Je(e,[0,2,3,1]):e))}function SW(e,t){return G(()=>(mn(t),t==="channelsFirst"?Je(e,[0,2,3,4,1]):e))}function Ome(e,t,n,r=1,a="valid",i,s=1){return G(()=>{if(i==null&&(i=Ci()),mn(i),e.shape.length!==3)throw new K(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(t.shape.length!==3)throw new K(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new K(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(i==="channelsFirst"&&(e=Je(e,[0,2,1])),a==="causal")throw new Qe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=Yx(e,t,r,a==="same"?"same":"valid","NWC",s);return n!=null&&(o=Ni(o,n)),o})}function nD(e,t,n,r=[1,1],a="valid",i,s,o=null){return G(()=>{if(i==null&&(i=Ci()),mn(i),e.rank!==3&&e.rank!==4)throw new K(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(t.rank!==3&&t.rank!==4)throw new K(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let l=HT(e,i);if(a==="causal")throw new Qe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=gp.conv2d({x:l,filter:t,strides:r,pad:a==="same"?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:o}),i==="channelsFirst"&&(l=Je(l,[0,3,1,2])),l})}function Pme(e,t,n,r=[1,1,1],a="valid",i,s){return G(()=>{if(i==null&&(i=Ci()),mn(i),e.rank!==4&&e.rank!==5)throw new K(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(t.rank!==4&&t.rank!==5)throw new K(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let o=SW(e,i);if(a==="causal")throw new Qe("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=v_(o,t,r,a==="same"?"same":"valid","NDHWC",s),n!=null&&(o=Ni(o,n)),i==="channelsFirst"&&(o=Je(o,[0,4,1,2,3])),o})}var GT=class extends tt{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",GT.verifyArgs(t),this.rank=e,jn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Qe(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Kd(t.kernelSize,e,"kernelSize"),this.strides=Kd(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,za(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,mn(this.dataFormat),this.activation=Uo(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=Kt(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=On(t.biasConstraint),this.biasRegularizer=Xt(t.biasRegularizer),this.activityRegularizer=Xt(t.activityRegularizer),this.dilationRate=Kd(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new K(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new K(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new K(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Li("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!yT(e.kernelSize,"number",1,3))throw new K(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){let e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Vo(this.activation),useBias:this.useBias,biasInitializer:tn(this.biasInitializer),biasRegularizer:Dt(this.biasRegularizer),activityRegularizer:Dt(this.activityRegularizer),biasConstraint:Mn(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}},uy=class extends GT{constructor(e,t){super(e,t),this.kernel=null,uy.verifyArgs(t),this.filters=t.filters,jn(this.filters,"filters"),this.kernelInitializer=Kt(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=On(t.kernelConstraint),this.kernelRegularizer=Xt(t.kernelRegularizer)}build(e){e=gt(e);let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new K(`The channel dimension of the input should be defined. Found ${e[t]}`);let n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return G(()=>{e=We(e);let n,r=this.bias==null?null:this.bias.read(),a=AB(this.activation.getClassName());if(a!=null&&this.rank===2)n=nD(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(this.rank===1)n=Ome(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)n=nD(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)n=Pme(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Qe("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(n=this.activation.apply(n))}return n})}computeOutputShape(e){e=gt(e);let t=[],n=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let a=0;a<n.length;++a){let i=ki(n[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);t.push(i)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){let e={filters:this.filters,kernelInitializer:tn(this.kernelInitializer),kernelRegularizer:Dt(this.kernelRegularizer),kernelConstraint:Mn(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new K(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}},cy=class extends uy{constructor(e){super(2,e),cy.verifyArgs(e)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!yT(e.kernelSize,"number",1,2))throw new K(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}};cy.className="Conv2D";le.registerClass(cy);var dy=class extends uy{constructor(e){super(3,e),dy.verifyArgs(e)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new K(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}};dy.className="Conv3D";le.registerClass(dy);var qT=class extends cy{constructor(e){if(super(e),this.inputSpec=[new kn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new K(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=gt(e),e.length!==4)throw new K("Input should have rank 4; Received input shape: "+JSON.stringify(e));let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new K("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new kn({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return G(()=>{let n=We(e);if(n.shape.length!==4)throw new K(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${n.shape.length}`);let r=n.shape,a=r[0],i,s;this.dataFormat==="channelsFirst"?(i=2,s=3):(i=1,s=2);let o=r[i],l=r[s],c=this.kernelSize[0],u=this.kernelSize[1],d=this.strides[0],p=this.strides[1],h=Bi(o,d,c,this.padding),f=Bi(l,p,u,this.padding),m=[a,h,f,this.filters];this.dataFormat!=="channelsLast"&&(n=Je(n,[0,2,3,1]));let g=Zx(n,this.kernel.read(),m,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(g=Je(g,[0,3,1,2])),this.bias!=null&&(g=Ni(g,this.bias.read(),this.dataFormat)),this.activation!=null&&(g=this.activation.apply(g)),g})}computeOutputShape(e){e=gt(e);let t=e.slice(),n,r,a;this.dataFormat==="channelsFirst"?(n=1,r=2,a=3):(n=3,r=1,a=2);let i=this.kernelSize[0],s=this.kernelSize[1],o=this.strides[0],l=this.strides[1];return t[n]=this.filters,t[r]=Bi(t[r],o,i,this.padding),t[a]=Bi(t[a],l,s,this.padding),t}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};qT.className="Conv2DTranspose";le.registerClass(qT);var KT=class extends dy{constructor(e){if(super(e),this.inputSpec=[new kn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new K(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=gt(e),e.length!==5)throw new K("Input should have rank 5; Received input shape: "+JSON.stringify(e));let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new K("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new kn({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return G(()=>{let n=We(e);if(n.shape.length!==5)throw new K(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${n.shape.length}`);let r=n.shape,a=r[0],i,s,o;this.dataFormat==="channelsFirst"?(o=2,i=3,s=4):(o=1,i=2,s=3);let l=r[o],c=r[i],u=r[s],d=this.kernelSize[0],p=this.kernelSize[1],h=this.kernelSize[2],f=this.strides[0],m=this.strides[1],g=this.strides[2],y=Bi(l,f,d,this.padding),b=Bi(c,m,p,this.padding),v=Bi(u,g,h,this.padding),x=[a,y,b,v,this.filters];this.dataFormat!=="channelsLast"&&(n=Je(n,[0,2,3,4,1]));let w=x_(n,this.kernel.read(),x,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(w=Je(w,[0,4,1,2,3])),this.bias!==null&&(w=Ni(w,this.bias.read(),this.dataFormat)),this.activation!==null&&(w=this.activation.apply(w)),w})}computeOutputShape(e){e=gt(e);let t=e.slice(),n,r,a,i;this.dataFormat==="channelsFirst"?(n=1,r=2,a=3,i=4):(n=4,r=1,a=2,i=3);let s=this.kernelSize[0],o=this.kernelSize[1],l=this.kernelSize[2],c=this.strides[0],u=this.strides[1],d=this.strides[2];return t[n]=this.filters,t[r]=Bi(t[r],c,s,this.padding),t[a]=Bi(t[a],u,o,this.padding),t[i]=Bi(t[i],d,l,this.padding),t}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};KT.className="Conv3DTranspose";le.registerClass(KT);var IW=class extends uy{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new K("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new K("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new K(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=Kt(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Xt(t.depthwiseRegularizer),this.depthwiseConstraint=On(t.depthwiseConstraint),this.pointwiseInitializer=Kt(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Xt(t.pointwiseRegularizer),this.pointwiseConstraint=On(t.pointwiseConstraint)}build(e){if(e=gt(e),e.length<this.rank+2)throw new K(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);let t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new K(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);let n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[];for(let s=0;s<this.rank;++s)a.push(1);a.push(n*this.depthMultiplier,this.filters);let i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new kn({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return G(()=>{e=We(e);let n;if(this.rank===1)throw new Qe("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Je(e,[0,2,3,1])),n=Vh(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(n=Ni(n,this.bias.read(),this.dataFormat)),this.activation!=null&&(n=this.activation.apply(n)),this.dataFormat==="channelsFirst"&&(n=Je(n,[0,3,1,2])),n})}getConfig(){let e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=tn(this.depthwiseInitializer),e.pointwiseInitializer=tn(this.pointwiseInitializer),e.depthwiseRegularizer=Dt(this.depthwiseRegularizer),e.pointwiseRegularizer=Dt(this.pointwiseRegularizer),e.depthwiseConstraint=Mn(this.depthwiseConstraint),e.pointwiseConstraint=Mn(this.pointwiseConstraint),e}};IW.className="SeparableConv";var XT=class extends IW{constructor(e){super(2,e)}};XT.className="SeparableConv2D";le.registerClass(XT);var L1=class extends uy{constructor(e){super(1,e),L1.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){let e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!yT(e.kernelSize,"number",1,1))throw new K(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}};L1.className="Conv1D";le.registerClass(L1);var YT=class extends tt{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return G(()=>{if(e=We(e),this.dataFormat==="channelsLast"){let n=g0(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return g0(n,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{let n=g0(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return g0(n,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){let e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};YT.className="Cropping2D";le.registerClass(YT);var ZT=class extends tt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,mn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,Yhe(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){let t=e[2]==null?null:this.size[0]*e[2],n=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,n]}else{let t=e[1]==null?null:this.size[0]*e[1],n=e[2]==null?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return G(()=>{let n=We(e),r=n.shape;if(this.dataFormat==="channelsFirst"){n=Je(n,[0,2,3,1]);let a=this.size[0]*r[2],i=this.size[1]*r[3],s=this.interpolation==="nearest"?Ia.resizeNearestNeighbor(n,[a,i]):Ia.resizeBilinear(n,[a,i]);return Je(s,[0,3,1,2])}else{let a=this.size[0]*r[1],i=this.size[1]*r[2];return this.interpolation==="nearest"?Ia.resizeNearestNeighbor(n,[a,i]):Ia.resizeBilinear(n,[a,i])}})}getConfig(){let e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}};ZT.className="UpSampling2D";le.registerClass(ZT);function zme(e,t,n=[1,1],r="valid",a,i){return G(()=>{a==null&&(a=Ci()),mn(a);let s=HT(e,a);if(e.rank!==4)throw new K(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(t.rank!==4)throw new K(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return s=Yc(s,t,n,r==="same"?"same":"valid","NHWC",i),a==="channelsFirst"&&(s=Je(s,[0,3,1,2])),s})}var QT=class extends GT{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Kt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=On(e.depthwiseConstraint),this.depthwiseRegularizer=Xt(e.depthwiseRegularizer)}build(e){if(e=gt(e),e.length<4)throw new K(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);let t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new K(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);let n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return G(()=>{e=We(e);let n=zme(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(n=Ni(n,this.bias.read(),this.dataFormat)),this.activation!=null&&(n=this.activation.apply(n)),n})}computeOutputShape(e){e=gt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=ki(t,this.kernelSize[0],this.padding,this.strides[0]),i=ki(n,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,a,i]:[e[0],a,i,r]}getConfig(){let e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=tn(this.depthwiseInitializer),e.depthwiseRegularizer=Dt(this.depthwiseRegularizer),e.depthwiseConstraint=Mn(this.depthwiseRegularizer),e}};QT.className="DepthwiseConv2D";le.registerClass(QT);function CW(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new K("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(i){return i==null||Array.isArray(i)?i:[i]}return t=a(t),n=a(n),{inputs:e,initialState:t,constants:n}}function _W(e,t,n,r=!1,a,i,s=!1,o=!1){return G(()=>{let l=t.shape.length;if(l<3)throw new K(`Input should be at least 3D, but is ${l}D.`);let c=[1,0].concat(Ii(2,l));if(t=Je(t,c),i!=null)throw new Qe("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),a!=null&&(a=he(he(a,"bool"),"float32"),a.rank===l-1&&(a=Qn(a,-1)),a=Je(a,c)),r&&(t=Da(t,0),a!=null&&(a=Da(a,0)));let u=[],d,p=n,h=t.shape[0],f=dn(t),m;a!=null&&(m=dn(a));for(let y=0;y<h;++y){let b=f[y],v=G(()=>e(b,p));if(a==null)d=v[0],p=v[1];else{let x=G(()=>{let w=m[y],S=we(fa(w),w),C=re(j(v[0],w),j(p[0],S)),T=p.map((E,R)=>re(j(v[1][R],w),j(E,S)));return{output:C,newStates:T}});d=x.output,p=x.newStates}o&&u.push(d)}let g;return o&&(g=Fn(u,1)),[d,g,p]})}var as=class extends tt{constructor(e){super(e);let t;if(e.cell==null)throw new K("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new V1({cells:e.cell}):t=e.cell,t.stateSize==null)throw new K("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new kn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Ii(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){fI(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);let n=t[0],r;if(this.returnSequences?r=[e[0],e[1],n]:r=[e[0],n],this.returnState){let a=[];for(let i of t)a.push([e[0],i]);return[r].concat(a)}else return r}computeMask(e,t){return G(()=>{Array.isArray(t)&&(t=t[0]);let n=this.returnSequences?t:null;if(this.returnState){let r=this.states.map(a=>null);return[n].concat(r)}else return n})}get states(){if(this.states_==null){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Qe("Constants support is not implemented in RNN yet.");fI(e)&&(e=e[0]),e=e;let t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new kn({shape:[t,null,...n]});let r=[e[0]].concat(e.slice(2));this.cell.build(r);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!k.arraysEqual(this.stateSpec.map(i=>i.shape[i.shape.length-1]),a))throw new K(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(i=>new kn({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){G(()=>{if(!this.stateful)throw new ms("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape[0];if(n==null)throw new K("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>en([n,r])):this.states_=[en([n,this.cell.stateSize])];else if(e==null)je(this.states_),this.keptStates!=null&&(je(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>en([n,r])):this.states_[0]=en([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new K(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):je(this.states_);for(let r=0;r<this.states_.length;++r){let a=e[r],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,s=[n,i];if(!k.arraysEqual(a.shape,s))throw new K(`State ${r} is incompatible with layer ${this.name}: expected shape=${s}, received shape=${a.shape}`);this.states_[r]=a}}this.states_=this.states_.map(r=>An(r.clone()))})}apply(e,t){let n=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});let a=CW(e,n,r,this.numConstants);e=a.inputs,n=a.initialState,r=a.constants;let i=[],s=[];if(n!=null){t.initialState=n,i=i.concat(n),this.stateSpec=[];for(let o of n)this.stateSpec.push(new kn({shape:o.shape}));s=s.concat(this.stateSpec)}if(r!=null&&(t.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof yi){let o=[e].concat(i),l=this.inputSpec.concat(s),c=this.inputSpec;this.inputSpec=l;let u=super.apply(o,t);return this.inputSpec=c,u}else return super.apply(e,t)}call(e,t){return G(()=>{let n=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;e=We(e),a==null&&(this.stateful?a=this.states_:a=this.getInitialState(e));let i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==i)throw new K(`RNN Layer has ${i} state(s) but was passed ${a.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");let s={training:r},o=_W((p,h)=>{let f=this.cell.call([p].concat(h),s);return[f[0],f.slice(1)]},e,a,this.goBackwards,n,null,this.unroll,this.returnSequences),l=o[0],c=o[1],u=o[2];this.stateful&&this.resetStates(u,r);let d=this.returnSequences?c:l;return this.returnState?[d].concat(u):d})}getInitialState(e){return G(()=>{let t=en(e.shape);return t=Te(t,[1,2]),t=ay(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(n=>n>1?pI(t,[1,n]):t):this.cell.stateSize>1?[pI(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){let e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);let n=this.cell.getConfig();return this.getClassName()===as.className&&(t.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),e),t)}static fromConfig(e,t,n={}){let r=t.cell,a=wi(r,n);return new e(Object.assign(t,{cell:a}))}};as.className="RNN";le.registerClass(as);var py=class extends tt{},B1=class extends py{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,jn(this.units,"units"),this.activation=Uo(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Kt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Kt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Kt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Xt(e.kernelRegularizer),this.recurrentRegularizer=Xt(e.recurrentRegularizer),this.biasRegularizer=Xt(e.biasRegularizer),this.kernelConstraint=On(e.kernelConstraint),this.recurrentConstraint=On(e.recurrentConstraint),this.biasConstraint=On(e.biasConstraint),this.dropout=bp([1,Wo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=bp([1,Wo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=gt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return G(()=>{if(e=e,e.length!==2)throw new K(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let n=e[1];e=e[0];let r=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=jo({ones:()=>fa(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=jo({ones:()=>fa(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let a,i=this.dropoutMask,s=this.recurrentDropoutMask;i!=null?a=Yi(j(e,i),this.kernel.read()):a=Yi(e,this.kernel.read()),this.bias!=null&&(a=Ni(a,this.bias.read())),s!=null&&(n=j(n,s));let o=re(a,Yi(n,this.recurrentKernel.read()));return this.activation!=null&&(o=this.activation.apply(o)),[o,o]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Vo(this.activation),useBias:this.useBias,kernelInitializer:tn(this.kernelInitializer),recurrentInitializer:tn(this.recurrentInitializer),biasInitializer:tn(this.biasInitializer),kernelRegularizer:Dt(this.kernelRegularizer),recurrentRegularizer:Dt(this.recurrentRegularizer),biasRegularizer:Dt(this.biasRegularizer),activityRegularizer:Dt(this.activityRegularizer),kernelConstraint:Mn(this.kernelConstraint),recurrentConstraint:Mn(this.recurrentConstraint),biasConstraint:Mn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}};B1.className="SimpleRNNCell";le.registerClass(B1);var JT=class extends as{constructor(e){e.cell=new B1(e),super(e)}call(e,t){return G(()=>{this.cell.dropoutMask!=null&&(je(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(je(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}static fromConfig(e,t){return new e(t)}};JT.className="SimpleRNN";le.registerClass(JT);var W1=class extends py{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new K("GRUCell does not support reset_after parameter set to true.");this.units=e.units,jn(this.units,"units"),this.activation=Uo(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Uo(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Kt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Kt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Kt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Xt(e.kernelRegularizer),this.recurrentRegularizer=Xt(e.recurrentRegularizer),this.biasRegularizer=Xt(e.biasRegularizer),this.kernelConstraint=On(e.kernelConstraint),this.recurrentConstraint=On(e.recurrentConstraint),this.biasConstraint=On(e.biasConstraint),this.dropout=bp([1,Wo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=bp([1,Wo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=gt(e);let t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return G(()=>{if(e=e,e.length!==2)throw new K(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);let n=t.training==null?!1:t.training,r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=jo({ones:()=>fa(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=jo({ones:()=>fa(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));let a=this.dropoutMask,i=this.recurrentDropoutMask,s,o,l;0<this.dropout&&this.dropout<1&&(e=j(e,a[0]));let c=Yi(e,this.kernel.read());this.useBias&&(c=Ni(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=j(r,i[0]));let u=this.recurrentKernel.read(),[d,p]=Wr(u,[2*this.units,this.units],u.rank-1),h=Yi(r,d),[f,m,g]=Wr(c,3,c.rank-1),[y,b]=Wr(h,2,h.rank-1);s=this.recurrentActivation.apply(re(f,y)),o=this.recurrentActivation.apply(re(m,b));let v=Yi(j(o,r),p);l=this.activation.apply(re(g,v));let x=re(j(s,r),j(re(1,Bt(s)),l));return[x,x]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Vo(this.activation),recurrentActivation:Vo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:tn(this.kernelInitializer),recurrentInitializer:tn(this.recurrentInitializer),biasInitializer:tn(this.biasInitializer),kernelRegularizer:Dt(this.kernelRegularizer),recurrentRegularizer:Dt(this.recurrentRegularizer),biasRegularizer:Dt(this.biasRegularizer),activityRegularizer:Dt(this.activityRegularizer),kernelConstraint:Mn(this.kernelConstraint),recurrentConstraint:Mn(this.recurrentConstraint),biasConstraint:Mn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}};W1.className="GRUCell";le.registerClass(W1);var eN=class extends as{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new W1(e),super(e)}call(e,t){return G(()=>{this.cell.dropoutMask!=null&&(je(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(je(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}};eN.className="GRU";le.registerClass(eN);var hy=class extends py{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,jn(this.units,"units"),this.activation=Uo(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Uo(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Kt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Kt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Kt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Xt(e.kernelRegularizer),this.recurrentRegularizer=Xt(e.recurrentRegularizer),this.biasRegularizer=Xt(e.biasRegularizer),this.kernelConstraint=On(e.kernelConstraint),this.recurrentConstraint=On(e.recurrentConstraint),this.biasConstraint=On(e.biasConstraint),this.dropout=bp([1,Wo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=bp([1,Wo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=gt(e);let n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){let a=this.biasInitializer,i=this.units;r=new(t=class extends oi{apply(s,o){let l=a.apply([i]),c=new E1().apply([i]),u=a.apply([i*2]);return BF(BF(l,c),u)}},t.className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return G(()=>{let n=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new K(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1],a=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=jo({ones:()=>fa(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=jo({ones:()=>fa(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let i=this.dropoutMask,s=this.recurrentDropoutMask,o,l,c,u;0<this.dropout&&this.dropout<1&&(e=j(e,i[0]));let d=Yi(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=j(r,s[0])),d=re(d,Yi(r,this.recurrentKernel.read())),this.useBias&&(d=Ni(d,this.bias.read()));let[p,h,f,m]=Wr(d,4,d.rank-1);o=this.recurrentActivation.apply(p),l=this.recurrentActivation.apply(h),c=re(j(l,a),j(o,this.activation.apply(f))),u=this.recurrentActivation.apply(m);let g=j(u,this.activation.apply(c));return[g,g,c]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Vo(this.activation),recurrentActivation:Vo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:tn(this.kernelInitializer),recurrentInitializer:tn(this.recurrentInitializer),biasInitializer:tn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Dt(this.kernelRegularizer),recurrentRegularizer:Dt(this.recurrentRegularizer),biasRegularizer:Dt(this.biasRegularizer),activityRegularizer:Dt(this.activityRegularizer),kernelConstraint:Mn(this.kernelConstraint),recurrentConstraint:Mn(this.recurrentConstraint),biasConstraint:Mn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}};hy.className="LSTMCell";le.registerClass(hy);var tN=class extends as{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new hy(e),super(e)}call(e,t){return G(()=>{this.cell.dropoutMask!=null&&(je(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(je(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}};tN.className="LSTM";le.registerClass(tN);var V1=class extends py{constructor(e){super(e),this.cells=e.cells}get stateSize(){let e=[];for(let t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return G(()=>{e=e;let n=e.slice(1),r=[];for(let s of this.cells.slice().reverse())Array.isArray(s.stateSize)?r.push(n.splice(0,s.stateSize.length)):r.push(n.splice(0,1));r.reverse();let a=[],i;for(let s=0;s<this.cells.length;++s){let o=this.cells[s];n=r[s],s===0?i=[e[0]].concat(n):i=[i[0]].concat(n),i=o.call(i,t),a.push(i.slice(1))}n=[];for(let s of a.slice().reverse())n.push(...s);return[i[0]].concat(n)})}build(e){fI(e)&&(e=e[0]),e=e;let t;this.cells.forEach((n,r)=>{Gl(`RNNCell_${r}`,()=>{n.build(e),Array.isArray(n.stateSize)?t=n.stateSize[0]:t=n.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){let e=super.getConfig(),t=r=>({className:r.getClassName(),config:r.getConfig()}),n={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),n)}static fromConfig(e,t,n={}){let r=[];for(let a of t.cells)r.push(wi(a,n));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];let e=[];for(let t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let n of this.cells)t.push(...n.trainableWeights);return t.concat(e)}return e}getWeights(){let e=[];for(let t of this.cells)e.push(...t.weights);return mI(e)}setWeights(e){let t=[];for(let n of this.cells){let r=n.weights.length,a=e.splice(r);for(let i=0;i<n.weights.length;++i)t.push([n.weights[i],a[i]])}_T(t)}};V1.className="StackedRNNCells";le.registerClass(V1);function jo(e){let{ones:t,rate:n,training:r=!1,count:a=1,dropoutFunc:i}=e,s=()=>i!=null?i(t(),n):zB(t(),n),o=()=>sy(s,t,r);return!a||a<=1?An(o().clone()):Array(a).fill(void 0).map(o).map(l=>An(l.clone()))}var Lme=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n},TW=class extends as{constructor(e){if(e.unroll)throw new Qe("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Qe("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new kn({ndim:5})]}call(e,t){return G(()=>{if(this.cell.dropoutMask!=null&&(je(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(je(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new K("ConvRNN2D cell does not support constants");let n=t==null?null:t.mask,r=t==null?null:t.training,a=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return G(()=>{let{stateSize:t}=this.cell,n=e.shape,r=this.computeSingleOutputShape(n),a=[r[0],...r.slice(2)],i=en(a);return Array.isArray(t)?Array(t.length).fill(i):[i]})}resetStates(e,t=!1){G(()=>{if(!this.stateful)throw new ms("Cannot call resetStates() on an RNN Layer that is not stateful.");let n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),a=[r[0],...r.slice(2)];if(n[0]==null)throw new K("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>en(a)):this.states_=[en(a)];else if(e==null)je(this.states_),this.keptStates!=null&&(je(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>en(a)):this.states_[0]=en(a);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new K(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):je(this.states_);for(let i=0;i<this.states_.length;++i){let s=e[i],o=a;if(!k.arraysEqual(s.shape,o))throw new K(`State ${i} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${s.shape}`);this.states_[i]=s}}this.states_=this.states_.map(i=>An(i.clone()))})}computeSingleOutputShape(e){let{dataFormat:t,filters:n,kernelSize:r,padding:a,strides:i,dilationRate:s}=this.cell,o=t==="channelsFirst",l=e[o?3:2],c=e[o?4:3],u=ki(l,r[0],a,i[0],s[0]),d=ki(c,r[1],a,i[1],s[1]);return[...e.slice(0,2),...o?[n,u,d]:[u,d,n]]}};TW.className="ConvRNN2D";var U1=class extends hy{constructor(e){let{filters:t,kernelSize:n,strides:r,padding:a,dataFormat:i,dilationRate:s}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,jn(this.filters,"filters"),this.kernelSize=Kd(n,2,"kernelSize"),this.kernelSize.forEach(o=>jn(o,"kernelSize")),this.strides=Kd(r||1,2,"strides"),this.strides.forEach(o=>jn(o,"strides")),this.padding=a||"valid",za(this.padding),this.dataFormat=i||"channelsLast",mn(this.dataFormat),this.dilationRate=Kd(s||1,2,"dilationRate"),this.dilationRate.forEach(o=>jn(o,"dilationRate"))}build(e){var t;e=gt(e);let n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new K(`The channel dimension of the input should be defined. Found ${e[n]}`);let r=e[n],a=4,i=this.kernelSize.concat([r,this.filters*a]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let s=this.kernelSize.concat([this.filters,this.filters*a]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",s,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let o;if(this.unitForgetBias){let l=this.biasInitializer,c=this.filters;o=new(t=class extends oi{apply(u,d){let p=l.apply([c]),h=ia([c]),f=l.apply([c*2]);return bT([p,h,f])}},t.className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*a],null,o,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return G(()=>{if(e.length!==3)throw new K(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let n=t.training||!1,r=e[0],a=e[1],i=e[2],s=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=jo({ones:()=>fa(r),rate:this.dropout,training:n,count:s,dropoutFunc:this.dropoutFunc}));let o=this.dropoutMask,l=(q,Z,X)=>!Z||!Z[X]?q:j(Z[X],q),c=l(r,o,0),u=l(r,o,1),d=l(r,o,2),p=l(r,o,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=jo({ones:()=>fa(a),rate:this.recurrentDropout,training:n,count:s,dropoutFunc:this.dropoutFunc}));let h=this.recurrentDropoutMask,f=l(a,h,0),m=l(a,h,1),g=l(a,h,2),y=l(a,h,3),b=3,[v,x,w,S]=Wr(this.kernel.read(),s,b),[C,T,E,R]=this.useBias?Wr(this.bias.read(),s):[null,null,null,null];c=this.inputConv(c,v,C,this.padding),u=this.inputConv(u,x,T,this.padding),d=this.inputConv(d,w,E,this.padding),p=this.inputConv(p,S,R,this.padding);let[$,_,D,P]=Wr(this.recurrentKernel.read(),s,b);f=this.recurrentConv(f,$),m=this.recurrentConv(m,_),g=this.recurrentConv(g,D),y=this.recurrentConv(y,P);let B=this.recurrentActivation.apply(re(c,f)),W=this.recurrentActivation.apply(re(u,m)),Y=re(j(W,i),j(B,this.activation.apply(re(d,g)))),O=j(this.recurrentActivation.apply(re(p,y)),this.activation.apply(Y));return[O,O,Y]})}getConfig(){let e=super.getConfig(),t=Lme(e,["units"]),n={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},t),n)}inputConv(e,t,n,r){let a=_r(e,t,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return n?Ni(a,n,this.dataFormat):a}recurrentConv(e,t){return _r(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}};U1.className="ConvLSTM2DCell";le.registerClass(U1);var nN=class extends TW{constructor(e){let t=new U1(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}};nN.className="ConvLSTM2D";le.registerClass(nN);var j1=class extends tt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;let t=e.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(this.noiseShape[r]==null?t[r]:this.noiseShape[r]);return n}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=We(e);if(0<this.rate&&this.rate<1){let r=t.training==null?!1:t.training,a=this.getNoiseShape(n);return sy(()=>zB(n,this.rate,a,this.seed),()=>n,r)}return e})}getConfig(){let e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}};j1.className="Dropout";le.registerClass(j1);var rN=class extends j1{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){let t=e.shape;return[t[0],1,t[2]]}};rN.className="SpatialDropout1D";le.registerClass(rN);var aN=class extends tt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,jn(this.units,"units"),this.activation=Uo(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Kt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Kt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=On(e.kernelConstraint),this.biasConstraint=On(e.biasConstraint),this.kernelRegularizer=Xt(e.kernelRegularizer),this.biasRegularizer=Xt(e.biasRegularizer),this.activityRegularizer=Xt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=gt(e);let t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=gt(e);let t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=We(e),r=AB(this.activation.getClassName()),a;return r!=null?a=Yi(n,this.kernel.read(),r,this.bias?this.bias.read():null):(a=Yi(n,this.kernel.read()),this.bias!=null&&(a=Ni(a,this.bias.read())),this.activation!=null&&(a=this.activation.apply(a))),a})}getConfig(){let e={units:this.units,activation:Vo(this.activation),useBias:this.useBias,kernelInitializer:tn(this.kernelInitializer),biasInitializer:tn(this.biasInitializer),kernelRegularizer:Dt(this.kernelRegularizer),biasRegularizer:Dt(this.biasRegularizer),activityRegularizer:Dt(this.activityRegularizer),kernelConstraint:Mn(this.kernelConstraint),biasConstraint:Mn(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}};aN.className="Dense";le.registerClass(aN);var iN=class extends tt{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=gt(e);for(let t of e.slice(1))if(t==null)throw new K(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],To(e,1)]}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=We(e);if(this.dataFormat==="channelsFirst"&&n.rank>1){let r=[0];for(let a=2;a<n.rank;++a)r.push(a);r.push(1),n=Je(n,r)}return nfe(n)})}getConfig(){let e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);let t=super.getConfig();return Object.assign(e,t),e}};iN.className="Flatten";le.registerClass(iN);var sN=class extends tt{constructor(e){super(e),this.supportsMasking=!0,this.activation=Uo(e.activation)}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=We(e);return this.activation.apply(n)})}getConfig(){let e={activation:Vo(this.activation)},t=super.getConfig();return Object.assign(e,t),e}};sN.className="Activation";le.registerClass(sN);var oN=class extends tt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return G(()=>(e=We(e),efe(e,this.n)))}getConfig(){let e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}};oN.className="RepeatVector";le.registerClass(oN);var lN=class extends tt{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){let n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null;for(let o=0;o<r.length;++o){let l=r[o];if(this.isUnknown(l))if(i===null)i=o;else throw new K("Can only specifiy one unknown dimension.");else a*=l}let s=To(e);if(i!==null){if(a===0||s%a!==0)throw new K(n);r[i]=s/a}else if(s!==a)throw new K(n);return r}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=We(e),r=n.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return H(n,a)})}getConfig(){let e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}};lN.className="Reshape";le.registerClass(lN);var uN=class extends tt{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);let t=Ii(1,e.dims.length+1);if(!k.arraysEqual(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new kn({ndim:this.dims.length+1})]}computeOutputShape(e){e=gt(e);let t=e.slice();return this.dims.forEach((n,r)=>{t[r+1]=e[n]}),t}call(e,t){return Je(We(e),this.dimsIncludingBatch)}getConfig(){let e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}};uN.className="Permute";le.registerClass(uN);var cN=class extends tt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){let n=We(e),r=-1;return jm(mu(n,this.maskValue),r)}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=We(e),r=-1,a=!0,i=jm(mu(n,this.maskValue),r,a);return j(n,he(i,n.dtype))})}};cN.className="Masking";le.registerClass(cN);var dN=class extends tt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(Vt(e.inputLength))}this.inputDim=e.inputDim,jn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,jn(this.outputDim,"outputDim"),this.embeddingsInitializer=Kt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Xt(e.embeddingsRegularizer),this.activityRegularizer=Xt(e.activityRegularizer),this.embeddingsConstraint=On(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return G(()=>this.maskZero?(e=We(e),mu(e,st(e))):null)}computeOutputShape(e){if(e=gt(e),this.inputLength==null)return[...e,this.outputDim];let t=Vt(this.inputLength);if(t.length!==e.length-1)throw new K(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let n=0;for(let r=0;r<t.length;++r){let a=t[r],i=e[r+1];if(a!=null&&i!=null&&a!==i)throw new K(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);a==null&&(t[n]=i),n++}}return[e[0],...t,this.outputDim]}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=We(e);n.dtype!=="int32"&&(n=zs(n,"int32"));let r=PB(this.embeddings.read(),H(n,[n.size]));return H(r,gt(this.computeOutputShape(n.shape)))})}getConfig(){let e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:tn(this.embeddingsInitializer),embeddingsRegularizer:Dt(this.embeddingsRegularizer),activityRegularizer:Dt(this.activityRegularizer),embeddingsConstraint:Mn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}};dN.className="Embedding";le.registerClass(dN);var td=class extends tt{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Qe}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;let n=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){let a=e[e.length-t.length+r],i=t[r];if(a==null||i==null||a<0||i<0)n.push(null);else if(a===1)n.push(i);else if(i===1)n.push(a);else{if(a!==i)throw new K("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[gt(e)]),e=e,e.length<2)throw new K(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(let a of e)a!=null&&a[0]!==null&&t.push(a[0]);if(t=_o(t),t.length>1)throw new K(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let n=e[0]==null?null:e[0].slice(1);for(let a=1;a<e.length;++a){let i=e[a]==null?null:e[a].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let r=e.map(a=>a.length);e.indexOf(null)===-1&&_o(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return G(()=>{if(e=e,this.reshapeRequired){let n=[],r=e.map(a=>a.rank);if(r.indexOf(null)===-1){let a=Wo(r);for(let i of e){let s=i.rank;for(let o=0;o<a-s;++o)i=ay(i,1);n.push(i)}return this.mergeFunction(n)}else{let a=!1;for(let o of e){let l=o.rank;if(l==null){let c=o.shape,u=c[0],d=c.slice(1).concat([u]),p=H(o,[u].concat(To(c.slice(1))));p=Je(p,[1,0]),p=H(p,d),n.push(p),a=!0}else if(l>1){let c=Ii(1,l).concat([0]);n.push(Je(o,c)),a=!0}else n.push(o)}let i=this.mergeFunction(n),s=i.rank;if(a){if(s==null){let o=i.shape,l=o.length,c=o[l-1],u=[c].concat(o.slice(0,o.length-1));i=H(Je(H(i,[-1,c]),[1,0]),u)}else if(s>1){let o=[s-1].concat(Ii(0,s-1));i=Je(i,o)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let r=1;r<e.length;++r){let a=e[r]==null?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,a)}let n=[];for(let r of e)r!=null&&r[0]!==null&&n.push(r[0]);return n=_o(n),n.length===1?t=n.concat(t):t=[null].concat(t),t}computeMask(e,t){return G(()=>{if(t==null)return null;if(!Array.isArray(t))throw new K("`mask` should be an Array");if(!Array.isArray(e))throw new K("`inputs` should be an Array");if(t.length!==e.length)throw new K(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(r=>r==null))return null;t=t.map(r=>r==null?r:Qn(r,0));let n=t[0];for(let r=1;r<t.length-1;++r)n=ri(n,t[r]);return n})}},pN=class extends td{constructor(e){super(e)}mergeFunction(e){return G(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=re(t,e[n]);return t})}};pN.className="Add";le.registerClass(pN);var hN=class extends td{constructor(e){super(e)}mergeFunction(e){return G(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=j(t,e[n]);return t})}};hN.className="Multiply";le.registerClass(hN);var fN=class extends td{constructor(e){super(e)}mergeFunction(e){return G(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=re(t,e[n]);return j(1/e.length,t)})}};fN.className="Average";le.registerClass(fN);var mN=class extends td{constructor(e){super(e)}mergeFunction(e){return G(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=ns(t,e[n]);return t})}};mN.className="Maximum";le.registerClass(mN);var gN=class extends td{constructor(e){super(e)}mergeFunction(e){return G(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=Lo(t,e[n]);return t})}};gN.className="Minimum";le.registerClass(gN);var yN=class extends td{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new K("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(let r of e)if(r!=null){t=!1;break}if(t)return;let n=[];for(let r=0;r<e.length;++r){let a=e[r].slice();a.splice(this.axis,1);let i=!1;for(let s of n)if(k.arraysEqual(s,a)){i=!0;break}i||n.push(a)}if(n.length>1)throw new K("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return G(()=>bT(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new K("A `Concatenate` layer should be called on a list of inputs.");let t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(let a of t.slice(1)){if(n[r]==null||a[r]==null){n[r]=null;break}n[r]+=a[r]}return n}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new K("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new K("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new K(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return G(()=>{let n=!0;if(t.forEach(i=>{if(i!=null){n=!1;return}}),n)return null;let r=[];for(let i=0;i<e.length;++i)t[i]==null?r.push(he(fa(e[i]),"bool")):t[i].rank<e[i].rank?r.push(Qn(t[i],-1)):r.push(t[i]);let a=Et(r,this.axis);return Xx(a,-1,!1)})}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};yN.className="Concatenate";le.registerClass(yN);function wf(e,t){for(;e<0;)e+=t;return e}function Bme(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new Qe("batchDot is not implemented for tensors of 4D or higher rank yet");if(k.assert(e.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`),k.assert(e.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new Qe("batchDot is not implemented for complex64-type Tensors yet.");let r=e.shape.length,a=t.shape.length;n==null&&(n=[r-1,a-2]);let i=n;return G(()=>{let s;if(r>a){s=r-a;let l=[];for(let c=0;c<s;++c)l.push(1);t=H(t,t.shape.concat(l))}else if(a>r){s=a-r;let l=[];for(let c=0;c<s;++c)l.push(1);e=H(e,e.shape.concat(l))}else s=0;let o;if(e.shape.length===2&&t.shape.length===2)i[0]===i[1]?o=Te(j(e,t),i[0]):o=Te(j(Je(e,[1,0]),t),i[1]);else{let l=i[0]!==e.shape.length-1,c=i[1]===t.shape.length-1;o=Ye(e,t,l,c)}if(s>0){let l;r>a?l=r+a-3:l=r-1;let c=[];for(let u=l;u<l+s;++u)c.push(u);o=ol(o,c)}return o.shape.length===1&&(o=Qn(o,1)),o})}var bN=class extends td{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){k.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0],n=e[1];if(t.length>3||n.length>3)throw new Qe("Dot layer does not support tensors of 4D or higher rank yet.");let r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new K(`Dimension incompatibility: ${t[r[0]]} !== ${n[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new K(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],n=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((a,i)=>wf(a,e[i].shape.length)):r=[wf(this.axes,t.shape.length),wf(this.axes,n.shape.length)],this.normalize&&(t=lv(t,r[0]),n=lv(n,r[1])),Bme(t,n,r)}interpretAxes(e,t){let n;return Array.isArray(this.axes)?n=this.axes:n=[wf(this.axes,e.length),wf(this.axes,t.length)],n}computeOutputShape(e){k.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new Qe("Dot layer does not support tensors of 4D or higher rank yet.");let r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);let a=t.concat(n);return a.length===1&&a.push(1),a}computeMask(e,t){return null}getConfig(){let e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}};bN.className="Dot";le.registerClass(bN);var vN=class extends tt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=We(e);return sy(()=>re(N1(n.shape,0,this.stddev),n),()=>n,t.training||!1)})}};vN.className="GaussianNoise";le.registerClass(vN);var xN=class extends tt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=We(e);return this.rate>0&&this.rate<1?sy(()=>{let r=Math.sqrt(this.rate/(1-this.rate));return j(n,N1(n.shape,1,r))},()=>n,t.training||!1):n})}};xN.className="GaussianDropout";le.registerClass(xN);var wN=class extends tt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||We(e).shape}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return G(()=>{if(this.rate<1&&this.rate>0){let n=this._getNoiseShape(e);return sy(()=>{let r=We(e),a=1.6732632423543772,i=1.0507009873554805,s=-a*i,o=Us(il(n),this.rate);o=zs(o,"float32");let l=((1-this.rate)*(1+this.rate*s**2))**-.5,c=-l*s*this.rate,u=re(j(r,o),j(re(o,-1),s));return re(j(u,l),c)},()=>We(e),t.training||!1)}return e})}};wN.className="AlphaDropout";le.registerClass(wN);function Ym(e,t,n,r,a,i=.001){let s;if(e.rank===2)s=u_(e,t,n,r,a,i);else if(e.rank===3)s=c_(e,t,n,r,a,i);else if(e.rank===4)s=d_(e,t,n,r,a,i);else throw new Qe(`batchNormalization is not implemented for array of rank ${e.rank} yet`);return s}function Wme(e,t,n,r,a=.001){return G(()=>{let i=Yg(e,r),s=i.mean,o=i.variance;return[Ym(e,s,o,n,t,a),s,o]})}function Vme(e,t,n,r,a=.001){return G(()=>{let i=Yg(e,r),s=i.mean,o=i.variance,l=[];for(let h of Ii(0,e.rank))r.indexOf(h)!==-1?l.push(1):l.push(e.shape[h]);let c=H(s,l),u=H(o,l),d=t==null?null:H(t,l),p=n==null?null:H(n,l);return[Ym(e,c,u,p,d,a),s,o]})}function Ume(e,t,n,r,a=.001){return k.arraysEqual(r.slice().sort(),Ii(0,e.rank-1))?Wme(e,t,n,r,a):Vme(e,t,n,r,a)}var kN=class extends tt{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Kt(e.betaInitializer||"zeros"),this.gammaInitializer=Kt(e.gammaInitializer||"ones"),this.movingMeanInitializer=Kt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Kt(e.movingVarianceInitializer||"ones"),this.betaConstraint=On(e.betaConstraint),this.gammaConstraint=On(e.gammaConstraint),this.betaRegularizer=Xt(e.betaRegularizer),this.gammaRegularizer=Xt(e.gammaRegularizer)}build(e){e=gt(e);let t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(n==null)throw new K(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new kn({ndim:e.length,axes:{[t]:n}})];let r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return G(()=>{let n=t.training==null?!1:t.training,r=We(e),a=r.shape,i=a.length,s=Ii(0,i),o=this.axis>=0?this.axis:this.axis+i;s.splice(o,1);let l=yu(1,i);l[o]=a[o];let c=s.slice();c.sort();let u=!k.arraysEqual(c,Ii(0,i).slice(0,i-1)),d=()=>{if(u){let g=H(this.movingMean.read(),l),y=H(this.movingVariance.read(),l),b=this.center?H(this.beta.read(),l):null,v=this.scale?H(this.gamma.read(),l):null;return Ym(r,g,y,b,v,this.epsilon)}else return Ym(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!n)return d();let[p,h,f]=Ume(r,this.gamma.read(),this.beta.read(),s,this.epsilon),m=(g,y,b)=>{G(()=>{let v=1-b,x=g.read(),w=j(we(x,y),v);g.write(we(x,w))})};return m(this.movingMean,h,this.momentum),m(this.movingVariance,f,this.momentum),p})}getConfig(){let e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:tn(this.betaInitializer),gammaInitializer:tn(this.gammaInitializer),movingMeanInitializer:tn(this.movingMeanInitializer),movingVarianceInitializer:tn(this.movingVarianceInitializer),betaRegularizer:Dt(this.betaRegularizer),gammaRegularizer:Dt(this.gammaRegularizer),betaConstraint:Mn(this.betaConstraint),gammaConstraint:Mn(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}};kN.className="BatchNormalization";le.registerClass(kN);var SN=class extends tt{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(let t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Kt(e.betaInitializer||"zeros"),this.gammaInitializer=Kt(e.gammaInitializer||"ones"),this.betaRegularizer=Xt(e.betaRegularizer),this.gammaRegularizer=Xt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=gt(e);let t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=t);for(let a of this.axis)if(a<0||a>=t)throw new Error(`Invalid axis: ${a}`);if(this.axis.length!==_o(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);let n=this.axis.map(a=>e[a]),r=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){let n=We(e),r=n.shape,a=r.length;return G(()=>{let{mean:i,variance:s}=Yg(n,this.axis,!0),o=yu(1,a);for(let h of this.axis)o[h]=r[h];let l=h=>h!=null&&h.shape.length!==a?H(h,o):h,c=this.scale?l(this.gamma.read()):null,u=this.center?l(this.beta.read()):null,d=[],p=[];for(let h=0;h<a;++h)this.axis.indexOf(h)!==-1?(d.push(r[h]),p.push(1)):(d.push(1),p.push(r[h]));return i=aa(i,d),s=aa(s,d),c!=null&&(c=aa(c,p)),u!=null&&(u=aa(u,p)),Ym(n,i,s,u,c,this.epsilon)})}getConfig(){let e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:tn(this.betaInitializer),gammaInitializer:tn(this.gammaInitializer),betaRegularizer:Dt(this.betaRegularizer),gammaRegularizer:Dt(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}};SN.className="LayerNormalization";le.registerClass(SN);function jme(e,t,n){return G(()=>{if(e.rank!==4)throw new K(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new K("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Ci()),n!=="channelsLast"&&n!=="channelsFirst")throw new K(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],t[0],t[1]]:r=[[0,0],t[0],t[1],[0,0]],Ti(e,r)})}var IN=class extends tt{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Ci():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new K(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,n;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new K(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new K(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new kn({ndim:4})]}computeOutputShape(e){e=gt(e);let t,n;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?n=e[3]+this.padding[1][0]+this.padding[1][1]:n=null,[e[0],e[1],t,n]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?n=e[2]+this.padding[1][0]+this.padding[1][1]:n=null,[e[0],t,n,e[3]])}call(e,t){return G(()=>jme(We(e),this.padding,this.dataFormat))}getConfig(){let e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};IN.className="ZeroPadding2D";le.registerClass(IN);function H1(e,t,n,r,a,i){return G(()=>{mn(a),FB(i),za(r),n==null&&(n=[1,1]),r==null&&(r="valid"),a==null&&(a=Ci()),i==null&&(i="max"),e=HT(e,a);let s,o=r==="same"?"same":"valid";return i==="max"?s=Ln(e,t,n,o):s=Vs(e,t,n,o),a==="channelsFirst"&&(s=Je(s,[0,3,1,2])),s})}function NW(e,t,n,r,a,i){return G(()=>{mn(a),FB(i),za(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),a==null&&(a=Ci()),i==null&&(i="max"),e=SW(e,a);let s,o=r==="same"?"same":"valid";return i==="max"?s=O_(e,t,n,o):s=l_(e,t,n,o),a==="channelsFirst"&&(s=Je(s,[0,4,1,2,3])),s})}var EW=class extends tt{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new K(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(jn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new K(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);jn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,za(this.padding),this.inputSpec=[new kn({ndim:3})]}computeOutputShape(e){e=gt(e);let t=ki(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return G(()=>{this.invokeCallHook(e,t),e=ay(We(e),2);let n=this.poolingFunction(We(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return ol(n,[2])})}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}},CN=class extends EW{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return mn(a),za(r),H1(e,t,n,r,a,"max")}};CN.className="MaxPooling1D";le.registerClass(CN);var _N=class extends EW{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return mn(a),za(r),H1(e,t,n,r,a,"avg")}};_N.className="AveragePooling1D";le.registerClass(_N);var $W=class extends tt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new K(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];jn(this.poolSize,"poolSize"),jn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,mn(this.dataFormat),za(this.padding),this.inputSpec=[new kn({ndim:4})]}computeOutputShape(e){e=gt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=ki(t,this.poolSize[0],this.padding,this.strides[0]),n=ki(n,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return G(()=>(this.invokeCallHook(e,t),this.poolingFunction(We(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},TN=class extends $W{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return mn(a),za(r),H1(e,t,n,r,a,"max")}};TN.className="MaxPooling2D";le.registerClass(TN);var NN=class extends $W{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return mn(a),za(r),H1(e,t,n,r,a,"avg")}};NN.className="AveragePooling2D";le.registerClass(NN);var AW=class extends tt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new K(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];jn(this.poolSize,"poolSize"),jn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,mn(this.dataFormat),za(this.padding),this.inputSpec=[new kn({ndim:5})]}computeOutputShape(e){e=gt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],n=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=ki(t,this.poolSize[0],this.padding,this.strides[0]),n=ki(n,this.poolSize[1],this.padding,this.strides[1]),r=ki(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}call(e,t){return G(()=>(this.invokeCallHook(e,t),this.poolingFunction(We(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},EN=class extends AW{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return mn(a),za(r),NW(e,t,n,r,a,"max")}};EN.className="MaxPooling3D";le.registerClass(EN);var $N=class extends AW{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return mn(a),za(r),NW(e,t,n,r,a,"avg")}};$N.className="AveragePooling3D";le.registerClass($N);var RW=class extends tt{constructor(e){super(e),this.inputSpec=[new kn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new Qe}},AN=class extends RW{constructor(e){super(e||{})}call(e,t){return G(()=>{let n=We(e);return Jt(n,1)})}};AN.className="GlobalAveragePooling1D";le.registerClass(AN);var RN=class extends RW{constructor(e){super(e||{})}call(e,t){return G(()=>{let n=We(e);return $a(n,1)})}};RN.className="GlobalMaxPooling1D";le.registerClass(RN);var FW=class extends tt{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,mn(this.dataFormat),this.inputSpec=[new kn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new Qe}getConfig(){let e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},FN=class extends FW{call(e,t){return G(()=>{let n=We(e);return this.dataFormat==="channelsLast"?Jt(n,[1,2]):Jt(n,[2,3])})}};FN.className="GlobalAveragePooling2D";le.registerClass(FN);var DN=class extends FW{call(e,t){return G(()=>{let n=We(e);return this.dataFormat==="channelsLast"?$a(n,[1,2]):$a(n,[2,3])})}};DN.className="GlobalMaxPooling2D";le.registerClass(DN);var DW=class extends tt{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){let e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,n={}){let r=t.layer,a=wi(r,n);delete t.layer;let i={layer:a};return Object.assign(i,t),new e(i)}},MN=class extends DW{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=gt(e),e.length<3)throw new K(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];let t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=gt(e);let t=[e[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}call(e,t){return G(()=>(e=We(e),_W((n,r)=>[We(this.layer.call(n,t)),[]],e,[],!1,null,null,!1,!0)[1]))}};MN.className="TimeDistributed";le.registerClass(MN);function Hme(e){Jc(Xhe,"BidirectionalMergeMode",e)}var Gme="concat",ON=class extends DW{constructor(e){super(e);let t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=wi(n),t.goBackwards=t.goBackwards!==!0;let r={};if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=wi(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?Gme:e.mergeMode,Hme(this.mergeMode),e.weights)throw new Qe("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){let t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let n,r,a;return this.returnState&&(a=t.slice(1)),n=t[0],n=n,this.mergeMode==="concat"?(n[n.length-1]*=2,r=[n]):this.mergeMode==null?r=[n,n.slice()]:r=[n],this.returnState?this.mergeMode==null?r.concat(a).concat(a.slice()):[n].concat(a).concat(a.slice()):Lr(r)}apply(e,t){let n=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});let a=CW(e,n,r,this.numConstants);if(e=a.inputs,n=a.initialState,r=a.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(n==null||n.length===0)&&r==null)return super.apply(e,t);let i=[],s=[];if(n!=null){let l=n.length;if(l%2>0)throw new K("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,i.push(...n);let c=n.map(u=>new kn({shape:u.shape}));this.forwardLayer.stateSpec=c.slice(0,l/2),this.backwardLayer.stateSpec=c.slice(l/2),s.push(...c)}if(r!=null)throw new Qe("Support for constants in Bidirectional layers is not implemented yet.");let o=i[0]instanceof yi;for(let l of i)if(l instanceof yi!==o)throw new K("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(o){let l=[e].concat(i),c=this.inputSpec.concat(s),u=this.inputSpec;this.inputSpec=c;let d=super.apply(l,t);return this.inputSpec=u,d}else return super.apply(e,t)}call(e,t){return G(()=>{let n=t.initialState,r,a;if(n==null)r=this.forwardLayer.call(e,t),a=this.backwardLayer.call(e,t);else{let o=n.slice(0,n.length/2),l=n.slice(n.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:o})),a=this.backwardLayer.call(e,Object.assign(t,{initialState:l}))}let i;this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),this.returnSequences&&(a=Da(a,1));let s;return this.mergeMode==="concat"?s=bT([r,a]):this.mergeMode==="sum"?s=re(r,a):this.mergeMode==="ave"?s=j(.5,re(r,a)):this.mergeMode==="mul"?s=j(r,a):this.mergeMode==null&&(s=[r,a]),this.returnState?this.mergeMode==null?s.concat(i):[s].concat(i):s})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Gl(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Gl(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let n;if(this.returnSequences?this.mergeMode==null?n=[t,t]:n=t:this.mergeMode==null?n=[null,null]:n=null,this.returnState){let r=this.forwardLayer.states.map(a=>null);return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}else return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){let e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){let n=wi(t.layer);if(delete t.layer,t.numConstants!=null)throw new Qe("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");let r=t;return r.layer=n,new e(r)}};ON.className="Bidirectional";le.registerClass(ON);var PN=class extends tt{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){let e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return G(()=>(e=We(e),e.dtype!=="float32"&&(e=zs(e,"float32")),re(j(e,this.scale),this.offset)))}};PN.className="Rescaling";le.registerClass(PN);var{resizeBilinear:qme,cropAndResize:Kme}=Ia,zN=class extends tt{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,r,a,i,s,o){return G(()=>{let l,c=!1,u=t/i,d=n/s,p=(r+t)/i,h=(a+n)/s,f=[u,d,p,h],m=[];e.rank===3?(c=!0,l=Fn([e])):l=e;for(let v=0;v<l.shape[0];v++)m.push(f);let g=Ir(m,[m.length,4]),y=gu(0,m.length,1,"int32"),b=Kme(l,g,y,[r,a],"nearest");return zs(c?We(dn(b)):b,o)})}upsize(e,t,n,r){return G(()=>{let a=qme(e,[t,n]);return zs(a,r)})}call(e,t){return G(()=>{let n=We(e),r=n.dtype,a=n.shape,i=a[a.length-3],s=a[a.length-2],o=0;i!==this.height&&(o=Math.floor((i-this.height)/2));let l=0;return s!==this.width&&(l=Math.floor((s-this.width)/2),l===0&&(l=1)),o>=0&&l>=0?this.centerCrop(n,o,l,this.height,this.width,i,s,r):this.upsize(e,this.height,this.width,r)})}getConfig(){let e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=gt(e);let t=e.length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}};zN.className="CenterCrop";le.registerClass(zN);function Xme(e,t,n,r){let a=We(e);if(a.dtype!=="int32"&&(a=zs(a,"int32")),t==="int")return a;let i=a.shape;if(a.rank===0&&(a=Qn(a,-1)),t==="oneHot"&&a.shape[a.shape.length-1]!==1&&(a=Qn(a,-1)),a.rank>2)throw new K(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${i} which would result in output rank ${a.rank}.`);let s=["multiHot","oneHot"].includes(t),o=a,l;if(typeof r<"u"&&t==="count"?l=rv(o,r,n,s):l=rv(o,[],n,s),t!=="tfIdf")return l;if(r)return j(l,r);throw new K("When outputMode is 'tfIdf', weights must be provided.")}var LN=class extends tt{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){let e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=gt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return G(()=>{e=We(e),e.dtype!=="int32"&&(e=zs(e,"int32"));let n;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new K(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);n=We(t.countWeights)}let r=$a(e),a=cp(e),i=Rr(this.numTokens,r).bufferSync().get(0),s=Us(a,0).bufferSync().get(0);if(!(i&&s))throw new K(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return Xme(e,this.outputMode,this.numTokens,n)})}};LN.className="CategoryEncoding";le.registerClass(LN);var Yme=["bilinear","nearest"],rD=new Set(Yme),BN=class extends tt{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(rD.has(e.interpolation))this.interpolation=e.interpolation;else throw new K(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=gt(e);let t=e[2];return[this.height,this.width,t]}getConfig(){let e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return G(()=>{let n=[this.height,this.width];if(this.interpolation==="bilinear")return Ia.resizeBilinear(e,n,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Ia.resizeNearestNeighbor(e,n,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...rD]} are supported`)})}};BN.className="Resizing";le.registerClass(BN);var MW=class{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}};MW.className="RandomSeed";var OW=class extends tt{constructor(e){super(e),this.randomGenerator=new MW(e.seed)}getConfig(){let e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}};OW.className="BaseRandomLayer";var Zme=["bilinear","nearest"],aD=new Set(Zme),WN=class extends OW{constructor(e){super(e);let{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new K(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new K(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new K(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(n)if(aD.has(n))this.interpolation=n;else throw new K(`Invalid interpolation parameter: ${n} is not implemented`)}getConfig(){let e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=gt(e);let t=e[2];return[this.imgHeight,-1,t]}call(e,t){return G(()=>{let n=We(e);this.imgHeight=n.shape[n.shape.length-3];let r=n.shape[n.shape.length-2];this.widthFactor=il([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*r;a=Math.round(a);let i=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return Ia.resizeBilinear(e,i);case"nearest":return Ia.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...aD]} are supported`)}})}};WN.className="RandomWidth";le.registerClass(WN);function Qme(e){return new Hh(e)}function Jme(e){return new VT(e)}function ege(e){return new LT(e)}function tge(e){return new BT(e)}function nge(e){return new WT(e)}function rge(e){return new jT(e)}function age(e){return new UT(e)}function ige(e){return new L1(e)}function sge(e){return new cy(e)}function oge(e){return new qT(e)}function lge(e){return new dy(e)}function uge(e){return new KT(e)}function cge(e){return new XT(e)}function dge(e){return new YT(e)}function pge(e){return new ZT(e)}function hge(e){return new QT(e)}function fge(e){return new sN(e)}function mge(e){return new aN(e)}function gge(e){return new j1(e)}function yge(e){return new rN(e)}function bge(e){return new iN(e)}function vge(e){return new oN(e)}function xge(e){return new lN(e)}function wge(e){return new uN(e)}function kge(e){return new dN(e)}function Sge(e){return new pN(e)}function Ige(e){return new fN(e)}function Cge(e){return new yN(e)}function _ge(e){return new mN(e)}function Tge(e){return new gN(e)}function Nge(e){return new hN(e)}function Ege(e){return new bN(e)}function $ge(e){return new kN(e)}function Age(e){return new SN(e)}function Rge(e){return new IN(e)}function VN(e){return new _N(e)}function Fge(e){return VN(e)}function Dge(e){return VN(e)}function UN(e){return new NN(e)}function Mge(e){return UN(e)}function Oge(e){return UN(e)}function jN(e){return new $N(e)}function Pge(e){return jN(e)}function zge(e){return jN(e)}function Lge(e){return new AN(e)}function Bge(e){return new FN(e)}function PW(e){return new RN(e)}function zW(e){return new DN(e)}function LW(e){return new CN(e)}function BW(e){return new TN(e)}function Wge(e){return new EN(e)}function Vge(e){return new eN(e)}function Uge(e){return new W1(e)}function jge(e){return new tN(e)}function Hge(e){return new hy(e)}function Gge(e){return new JT(e)}function qge(e){return new B1(e)}function Kge(e){return new nN(e)}function Xge(e){return new U1(e)}function Yge(e){return new as(e)}function Zge(e){return new V1(e)}function Qge(e){return new ON(e)}function Jge(e){return new MN(e)}var eye=PW,tye=zW,nye=LW,rye=BW;function aye(e){return new vN(e)}function iye(e){return new xN(e)}function sye(e){return new wN(e)}function oye(e){return new cN(e)}function lye(e){return new PN(e)}function uye(e){return new zN(e)}function cye(e){return new BN(e)}function dye(e){return new LN(e)}function pye(e){return new WN(e)}var WW={};He(WW,{MAPE:()=>Sye,MSE:()=>_ye,binaryAccuracy:()=>hye,binaryCrossentropy:()=>fye,categoricalAccuracy:()=>gye,categoricalCrossentropy:()=>yye,cosineProximity:()=>xye,mape:()=>Iye,meanAbsoluteError:()=>wye,meanAbsolutePercentageError:()=>kye,meanSquaredError:()=>Cye,mse:()=>Tye,precision:()=>bye,recall:()=>vye,sparseCategoricalAccuracy:()=>mye});function hye(e,t){return FT(e,t)}function fye(e,t){return JB(e,t)}function mye(e,t){return eW(e,t)}function gye(e,t){return DT(e,t)}function yye(e,t){return MT(e,t)}function bye(e,t){return QB(e,t)}function vye(e,t){return Jfe(e,t)}function xye(e,t){return RT(e,t)}function wye(e,t){return P1(e,t)}function kye(e,t){return Gh(e,t)}function Sye(e,t){return Gh(e,t)}function Iye(e,t){return Gh(e,t)}function Cye(e,t){return ed(e,t)}function _ye(e,t){return ed(e,t)}function Tye(e,t){return ed(e,t)}var VW={};He(VW,{modelFromJSON:()=>Tme});var UW={};He(UW,{l1:()=>Eye,l1l2:()=>Nye,l2:()=>$ye});function Nye(e){return new ly(e)}function Eye(e){return Dme(e)}function $ye(e){return Mme(e)}var jW=class extends vp{constructor(){super(...arguments),this.model=null}setModel(e){if(!(e instanceof Ns))throw new Error("model must be a LayersModel, not some other Container");this.model=e}};function b0(e,t){return e<t}function iD(e,t){return e>t}var HW=class extends jW{constructor(e){if(super(),e==null&&(e={}),e.restoreBestWeights)throw new Qe("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=e.monitor||"val_loss",this.minDelta=Math.abs(e.minDelta||0),this.patience=e.patience||0,this.verbose=e.verbose||0,this.mode=e.mode||"auto",this.baseline=e.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=b0:this.mode==="max"?this.monitorFunc=iD:this.monitor.indexOf("acc")!==-1?this.monitorFunc=iD:this.monitorFunc=b0,this.monitorFunc===b0&&(this.minDelta*=-1)}async onTrainBegin(e){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===b0?1/0:-1/0}async onEpochEnd(e,t){await Js(t);let n=this.getMonitorValue(t);n!=null&&(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)))}async onTrainEnd(e){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(e){e==null&&(e={});let t=e[this.monitor];return t==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(e)}`),t}};function Aye(e){return new HW(e)}var Rye={earlyStopping:Aye},Fye=Q();Fye.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});var ja;(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"})(ja||(ja={}));var sD;(function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(sD||(sD={}));var HN={};function Dye(e,t){let n={tfOpName:e,category:"custom",inputs:[],attrs:[],customExecutor:t};HN[e]=n}function GW(e){return HN[e]}function Mye(e){delete HN[e]}function I(e,t,n,r,a){let i=t.inputParams[e];if(i&&i.inputIndexStart!==void 0){let o=i.inputIndexStart,l=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?o+1:i.inputIndexEnd,c=o<0?t.inputNames.length+o:o;if(i.type==="tensor")return Jn(t.inputNames[c],n,r,a);if(i.type==="tensors"){let p=t.inputs.slice(o,l);return t.inputNames.slice(o,l).filter((h,f)=>{var m;return((m=p[f])===null||m===void 0?void 0:m.op)!=="NoOp"}).map(h=>Jn(h,n,r,a))}let u=Jn(t.inputNames[c],n,r,a),d=u.dataSync();return i.type==="number"?d[0]:k.toNestedArray(u.shape,d)}let s=t.attrParams[e];return s&&s.value}function Jn(e,t,n,r){let[a,i]=Jr(e,n);if(r!=null){let o=r.getHashTableHandleByName(a);if(o!=null)return o}let s=n.currentContextIds.find(o=>!!t[hv(a,o)]);return s!==void 0?t[hv(a,s)][i]:void 0}function oD(e,t,n){return t[hv(e,n.currentContextId)]}function ys(e,t){let[n,r,a]=Jr(e,t);return[hv(n,t&&t.currentContextId),r,a]}function hv(e,t){return t?`${e}-${t}`:e}function Jr(e,t){if(e==="")return["",0,void 0];let n=t!=null&&t.parseNodeNameCache!=null;if(n){let i=t.parseNodeNameCache.get(e);if(i!=null)return i}let r=e.split(":"),a;if(r.length===1)a=[e,0,void 0];else{let i=r[0],s=r.length===3?r[1]:void 0,o=Number(r[r.length-1]);a=[i,o,s]}return n&&t.parseNodeNameCache.set(e,a),a}function eb(e,t,n){let r=I("pad",e,t,n);if(r==="explicit"){r=I("explicitPaddings",e,t,n);let a=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)a[i][0]=r[i*2],a[i][1]=r[i*2+1];return a}return r}function bs(e){return e.kept?e:Ki(e)}var qW={};He(qW,{json:()=>Oye});var Oye=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],KW={};He(KW,{json:()=>Pye});var Pye=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],XW={};He(XW,{json:()=>zye});var zye=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],YW={};He(YW,{json:()=>Lye});var Lye=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],ZW={};He(ZW,{json:()=>Bye});var Bye=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],QW={};He(QW,{json:()=>Wye});var Wye=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],JW={};He(JW,{json:()=>Vye});var Vye=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],eV={};He(eV,{json:()=>Uye});var Uye=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],tV={};He(tV,{json:()=>jye});var jye=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],nV={};He(nV,{json:()=>Hye});var Hye=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],rV={};He(rV,{json:()=>Gye});var Gye=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],aV={};He(aV,{json:()=>qye});var qye=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],iV={};He(iV,{json:()=>Kye});var Kye=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],sV={};He(sV,{json:()=>Xye});var Xye=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],oV={};He(oV,{json:()=>Yye});var Yye=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],lV={};He(lV,{json:()=>Zye});var Zye=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],uV={};He(uV,{json:()=>Qye});var Qye=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],cV={};He(cV,{json:()=>Jye});var Jye=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],dV={};He(dV,{json:()=>e0e});var e0e=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],lD=class{static get Instance(){return this._instance||(this._instance=new this)}constructor(){let e=[qW,KW,XW,YW,ZW,QW,JW,eV,tV,nV,rV,aV,iV,sV,oV,lV,uV,cV,dV],t=[].concat(...e.map(n=>n.json));this.opMappers=t.reduce((n,r)=>(n[r.tfOpName]=r,n),{})}transformGraph(e,t={}){let n=e.node,r=[],a=[],i=[],s=n.reduce((f,m)=>(f[m.name]=this.mapNode(m),m.op.startsWith("Placeholder")?r.push(f[m.name]):m.op==="Const"?a.push(f[m.name]):(m.input==null||m.input.length===0)&&i.push(f[m.name]),f),{}),o=[],l=[],c={},u={};t!=null&&(c=this.mapSignatureEntries(t.inputs),u=this.mapSignatureEntries(t.outputs));let d=Object.keys(s);d.forEach(f=>{let m=s[f];m.inputNames.forEach((g,y)=>{let[b,,v]=ys(g),x=s[b];if(x.outputs!=null){let w=x.outputs.indexOf(v);if(w!==-1){let S=`${b}:${w}`;m.inputNames[y]=S}}m.inputs.push(x),x.children.push(m)})}),Object.keys(u).length===0?d.forEach(f=>{let m=s[f];m.children.length===0&&l.push(m)}):Object.keys(u).forEach(f=>{let[m]=ys(f),g=s[m];g!=null&&(g.signatureKey=u[f],l.push(g))}),Object.keys(c).length>0?Object.keys(c).forEach(f=>{let[m]=ys(f),g=s[m];g&&(g.signatureKey=c[f],o.push(g))}):o=r;let p={};e.library!=null&&e.library.function!=null&&(p=e.library.function.reduce((f,m)=>(f[m.signature.name]=this.mapFunction(m),f),{}));let h={nodes:s,inputs:o,outputs:l,weights:a,placeholders:r,signature:t,functions:p};return i.length>0&&(h.initNodes=i),h}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,n)=>(t[e[n].name]=n,t),{})}mapNode(e){let t=GW(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});let n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(n.inputParams=t.inputs.reduce((r,a)=>(r[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},r),{})),t.attrs!=null&&(n.attrParams=t.attrs.reduce((r,a)=>{let i=a.type,s;switch(a.type){case"string":s=xI(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=xI(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":s=TI(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=TI(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":s=kI(e.attr,a.tfName,a.defaultValue||0),s===void 0&&a.tfDeprecatedName&&(s=kI(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":s=_I(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=_I(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":s=wI(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=wI(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":s=EI(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=EI(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":s=CI(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=CI(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":s=NI(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=NI(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":s=SI(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=SI(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":s=II(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=II(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":s=uD(e.attr,a.tfName,a.defaultValue),s===void 0&&a.tfDeprecatedName&&(s=uD(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${a.type} for op: ${e.op}`)}return r[a.name]={value:s,type:i},r},{})),n}mapFunction(e){let t=e.nodeDef,n=[],r=[],a={};t!=null&&(a=t.reduce((c,u)=>(c[u.name]=this.mapNode(u),u.op==="Const"&&r.push(c[u.name]),c),{}));let i=[],s=[];e.signature.inputArg.forEach(c=>{let[u]=ys(c.name),d={name:u,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:GN(c.type),type:"dtype"}},children:[]};d.signatureKey=c.name,i.push(d),a[u]=d}),Object.keys(a).forEach(c=>{let u=a[c];u.inputNames.forEach((d,p)=>{let[h,,f]=ys(d),m=a[h];if(m.outputs!=null){let g=m.outputs.indexOf(f);if(g!==-1){let y=`${h}:${g}`;u.inputNames[p]=y}}u.inputs.push(m),m.children.push(u)})});let o=e.ret;e.signature.outputArg.forEach(c=>{let[u,d]=ys(o[c.name]),p=a[u];p!=null&&(p.defaultOutput=d,s.push(p))});let l=this.mapArgsToSignature(e);return{nodes:a,inputs:i,outputs:s,weights:r,placeholders:n,signature:l}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n),t),{}),outputs:e.signature.outputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t),{})}}mapArgToTensorInfo(e,t){let n=e.name;return t!=null&&(n=t[n]),{name:n,dtype:e.type}}};function t0e(e){let t=Q().global;if(typeof t.atob<"u")return t.atob(e);if(typeof Buffer<"u")return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function pV(e,t){let n=Array.isArray(e)?String.fromCharCode.apply(null,e):t0e(e);return t?n:n.toLowerCase()}function xI(e,t,n,r=!1){let a=e[t];return a!=null?pV(a.s,r):n}function wI(e,t,n){let r=e[t];return r?r.b:n}function kI(e,t,n){let r=e[t]||{},a=r.i!=null?r.i:r.f!=null?r.f:n;return typeof a=="number"?a:parseInt(a,10)}function GN(e){switch(typeof e=="string"&&(e=ja[e]),e){case ja.DT_FLOAT:case ja.DT_HALF:return"float32";case ja.DT_INT32:case ja.DT_INT64:case ja.DT_INT8:case ja.DT_UINT8:return"int32";case ja.DT_BOOL:return"bool";case ja.DT_DOUBLE:return"float32";case ja.DT_STRING:return"string";default:return null}}function uD(e,t,n){let r=e[t];return r&&r.func?r.func.name:n}function SI(e,t,n){let r=e[t];return r&&r.type?GN(r.type):n}function II(e,t,n){let r=e[t];return r&&r.list&&r.list.type?r.list.type.map(a=>GN(a)):n}function hV(e){if(!e.unknownRank)return e.dim!=null?e.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function CI(e,t,n){let r=e[t];return r&&r.shape?hV(r.shape):n}function _I(e,t,n){let r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(a=>typeof a=="number"?a:parseInt(a,10)):n}function TI(e,t,n,r=!1){let a=e[t];return a&&a.list&&a.list.s?a.list.s.map(i=>pV(i,r)):n}function NI(e,t,n){let r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map(a=>hV(a)):n}function EI(e,t,n){let r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var n0e=class{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,a)=>(r[a]=this.getAttr(a),r),{}))}getInput(e){return Jn(e,this.tensorMap,this.context)}getAttr(e,t){let n=this.node.rawAttrs[e];if(n.tensor!=null)return Jn(e,this.tensorMap,this.context);if(n.i!=null||n.f!=null)return kI(this.node.rawAttrs,e,t);if(n.s!=null)return xI(this.node.rawAttrs,e,t);if(n.b!=null)return wI(this.node.rawAttrs,e,t);if(n.shape!=null)return CI(this.node.rawAttrs,e,t);if(n.type!=null)return SI(this.node.rawAttrs,e,t);if(n.list!=null){if(n.list.i!=null||n.list.f!=null)return _I(this.node.rawAttrs,e,t);if(n.list.s!=null)return TI(this.node.rawAttrs,e,t);if(n.list.shape!=null)return NI(this.node.rawAttrs,e,t);if(n.list.b!=null)return EI(this.node.rawAttrs,e,t);if(n.list.type!=null)return II(this.node.rawAttrs,e,t)}return t}},qn={};He(qn,{OP_SCOPE_SUFFIX:()=>XC,abs:()=>xn,acos:()=>JC,acosh:()=>e_,add:()=>re,addN:()=>WL,all:()=>Xx,any:()=>jm,argMax:()=>du,argMin:()=>t_,asin:()=>n_,asinh:()=>r_,atan:()=>a_,atan2:()=>i_,atanh:()=>s_,avgPool:()=>Vs,avgPool3d:()=>l_,basicLSTMCell:()=>HL,batchNorm:()=>Xc,batchNorm2d:()=>u_,batchNorm3d:()=>c_,batchNorm4d:()=>d_,batchToSpaceND:()=>jg,bincount:()=>p_,bitwiseAnd:()=>GL,booleanMaskAsync:()=>O4,broadcastArgs:()=>qL,broadcastTo:()=>Hl,buffer:()=>et,cast:()=>he,ceil:()=>h_,clipByValue:()=>hr,clone:()=>Ki,complex:()=>Os,concat:()=>Et,concat1d:()=>f_,concat2d:()=>m_,concat3d:()=>g_,concat4d:()=>y_,conv1d:()=>Yx,conv2d:()=>_r,conv2dTranspose:()=>Zx,conv3d:()=>v_,conv3dTranspose:()=>x_,cos:()=>Hg,cosh:()=>Qx,cosineWindow:()=>w1,cumprod:()=>qm,cumsum:()=>Jx,denseBincount:()=>rv,depthToSpace:()=>w_,depthwiseConv2d:()=>Yc,diag:()=>XL,dilation2d:()=>k_,div:()=>Ie,divNoNan:()=>S_,dot:()=>I_,dropout:()=>eT,einsum:()=>ZL,elu:()=>zh,enclosingPowerOfTwo:()=>tT,ensureShape:()=>QL,equal:()=>pa,erf:()=>C_,euclideanNorm:()=>N_,exp:()=>Tr,expandDims:()=>Qn,expm1:()=>E_,eye:()=>e1,fft:()=>ey,fill:()=>ua,floor:()=>Bh,floorDiv:()=>Kx,fused:()=>gp,gather:()=>Wh,gatherND:()=>B4,greater:()=>Rr,greaterEqual:()=>Us,ifft:()=>mp,imag:()=>Gg,image:()=>Ia,inTopKAsync:()=>W4,irfft:()=>f1,isFinite:()=>$_,isInf:()=>A_,isNaN:()=>R_,leakyRelu:()=>qg,less:()=>dp,lessEqual:()=>al,linalg:()=>aT,linspace:()=>r4,localResponseNormalization:()=>F_,log:()=>ha,log1p:()=>Kg,logSigmoid:()=>D_,logSoftmax:()=>n1,logSumExp:()=>r1,logicalAnd:()=>ri,logicalNot:()=>Xg,logicalOr:()=>a1,logicalXor:()=>M_,losses:()=>J4,lowerBound:()=>i4,matMul:()=>Ye,max:()=>$a,maxPool:()=>Ln,maxPool3d:()=>O_,maxPoolWithArgmax:()=>s4,maximum:()=>ns,mean:()=>Jt,meshgrid:()=>o4,min:()=>cp,minimum:()=>Lo,mirrorPad:()=>P_,mod:()=>z_,moments:()=>Yg,movingAverage:()=>P4,mul:()=>j,multiRNNCell:()=>l4,multinomial:()=>u4,neg:()=>Bt,norm:()=>Lh,notEqual:()=>mu,oneHot:()=>pp,ones:()=>ia,onesLike:()=>fa,op:()=>U,outerProduct:()=>c4,pad:()=>Ti,pad1d:()=>d4,pad2d:()=>p4,pad3d:()=>h4,pad4d:()=>f4,pool:()=>L_,pow:()=>Ps,prelu:()=>Qg,print:()=>QC,prod:()=>B_,raggedGather:()=>m4,raggedRange:()=>g4,raggedTensorToTensor:()=>y4,rand:()=>b4,randomGamma:()=>k4,randomNormal:()=>s1,randomStandardNormal:()=>S4,randomUniform:()=>il,randomUniformInt:()=>I4,range:()=>gu,real:()=>hp,reciprocal:()=>H_,relu:()=>Ct,relu6:()=>o1,reshape:()=>H,reverse:()=>Da,reverse1d:()=>C4,reverse2d:()=>_4,reverse3d:()=>T4,reverse4d:()=>N4,rfft:()=>ty,round:()=>l1,rsqrt:()=>u1,scalar:()=>Re,scatterND:()=>z4,searchSorted:()=>i1,selu:()=>c1,separableConv2d:()=>Vh,setdiff1dAsync:()=>E4,sigmoid:()=>ei,sign:()=>G_,signal:()=>Q4,sin:()=>d1,sinh:()=>p1,slice:()=>it,slice1d:()=>Jg,slice2d:()=>h1,slice3d:()=>Uh,slice4d:()=>fp,softmax:()=>sl,softplus:()=>Zc,spaceToBatchND:()=>Zg,sparse:()=>eB,sparseToDense:()=>L4,spectral:()=>Z4,split:()=>Wr,sqrt:()=>ar,square:()=>Tt,squaredDifference:()=>m1,squeeze:()=>ol,stack:()=>Fn,step:()=>Qc,stridedSlice:()=>q_,string:()=>tB,sub:()=>we,sum:()=>Te,tan:()=>K_,tanh:()=>hu,tensor:()=>Ir,tensor1d:()=>It,tensor2d:()=>Xi,tensor3d:()=>g1,tensor4d:()=>Bo,tensor5d:()=>$4,tensor6d:()=>A4,tensorScatterUpdate:()=>F4,tile:()=>aa,topk:()=>Y_,transpose:()=>Je,truncatedNormal:()=>v1,unique:()=>Z_,unsortedSegmentSum:()=>x1,unstack:()=>dn,upperBound:()=>D4,variable:()=>Q_,where:()=>Hn,whereAsync:()=>J_,zeros:()=>en,zerosLike:()=>st});var r0e=(e,t,n,r=qn)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(I("a",e,t,n),I("b",e,t,n))];case"AddN":return[r.addN(I("tensors",e,t,n))];case"FloorMod":case"Mod":return[r.mod(I("a",e,t,n),I("b",e,t,n))];case"Mul":return[r.mul(I("a",e,t,n),I("b",e,t,n))];case"RealDiv":case"Div":return[r.div(I("a",e,t,n),I("b",e,t,n))];case"DivNoNan":return[r.divNoNan(I("a",e,t,n),I("b",e,t,n))];case"FloorDiv":return[r.floorDiv(I("a",e,t,n),I("b",e,t,n))];case"Sub":return[r.sub(I("a",e,t,n),I("b",e,t,n))];case"Minimum":return[r.minimum(I("a",e,t,n),I("b",e,t,n))];case"Maximum":return[r.maximum(I("a",e,t,n),I("b",e,t,n))];case"Pow":return[r.pow(I("a",e,t,n),I("b",e,t,n))];case"SquaredDifference":return[r.squaredDifference(I("a",e,t,n),I("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},a0e=(e,t,n,r=qn)=>{switch(e.op){case"Abs":case"ComplexAbs":return[r.abs(I("x",e,t,n))];case"Acos":return[r.acos(I("x",e,t,n))];case"Acosh":return[r.acosh(I("x",e,t,n))];case"Asin":return[r.asin(I("x",e,t,n))];case"Asinh":return[r.asinh(I("x",e,t,n))];case"Atan":return[r.atan(I("x",e,t,n))];case"Atan2":return[r.atan2(I("x",e,t,n),I("y",e,t,n))];case"Atanh":return[r.atanh(I("x",e,t,n))];case"Ceil":return[r.ceil(I("x",e,t,n))];case"Complex":return[r.complex(I("real",e,t,n),I("imag",e,t,n))];case"Cos":return[r.cos(I("x",e,t,n))];case"Cosh":return[r.cosh(I("x",e,t,n))];case"Elu":return[r.elu(I("x",e,t,n))];case"Erf":return[r.erf(I("x",e,t,n))];case"Exp":return[r.exp(I("x",e,t,n))];case"Expm1":return[r.expm1(I("x",e,t,n))];case"Floor":return[r.floor(I("x",e,t,n))];case"Log":return[r.log(I("x",e,t,n))];case"Log1p":return[r.log1p(I("x",e,t,n))];case"Imag":return[r.imag(I("x",e,t,n))];case"Neg":return[r.neg(I("x",e,t,n))];case"Reciprocal":return[r.reciprocal(I("x",e,t,n))];case"Real":return[r.real(I("x",e,t,n))];case"Relu":return[r.relu(I("x",e,t,n))];case"Round":return[r.round(I("x",e,t,n))];case"Selu":return[r.selu(I("x",e,t,n))];case"Sigmoid":return[r.sigmoid(I("x",e,t,n))];case"Sin":return[r.sin(I("x",e,t,n))];case"Sign":return[r.sign(I("x",e,t,n))];case"Sinh":return[r.sinh(I("x",e,t,n))];case"Softplus":return[r.softplus(I("x",e,t,n))];case"Sqrt":return[r.sqrt(I("x",e,t,n))];case"Square":return[r.square(I("x",e,t,n))];case"Tanh":return[r.tanh(I("x",e,t,n))];case"Tan":return[r.tan(I("x",e,t,n))];case"ClipByValue":return[r.clipByValue(I("x",e,t,n),I("clipValueMin",e,t,n),I("clipValueMax",e,t,n))];case"Relu6":return[r.relu6(I("x",e,t,n))];case"Rsqrt":return[r.rsqrt(Jn(e.inputNames[0],t,n))];case"LeakyRelu":return[r.leakyRelu(I("x",e,t,n),I("alpha",e,t,n))];case"Prelu":return[r.prelu(I("x",e,t,n),I("alpha",e,t,n))];case"IsNan":return[r.isNaN(Jn(e.inputNames[0],t,n))];case"IsInf":return[r.isInf(Jn(e.inputNames[0],t,n))];case"IsFinite":return[r.isFinite(Jn(e.inputNames[0],t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};function qa(e,t,n=""){if(!(typeof e=="number"||typeof t=="number")){k.assert(e.length===t.length,()=>n+` Shapes ${e} and ${t} must match`);for(let r=0;r<e.length;r++){let a=e[r],i=t[r];k.assert(a<0||i<0||a===i,()=>n+` Shapes ${e} and ${t} must match`)}}}function cD(e){return!(typeof e=="number"||e.some(t=>t<0))}function kf(e,t,n){let r=$I(e,n),a=!cD(r);if(a&&t.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(a&&t.forEach(i=>{r=$I(i.shape,r)}),!cD(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function $I(e,t){if(typeof e=="number")return t;if(typeof t=="number")return e;if(e.length!==t.length)throw new Error(`Incompatible ranks during merge: ${e} vs. ${t}`);let n=[];for(let r=0;r<e.length;++r){let a=e[r],i=t[r];if(a>=0&&i>=0&&a!==i)throw new Error(`Incompatible shape during merge: ${e} vs. ${t}`);n[r]=a>=0?a:i}return n}var i0e=class{constructor(e,t,n,r,a,i,s){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=i,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=Re(0),An(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);let t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);let n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),qa(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);n.tensor=t,An(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((n,r)=>this.write(n,t[r]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return Ir([],[0].concat(this.elementShape));let n=this.readMany(e);return qa(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),Fn(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Ir([],[0].concat(this.elementShape));let t=[];for(let r=0;r<this.size();r++)t.push(r);let n=this.readMany(t);return qa(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),Et(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);let n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(e,dn(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let n=0,r=e.map(o=>(n+=o,n));if(n!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${n}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);let a=n===0?0:t.size/n,i=[];G(()=>{t=H(t,[1,n,a]);for(let o=0;o<e.length;++o){let l=[0,o===0?0:r[o-1],0],c=[1,e[o],a];i[o]=H(it(t,l,c),this.elementShape)}return i});let s=[];for(let o=0;o<e.length;o++)s[o]=o;this.writeMany(s,i)}},wp=class{get id(){return this.idTensor.id}constructor(e,t,n,r=-1){this.tensors=e,this.elementShape=t,this.elementDtype=n,e!=null&&e.forEach(a=>{if(n!==a.dtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${a.dtype}`);qa(t,a.shape,"TensorList shape mismatch: "),An(a)}),this.idTensor=Re(0),this.maxNumElements=r,An(this.idTensor)}copy(){return new wp([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,n=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(n!==-1&&this.tensors.length!==n)throw new Error(`Operation expected a list with ${n} elements but got a list with ${this.tensors.length} elements.`);qa(e,this.elementShape,"TensorList shape mismatch: ");let r=kf(this.elementShape,this.tensors,e);return G(()=>{let a=this.tensors.map(i=>H(i,r));return Fn(a,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");let n=kf(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,qa(r.shape,e,"TensorList shape mismatch: "),H(r,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(qa(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");An(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);let t=new wp([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let n=0;n<Math.min(this.tensors.length,e);++n)t.tensors[n]=this.tensors[n];return t}getItem(e,t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);qa(this.tensors[e].shape,t,"TensorList shape mismatch: ");let r=kf(this.elementShape,this.tensors,t);return H(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);qa(this.elementShape,t.shape,"TensorList shape mismatch: "),An(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);qa(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());let r=kf(this.elementShape,this.tensors,n);return e.length===0?Ir([],[0].concat(r)):G(()=>{let a=e.map(i=>H(this.tensors[i],r));return Fn(a,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);qa(this.elementShape,t,"TensorList shape mismatch: ");let n=kf(this.elementShape,this.tensors,t);return this.size()===0?Ir([],[0].concat(n)):G(()=>{let r=this.tensors.map(a=>H(a,n));return Et(r,0)})}};function s0e(e,t,n){let r=e.dtype;if(e.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${e.shape}`);if(e.dtype!==n)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${n}`);let a=e.shape.slice(1);qa(a,t,"TensorList shape mismatch: ");let i=dn(e);return new wp(i,t,r)}function o0e(e,t,n,r){return new wp([],e,t,r)}function l0e(e,t,n,r){if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);let a=Math.max(...t);if(r!=null&&r!==-1&&a>=r)throw new Error(`Max index must be < array size (${a}  vs. ${r})`);let i=new wp([],n,e.dtype,r),s=dn(e,0);return t.forEach((o,l)=>{i.setItem(o,s[l])}),i}function u0e(e,t,n){let r=0,a=t.map(u=>(r+=u,r));if(r!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${e.shape}`);let i=e.shape.slice(1),s=$I(i,n),o=r===0?0:e.size/r,l=G(()=>{let u=[];e=H(e,[1,r,o]);for(let d=0;d<t.length;++d){let p=[0,d===0?0:a[d-1],0],h=[1,t[d],o];u[d]=H(it(e,p,h),s)}return e.dispose(),u}),c=new wp([],n,e.dtype,t.length);for(let u=0;u<l.length;u++)c.setItem(u,l[u]);return c}var c0e=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{let r=I("thenBranch",e,t,n),a=I("elseBranch",e,t,n),i=I("cond",e,t,n),s=I("args",e,t,n);return(await i.data())[0]?n.functionMap[r].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap):n.functionMap[a].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{let r=I("body",e,t,n),a=I("cond",e,t,n),i=I("args",e,t,n),s=await n.functionMap[a].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),o=i.map(u=>u.id),l=await s[0].data();s.forEach(u=>{!u.kept&&o.indexOf(u.id)===-1&&u.dispose()});let c=i;for(;l[0];){let u=c;c=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);let d=c.map(h=>h.id);u.forEach(h=>{!h.kept&&o.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()});let p=await n.functionMap[a].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);l=await p[0].data(),p.forEach(h=>{!h.kept&&o.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()})}return c}case"LoopCond":{let r=I("pred",e,t,n);return[bs(r)]}case"Switch":{let r=I("pred",e,t,n),a=I("data",e,t,n);return a.kept||(a=bs(a)),(await r.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{let r=e.inputNames.find(a=>Jn(a,t,n)!==void 0);if(r){let a=Jn(r,t,n);return[bs(a)]}return}case"Enter":{let r=I("frameName",e,t,n),a=I("tensor",e,t,n);return n.enterFrame(r),[bs(a)]}case"Exit":{let r=I("tensor",e,t,n);return n.exitFrame(),[bs(r)]}case"NextIteration":{let r=I("tensor",e,t,n);return n.nextIteration(),[bs(r)]}case"TensorArrayV3":{let r=I("size",e,t,n),a=I("dtype",e,t,n),i=I("elementShape",e,t,n),s=I("dynamicSize",e,t,n),o=I("clearAfterRead",e,t,n),l=I("identicalElementShapes",e,t,n),c=I("name",e,t,n),u=new i0e(c,a,r,i,l,s,o);return n.addTensorArray(u),[u.idTensor,Re(1)]}case"TensorArrayWriteV3":{let r=I("tensorArrayId",e,t,n),a=I("index",e,t,n),i=I("tensor",e,t,n),s=n.getTensorArray(r.id);return s.write(a,i),[s.idTensor]}case"TensorArrayReadV3":{let r=I("tensorArrayId",e,t,n),a=I("index",e,t,n);return[n.getTensorArray(r.id).read(a)]}case"TensorArrayGatherV3":{let r=I("tensorArrayId",e,t,n),a=I("indices",e,t,n),i=I("dtype",e,t,n);return[n.getTensorArray(r.id).gather(a,i)]}case"TensorArrayScatterV3":{let r=I("tensorArrayId",e,t,n),a=I("indices",e,t,n),i=I("tensor",e,t,n),s=n.getTensorArray(r.id);return s.scatter(a,i),[s.idTensor]}case"TensorArrayConcatV3":{let r=I("tensorArrayId",e,t,n),a=n.getTensorArray(r.id),i=I("dtype",e,t,n);return[a.concat(i)]}case"TensorArraySplitV3":{let r=I("tensorArrayId",e,t,n),a=I("tensor",e,t,n),i=I("lengths",e,t,n),s=n.getTensorArray(r.id);return s.split(i,a),[s.idTensor]}case"TensorArraySizeV3":{let r=I("tensorArrayId",e,t,n),a=n.getTensorArray(r.id);return[Re(a.size(),"int32")]}case"TensorArrayCloseV3":{let r=I("tensorArrayId",e,t,n),a=n.getTensorArray(r.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{let r=I("tensorListId",e,t,n),a=I("index",e,t,n),i=I("tensor",e,t,n),s=n.getTensorList(r.id);return s.setItem(a,i),[s.idTensor]}case"TensorListGetItem":{let r=I("tensorListId",e,t,n),a=I("index",e,t,n),i=I("elementShape",e,t,n),s=I("elementDType",e,t,n);return[n.getTensorList(r.id).getItem(a,i,s)]}case"TensorListScatterV2":case"TensorListScatter":{let r=I("indices",e,t,n),a=I("tensor",e,t,n),i=I("elementShape",e,t,n),s=I("numElements",e,t,n),o=l0e(a,r,i,s);return n.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{let r=I("elementShape",e,t,n),a=I("elementDType",e,t,n),i;e.op==="TensorListReserve"?i="numElements":i="maxNumElements";let s=I(i,e,t,n),o=e.op==="TensorListReserve"?-1:s,l=o0e(r,a,s,o);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{let r=I("tensorListId",e,t,n),a=I("indices",e,t,n),i=I("elementShape",e,t,n),s=I("elementDType",e,t,n);return[n.getTensorList(r.id).gather(a,s,i)]}case"TensorListStack":{let r=I("tensorListId",e,t,n),a=I("elementShape",e,t,n),i=I("elementDType",e,t,n),s=I("numElements",e,t,n);return[n.getTensorList(r.id).stack(a,i,s)]}case"TensorListFromTensor":{let r=I("tensor",e,t,n),a=I("elementShape",e,t,n),i=I("elementDType",e,t,n),s=s0e(r,a,i);return n.addTensorList(s),[s.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{let r=I("tensorListId",e,t,n),a=n.getTensorList(r.id),i=I("dtype",e,t,n),s=I("elementShape",e,t,n);return[a.concat(i,s)]}case"TensorListPushBack":{let r=I("tensorListId",e,t,n),a=I("tensor",e,t,n),i=n.getTensorList(r.id);return i.pushBack(a),[i.idTensor]}case"TensorListPopBack":{let r=I("tensorListId",e,t,n),a=I("elementShape",e,t,n),i=I("elementDType",e,t,n);return[n.getTensorList(r.id).popBack(a,i)]}case"TensorListSplit":{let r=I("tensor",e,t,n),a=I("elementShape",e,t,n),i=I("lengths",e,t,n),s=u0e(r,i,a);return n.addTensorList(s),[s.idTensor]}case"TensorListLength":{let r=I("tensorListId",e,t,n),a=n.getTensorList(r.id);return[Re(a.size(),"int32")]}case"TensorListResize":{let r=I("tensorListId",e,t,n),a=I("size",e,t,n),i=n.getTensorList(r.id).resize(a);return n.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};function dD(e,t,n){let[r,a]=I("fusedOps",e,t,n),i=r==="biasadd",s=!i,o=a==="prelu",l=r==="fusedbatchnorm",c=I("numArgs",e,t,n);if(i){if(o&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&i&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");let u=I("strides",e,t,n),d=eb(e,t,n),p=I("dataFormat",e,t,n).toUpperCase(),h=I("dilations",e,t,n),[f,m]=I("args",e,t,n);s&&(m=f,f=void 0);let g=I("leakyreluAlpha",e,t,n);return{stride:u,pad:d,dataFormat:p,dilations:h,biasArg:f,preluArg:m,activationFunc:a,leakyreluAlpha:g}}var d0e=(e,t,n,r=qn)=>{switch(e.op){case"Conv1D":{let a=I("stride",e,t,n),i=I("pad",e,t,n),s=I("dataFormat",e,t,n).toUpperCase(),o=I("dilation",e,t,n);return[r.conv1d(I("x",e,t,n),I("filter",e,t,n),a,i,s,o)]}case"Conv2D":{let a=I("strides",e,t,n),i=eb(e,t,n),s=I("dataFormat",e,t,n).toUpperCase(),o=I("dilations",e,t,n);return[r.conv2d(I("x",e,t,n),I("filter",e,t,n),[a[1],a[2]],i,s,[o[1],o[2]])]}case"_FusedConv2D":{let{stride:a,pad:i,dataFormat:s,dilations:o,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=dD(e,t,n);return[r.fused.conv2d({x:I("x",e,t,n),filter:I("filter",e,t,n),strides:[a[1],a[2]],pad:i,dataFormat:s,dilations:[o[1],o[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{let{stride:a,pad:i,dataFormat:s,dilations:o,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=dD(e,t,n);return[r.fused.depthwiseConv2d({x:I("x",e,t,n),filter:I("filter",e,t,n),strides:[a[1],a[2]],pad:i,dataFormat:s,dilations:[o[1],o[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{let a=I("outputShape",e,t,n),i=I("strides",e,t,n),s=eb(e,t,n);return[r.conv2dTranspose(I("x",e,t,n),I("filter",e,t,n),a,[i[1],i[2]],s)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{let a=I("strides",e,t,n),i=eb(e,t,n),s=I("dilations",e,t,n),o=I("dataFormat",e,t,n).toUpperCase();return[r.depthwiseConv2d(I("input",e,t,n),I("filter",e,t,n),[a[1],a[2]],i,o,[s[1],s[2]])]}case"Conv3D":{let a=I("strides",e,t,n),i=I("pad",e,t,n),s=I("dataFormat",e,t,n).toUpperCase(),o=I("dilations",e,t,n);return[r.conv3d(I("x",e,t,n),I("filter",e,t,n),[a[1],a[2],a[3]],i,s,[o[1],o[2],o[3]])]}case"AvgPool":{let a=I("strides",e,t,n),i=I("pad",e,t,n),s=I("kernelSize",e,t,n);return[r.avgPool(I("x",e,t,n),[s[1],s[2]],[a[1],a[2]],i)]}case"MaxPool":{let a=I("strides",e,t,n),i=I("pad",e,t,n),s=I("kernelSize",e,t,n);return[r.maxPool(I("x",e,t,n),[s[1],s[2]],[a[1],a[2]],i)]}case"MaxPoolWithArgmax":{let a=I("strides",e,t,n),i=I("pad",e,t,n),s=I("kernelSize",e,t,n),o=I("includeBatchInIndex",e,t,n),{result:l,indexes:c}=r.maxPoolWithArgmax(I("x",e,t,n),[s[1],s[2]],[a[1],a[2]],i,o);return[l,c]}case"AvgPool3D":{let a=I("strides",e,t,n),i=I("pad",e,t,n),s=I("kernelSize",e,t,n);return[r.avgPool3d(I("x",e,t,n),[s[1],s[2],s[3]],[a[1],a[2],a[3]],i)]}case"MaxPool3D":{let a=I("strides",e,t,n),i=I("pad",e,t,n),s=I("kernelSize",e,t,n);return[r.maxPool3d(I("x",e,t,n),[s[1],s[2],s[3]],[a[1],a[2],a[3]],i)]}case"Dilation2D":{let a=I("strides",e,t,n),i=I("pad",e,t,n),s=I("dilations",e,t,n),o=a[1],l=a[2],c=s[1],u=s[2];return[r.dilation2d(I("x",e,t,n),I("filter",e,t,n),[o,l],i,[c,u],"NHWC")]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},p0e=(e,t,n,r=qn)=>{switch(e.op){case"Fill":{let a=I("shape",e,t,n),i=I("dtype",e,t,n),s=I("value",e,t,n);return[r.fill(a,s,i)]}case"LinSpace":{let a=I("start",e,t,n),i=I("stop",e,t,n),s=I("num",e,t,n);return[r.linspace(a,i,s)]}case"Multinomial":{let a=I("logits",e,t,n),i=I("numSamples",e,t,n),s=I("seed",e,t,n);return[r.multinomial(a,i,s)]}case"OneHot":{let a=I("indices",e,t,n),i=I("depth",e,t,n),s=I("onValue",e,t,n),o=I("offValue",e,t,n),l=I("dtype",e,t,n);return[r.oneHot(a,i,s,o,l)]}case"Ones":return[r.ones(I("shape",e,t,n),I("dtype",e,t,n))];case"OnesLike":return[r.onesLike(I("x",e,t,n))];case"RandomStandardNormal":return[r.randomStandardNormal(I("shape",e,t,n),I("dtype",e,t,n),I("seed",e,t,n))];case"RandomUniform":return[r.randomUniform(I("shape",e,t,n),I("minval",e,t,n),I("maxval",e,t,n),I("dtype",e,t,n))];case"RandomUniformInt":return[r.randomUniformInt(I("shape",e,t,n),I("minval",e,t,n),I("maxval",e,t,n),I("seed",e,t,n))];case"Range":{let a=I("start",e,t,n),i=I("stop",e,t,n),s=I("step",e,t,n);return[r.range(a,i,s,I("dtype",e,t,n))]}case"TruncatedNormal":{let a=I("shape",e,t,n),i=I("mean",e,t,n),s=I("stdDev",e,t,n),o=I("seed",e,t,n);return[r.truncatedNormal(a,i,s,I("dtype",e,t,n),o)]}case"Zeros":return[r.zeros(I("shape",e,t,n),I("dtype",e,t,n))];case"ZerosLike":return[r.zerosLike(I("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};function gk(e,t,n){let r=I("boxes",e,t,n),a=I("scores",e,t,n),i=I("maxOutputSize",e,t,n),s=I("iouThreshold",e,t,n),o=I("scoreThreshold",e,t,n),l=I("softNmsSigma",e,t,n);return{boxes:r,scores:a,maxOutputSize:i,iouThreshold:s,scoreThreshold:o,softNmsSigma:l}}var h0e=async(e,t,n,r,a=qn)=>{switch(e.op){case"NonMaxSuppressionV5":{let{boxes:i,scores:s,maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=gk(e,t,n),d=await a.image.nonMaxSuppressionWithScoreAsync(i,s,o,l,c,u);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{let{boxes:i,scores:s,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=gk(e,t,n),u=I("padToMaxOutputSize",e,t,n),d=await a.image.nonMaxSuppressionPaddedAsync(i,s,o,l,c,u);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{let{boxes:i,scores:s,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=gk(e,t,n);return[await a.image.nonMaxSuppressionAsync(i,s,o,l,c)]}case"Where":{let i=a.cast(I("condition",e,t,n),"bool"),s=[await a.whereAsync(i)];return i.dispose(),s}case"ListDiff":return a.setdiff1dAsync(I("x",e,t,n),I("y",e,t,n));default:throw TypeError(`Node type ${e.op} is not implemented`)}},f0e=(e,t,n,r=qn)=>{switch(e.op){case"LowerBound":{let a=I("sortedSequence",e,t,n),i=I("values",e,t,n);return[r.lowerBound(a,i)]}case"TopKV2":{let a=I("x",e,t,n),i=I("k",e,t,n),s=I("sorted",e,t,n),o=r.topk(a,i,s);return[o.values,o.indices]}case"UpperBound":{let a=I("sortedSequence",e,t,n),i=I("values",e,t,n);return[r.upperBound(a,i)]}case"Unique":{let a=I("x",e,t,n),i=r.unique(a);return[i.values,i.indices]}case"UniqueV2":{let a=I("x",e,t,n),i=I("axis",e,t,n),s=r.unique(a,i);return[s.values,s.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},m0e=(e,t,n,r=qn)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":let a=I("default",e,t,n);return[Jn(e.name,t,n)||a];case"Placeholder":return[Jn(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{let u=I("x",e,t,n);return[bs(u)]}case"IdentityN":return I("x",e,t,n).map(u=>bs(u));case"Snapshot":let i=I("x",e,t,n);return[bs(i)];case"Shape":return[r.tensor1d(I("x",e,t,n).shape,"int32")];case"ShapeN":return I("x",e,t,n).map(u=>r.tensor1d(u.shape));case"Size":return[r.scalar(I("x",e,t,n).size,"int32")];case"Rank":return[r.scalar(I("x",e,t,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":let s=I("x",e,t,n),o=I("data",e,t,n),l=I("message",e,t,n),c=I("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let u=0;u<o.length;u++)console.log(Array.prototype.slice.call(o[u].dataSync()).slice(0,c));return[s];default:throw TypeError(`Node type ${e.op} is not implemented`)}},g0e=class{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=Re(0),this.tensorMap=new Map,An(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Re(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);let n=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),G(()=>{let r=dn(t),a=n.length,i=r.length;k.assert(a===i,()=>`The number of elements doesn't match, keys has ${a} elements, the values has ${i} elements.`);for(let s=0;s<a;s++){let o=n[s],l=r[s];An(l),this.tensorMap.set(o,l)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);let n=await e.data();return G(()=>{let r=[];for(let a=0;a<n.length;a++){let i=n[a],s=this.findWithDefault(i,t);r.push(s)}return Fn(r)})}findWithDefault(e,t){let n=this.tensorMap.get(e);return n??t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}},y0e=async(e,t,n,r)=>{switch(e.op){case"HashTable":case"HashTableV2":{let a=r.getHashTableHandleByName(e.name);if(a!=null)return[a];{let i=I("keyDType",e,t,n),s=I("valueDType",e,t,n),o=new g0e(i,s);return r.addHashTable(e.name,o),[o.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{let a=I("tableHandle",e,t,n,r),i=I("keys",e,t,n),s=I("values",e,t,n);return[await r.getHashTableById(a.id).import(i,s)]}case"LookupTableFind":case"LookupTableFindV2":{let a=I("tableHandle",e,t,n,r),i=I("keys",e,t,n),s=I("defaultValue",e,t,n);return[await r.getHashTableById(a.id).find(i,s)]}case"LookupTableSize":case"LookupTableSizeV2":{let a=I("tableHandle",e,t,n,r);return[r.getHashTableById(a.id).tensorSize()]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},b0e=(e,t,n,r=qn)=>{switch(e.op){case"ResizeBilinear":{let a=I("images",e,t,n),i=I("size",e,t,n),s=I("alignCorners",e,t,n),o=I("halfPixelCenters",e,t,n);return[r.image.resizeBilinear(a,[i[0],i[1]],s,o)]}case"ResizeNearestNeighbor":{let a=I("images",e,t,n),i=I("size",e,t,n),s=I("alignCorners",e,t,n),o=I("halfPixelCenters",e,t,n);return[r.image.resizeNearestNeighbor(a,[i[0],i[1]],s,o)]}case"CropAndResize":{let a=I("image",e,t,n),i=I("boxes",e,t,n),s=I("boxInd",e,t,n),o=I("cropSize",e,t,n),l=I("method",e,t,n),c=I("extrapolationValue",e,t,n);return[r.image.cropAndResize(a,i,s,o,l,c)]}case"ImageProjectiveTransformV3":{let a=I("images",e,t,n),i=I("transforms",e,t,n),s=I("outputShape",e,t,n),o=I("fillValue",e,t,n),l=I("interpolation",e,t,n),c=I("fillMode",e,t,n);return[r.image.transform(a,i,l.toLowerCase(),c.toLowerCase(),o,s)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},v0e=(e,t,n,r=qn)=>{switch(e.op){case"Equal":return[r.equal(I("a",e,t,n),I("b",e,t,n))];case"NotEqual":return[r.notEqual(I("a",e,t,n),I("b",e,t,n))];case"Greater":return[r.greater(I("a",e,t,n),I("b",e,t,n))];case"GreaterEqual":return[r.greaterEqual(I("a",e,t,n),I("b",e,t,n))];case"Less":return[r.less(I("a",e,t,n),I("b",e,t,n))];case"LessEqual":return[r.lessEqual(I("a",e,t,n),I("b",e,t,n))];case"LogicalAnd":return[r.logicalAnd(I("a",e,t,n),I("b",e,t,n))];case"LogicalNot":return[r.logicalNot(I("a",e,t,n))];case"LogicalOr":return[r.logicalOr(I("a",e,t,n),I("b",e,t,n))];case"Select":case"SelectV2":return[r.where(I("condition",e,t,n),I("a",e,t,n),I("b",e,t,n))];case"BitwiseAnd":return[r.bitwiseAnd(I("a",e,t,n),I("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},x0e=(e,t,n,r=qn)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(I("a",e,t,n),I("b",e,t,n),I("transposeA",e,t,n),I("transposeB",e,t,n))];case"Einsum":return[r.einsum(I("equation",e,t,n),...I("tensors",e,t,n))];case"Transpose":return[r.transpose(I("x",e,t,n),I("perm",e,t,n))];case"_FusedMatMul":let[a,i]=I("fusedOps",e,t,n),s=a==="biasadd",o=i==="prelu",l=I("numArgs",e,t,n),c=I("leakyreluAlpha",e,t,n);if(s){if(o&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}let[u,d]=I("args",e,t,n);return[r.fused.matMul({a:I("a",e,t,n),b:I("b",e,t,n),transposeA:I("transposeA",e,t,n),transposeB:I("transposeB",e,t,n),bias:u,activation:i,preluActivationWeights:d,leakyreluAlpha:c})];case"MatrixBandPart":return[r.linalg.bandPart(I("a",e,t,n),I("numLower",e,t,n),I("numUpper",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},w0e=(e,t,n,r=qn)=>{switch(e.op){case"EuclideanNorm":return[r.euclideanNorm(I("x",e,t,n),I("axis",e,t,n),I("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(I("x",e,t,n),I("mean",e,t,n),I("variance",e,t,n),I("offset",e,t,n),I("scale",e,t,n),I("epsilon",e,t,n))];case"FusedBatchNormV3":return[r.batchNorm(I("x",e,t,n),I("mean",e,t,n),I("variance",e,t,n),I("offset",e,t,n),I("scale",e,t,n),I("epsilon",e,t,n))];case"LRN":return[r.localResponseNormalization(I("x",e,t,n),I("radius",e,t,n),I("bias",e,t,n),I("alpha",e,t,n),I("beta",e,t,n))];case"Softmax":return[r.softmax(I("x",e,t,n))];case"LogSoftmax":return[r.logSoftmax(I("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},k0e=(e,t,n,r=qn)=>{switch(e.op){case"RaggedGather":{let{outputNestedSplits:a,outputDenseValues:i}=r.raggedGather(I("paramsNestedSplits",e,t,n),I("paramsDenseValues",e,t,n),I("indices",e,t,n),I("outputRaggedRank",e,t,n));return a.concat(i)}case"RaggedRange":{let{rtNestedSplits:a,rtDenseValues:i}=r.raggedRange(I("starts",e,t,n),I("limits",e,t,n),I("splits",e,t,n));return[a,i]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(I("shape",e,t,n),I("values",e,t,n),I("defaultValue",e,t,n),I("rowPartitionTensors",e,t,n),I("rowPartitionTypes",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},S0e=(e,t,n,r=qn)=>{switch(e.op){case"Max":{let o=I("axis",e,t,n),l=I("keepDims",e,t,n);return[r.max(I("x",e,t,n),o,l)]}case"Mean":{let o=I("axis",e,t,n),l=I("keepDims",e,t,n);return[r.mean(I("x",e,t,n),o,l)]}case"Min":{let o=I("axis",e,t,n),l=I("keepDims",e,t,n);return[r.min(I("x",e,t,n),o,l)]}case"Sum":{let o=I("axis",e,t,n),l=I("keepDims",e,t,n);return[r.sum(I("x",e,t,n),o,l)]}case"All":{let o=I("axis",e,t,n),l=I("keepDims",e,t,n);return[r.all(I("x",e,t,n),o,l)]}case"Any":{let o=I("axis",e,t,n),l=I("keepDims",e,t,n);return[r.any(I("x",e,t,n),o,l)]}case"ArgMax":{let o=I("axis",e,t,n);return[r.argMax(I("x",e,t,n),o)]}case"ArgMin":{let o=I("axis",e,t,n);return[r.argMin(I("x",e,t,n),o)]}case"Prod":{let o=I("axis",e,t,n),l=I("keepDims",e,t,n);return[r.prod(I("x",e,t,n),o,l)]}case"Cumprod":{let o=I("axis",e,t,n),l=I("exclusive",e,t,n),c=I("reverse",e,t,n);return[r.cumprod(I("x",e,t,n),o,l,c)]}case"Cumsum":{let o=I("axis",e,t,n),l=I("exclusive",e,t,n),c=I("reverse",e,t,n);return[r.cumsum(I("x",e,t,n),o,l,c)]}case"Bincount":let a=I("x",e,t,n),i=I("weights",e,t,n),s=I("size",e,t,n);return[r.bincount(a,i,s)];case"DenseBincount":{let o=I("x",e,t,n),l=I("weights",e,t,n),c=I("size",e,t,n),u=I("binaryOutput",e,t,n);return[r.denseBincount(o,l,c,u)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},I0e=(e,t,n,r=qn)=>{switch(e.op){case"ConcatV2":case"Concat":{let a=I("n",e,t,n),i=I("axis",e,t,n),s=I("tensors",e,t,n);return s=s.slice(0,a),[r.concat(s,i)]}case"Gather":{let a=I("x",e,t,n),i=I("indices",e,t,n);return[r.gather(a,r.cast(i,"int32"),0)]}case"GatherV2":{let a=I("axis",e,t,n),i=I("batchDims",e,t,n),s=I("x",e,t,n),o=I("indices",e,t,n);return[r.gather(s,r.cast(o,"int32"),a,i)]}case"Reverse":{let a=I("dims",e,t,n),i=[];for(let o=0;o<a.length;o++)a[o]&&i.push(o);let s=I("x",e,t,n);return[r.reverse(s,i)]}case"ReverseV2":{let a=I("axis",e,t,n),i=I("x",e,t,n);return[r.reverse(i,a)]}case"Slice":{let a=I("begin",e,t,n),i=I("size",e,t,n);return[r.slice(I("x",e,t,n),a,i)]}case"StridedSlice":{let a=I("begin",e,t,n),i=I("end",e,t,n),s=I("strides",e,t,n),o=I("beginMask",e,t,n),l=I("endMask",e,t,n),c=I("ellipsisMask",e,t,n),u=I("newAxisMask",e,t,n),d=I("shrinkAxisMask",e,t,n),p=I("x",e,t,n);return[r.stridedSlice(p,a,i,s,o,l,c,u,d)]}case"Pack":return G(()=>{let a=I("axis",e,t,n),i=I("tensors",e,t,n),s=i[0].shape,o=r.squeeze(i[0]).shape,l=i.map(c=>{let u=k.arraysEqual(c.shape,s);if(!u&&!k.arraysEqual(r.squeeze(c).shape,o))throw new Error("the input tensors shape does not match");return u?c:r.reshape(c,s)});return[r.stack(l,a)]});case"Unpack":{let a=I("axis",e,t,n),i=I("tensor",e,t,n);return r.unstack(i,a)}case"Tile":{let a=I("reps",e,t,n);return[r.tile(I("x",e,t,n),a)]}case"Split":case"SplitV":{let a=I("axis",e,t,n),i=I("numOrSizeSplits",e,t,n),s=I("x",e,t,n);return r.split(s,i,a)}case"ScatterNd":{let a=I("indices",e,t,n),i=I("values",e,t,n),s=I("shape",e,t,n);return[r.scatterND(a,i,s)]}case"GatherNd":{let a=I("x",e,t,n),i=I("indices",e,t,n);return[r.gatherND(a,i)]}case"SparseToDense":{let a=I("sparseIndices",e,t,n),i=I("outputShape",e,t,n),s=I("sparseValues",e,t,n),o=I("defaultValue",e,t,n);return[r.sparseToDense(a,s,i,s.dtype===o.dtype?o:r.cast(o,s.dtype))]}case"TensorScatterUpdate":{let a=I("indices",e,t,n),i=I("values",e,t,n),s=I("tensor",e,t,n);return[r.tensorScatterUpdate(s,a,i)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},C0e=(e,t,n,r=qn)=>{switch(e.op){case"SparseFillEmptyRows":{let{outputIndices:a,outputValues:i,emptyRowIndicator:s,reverseIndexMap:o}=r.sparse.sparseFillEmptyRows(I("indices",e,t,n),I("values",e,t,n),I("denseShape",e,t,n),I("defaultValue",e,t,n));return[a,i,s,o]}case"SparseReshape":{let{outputIndices:a,outputShape:i}=r.sparse.sparseReshape(I("inputIndices",e,t,n),I("inputShape",e,t,n),I("newShape",e,t,n));return[a,i]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(I("data",e,t,n),I("indices",e,t,n),I("segmentIds",e,t,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(I("data",e,t,n),I("indices",e,t,n),I("segmentIds",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},_0e=(e,t,n,r=qn)=>{switch(e.op){case"FFT":return[r.fft(I("x",e,t,n))];case"IFFT":return[r.ifft(I("x",e,t,n))];case"RFFT":return[r.rfft(I("x",e,t,n))];case"IRFFT":return[r.irfft(I("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},T0e=(e,t,n,r=qn)=>{switch(e.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(I("input",e,t,n),I("pattern",e,t,n),I("rewrite",e,t,n),I("replaceGlobal",e,t,n))];case"StringNGrams":{let{nGrams:a,nGramsSplits:i}=r.string.stringNGrams(I("data",e,t,n),I("dataSplits",e,t,n),I("separator",e,t,n),I("nGramWidths",e,t,n),I("leftPad",e,t,n),I("rightPad",e,t,n),I("padWidth",e,t,n),I("preserveShortSequences",e,t,n));return[a,i]}case"StringSplit":{let{indices:a,values:i,shape:s}=r.string.stringSplit(I("input",e,t,n),I("delimiter",e,t,n),I("skipEmpty",e,t,n));return[a,i,s]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(I("input",e,t,n),I("numBuckets",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},N0e=(e,t,n,r=qn)=>{switch(e.op){case"Cast":return[r.cast(I("x",e,t,n),I("dtype",e,t,n))];case"ExpandDims":{let a=I("axis",e,t,n);return[r.expandDims(I("x",e,t,n),a)]}case"Squeeze":{let a=I("axis",e,t,n);return[r.squeeze(I("x",e,t,n),a)]}case"Reshape":return[r.reshape(I("x",e,t,n),I("shape",e,t,n))];case"EnsureShape":return[r.ensureShape(I("x",e,t,n),I("shape",e,t,n))];case"MirrorPad":return[r.mirrorPad(I("x",e,t,n),I("padding",e,t,n),I("mode",e,t,n))];case"PadV2":case"Pad":return[r.pad(I("x",e,t,n),I("padding",e,t,n),I("constantValue",e,t,n))];case"SpaceToBatchND":{let a=I("blockShape",e,t,n),i=I("paddings",e,t,n);return[r.spaceToBatchND(I("x",e,t,n),a,i)]}case"BatchToSpaceND":{let a=I("blockShape",e,t,n),i=I("crops",e,t,n);return[r.batchToSpaceND(I("x",e,t,n),a,i)]}case"DepthToSpace":{let a=I("blockSize",e,t,n),i=I("dataFormat",e,t,n).toUpperCase();return[r.depthToSpace(I("x",e,t,n),a,i)]}case"BroadcastTo":return[r.broadcastTo(I("x",e,t,n),I("shape",e,t,n))];case"BroadcastArgs":return[r.broadcastArgs(I("s0",e,t,n),I("s1",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};function pD(e,t,n,r,a=G){let i=((s,o,l)=>{switch(s.category){case"arithmetic":return a(()=>r0e(s,o,l));case"basic_math":return a(()=>a0e(s,o,l));case"control":return c0e(s,o,l);case"convolution":return a(()=>d0e(s,o,l));case"creation":return a(()=>p0e(s,o,l));case"dynamic":return h0e(s,o,l);case"evaluation":return a(()=>f0e(s,o,l));case"image":return a(()=>b0e(s,o,l));case"graph":return a(()=>m0e(s,o,l));case"logical":return a(()=>v0e(s,o,l));case"matrices":return a(()=>x0e(s,o,l));case"normalization":return a(()=>w0e(s,o,l));case"ragged":return a(()=>k0e(s,o,l));case"reduction":return a(()=>S0e(s,o,l));case"slice_join":return a(()=>I0e(s,o,l));case"sparse":return a(()=>C0e(s,o,l));case"spectral":return a(()=>_0e(s,o,l));case"string":return a(()=>T0e(s,o,l));case"transformation":return a(()=>N0e(s,o,l));case"hash_table":return y0e(s,o,l,r);case"custom":let c=GW(s.op);if(c&&c.customExecutor)return c.customExecutor(new n0e(s,o,l));throw TypeError(`Custom op ${s.op} is not registered.`);default:throw TypeError(`Unknown op '${s.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,n);return k.isPromise(i)?i.then(s=>[].concat(s)):[].concat(i)}var hD=class{constructor(e={},t={},n={},r={},a){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=r,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){let e=[];for(let t=0;t<this.contexts.length-1;t++){let n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;let e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(let t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(let t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}};function fD(e,t,n,r){let a=new Set,i=[],s=null,o=null,l=new Set,c=new Set(Object.keys(e).map(p=>Jr(p)[0]));r=r||[];let u=new Set(r.map(p=>Jr(p.name)[0])),d=[...t];for(;d.length>0;){let p=d.pop();if((Rl(p)||O0e(p)||P0e(p))&&s==null&&(s=p,o=s.children.map(h=>h.name).filter(h=>a.has(h))),a.add(p.name),n[p.name]==null&&!c.has(p.name)&&!u.has(p.name)){if(p.inputs.length===0){i.push(p.name);continue}p.inputs.forEach(h=>{l.has(h.name)||(l.add(h.name),d.push(h))})}}return{inputs:e,outputs:t,usedNodes:a,missingInputs:i,dynamicNode:s,syncInputs:o}}function E0e(e,t){let{usedNodes:n,inputs:r}=t,a=Object.keys(r).map(g=>Jr(g)[0]).map(g=>e.nodes[g]),i=e.initNodes||[],s=g=>n.has(typeof g=="string"?g:g.name);function o(g){return[...new Map(g.map(y=>[y.name,y])).values()]}let l=o([...a,...e.weights,...i]).filter(s),c=o([...l,...Object.values(e.nodes)]).filter(s),u=new Map(c.map(g=>[g.name,g])),d={};for(let g of c){d[g.name]=d[g.name]||0;for(let y of g.children)s(y)||(d[y.name]=Number.POSITIVE_INFINITY),d[y.name]=(d[y.name]||0)+1}let p=Object.entries(d).filter(([,g])=>g===0).map(([g])=>g),h=[...p];for(;p.length>0;){let g=p.pop(),y=u.get(g);for(let b of y.children.filter(s))--d[b.name]===0&&(h.push(b.name),p.push(b.name))}let f=h.map(g=>u.get(g)),m=$0e(f,l);return A0e(m,l),m}function $0e(e,t){let n=new Map(e.map(i=>[i.name,i])),r=t.map(i=>i.name),a=new Set(r);for(;r.length>0;){let i=r.pop(),s=n.get(i);for(let o of s.children)!n.has(o.name)||a.has(o.name)||(a.add(o.name),r.push(o.name))}return e.filter(i=>a.has(i.name))}var v0=class extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}};function A0e(e,t){let n=new Map(e.map((o,l)=>[o.name,l])),r=new Set(t.map(o=>o.name)),a=o=>r.has(typeof o=="string"?o:o.name),i=new Set(e.map(o=>o.name)),s=o=>i.has(typeof o=="string"?o:o.name);for(let o of e){for(let l of o.children.filter(s)){if(!n.has(l.name))throw new v0(`Child ${l.name} of node ${o.name} is unreachable.`);if(n.get(o.name)>n.get(l.name))throw new v0(`Node ${o.name} is scheduled to run after its child ${l.name}.`)}if(!a(o))for(let l of o.inputs){if(!n.has(l.name))throw new v0(`Input ${l.name} of node ${o.name} is unreachable.`);if(n.get(l.name)>n.get(o.name))throw new v0(`Node ${o.name} is scheduled to run before its input ${l.name}.`)}}}function R0e(e){let t=new Map(e.map((o,l)=>[o.name,l])),n=Number.MAX_SAFE_INTEGER,r=e.map((o,l)=>Rl(o)?n:l),a=o=>{let l=r[t.get(o.name)];return l??-1},i=e.map((o,l)=>o.children.map(a).reduce((c,u)=>Math.max(c,u),r[l])),s=new Map;for(let o=0;o<e.length;++o){let l=i[o];if(l===n)continue;let c=e[o],u=e[l];s.has(u.name)||s.set(u.name,[]),s.get(u.name).push(c)}return s}var F0e=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),D0e=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),M0e=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Rl(e){return F0e.has(e.op)}function O0e(e){return D0e.has(e.op)}function P0e(e){return M0e.has(e.op)}var AI=class{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){let t=Object.keys(e).map(n=>e[n].map(r=>r.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{let t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(n=>{this._functionExecutorMap[n]=new AI(e.functions[n],this)})}getCompilationKey(e,t){let n=e.map(a=>a.name).sort(),r=t.map(a=>a.name).sort();return n.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,t){let n=fD(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:i}=n;if(a!=null)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(r.length>0){let l=t.map(u=>u.name),c=Object.keys(e);throw new Error(`Cannot compute the outputs [${l}] from the provided inputs [${c}]. Missing the following inputs: [${r}]`)}let s=E0e(this.graph,n),o=R0e(s);return{orderedNodes:s,nodeLiveUntilMap:o}}cloneAndKeepTensor(e){if(e==null)return null;let t=e.clone();return An(t),t}cloneTensorList(e){return e?e.map(t=>this.cloneAndKeepTensor(t)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,this.cloneTensorList(n)]))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);let n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);let r=n.map(d=>this.graph.nodes[Jr(d)[0]]),a=t.map(d=>Jr(d)[0]),i=new Set(a),s=a.map(d=>this.graph.nodes[d]);s.length===0&&(s=this._outputs);let o=this.getCompilationKey(r,s),l=this.compiledMap.get(o);l==null&&(l=this.compile(e,s),this.compiledMap.set(o,l));try{this.keepIntermediateTensors=Q().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}let c={},u={};return G(()=>{let d=new hD(this.weightMap,c,u,this.functionExecutorMap,this.parseNodeNameCache),p=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(g=>{let[y,b]=Jr(g,d),v=[];v[b]=e[g],p[y]=v,this.keepIntermediateTensors&&(this.clonedTensorsMap[y]=this.cloneTensorList(v))});let h=this.getFrozenTensorIds(p),{orderedNodes:f,nodeLiveUntilMap:m}=l;for(let g of f){if(p[g.name])continue;let y=pD(g,p,d,this._resourceManager);if(k.isPromise(y))throw new Error(`The execution of the op '${g.op}' returned a promise. Please use model.executeAsync() instead.`);p[g.name]=y,this.keepIntermediateTensors&&(this.clonedTensorsMap[g.name]=this.cloneTensorList(y)),this.checkTensorForDisposalWithNodeLiveUntilInfo(g,p,d,h,i,m.get(g.name))}return this.parent==null&&d.dispose(h),t.map(g=>Jn(g,p,d))})}getFrozenTensorIds(e){let t=[].concat.apply([],Object.keys(e).map(n=>e[n]).map(n=>n.map(r=>r.id)));return new Set(t)}checkTensorForDisposal(e,t,n,r,a,i,s){if(!(Rl(t)||i.has(e))){for(let o of n[e])o!=null&&(s[o.id]=(s[o.id]||0)+t.children.length);for(let o of t.inputs){if(Rl(o))continue;let l=oD(o.name,n,r);if(l!=null)for(let c of l){if(!c||c.kept||a.has(c.id))continue;let u=s[c.id];u===1?(c.dispose(),delete s[c.id]):u!=null&&s[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,n,r,a,i){function s(o){return Rl(o)||a.has(o.name)}if(!(Rl(e)||i==null))for(let o of i){if(s(o))continue;let l=oD(o.name,t,n);for(let c of l)!c||c.kept||r.has(c.id)||c.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(let t of e)t&&!t.isDisposed&&t.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t,n=!1,r={},a={}){this.disposeIntermediateTensors(),n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=Q().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}let i=new hD(this.weightMap,r,a,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));let s=await this.executeWithControlFlow(e,i,t,n),o=t.map(d=>Jn(d,s,i)),l=o.map(d=>d.id),c=Object.keys(e).map(d=>e[d].id),u=new Set([...l,...c,...this.weightIds]);return Object.values(s).forEach(d=>{d.forEach(p=>{p&&!p.isDisposed&&!u.has(p.id)&&p.dispose()})}),this.parent==null&&i.dispose(u),o}async executeFunctionAsync(e,t,n){let r=e.reduce((a,i,s)=>(a[this.inputs[s].name]=i,a),{});return this._executeAsync(r,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,r){let a=Object.keys(e),i=a.map(v=>this.graph.nodes[Jr(v)[0]]),s=n.map(v=>Jr(v)[0]),o=new Set(s),l=s.map(v=>this.graph.nodes[v]);l.length===0&&(l=this._outputs);let{usedNodes:c,missingInputs:u,dynamicNode:d,syncInputs:p}=fD(e,l,this.weightMap,this._initNodes),h=[...i,...this.graph.weights,...this._initNodes||[]].map(v=>({node:v,contexts:t.currentContext})),f=Object.assign({},this.weightMap);Object.keys(e).forEach(v=>{let[x,w]=Jr(v),S=[];S[w]=e[v],f[x]=S});let m={},g=this.getFrozenTensorIds(f),y={};for(;h.length>0;){let v=this.processStack(i,h,t,f,y,g,o,m,c);await Promise.all(v)}d==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");let b=l.filter(v=>!Rl(v)&&!Jn(v.name,f,t)).map(v=>v.name);if(b.length>0){let v="";throw d!=null&&(v=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${p}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${a}]. Consider providing the following inputs: [${u}]. ${v}`)}return f}processStack(e,t,n,r,a,i,s,o,l){let c=[];for(;t.length>0;){let u=t.pop();n.currentContext=u.contexts;let d="";if(u.node.op==="Enter"&&I("isConstant",u.node,r,n)&&([d]=ys(u.node.name,n)),r[u.node.name]==null){let p=pD(u.node,r,n,this._resourceManager);d||([d]=ys(u.node.name,n));let h=n.currentContext;k.isPromise(p)?c.push(p.then(f=>(r[d]=f,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(f)),n.currentContext=h,this.checkTensorForDisposal(d,u.node,r,n,i,s,o),this.processChildNodes(u.node,t,n,r,a,l),f))):(r[d]=p,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(p)),this.checkTensorForDisposal(d,u.node,r,n,i,s,o),this.processChildNodes(u.node,t,n,r,a,l))}else this.processChildNodes(u.node,t,n,r,a,l)}return c}processChildNodes(e,t,n,r,a,i){e.children.forEach(s=>{let[o]=ys(s.name,n);a[o]||!i.has(s.name)||(s.op==="Merge"?s.inputNames.some(l=>!!Jn(l,r,n))&&(a[o]=!0,t.push({contexts:n.currentContext,node:s})):s.inputNames.every(l=>!!Jn(l,r,n))&&(a[o]=!0,t.push({contexts:n.currentContext,node:s})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{let n=e[t],[r]=Jr(t),a=this.graph.nodes[r];if(a.attrParams.shape&&a.attrParams.shape.value){let i=a.attrParams.shape.value,s=i.length===n.shape.length&&n.shape.every((o,l)=>i[l]===-1||i[l]===o);k.assert(s,()=>`The shape of dict['${a.name}'] provided in model.execute(dict) must be [${i}], but was [${n.shape}]`)}a.attrParams.dtype&&a.attrParams.dtype.value&&k.assert(n.dtype===a.attrParams.dtype.value,()=>`The dtype of dict['${a.name}'] provided in model.execute(dict) must be ${a.attrParams.dtype.value}, but was ${n.dtype}`)})}mapInputs(e){var t,n;let r={};for(let a in e){let i=(n=(t=this._signature)===null||t===void 0?void 0:t.inputs)===null||n===void 0?void 0:n[a];i!=null?r[i.name]=e[a]:r[a]=e[a]}return r}checkInputs(e){let t=Object.keys(e).filter(n=>{let[r]=Jr(n);return this.graph.nodes[r]==null});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(t=>{var n,r;let a=(r=(n=this._signature)===null||n===void 0?void 0:n.outputs)===null||r===void 0?void 0:r[t];return a!=null?a.name:t},{})}checkOutputs(e){e.forEach(t=>{let[n]=Jr(t);if(!this.graph.nodes[n])throw new Error(`The output '${t}' is not found in the graph`)})}},z0e=class{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(let e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(let e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}},L0e="?tfjs-format=file",B0e="model.json",qN=class{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},n=tr){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=n,t==null&&(this.loadOptions={}),this.resourceManager=new z0e}findIOHandler(){let e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{let t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let e=this.handler.load();return k.isPromise(e)?e.then(t=>this.loadSync(t)):this.loadSync(e)}loadSync(e){this.artifacts=e;let t=this.artifacts.modelTopology,n=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){let a=this.artifacts.userDefinedMetadata;a.signature!=null&&(n=a.signature),a.structuredOutputKeys!=null&&(this.structuredOutputKeys=a.structuredOutputKeys)}this.signature=n,this.version=`${t.versions.producer}.${t.versions.minConsumer}`;let r=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new AI(lD.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){let a=lD.Instance.transformGraph(e.modelInitializer);this.initializer=new AI(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if(typeof e=="string"){let n=this.io.getSaveHandlers(e);if(n.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(n.length>1)throw new Error(`Found more than one (${n.length}) save handlers for URL '${e}'`);e=n[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){let t=e instanceof Ze?[e]:e,n={};return t.forEach((r,a)=>n[this.structuredOutputKeys[a]]=r),n}return e}predict(e,t){let n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(e,t){let n=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(e){var t;if(!(e instanceof Ze)&&!Array.isArray(e)){let a=(t=this.signature)===null||t===void 0?void 0:t.inputs;if(a!=null)for(let i in a){let s=a[i];s.resourceId!=null&&(e[i]=this.resourceIdToCapturedInput[s.resourceId])}return e}e=Array.isArray(e)?e:[e];let n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-n} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((a,i)=>{var s,o,l;let c=(l=(o=(s=this.signature)===null||s===void 0?void 0:s.inputs)===null||o===void 0?void 0:o[i])===null||l===void 0?void 0:l.resourceId;return c!=null?a[i]=this.resourceIdToCapturedInput[c]:a[i]=e[r++],a},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){let t=this.initializerSignature.outputs,n=Object.keys(t);for(let r=0;r<n.length;r++){let a=n[r],i=t[a];this.resourceIdToCapturedInput[i.resourceId]=e[r]}}}execute(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);let n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,n)=>(t[n]=[e[n]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&je(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}};async function W0e(e,t={},n=tr){if(e==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&typeof e=="string"&&(e=U0e(e));let r=new qN(e,t,n);return await r.load(),r}function V0e(e){if(e==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let t;if(e instanceof Array){let[r,a]=e;if(!r)throw new Error("modelJSON must be the first element of the array");if(!a||!(a instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in r))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in r))throw new Error("Model JSON is missing 'weightsManifest'");let i=tr.getWeightSpecs(r.weightsManifest),s=tr.getModelArtifactsForJSONSync(r,i,a);t=tr.fromMemorySync(s)}else if("load"in e)t=e;else if("modelTopology"in e&&"weightSpecs"in e&&"weightData"in e)t=tr.fromMemorySync(e);else throw new Error("Unknown model format");let n=new qN(t);return n.load(),n}function U0e(e){return e.endsWith("/")||(e=e+"/"),`${e}${B0e}${L0e}`}var j0e="4.7.0",fV={};He(fV,{CSVDataset:()=>SV,Dataset:()=>qh,FileDataSource:()=>$V,TextLineDataset:()=>kV,URLDataSource:()=>AV,array:()=>hbe,csv:()=>Ibe,func:()=>Cbe,generator:()=>_be,microphone:()=>Nbe,version_data:()=>Ebe,webcam:()=>Tbe,zip:()=>fbe});var H0e=Qo(Ex()),G0e=Qo(Ex());function q0e(e,t){return fv(e,t)}function fv(e,t,n=new Map,r=new Set){if(e==null)return null;if(typeof Blob=="function"&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);let a=t(e);if(a.recurse&&a.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse)if(kp(e)){let i=Array.isArray(e)?[]:{};r.add(e);for(let s in e){let o=e[s],l=fv(o,t,n,r);i[s]=l}return r.delete(e),e.__proto__&&(i.__proto__=e.__proto__),i}else throw new Error(`Can't recurse into non-iterable type: ${e}`);else return n.set(e,a.value),a.value}function K0e(e,t=gV){return mV(e,t)}function mV(e,t,n=new Set){let r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");let a=t(e);if(a.recurse&&a.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse)if(kp(r)){let i=Array.isArray(r)?[]:{};n.add(r);for(let s in r){let o=e.map(c=>c[s]),l=mV(o,t,n);i[s]=l}return n.delete(r),i}else throw new Error(`Can't recurse into non-iterable type: ${r}`);else return a.value}function gV(e){return e===null?null:kp(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}async function yV(e,t){let n=new Map;fv(e,t,n);for(let r of Array.from(n.keys())){let a=n.get(r);if(k.isPromise(a)){let i=await a;n.set(r,i)}}return fv(e,t,n)}function kp(e){let t=!1;if(Q().get("IS_BROWSER"))t=e instanceof TextDecoder;else{let{StringDecoder:n}=Jz();t=e instanceof n}return e!=null&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||typeof e=="object"&&!(e instanceof Ze)&&!(e instanceof Promise)&&!t)}function X0e(e){return e==null||Y0e(e)||Array.isArray(e)||typeof e=="object"&&e instanceof Ze||k.isTypedArray(e)}function Y0e(e){return e===null||typeof e!="object"&&typeof e!="function"}function Z0e(e){return q0e(e,Q0e)}function Q0e(e){return e instanceof Ze?{value:e.clone(),recurse:!1}:kp(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var bV=class{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,e==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(let t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);let e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");let t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}},KN=class extends bV{constructor(){super(KN.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){let e=this.capacity*2,t=new Array(e),n=this.length();for(let r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}};KN.INITIAL_CAPACITY=32;function vV(e){return new tbe(e)}function XN(e){return new nbe(e)}function J0e(e,t){return new xV(e,t)}function ebe(e,t=fo.FAIL){return new dbe(e,t)}var Gn=class{async toArray(){let e=[],t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){let e=this.prefetch(100),t=[],n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new ube(this,e)}filter(e){return new obe(this,e)}map(e){return new lbe(this,e)}mapAsync(e){return new mD(this,e)}serialMapAsync(e){return new mD(this,e).serial()}flatmap(e){return new cbe(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(t=>t===!0)}rowMajorBatch(e,t=!0){return new sbe(this,e,t)}columnMajorBatch(e,t=!0,n=gV){return this.rowMajorBatch(e,t).map(r=>K0e(r,n))}concatenate(e,t){return new xV(vV([this,e]),t)}take(e){return e<0||e==null?this:new ibe(this,e)}skip(e){return e<0||e==null?this:new abe(this,e)}prefetch(e){return new wV(this,e)}shuffle(e,t){return new pbe(this,e,t)}serial(){return new rbe(this)}},tbe=class extends Gn{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};let e=this.items[this.trav];return this.trav++,{value:Z0e(e),done:!1}}},nbe=class extends Gn{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(e){throw e.message=`Error thrown while iterating through a dataset: ${e.message}`,e}}},rbe=class extends Gn{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}},abe=class extends Gn{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){let e=await this.upstream.next();if(e.done)return e;je(e.value)}return this.upstream.next()}},ibe=class extends Gn{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}},sbe=class extends Gn{constructor(e,t,n=!0){super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){let e=[];for(;e.length<this.batchSize;){let t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}},obe=class extends Gn{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){let e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;je(e.value)}}},lbe=class extends Gn{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Map`}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=xi.getTensorsInContainer(e.value),n=this.transform(e.value),r=xi.getTensorsInContainer(n);for(let a of t)xi.isTensorInList(a,r)||a.dispose();return{value:n,done:!1}}},ube=class extends Gn{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}},mD=class extends Gn{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=xi.getTensorsInContainer(e.value),n=await this.transform(e.value),r=xi.getTensorsInContainer(n);for(let a of t)xi.isTensorInList(a,r)||a.dispose();return{value:n,done:!1}}},YN=class extends Gn{constructor(){super(),this.outputQueue=new KN,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}},cbe=class extends YN{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){let e=await this.upstream.next();if(e.done)return!1;let t=xi.getTensorsInContainer(e.value),n=this.transform(e.value),r=xi.getTensorsInContainer(n);this.outputQueue.pushAll(n);for(let a of t)xi.isTensorInList(a,r)||a.dispose();return!0}},xV=class extends Gn{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,this.iterator==null){let n=await this.moreIterators.next();if(n.done)return{value:null,done:!0};this.iterator=n.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}let t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}},fo;(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(fo||(fo={}));var dbe=class extends Gn{constructor(e,t=fo.FAIL){super(),this.iterators=e,this.mismatchMode=t,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let t=0,n=0;function r(i){return i instanceof Gn?{value:i.next().then(s=>(t++,s.done&&n++,s.value)),recurse:!1}:{value:null,recurse:!0}}let a=await yV(this.iterators,r);if(t===n)return{value:null,done:!0};if(n>0)switch(this.mismatchMode){case fo.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case fo.SHORTEST:return{value:null,done:!0};case fo.LONGEST:}return this.count++,{value:a,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}},wV=class extends Gn{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new bV(t)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){let e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}},pbe=class extends wV{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=G0e.alea(n||k.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){let e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(t.done)this.upstreamExhausted=!0;else return this.refill(),t}return{value:null,done:!0}}},qh=class{constructor(){this.size=null}batch(e,t=!0){let n=this;k.assert(e>0,()=>`batchSize needs to be positive, but it is
      ${e}`);let r;return this.size===1/0||this.size==null?r=this.size:t?r=Math.ceil(this.size/e):r=Math.floor(this.size/e),Qr(async()=>(await n.iterator()).columnMajorBatch(e,t,mbe),r)}concatenate(e){let t=this,n;return this.size===1/0||e.size===1/0?n=1/0:this.size!=null&&e.size!=null?n=this.size+e.size:n=null,Qr(async()=>(await t.iterator()).concatenate(await e.iterator()),n)}filter(e){let t=this,n;return this.size===1/0?n=1/0:n=null,Qr(async()=>(await t.iterator()).filter(r=>G(()=>e(r))),n)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){let t=this;return Qr(async()=>(await t.iterator()).map(n=>G(()=>e(n))),this.size)}mapAsync(e){let t=this;return Qr(async()=>(await t.iterator()).mapAsync(e),this.size)}prefetch(e){if(e==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");let t=this;return Qr(async()=>(await t.iterator()).prefetch(e),this.size)}repeat(e){let t=this,n;return this.size!=null&&e>0?n=this.size*e:e===0?n=0:this.size!=null&&(e===void 0||e<0)?n=1/0:n=null,Qr(async()=>{let r=XN(async()=>({value:await t.iterator(),done:!1}));return J0e(r.take(e))},n)}skip(e){let t=this,n;return this.size!=null&&e>=0&&this.size>=e?n=this.size-e:this.size!=null&&(this.size<e||e===void 0||e<0)?n=0:n=null,Qr(async()=>(await t.iterator()).skip(e),n)}shuffle(e,t,n=!0){if(e==null||e<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);let r=this,a=H0e.alea(t||k.now().toString());return Qr(async()=>{let i=a.int32();return n&&(i+=a.int32()),(await r.iterator()).shuffle(e,i.toString())},this.size)}take(e){let t=this,n;return this.size!=null&&this.size>e?n=e:this.size!=null&&this.size<=e?n=this.size:n=null,Qr(async()=>(await t.iterator()).take(e),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}};qh.MAX_BUFFER_SIZE=1e4;function Qr(e,t=null){return new class extends qh{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function hbe(e){return Qr(async()=>vV(e),e.length)}function fbe(e){if(!kp(e))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(e))for(let n=0;n<e.length;n++)t=t==null?e[n].size:Math.min(t,e[n].size);else if(e instanceof Object)for(let n in e)t=t==null?e[n].size:Math.min(t,e[n].size);return Qr(async()=>{let n=await yV(e,r=>{if(r instanceof qh)return{value:r.iterator(),recurse:!1};if(kp(r))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return ebe(n,fo.SHORTEST)},t)}function mbe(e){if(e===null)return null;let t=e[0];return X0e(t)?{value:gbe(e),recurse:!1}:{value:null,recurse:!0}}function gbe(e){if(e.length===0)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof Ze?Fn(e):Ir(e)}var kV=class extends qh{constructor(e){super(),this.input=e}async iterator(){return(await this.input.iterator()).decodeUTF8().split(`
`).map(e=>(e.endsWith("\r")&&(e=e.slice(0,-1)),e))}},x0='"',Sf=Symbol("out"),gD=Symbol("field"),w0=Symbol("quote"),yk=Symbol("quoteafterquote"),yD=Symbol("quoteinquote"),SV=class extends qh{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){let e=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&e&&k.assert(e.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=e);let t=this.fullColumnNames.reduce((r,a)=>(r[a]=r[a]+1||1,r),{}),n=Object.keys(t).filter(r=>t[r]>1);if(k.assert(n.length===0,()=>"Duplicate column names found: "+n.toString()),this.columnConfigs){for(let r of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(r)===-1)throw new Error('The key "'+r+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){let e=await(await this.base.iterator()).next();if(e.done)throw new Error("No data was found for CSV parsing.");let t=e.value;return this.parseRow(t,!1)}else return null}constructor(e,t){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new kV(e),t||(t={}),this.hasHeader=t.hasHeader!==!1,this.fullColumnNames=t.columnNames,this.columnConfigs=t.columnConfigs,this.configuredColumnsOnly=t.configuredColumnsOnly,t.delimWhitespace?(k.assert(t.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=t.delimiter?t.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map(t=>this.makeDataElement(t))}makeDataElement(e){let t=this.parseRow(e),n={},r={};for(let a=0;a<this.fullColumnNames.length;a++){let i=this.fullColumnNames[a],s=this.columnConfigs?this.columnConfigs[i]:null;if(!(this.configuredColumnsOnly&&!s)){let o=t[a],l=null;if(o==="")if(s&&s.default!==void 0)l=s.default;else{if(s&&(s.required||s.isLabel))throw new Error(`Required column ${i} is empty in this line: ${e}`);l=void 0}else{let c=Number(o);if(isNaN(c))s&&s.dtype==="bool"?l=this.getBoolean(o):l=o;else if(!s||!s.dtype)l=c;else switch(s.dtype){case"float32":l=c;break;case"int32":l=Math.floor(c);break;case"bool":l=this.getBoolean(o);break;default:l=c}}s&&s.isLabel?r[i]=l:n[i]=l}}return Object.keys(r).length===0?n:{xs:n,ys:r}}getBoolean(e){return e==="1"||e.toLowerCase()==="true"?1:0}parseRow(e,t=!0){let n=[],r=0,a=e.length,i=Sf;for(let s=0;s<a;s++)switch(i){case Sf:switch(e.charAt(s)){case x0:r=s+1,i=w0;break;case this.delimiter:if(r=s+1,this.delimiter===" "&&this.delimWhitespace)break;n.push(""),i=Sf;break;default:i=gD,r=s;break}break;case gD:switch(e.charAt(s)){case this.delimiter:n.push(e.substring(r,s)),i=Sf,r=s+1;break}break;case w0:switch(e.charAt(s)){case x0:i=yk;break}break;case yk:switch(e.charAt(s)){case this.delimiter:n.push(e.substring(r,s-1)),i=Sf,r=s+1;break;case x0:i=w0;break;default:i=yD;break}break;case yD:switch(e.charAt(s)){case x0:i=w0;break}break}if(i===yk?n.push(e.substring(r,a-1)):n.push(e.substring(r)),t&&n.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${n}`);return n}},IV=class extends Gn{constructor(e){super(),this.microphoneConfig=e,this.isClosed=!1,this.fftSize=e.fftSize||1024;let t=Math.log2(this.fftSize);if(this.fftSize<0||t<4||t>14||!Number.isInteger(t))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=e.numFramesPerSpectrogram||43,this.sampleRateHz=e.sampleRateHz,this.columnTruncateLength=e.columnTruncateLength||this.fftSize,this.audioTrackConstraints=e.audioTrackConstraints,this.smoothingTimeConstant=e.smoothingTimeConstant||0,this.includeSpectrogram=e.includeSpectrogram!==!1,this.includeWaveform=e.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(e={}){if(!Q().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");let t=new IV(e);return await t.start(),t}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(n){throw new Error(`Error thrown while initializing video stream: ${n.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");let e=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new e,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`);let t=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,t.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let e,t,n=await this.getAudioData();if(this.includeSpectrogram){let r=this.flattenQueue(n.freqDataQueue);e=this.getTensorFromAudioDataArray(r,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){let r=this.flattenQueue(n.timeDataQueue);t=this.getTensorFromAudioDataArray(r,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:e,waveform:t},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){let e=[],t=[],n=0;return new Promise(r=>{let a=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&r({freqDataQueue:e,timeDataQueue:t}),e.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),t.push(this.timeData.slice())),++n===this.numFrames&&(clearInterval(a),r({freqDataQueue:e,timeDataQueue:t}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(e){let t=e[0].length,n=new Float32Array(e.length*t);return e.forEach((r,a)=>n.set(r,a*t)),n}getTensorFromAudioDataArray(e,t){let n=new Float32Array(k.sizeFromShape(t));return n.set(e,n.length-e.length),Ir(n,t)}},CV=class extends Gn{constructor(e,t){if(super(),this.webcamVideoElement=e,this.webcamConfig=t,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=It([0],"int32"),this.webcamConfig.centerCrop){let n=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,r=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,a=(1-n)/2,i=(1-r)/2,s=a+n,o=r+i;this.cropBox=Xi([i,a,o,s],[1,4])}else this.cropBox=Xi([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(e,t={}){if(!Q().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!e){if(e=document.createElement("video"),!t.resizeWidth||!t.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");e.width=t.resizeWidth,e.height=t.resizeHeight}let n=new CV(e,t);return await n.start(),n}async start(){this.webcamConfig.facingMode&&k.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(e){throw e.message=`Error thrown while initializing video stream: ${e.message}`,e}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(e=>{this.webcamVideoElement.onloadedmetadata=()=>{e()}})}async next(){if(this.isClosed)return{value:null,done:!0};let e;try{e=ny.fromPixels(this.webcamVideoElement)}catch(t){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(t)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(e),done:!1}}catch(t){throw new Error(`Error thrown cropping the video: ${t.message}`)}finally{e.dispose()}else return{value:e,done:!1}}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(e){return G(()=>{let t=Qn(he(e,"float32"),0),n;n=Ia.cropAndResize(t,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");let r=n.shape;return H(n,r.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(e=>e.stop());try{this.webcamVideoElement.srcObject=null}catch(e){console.log(e),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}},_V=class{},TV=class extends Gn{split(e){return new ybe(this,e)}},ybe=class extends TV{constructor(e,t){super(),this.upstream=e,this.impl=new bbe(e,t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},bbe=class extends YN{constructor(e,t){super(),this.upstream=e,this.separator=t,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){let e=await this.upstream.next();if(e.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);let t=e.value.split(this.separator);t[0]=this.carryover+t[0];for(let n of t.slice(0,-1))this.outputQueue.push(n);return this.carryover=t[t.length-1],!0}},vbe=class extends Gn{decodeUTF8(){return new xbe(this)}},xbe=class extends TV{constructor(e){super(),this.upstream=e,this.impl=new wbe(e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}},wbe=class extends YN{constructor(e){if(super(),this.upstream=e,Q().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{let{StringDecoder:t}=Jz();this.decoder=new t("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}async pump(){let e=await this.upstream.next(),t;if(e.done)return!1;t=e.value;let n;return Q().get("IS_BROWSER")?n=this.decoder.decode(t,{stream:!0}):n=this.decoder.write(Buffer.from(t.buffer)),this.outputQueue.push(n),!0}},NV=class extends vbe{constructor(e,t={}){super(),this.file=e,this.options=t,k.assert(e instanceof Uint8Array||(Q().get("IS_BROWSER")?e instanceof File||e instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=t.offset||0,this.chunkSize=t.chunkSize||1024*1024}summary(){return`FileChunks ${this.file}`}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise((e,t)=>{let n=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)e(new Uint8Array(this.file.slice(this.offset,n)));else{let r=new FileReader;r.onload=i=>{let s=r.result;if(s instanceof ArrayBuffer&&(s=new Uint8Array(s)),!(s instanceof Uint8Array))return t(new TypeError("FileReader returned unknown type."));e(s)},r.onabort=i=>t(new Error("Aborted")),r.onerror=i=>t(new Error(i.type));let a=this.file.slice(this.offset,n);r.readAsArrayBuffer(a)}this.offset=n}),done:!1}}};async function kbe(e,t={},n){let r,a;typeof e=="string"?r=e:(r=e.url,a=Sbe(e));let i=await(n||k.fetch)(r,a);if(i.ok){let s=new Uint8Array(await i.arrayBuffer());return new NV(s,t)}else throw new Error(i.statusText)}var Sbe=e=>({method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity});function EV(e){return typeof e=="string"&&e.slice(0,7)==="file://"}var $V=class extends _V{constructor(e,t={}){super(),this.input=e,this.options=t}async iterator(){if(EV(this.input)&&Q().get("IS_NODE")){let e=WC();this.input=e.readFileSync(this.input.slice(7))}return new NV(this.input,this.options)}},AV=class extends _V{constructor(e,t={}){super(),this.url=e,this.fileOptions=t}async iterator(){return EV(this.url)?new $V(this.url,this.fileOptions).iterator():kbe(this.url,this.fileOptions)}};function Ibe(e,t={}){return new SV(new AV(e),t)}function Cbe(e){let t=XN(e);return Qr(async()=>t)}function _be(e){return Qr(async()=>{let t=await e();return XN(()=>t.next())})}async function Tbe(e,t){return CV.create(e,t)}async function Nbe(e){return IV.create(e)}var Ebe="4.7.0";function Ee(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&k.assert(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}var $be=rs.whereImpl,G1=class extends mg{nextDataId(){return G1.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new $x(this,Ga())}write(e,t,n){this.firstUse&&(this.firstUse=!1,Q().get("IS_NODE")&&N.warn(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));let r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}makeTensorInfo(e,t,n){let r;if(t==="string"&&n!=null&&n.length>0&&k.isString(n[0])){let a=n.map(i=>k.encodeString(i));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){let t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){let t=this.data.get(e);t.refCount--}}move(e,t,n,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){let{dtype:t,complexTensorInfos:n}=this.data.get(e);if(t==="complex64"){let r=this.readSync(n.real.dataId),a=this.readSync(n.imag.dataId);return N.mergeRealAndImagArrays(r,a)}return k.convertBackendValuesAndArrayBuffer(this.data.get(e).values,t)}bufferSync(e){let t=this.readSync(e.dataId);if(e.dtype==="string")try{let n=t.map(r=>k.decodeString(r));return et(e.shape,e.dtype,n)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return et(e.shape,e.dtype,t)}makeOutput(e,t,n){return Ga().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;let{complexTensorInfos:n}=this.data.get(e);n!=null&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){let t=k.now();return e(),{kernelMs:k.now()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Ee([e],"where");let t=this.readSync(e.dataId);return $be(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}};G1.nextDataId=0;var ZN={};He(ZN,{addImpl:()=>DV,bincountImpl:()=>JN,bincountReduceImpl:()=>MV,bitwiseAndImpl:()=>OV,castImpl:()=>FV,ceilImpl:()=>PV,concatImpl:()=>eE,equalImpl:()=>zV,expImpl:()=>BV,expm1Impl:()=>VV,floorDivImpl:()=>jV,floorImpl:()=>UV,gatherNdImpl:()=>HV,gatherV2Impl:()=>GV,greaterEqualImpl:()=>KV,greaterImpl:()=>qV,lessEqualImpl:()=>YV,lessImpl:()=>XV,linSpaceImpl:()=>ZV,logImpl:()=>QV,maxImpl:()=>JV,maximumImpl:()=>e5,minimumImpl:()=>t5,multiplyImpl:()=>tE,negImpl:()=>n5,notEqualImpl:()=>r5,prodImpl:()=>a5,raggedGatherImpl:()=>i5,raggedRangeImpl:()=>s5,raggedTensorToTensorImpl:()=>o5,rangeImpl:()=>rE,rsqrtImpl:()=>l5,scatterImpl:()=>Vl,sigmoidImpl:()=>Nve,simpleAbsImpl:()=>RV,sliceImpl:()=>gv,sparseFillEmptyRowsImpl:()=>c5,sparseReshapeImpl:()=>d5,sparseSegmentReductionImpl:()=>aE,sqrtImpl:()=>Ave,squaredDifferenceImpl:()=>p5,staticRegexReplaceImpl:()=>h5,stridedSliceImpl:()=>f5,stringNGramsImpl:()=>iE,stringSplitImpl:()=>sE,stringToHashBucketFastImpl:()=>oE,subImpl:()=>m5,tileImpl:()=>g5,topKImpl:()=>b5,transposeImpl:()=>nE,uniqueImpl:()=>uE});function RV(e){let t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var Abe=e=>{let{x:t}=e.inputs,n=e.backend;Ee(t,"abs");let r=new Float32Array(k.sizeFromShape(t.shape)),a=n.data.get(t.dataId).values;return r=RV(a),n.makeOutput(r,t.shape,t.dtype)},Rbe={kernelName:Mp,backendName:"cpu",kernelFunc:Abe};function gn(e){return(t,n,r,a,i)=>{let s=N.assertAndGetBroadcastShape(t,n),o=s.length,l=k.computeStrides(s),c=k.sizeFromShape(s),u=k.getTypedArrayFromDType(i,c),d=t.length,p=n.length,h=k.computeStrides(t),f=k.computeStrides(n),m=N.getBroadcastDims(t,s),g=N.getBroadcastDims(n,s);if(m.length+g.length===0)for(let y=0;y<u.length;++y)u[y]=e(r[y%r.length],a[y%a.length]);else for(let y=0;y<u.length;++y){let b=k.indexToLoc(y,o,l),v=b.slice(-d);m.forEach(C=>v[C]=0);let x=k.locToIndex(v,d,h),w=b.slice(-p);g.forEach(C=>w[C]=0);let S=k.locToIndex(w,p,f);u[y]=e(r[x],a[S])}return[u,s]}}function ta(e){let{inputs:t,backend:n}=e,{real:r,imag:a}=t,i=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,o=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(o.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",s)},o}var Fbe={kernelName:Fx,backendName:"cpu",kernelFunc:ta};function mv(e,t,n="float32"){if(n==="complex64"){let a=mv(e,t,"float32"),i=mv(e,t,"float32");return ta({inputs:{real:a,imag:i},backend:e})}let r=k.makeZerosTypedArray(k.sizeFromShape(t),n);return e.makeTensorInfo(t,n,r)}function Ji(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var Dbe={kernelName:sc,backendName:"cpu",kernelFunc:Ji};function bu(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var Mbe={kernelName:jx,backendName:"cpu",kernelFunc:bu};function FV(e,t,n,r){if(r==="int32"){let a=Int32Array.from(e);return[t,"int32",a]}if(r==="bool"){let a=k.toTypedArray([0],n),[i,s]=gn((o,l)=>o!==l?1:0)(t,[],e,a,"bool");return[s,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function Ho(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dtype:i}=r;if(i==="complex64"){if(a.dtype==="complex64")return Ji({inputs:{x:a},backend:n});let u=mv(n,a.shape,a.dtype),d=Ho({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),p=ta({inputs:{real:d,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),p}if(a.dtype==="complex64"){let u=bu({inputs:{input:a},backend:n}),d=Ho({inputs:{x:u},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(u),d}if(!k.hasEncodingLoss(a.dtype,i)){let u=Ji({inputs:{x:a},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:i}}let s=n.data.get(a.dataId).values,[o,l,c]=FV(s,a.shape,a.dtype,i);return n.makeTensorInfo(o,l,c)}var Obe={kernelName:Wu,backendName:"cpu",kernelFunc:Ho};function Pn(e,t,n,r){return n==null?({inputs:a,backend:i})=>{let{a:s,b:o}=a,l=i;Ee([s,o],e);let c=l.data.get(s.dataId).values,u=l.data.get(o.dataId).values,d=s.dtype==="string"?N.fromUint8ToStringArray(c):c,p=s.dtype==="string"?N.fromUint8ToStringArray(u):u,h=r||s.dtype,[f,m]=t(s.shape,o.shape,d,p,h);return l.makeTensorInfo(m,h,f)}:({inputs:a,backend:i})=>{let{a:s,b:o}=a,l=i;if(s.dtype==="complex64"||o.dtype==="complex64"){let c=Ho({inputs:{x:s},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),d=u.complexTensorInfos.real,p=u.complexTensorInfos.imag,h=l.data.get(d.dataId).values,f=l.data.get(p.dataId).values,m=Ho({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),g=l.data.get(m.dataId),y=g.complexTensorInfos.real,b=g.complexTensorInfos.imag,v=l.data.get(y.dataId).values,x=l.data.get(b.dataId).values,[w,S,C]=n(s.shape,o.shape,h,f,v,x),T=l.makeTensorInfo(C,"float32",w),E=l.makeTensorInfo(C,"float32",S),R=ta({inputs:{real:T,imag:E},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(T),l.disposeIntermediateTensorInfo(E),R}else{let c=l.data.get(s.dataId).values,u=l.data.get(o.dataId).values,d=r||s.dtype,[p,h]=t(s.shape,o.shape,c,u,d);return l.makeTensorInfo(h,d,p)}}}function QN(e){return(t,n,r,a,i,s)=>{let o=N.assertAndGetBroadcastShape(t,n),l=k.sizeFromShape(o),c=o.length,u=k.computeStrides(o),d=k.getTypedArrayFromDType("float32",l),p=k.getTypedArrayFromDType("float32",l),h=N.getBroadcastDims(t,o),f=N.getBroadcastDims(n,o),m=N.mergeRealAndImagArrays(r,a),g=N.mergeRealAndImagArrays(i,s),y=t.length,b=k.computeStrides(t),v=n.length,x=k.computeStrides(n);if(h.length+f.length===0)for(let w=0;w<d.length;w++){let S=w%m.length,C=w%g.length,T=e(m[S*2],m[S*2+1],g[C*2],g[C*2+1]);d[w]=T.real,p[w]=T.imag}else for(let w=0;w<d.length;w++){let S=k.indexToLoc(w,c,u),C=S.slice(-y);h.forEach(_=>C[_]=0);let T=k.locToIndex(C,y,b),E=S.slice(-v);f.forEach(_=>E[_]=0);let R=k.locToIndex(E,v,x),$=e(m[T*2],m[T*2+1],g[R*2],g[R*2+1]);d[w]=$.real,p[w]=$.imag}return[d,p,o]}}var DV=gn((e,t)=>e+t),Pbe=QN((e,t,n,r)=>({real:e+n,imag:t+r})),Sp=Pn(Jo,DV,Pbe),zbe={kernelName:Jo,backendName:"cpu",kernelFunc:Sp};function JN(e,t,n,r,a){let i=k.sizeFromShape(r),s=k.makeZerosTypedArray(a,n);for(let o=0;o<e.length;o++){let l=e[o];if(l<0)throw new Error("Input x must be non-negative!");l>=a||(i>0?s[l]+=t[o]:s[l]+=1)}return s}function MV(e,t,n,r=!1){let a=e.shape[0],i=e.shape[1],s=et([a,n],t.dtype);for(let o=0;o<a;o++)for(let l=0;l<i;l++){let c=e.get(o,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?s.set(1,o,c):t.size>0?s.set(s.get(o,c)+t.get(o,l),o,c):s.set(s.get(o,c)+1,o,c))}return s}var OV=gn((e,t)=>e&t),Lbe=Pn(Up,OV),Bbe={kernelName:Up,backendName:"cpu",kernelFunc:Lbe};function is(e){return(t,n,r)=>{let a=k.getArrayFromDType(n,t.length);for(let i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}function _t(e,t,n){let r=is(t);return ll(e,r,n)}function ll(e,t,n){return({inputs:r,attrs:a,backend:i})=>{let{x:s}=r;Ee(s,e);let o=i,l=o.data.get(s.dataId).values,c;if(s.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=N.fromUint8ToStringArray(l)}else c=l;let u=n||s.dtype,d=t(c,u,a);return o.makeTensorInfo(s.shape,u,d)}}var PV=is(e=>Math.ceil(e)),Wbe=ll(Vu,PV),Vbe={kernelName:Vu,backendName:"cpu",kernelFunc:Wbe};function eE(e,t,n,r){let a=k.getArrayFromDType(n,k.sizeFromShape(t));if(r&&n!=="string"){let i=0;e.forEach(s=>{let o=k.sizeFromShape(s.shape);a.set(s.vals,i),i+=o})}else{let i=0;e.forEach(s=>{let o=n==="string"?N.fromUint8ToStringArray(s.vals):s.vals,l=0;for(let c=0;c<s.shape[0];++c){let u=c*t[1]+i;for(let d=0;d<s.shape[1];++d)a[u+d]=o[l++]}i+=s.shape[1]})}return a}var zV=gn((e,t)=>e===t?1:0),LV=Pn(Zp,zV,null,"bool"),Ube={kernelName:Zp,backendName:"cpu",kernelFunc:LV},BV=is(e=>Math.exp(e)),WV=ll(ec,BV,"float32"),jbe={kernelName:ec,backendName:"cpu",kernelFunc:WV},VV=is(e=>Math.expm1(e)),Hbe=ll(tc,VV),Gbe={kernelName:tc,backendName:"cpu",kernelFunc:Hbe},UV=is(e=>Math.floor(e)),qbe=ll(nc,UV),Kbe={kernelName:nc,backendName:"cpu",kernelFunc:qbe},jV=gn((e,t)=>Math.floor(e/t)),Xbe=Pn(rc,jV,null,"int32"),Ybe={kernelName:rc,backendName:"cpu",kernelFunc:Xbe};function HV(e,t,n,r,a,i,s,o,l){let c=et([r,i],n);for(let u=0;u<r;u++){let d=[],p=0;for(let h=0;h<a;h++){let f=e[u*a+h];p+=f*s[h],d.push(f)}if(p<0||p>=l/i)throw new Error(`Invalid indices: ${d} does not index into ${o}`);for(let h=0;h<i;h++)c.values[u*i+h]=t.get(...t.indexToLoc(p*i+h))}return c}function GV(e,t,n){let r=et(n,e.dtype);for(let a=0;a<r.size;++a){let i=r.indexToLoc(a).slice(),s=i[0],o=i[2],l=t.locToIndex([s,o]);i[2]=t.values[l];let c=e.locToIndex(i);0<=c&&c<e.values.length&&(r.values[a]=e.values[c])}return r}var qV=gn((e,t)=>e>t?1:0),Zbe=Pn(nh,qV,null,"bool"),Qbe={kernelName:nh,backendName:"cpu",kernelFunc:Zbe},KV=gn((e,t)=>e>=t?1:0),Jbe=Pn(ic,KV,null,"bool"),eve={kernelName:ic,backendName:"cpu",kernelFunc:Jbe},XV=gn((e,t)=>e<t?1:0),tve=Pn(rh,XV,null,"bool"),nve={kernelName:rh,backendName:"cpu",kernelFunc:tve},YV=gn((e,t)=>e<=t?1:0),rve=Pn(ah,YV,null,"bool"),ave={kernelName:ah,backendName:"cpu",kernelFunc:rve};function ZV(e,t,n){let r=(t-e)/(n-1),a=k.makeZerosTypedArray(n,"float32");a[0]=e;for(let i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}var QV=is(e=>Math.log(e)),ive=ll(dc,QV),sve={kernelName:dc,backendName:"cpu",kernelFunc:ive};function JV(e,t,n,r){let a=k.getTypedArrayFromDType(r,k.sizeFromShape(n));for(let i=0;i<a.length;++i){let s=i*t,o=e[s];for(let l=0;l<t;++l){let c=e[s+l];(Number.isNaN(c)||c>o)&&(o=c)}a[i]=o}return a}var e5=gn((e,t)=>Math.max(e,t)),ove=Pn(mc,e5),lve={kernelName:mc,backendName:"cpu",kernelFunc:ove},t5=gn((e,t)=>Math.min(e,t)),uve=Pn(vc,t5),cve={kernelName:vc,backendName:"cpu",kernelFunc:uve},tE=gn((e,t)=>e*t),dve=QN((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n})),q1=Pn(kc,tE,dve),pve={kernelName:kc,backendName:"cpu",kernelFunc:q1};function n5(e,t,n){let r=k.createScalarValue(-1,n);return tE([],t,r,e,n)}function hve(e){let{inputs:t,backend:n}=e,{x:r}=t;Ee(r,"neg");let a=n.data.get(r.dataId).values,[i,s]=n5(a,r.shape,r.dtype);return n.makeTensorInfo(s,r.dtype,i)}var fve={kernelName:ph,backendName:"cpu",kernelFunc:hve},r5=gn((e,t)=>e!==t?1:0),mve=Pn(hh,r5,null,"bool"),gve={kernelName:hh,backendName:"cpu",kernelFunc:mve};function nE(e,t,n,r,a){let i=t.length,s=k.sizeFromShape(t),o=k.computeStrides(t),l=k.computeStrides(a),c=k.getTypedArrayFromDType(n,k.sizeFromShape(a));for(let u=0;u<s;++u){let d=k.indexToLoc(u,i,o),p=new Array(d.length);for(let f=0;f<p.length;f++)p[f]=d[r[f]];let h=k.locToIndex(p,i,l);c[h]=e[u]}return c}function Hr(e){let{inputs:t,attrs:n,backend:r}=e,{x:a}=t,{perm:i}=n;Ee(a,"transpose");let s=a.shape.length,o=new Array(s);for(let u=0;u<o.length;u++)o[u]=a.shape[i[u]];let l=r.data.get(a.dataId).values,c=nE(l,a.shape,a.dtype,i,o);return{dataId:r.write(c,o,a.dtype),shape:o,dtype:a.dtype}}var yve={kernelName:Ts,backendName:"cpu",kernelFunc:Hr};function a5(e,t,n,r){let[a,i]=N.computeOutAndReduceShapes(e,r),s=Fa(t,"int32"),o=k.makeZerosTypedArray(k.sizeFromShape(a),s),l=k.sizeFromShape(i);for(let c=0;c<o.length;++c){let u=c*l,d=1;for(let p=0;p<l;++p)d*=n[u+p];o[c]=d}return{outVals:o,outShape:a,outDtype:s}}function bve(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;Ee(a,"prod");let o=a.shape.length,l=k.parseAxisParam(i,a.shape),c=N.getAxesPermutation(l,o),u=l,d=a,p=[];c!=null&&(d=Hr({inputs:{x:a},backend:n,attrs:{perm:c}}),p.push(d),u=N.getInnerMostAxes(u.length,o));let h=n.data.get(d.dataId).values,{outVals:f,outShape:m,outDtype:g}=a5(d.shape,d.dtype,h,u),y=m;return s&&(y=N.expandShapeToKeepDim(m,l)),p.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(y,g,f)}var vve={kernelName:Tc,backendName:"cpu",kernelFunc:bve};function xve(e,t,n){e.forEach((r,a)=>{if(r<0||r>=n){let i=k.indexToLoc(a,t.length,k.computeStrides(t)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${n})`)}})}function wve(e,t){for(let n=0;n<e.length;++n){let r=e[n],a=n===e.length-1?t:e[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function kve(e,t,n,r){let a=[],i=0,s=t.length-1+n.length,o=new Array(s).fill(null).map(()=>[0]);wve(n,r);let l=1;for(let c=0;c<t.length-1;++c){l*=t[c];let u=t[c+1];for(let d=1;d<l+1;++d)o[c].push(d*u)}for(let c=0;c<e.length;++c){let u=e[c],d=e[c]+1;for(let p=0;p<n.length;++p){let h=n[p],f=p+t.length-1;if(f>=0){let m=o[f],g=m[m.length-1]-h[u];for(let y=u;y<d;++y)o[f].push(h[y+1]+g)}u=h[u],d=h[d]}d!==u&&(a.push([u,d]),i+=d-u)}return{outSplits:o,valueSlices:a,numValues:i}}function Sve(e){let t=[];for(let n=0;n<e.length;++n){let r=e[n].length,a=k.getArrayFromDType("int32",r);t.push(a),e[n].forEach((i,s)=>a[s]=i)}return t}function bD(e,t){let n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function Ive(e,t,n,r,a,i){let s=bD(t,2)[1],o=bD(i,2)[1],l=0;for(let c of n)for(let u=c[0];u<c[1];++u){for(let d=0;d<r;++d)a[l*o+d]=e[u*s+d];++l}}function Cve(e,t,n,r,a){let i=t.slice();i[0]=a;let s=k.getArrayFromDType(n,k.sizeFromShape(i)),o=e.length,l=o===0?0:o/t[0];return Ive(e,t,r,l,s,i),[s,i]}function i5(e,t,n,r,a,i,s,o){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");let l=t[0][0]-1;if(xve(i,s,l),r.length===0)throw new Error("params.rank must be nonzero");let c=r[0],{outSplits:u,valueSlices:d,numValues:p}=kve(i,s,e,c),h=Sve(u),f=Cve(n,r,a,d,p);return[h,f[0],f[1]]}var vD=2147483647;function s5(e,t,n,r,a,i,s){if(t.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(s.length>1)throw new Error("deltas must be a scalar or vector");let o=t.length===0,l=a.length===0,c=s.length===0,u=[];o||u.push(t[0]),l||u.push(a[0]),c||u.push(s[0]);for(let g=1;g<u.length;++g)if(u[g]!==u[g-1])throw new Error("starts, limits, and deltas must have the same shape");let d=u.length===0?1:u[0],p=k.getArrayFromDType("int32",d+1);p[0]=0;for(let g=0;g<d;++g){let y=o?e[0]:e[g],b=l?r[0]:r[g],v=c?i[0]:i[g];if(v===0)throw new Error("Requires delta != 0");let x;if(v>0&&b<y||v<0&&b>y)x=0;else if(x=Math.ceil(Math.abs((b-y)/v)),x>vD)throw new Error(`Requires ((limit - start) / delta) <= ${vD}`);p[g+1]=p[g]+x}let h=p[d],f=k.getArrayFromDType(n,h),m=0;for(let g=0;g<d;++g){let y=p[g+1]-p[g],b=o?e[0]:e[g],v=c?i[0]:i[g];for(let x=0;x<y;++x)f[m++]=b,b+=v}return[p,f]}var Ua=N.RowPartitionType,RI=class{constructor(e,t,n,r,a,i,s,o,l,c){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=r,this.valuesDType=a,this.defaultValue=i,this.defaultValueShape=s,this.rowPartitionValues=o,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=N.getRowPartitionTypesHelper(c),this.raggedRank=N.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Ua.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Ua.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){let t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Ua.VALUE_ROWIDS:return RI.getMaxWidthValueRowID(t);case Ua.ROW_SPLITS:return RI.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${Ua[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){let t=e.length;if(t===0||t===1)return 0;let n=0;for(let r=0;r<t-1;++r){let a=e[r+1]-e[r];a>n&&(n=a)}return n}static getMaxWidthValueRowID(e){let t=e.length;if(t===0)return 0;let n=0,r=e[0],a=0;for(let i=1;i<t;++i){let s=e[i];s!==r&&(r=s,a=Math.max(i-n,a),n=i)}return Math.max(t-n,a)}tensorShapeFromTensor(e,t,n=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return wD(e,n)}calculateOutputSize(e){let t=this.valuesShape,n=this.defaultValueShape;N.validateDefaultValueShape(n,t);let r=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=N.combineRaggedTensorToTensorShapes(this.raggedRank,r,t);a[0]<0&&(a[0]=e);for(let i=1;i<=this.raggedRank;++i)a[i]<0&&(a[i]=this.getMaxWidth(i));return a}calculateFirstParentOutputIndex(e,t,n){let r=Math.min(e,n),a=[],i=0;for(let s=0;s<r;++s,i+=t)a.push(i);for(let s=r;s<e;++s)a.push(-1);return k.assert(a.length===e,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(e,t,n,r){let a=e.length,i=[];for(let s=0;s<a-1;++s){let o=e[s+1]-e[s],l=Math.min(r,o),c=t[s];c===-1&&(l=0);for(let u=0;u<l;++u)i.push(c),c+=n;for(let u=0;u<o-l;++u)i.push(-1)}if(a>0&&i.length!==e[a-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,n,r){let a=e.length,i=[];if(a===0)return[];let s=0,o=e[0];if(o>=t.length)throw new Error(`Got currentValueRowId=${o}, which is not less than ${t.length}`);let l=t[o];i.push(l);for(let c=1;c<a;++c){let u=e[c];if(u===o)l>=0&&(++s,s<r?l+=n:l=-1);else{if(s=0,o=u,u>=t.length)throw new Error(`Got nextValueRowId=${u} which is not less than ${t.length}`);l=t[u]}i.push(l)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,t,n,r){let a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case Ua.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,r);case Ua.ROW_SPLITS:if(a.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(a,t,n,r);default:throw new Error(`Unsupported partition type: ${Ua[i]}`)}}getFirstDimensionSize(){let e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");let t=this.rowPartitionTypes[0];switch(t){case Ua.FIRST_DIM_SIZE:return e[0];case Ua.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ua.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ua[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");let e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let i=n.length-2;i>=0;--i)n[i]=n[i+1]*t[i+1];let r=wD(t,!1),a=k.getArrayFromDType(this.valuesDType,k.sizeFromShape(r));if(n[0]*t[0]>0){let i=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let s=1;s<=this.raggedRank;++s)i=this.calculateOutputIndex(s-1,i,n[s],t[s]);this.setOutput(this.raggedRank,i,a,r)}return[r,a]}setOutput(e,t,n,r){if(n.length===0)return;let a=this.values,i=n,s=r.slice();s=s.slice(e+1);let o=k.sizeFromShape(s),l=t.length,c=this.defaultValue;if(c.length!==o&&c.length!==1){let h=this.defaultValueShape;G(()=>{let f=H(c,h);c=Hl(f,s).dataSync()})}let u=0,d=0,p=0;for(let h=0;h<=l;++h){let f=h<l?t[h]:-1;if(f===p){++p;continue}if(d<p){let m=a.subarray(u*o),g=i.subarray(d*o),y=(p-d)*o;xD(g,m,y)}if(h>=l){let m=n.length;f=Math.floor(m/o)}if(f>p)if(this.defaultValue.length===1)i.subarray(p*o,f*o).fill(this.defaultValue[0]),p=f;else for(;f>p;){let m=i.slice(p*o);xD(m,c,o),++p}f<0?(u=h+1,d=p):(u=h,d=p,p=d+1)}}};function xD(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function wD(e,t){let n=[];for(let r of e){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function o5(e,t,n,r,a,i,s,o,l,c){return new RI(e,t,n,r,a,i,s,o,l,c).compute()}function rE(e,t,n,r){let a=e===t,i=e<t&&n<0,s=t<e&&n>1;if(a||i||s)return k.makeZerosTypedArray(0,r);let o=Math.abs(Math.ceil((t-e)/n)),l=k.makeZerosTypedArray(o,r);t<e&&n===1&&(n=-1),l[0]=e;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}var l5=is(e=>1/Math.sqrt(e)),_ve=ll(Mc,l5),Tve={kernelName:Mc,backendName:"cpu",kernelFunc:_ve};function Vl(e,t,n,r,a,i,s,o,l,c){let u=[r/a,a],d=e.values,p=t.values;if(r===0)return et(n,t.dtype);let h=l instanceof Sn?l:et(u,t.dtype);typeof l=="string"||typeof l=="number"?h.values.fill(l):typeof l=="boolean"&&h.values.fill(+l);for(let f=0;f<i;f++){let m=[],g=0;for(let y=0;y<s;y++){let b=d[f*s+y];m.push(b),g+=b*o[y]}if(g<0||g>=r/a)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let y=0;y<a;y++)c?h.values[g*a+y]+=p[f*a+y]:h.values[g*a+y]=t.rank===0?p[0]:p[f*a+y]}return h}var Nve=is(e=>1/(1+Math.exp(-e))),u5=_t(Bc,e=>1/(1+Math.exp(-e))),Eve={kernelName:Bc,backendName:"cpu",kernelFunc:u5};function gv(e,t,n,r,a){let i=Dn.isSliceContinous(r,t,n),s=k.sizeFromShape(n),o=k.computeStrides(r);if(i){let d=Dn.computeFlatOffset(t,o);return a==="string"?e.slice(d,d+s):e.subarray(d,d+s)}let l=a==="string"?N.fromUint8ToStringArray(e):e,c=et(r,a,l),u=et(n,a);for(let d=0;d<u.size;++d){let p=u.indexToLoc(d),h=p.map((f,m)=>f+t[m]);u.set(c.get(...h),...p)}return a==="string"?N.fromStringArrayToUint8(u.values):u.values}function vu(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,size:s}=r;Ee(a,"slice");let[o,l]=Dn.parseSliceParams(a,i,s);Dn.assertParamsValid(a,o,l);let c=n.data.get(a.dataId).values,u=gv(c,o,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,u)}var $ve={kernelName:_h,backendName:"cpu",kernelFunc:vu};function c5(e,t,n,r,a,i,s){let o=t[0],l=i[0],c=new Array(l),u=new Array(o),d=t[1];if(l===0){if(o!==0)throw new Error(N.getSparseFillEmptyRowsIndicesDenseShapeMismatch(o));let g=k.getArrayFromDType(n,0),y=k.getArrayFromDType(a,0);return[g,[0,d],y,c,u]}let p=!0,h=0,f=new Array(l).fill(0);for(let g=0;g<o;++g){let y=e[g*d];if(y<0)throw new Error(N.getSparseFillEmptyRowsNegativeIndexErrorMessage(g,y));if(y>=l)throw new Error(N.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(g,y,l));++f[y],p=p&&y>=h,h=y}let m=!0;for(let g=0;g<l;++g){let y=f[g]===0;c[g]=y,m=m&&!y,f[g]=Math.max(f[g],1),g>0&&(f[g]+=f[g-1])}if(m&&p){let g=e,y=r;for(let b=0;b<o;++b)u[b]=b;return[g,[o,d],y,c,u]}else{let g=f[l-1],y=k.getArrayFromDType(n,g*d),b=k.getArrayFromDType(a,g),v=new Array(l).fill(0);for(let x=0;x<o;++x){let w=e[x*d],S=v[w],C=(w===0?0:f[w-1])+S;v[w]++;for(let T=0;T<d;++T)y[C*d+T]=e[x*d+T];b[C]=r[x],u[x]=C}for(let x=0;x<l;++x)if(v[x]===0){let w=x===0?0:f[x-1];y[w*d+0]=x;for(let S=1;S<d;++S)y[w*d+S]=0;b[w]=s}return[y,[g,d],b,c,u]}}function d5(e,t,n,r,a){let i=k.sizeFromShape(r),s=t[0],o=a.length,l=[],c=1,u=-1;for(let m=0;m<o;++m){let g=a[m];if(g===-1){if(u!==-1)throw new Error(N.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(u,m));u=m,l.push(1)}else{if(g<0)throw new Error(N.getSparseReshapeNegativeOutputDimErrorMessage(m,g));c*=g,l.push(g)}}if(u!==-1){if(c<=0)throw new Error(N.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let m=Math.trunc(i/c);if(c*m!==i)throw new Error(N.getSparseReshapeInputOutputMultipleErrorMessage(r,l));l[u]=m}if(k.sizeFromShape(l)!==i)throw new Error(N.getSparseReshapeInputOutputMismatchErrorMessage(r,l));let d=r.length,p=[];if(d>0){p[d-1]=1;for(let m=d-2;m>=0;--m)p[m]=p[m+1]*r[m+1]}let h=[];if(o>0){h[o-1]=1;for(let m=o-2;m>=0;--m)h[m]=h[m+1]*l[m+1]}let f=k.getArrayFromDType(n,s*o);for(let m=0;m<s;++m){let g=0;for(let y=0;y<d;++y)g+=e[m*d+y]*p[y];for(let y=0;y<o;++y)f[m*o+y]=Math.trunc(g/h[y]),g%=h[y]}return[f,[s,o],l]}function aE(e,t,n,r,a,i=!1,s=0){let o=r.length,l=[t[0],e.length/t[0]],c=l[1],u=o>0?a[o-1]+1:0;if(u<0)throw new Error(N.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let d=t.slice();d[0]=u;let p=d.reduce((b,v)=>b*v,1),h=k.getArrayFromDType(n,p);if(o===0)return u>0&&h.fill(s),[h,d];if(u<=0)throw new Error(N.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let f=0,m=1,g=0,y=a[f];for(;;){let b=0;if(m<o){if(b=a[m],y===b){++m;continue}if(y>=b)throw new Error(N.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(y<0||y>=u)throw new Error(N.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(y,u));y>g&&h.fill(s,g*c,y*c);for(let v=f;v<m;++v){let x=r[v];if(x<0||x>=l[0])throw new Error(N.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(v,r[v],l[0]));for(let w=0;w<c;w++)h[y*c+w]+=e[x*c+w]}if(i)for(let v=0;v<c;v++)h[y*c+v]/=m-f;if(f=m,++m,g=y+1,y=b,m>o)break}return g<u&&h.fill(s,g*c,u*c),[h,d]}var Ave=is(e=>Math.sqrt(e)),Rve=_t(Vc,e=>Math.sqrt(e)),Fve={kernelName:Vc,backendName:"cpu",kernelFunc:Rve},p5=gn((e,t)=>{let n=e-t;return n*n}),Dve=Pn(Hc,p5),Mve={kernelName:Hc,backendName:"cpu",kernelFunc:Dve},h5=is((e,t)=>{let{pattern:n,replaceGlobal:r,rewrite:a}=t;return e.replace(new RegExp(n,r?"g":""),a)}),Ove=ll(Rg,h5),Pve={kernelName:Rg,backendName:"cpu",kernelFunc:Ove};function f5(e,t,n,r){let a=et(e,t.dtype);for(let i=0;i<a.size;i++){let s=a.indexToLoc(i),o=new Array(s.length);for(let l=0;l<o.length;l++)o[l]=s[l]*n[l]+r[l];a.set(t.get(...o),...s)}return a}var zve=class{constructor(e,t,n,r,a,i){this.separator=k.encodeString(e),this.nGramWidths=t,this.leftPad=k.encodeString(n),this.rightPad=k.encodeString(r),this.padWidth=a,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){let n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,a,i){for(let s=0;s<a;++s){let o=this.getPadWidth(i),l=Math.max(0,o-s),c=Math.max(0,o-(a-(s+1))),u=i-(l+c),d=t+(l>0?0:s-o),p=0;p+=l*this.leftPad.length;for(let y=0;y<u;++y)p+=e[d+y].length;p+=c*this.rightPad.length;let h=l+c+u-1;p+=h*this.separator.length,n[r+s]=new Uint8Array(p);let f=n[r+s],m=0,g=y=>y.forEach(b=>f[m++]=b);for(let y=0;y<l;++y)g(this.leftPad),g(this.separator);for(let y=0;y<u-1;++y)g(e[d+y]),g(this.separator);if(u>0){g(e[d+u-1]);for(let y=0;y<c;++y)g(this.separator),g(this.rightPad)}else{for(let y=0;y<c-1;++y)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,t){let n=e.length,r=t.length;if(r>0){let o=t[0];if(o!==0)throw new Error(`First split value must be 0, got ${o}`);for(let l=1;l<r;++l){let c=t[l]>=o;if(c=c&&t[l]<=n,!c)throw new Error(`Invalid split value ${t[l]}, must be in [${o}, ${n}]`);o=t[l]}if(o!==n)throw new Error(`Last split value must be data size. Expected ${n}, got ${o}`)}let a=r-1,i=k.getArrayFromDType("int32",r);if(n===0||r===0){let o=new Array(n);for(let l=0;l<=a;++l)i[l]=0;return[o,i]}i[0]=0;for(let o=1;o<=a;++o){let l=t[o]-t[o-1],c=0;this.nGramWidths.forEach(u=>{c+=this.getNumNGrams(l,u)}),this.preserveShort&&l>0&&c===0&&(c=1),i[o]=i[o-1]+c}let s=new Array(i[a]);for(let o=0;o<a;++o){let l=t[o],c=i[o];if(this.nGramWidths.forEach(u=>{let d=t[o+1]-t[o],p=this.getNumNGrams(d,u);this.createNGrams(e,l,s,c,p,u),c+=p}),this.preserveShort&&c===i[o]){let u=t[o+1]-t[o];if(u===0)continue;let d=u+2*this.padWidth,p=1;this.createNGrams(e,l,s,c,p,d)}}return[s,i]}};function iE(e,t,n,r,a,i,s,o){return new zve(n,r,a,i,s,o).compute(e,t)}function Lve(e,t,n,r){if(!e.length)return;if(t.length===0){for(let i=0;i<e.length;++i)r.push(e.subarray(i,i+1));return}if(t.length===1){let i=t[0],s=e.indexOf(i);for(;s!==-1;){let o=e.subarray(0,s);(!n||o.length!==0)&&r.push(o),e=e.subarray(s+1),s=e.indexOf(i)}(!n||e.length!==0)&&r.push(e);return}let a=0;for(let i=0;i<e.length+1;i++)if(i===e.length||t.indexOf(e[i])!==-1){let s=e.subarray(a,i);(!n||s.length!==0)&&r.push(s),a=i+1}}function sE(e,t,n){let r=e.length,a=[],i=0,s=0,o=new Array(r);for(let p=0;p<r;++p){let h=a.length;Lve(e[p],t,n,a);let f=a.length-h;o[p]=f,i+=f,s=Math.max(s,f)}let l=k.getArrayFromDType("int32",i*2),c=new Array(i),u=[r,s],d=0;for(let p=0;p<r;++p)for(let h=0;h<o[p];++h)l[d*2]=p,l[d*2+1]=h,c[d]=a[d],++d;return[l,c,u]}function oE(e,t){let n=k.getArrayFromDType("int32",e.length);for(let r=0;r<e.length;++r)n[r]=k.fingerPrint64(e[r]).modulo(t).getLowBitsUnsigned();return n}var m5=gn((e,t)=>e-t),Bve=QN((e,t,n,r)=>({real:e-n,imag:t-r})),lE=Pn(Gc,m5,Bve),Wve={kernelName:Gc,backendName:"cpu",kernelFunc:lE};function g5(e,t){let n=new Array(e.rank);for(let a=0;a<n.length;a++)n[a]=e.shape[a]*t[a];let r=et(n,e.dtype);for(let a=0;a<r.values.length;++a){let i=r.indexToLoc(a),s=new Array(e.rank);for(let l=0;l<s.length;l++)s[l]=i[l]%e.shape[l];let o=e.locToIndex(s);r.values[a]=e.values[o]}return r}var Ff=(e,t)=>{let n=t.value-e.value;return n===0?e.index-t.index:n};function y5(e,t,n=0,r=e.length-1){for(;r>n;){if(r-n>600){let o=r-n+1,l=t-n+1,c=Math.log(o),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(o-u)/o)*Math.sign(l-o/2),p=Math.max(n,Math.floor(t-l*u/o+d)),h=Math.min(r,Math.floor(t+(o-l)*u/o+d));y5(e,t,p,h)}let a=e[t],i=n,s=r;for(k.swap(e,n,t),Ff(e[r],a)>0&&k.swap(e,n,r);i<s;){for(k.swap(e,i,s),i++,s--;Ff(e[i],a)<0;)i=i+1;for(;Ff(e[s],a)>0;)s=s-1}Ff(e[n],a)===0?k.swap(e,n,s):(s=s+1,k.swap(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}}function b5(e,t,n,r,a){let i=t[t.length-1],[s,o]=[e.length/i,i],l=k.getTypedArrayFromDType(n,s*r),c=k.getTypedArrayFromDType("int32",s*r);for(let d=0;d<s;d++){let p=d*o,h=e.subarray(p,p+o),f=new Array(h.length);h.forEach((b,v)=>f[v]={value:b,index:v}),r<f.length&&(y5(f,r),f=f.slice(0,r)),a&&f.sort(Ff);let m=d*r,g=l.subarray(m,m+r),y=c.subarray(m,m+r);for(let b=0;b<r;b++)g[b]=f[b].value,y[b]=f[b].index}let u=t.slice();return u[u.length-1]=r,[et(u,n,l),et(u,"int32",c)]}function uE(e,t,n,r){let a=k.parseAxisParam(t,n)[0],i=[1,n[0],1];for(let f=0;f<a;f++)i[0]*=n[f];i[1]=n[a];for(let f=a+1;f<n.length;f++)i[2]*=n[f];let s=new Map,o=new Int32Array(n[a]),l=new Sn(i,r,e),c=[],u=i[0]===1&&i[2]===1;for(let f=0;f<n[a];f++){let m;if(u)m=e[f].toString();else{let y=[];for(let b=0;b<i[0];b++)for(let v=0;v<i[2];v++)y.push(l.get(b,f,v));m=y.join(",")}let g=s.get(m);if(g!=null)o[f]=g;else{let y=s.size;s.set(m,y),o[f]=y,c.push(f)}}let d=i.slice();d[1]=s.size;let p=new Sn(d,r);c.forEach((f,m)=>{for(let g=0;g<i[0];g++)for(let y=0;y<i[2];y++)p.set(l.get(g,f,y),g,m,y)});let h=n.slice();return h[a]=d[1],{outputValues:p.values,outputShape:h,indices:o}}var Vve="4.7.0";qx("cpu",()=>new G1,1);var v5=_t(Qu,e=>e>=0?e:Math.exp(e)-1),Uve={kernelName:Qu,backendName:"cpu",kernelFunc:v5};function x5(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:i}=r;Ee([a],"leakyRelu");let s=k.sizeFromShape(a.shape),o=n.data.get(a.dataId).values,l=k.getTypedArrayFromDType("float32",s);for(let c=0;c<o.length;c++)l[c]=o[c]<0?i*o[c]:o[c];return n.makeTensorInfo(a.shape,"float32",l)}var jve={kernelName:cc,backendName:"cpu",kernelFunc:x5},Hve=gn((e,t)=>e<0?t*e:e);function w5(e){let{inputs:t,backend:n}=e,{x:r,alpha:a}=t;Ee([r,a],"prelu");let i=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,[o,l]=Hve(r.shape,a.shape,i,s,"float32");return n.makeTensorInfo(l,"float32",o)}var Gve={kernelName:_c,backendName:"cpu",kernelFunc:w5},k5=_t(Ec,e=>Math.max(0,e)),qve={kernelName:Ec,backendName:"cpu",kernelFunc:k5},S5=_t(Rc,e=>Math.min(Math.max(0,e),6)),Kve={kernelName:Rc,backendName:"cpu",kernelFunc:S5};function yv(e,t,n,r,a){if(n==="linear")return Ji({inputs:{x:t},backend:e});if(n==="relu")return k5({inputs:{x:t},backend:e});if(n==="elu")return v5({inputs:{x:t},backend:e});if(n==="relu6")return S5({inputs:{x:t},backend:e});if(n==="prelu")return w5({inputs:{x:t,alpha:r},backend:e});if(n==="leakyrelu")return x5({inputs:{x:t},backend:e,attrs:{alpha:a}});if(n==="sigmoid")return u5({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}function Wt(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:i}=r,s=k.sizeFromShape(a.shape),o=k.inferFromImplicitShape(i,s),l=k.sizeFromShape(o);k.assert(s===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${a.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`),n.incRef(a.dataId);let c=n.data.get(a.dataId);if(c.complexTensorInfos!=null){let u=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;u.shape=o,d.shape=o}return{dataId:a.dataId,shape:o,dtype:a.dtype}}var Xve={kernelName:vh,backendName:"cpu",kernelFunc:Wt};function I5(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i}=t,{transposeA:s,transposeB:o}=r;Ee([a,i],"matMul");let l=a.shape.length,c=i.shape.length,u=s?a.shape[l-2]:a.shape[l-1],d=o?i.shape[c-1]:i.shape[c-2],p=s?a.shape[l-1]:a.shape[l-2],h=o?i.shape[c-2]:i.shape[c-1],f=a.shape.slice(0,-2),m=i.shape.slice(0,-2),g=k.sizeFromShape(f),y=k.sizeFromShape(m),b=Ph.assertAndGetBroadcastShape(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([p,h]);k.assert(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${a.shape} and ${i.shape} and transposeA=${s} and transposeB=${o} must match.`);let v=s?[g,u,p]:[g,p,u],x=o?[y,h,d]:[y,d,h],w=Wt({inputs:{x:a},backend:n,attrs:{shape:v}}),S=Wt({inputs:{x:i},backend:n,attrs:{shape:x}}),C=s?w.shape[1]:w.shape[2],T=s?w.shape[2]:w.shape[1],E=o?S.shape[1]:S.shape[2],R=Math.max(g,y),$=n.data.get(w.dataId).values,_=n.data.get(S.dataId).values,D=k.computeStrides(w.shape),P=k.computeStrides(S.shape),[B,W,Y]=s?[D[0],1,D[1]]:[D[0],D[1],1],[O,q,Z]=o?[1,P[1],P[0]]:[P[1],1,P[0]],X=T*E,ne=et([R,T,E],w.dtype),te=ne.values,se=n.blockSize;for(let oe=0;oe<R;oe++){let fe=oe%g,ce=oe%y;for(let ue=0;ue<T;ue+=se){let ye=Math.min(ue+se,T);for(let de=0;de<E;de+=se){let Ce=Math.min(de+se,E);for(let Ae=0;Ae<C;Ae+=se){let Me=Math.min(Ae+se,C);for(let Fe=ue;Fe<ye;Fe++)for(let Ge=de;Ge<Ce;Ge++){let ze=0;for(let nt=Ae;nt<Me;nt++){let vt=$[fe*B+Fe*W+nt*Y],Kn=_[nt*O+Ge*q+ce*Z];ze+=vt*Kn}te[oe*X+(Fe*E+Ge)]+=ze}}}}}return n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(S),n.makeTensorInfo(b,ne.dtype,ne.values)}var Yve={kernelName:Bu,backendName:"cpu",kernelFunc:I5};function Zve(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i,bias:s,preluActivationWeights:o}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r,p,h,f,m=[];p=I5({inputs:{a,b:i},attrs:{transposeA:l,transposeB:c},backend:n}),s&&(h=Sp({inputs:{a:p,b:s},backend:n}),m.push(p),p=h),u&&(f=yv(n,p,u,o,d),m.push(p),p=f);for(let g of m)n.disposeIntermediateTensorInfo(g);return p}var Qve={kernelName:iu,backendName:"cpu",kernelFunc:Zve},Jve=_t(Au,e=>Math.acos(e)),exe={kernelName:Au,backendName:"cpu",kernelFunc:Jve},txe=_t(Ru,e=>Math.acosh(e)),nxe={kernelName:Ru,backendName:"cpu",kernelFunc:txe};function rxe(e){let{inputs:t,backend:n}=e,r=t;Ee(t,"addN");let a=r.map(o=>n.data.get(o.dataId).values),i=et(r[0].shape,r[0].dtype),s=i.values;for(let o=0;o<r.length;o++){let l=a[o];for(let c=0;c<s.length;c++)s[c]+=l[c]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}var axe={kernelName:Fu,backendName:"cpu",kernelFunc:rxe};function ixe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;Ee(a,"all");let o=k.parseAxisParam(i,a.shape),l=o,c=N.getAxesPermutation(l,a.shape.length),u=a;c!=null&&(u=Hr({inputs:{x:a},backend:n,attrs:{perm:c}}),l=N.getInnerMostAxes(l.length,a.shape.length)),N.assertAxesAreInnerMostDims("all",l,u.shape.length);let[d,p]=N.computeOutAndReduceShapes(u.shape,l),h=k.sizeFromShape(p),f=k.makeZerosTypedArray(k.sizeFromShape(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<f.length;++y){let b=y*h,v=m[b];for(let x=0;x<h;++x){let w=m[b+x];v=v&&w}f[y]=v}c!=null&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(d,u.dtype,f);if(s){let y=N.expandShapeToKeepDim(d,o),b=Wt({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),b}return g}var sxe={kernelName:Op,backendName:"cpu",kernelFunc:ixe};function oxe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;Ee(a,"any");let o=k.parseAxisParam(i,a.shape),l=o,c=N.getAxesPermutation(l,a.shape.length),u=a;c!=null&&(u=Hr({inputs:{x:a},backend:n,attrs:{perm:c}}),l=N.getInnerMostAxes(l.length,a.shape.length)),N.assertAxesAreInnerMostDims("any",l,u.shape.length);let[d,p]=N.computeOutAndReduceShapes(u.shape,l),h=k.sizeFromShape(p),f=k.makeZerosTypedArray(k.sizeFromShape(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<f.length;++y){let b=y*h,v=m[b];for(let x=0;x<h;++x){let w=m[b+x];v=v||w}f[y]=v}c!=null&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(d,u.dtype,f);if(s){let y=N.expandShapeToKeepDim(d,o),b=Wt({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),b}return g}var lxe={kernelName:Pp,backendName:"cpu",kernelFunc:oxe};function uxe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;Ee(a,"argMax");let s=k.parseAxisParam(i,a.shape),o=N.getAxesPermutation(s,a.shape.length),l=a,c=[];o!=null&&(l=Hr({inputs:{x:a},backend:n,attrs:{perm:o}}),c.push(l),s=N.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],N.assertAxesAreInnerMostDims("argMax",s,l.shape.length);let[u,d]=N.computeOutAndReduceShapes(l.shape,s),p=k.sizeFromShape(u),h=k.makeZerosTypedArray(p,"int32"),f=k.sizeFromShape(d),m=n.data.get(l.dataId).values;for(let g=0;g<h.length;++g){let y=g*f,b=m[y],v=0;for(let x=0;x<f;++x){let w=m[y+x];w>b&&(b=w,v=x)}h[g]=v}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(u,"int32",h)}var cxe={kernelName:zp,backendName:"cpu",kernelFunc:uxe};function dxe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;Ee(a,"argMin");let s=k.parseAxisParam(i,a.shape),o=N.getAxesPermutation(s,a.shape.length),l=a,c=[];o!=null&&(l=Hr({inputs:{x:a},backend:n,attrs:{perm:o}}),c.push(l),s=N.getInnerMostAxes(s.length,l.shape.length)),s=[s[0]],N.assertAxesAreInnerMostDims("argMin",s,l.shape.length);let[u,d]=N.computeOutAndReduceShapes(l.shape,s),p=k.sizeFromShape(u),h=k.makeZerosTypedArray(p,"int32"),f=k.sizeFromShape(d),m=n.data.get(l.dataId).values;for(let g=0;g<h.length;++g){let y=g*f,b=m[y],v=0;for(let x=0;x<f;++x){let w=m[y+x];w<b&&(b=w,v=x)}h[g]=v}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(u,"int32",h)}var pxe={kernelName:Lp,backendName:"cpu",kernelFunc:dxe},hxe=_t(Du,e=>Math.asin(e)),fxe={kernelName:Du,backendName:"cpu",kernelFunc:hxe},mxe=_t(Mu,e=>Math.asinh(e)),gxe={kernelName:Mu,backendName:"cpu",kernelFunc:mxe},yxe=_t(Ou,e=>Math.atan(e)),bxe={kernelName:Ou,backendName:"cpu",kernelFunc:yxe},vxe=gn((e,t)=>Math.atan2(e,t)),xxe=Pn(zu,vxe),wxe={kernelName:zu,backendName:"cpu",kernelFunc:xxe},kxe=_t(Pu,e=>Math.atanh(e)),Sxe={kernelName:Pu,backendName:"cpu",kernelFunc:kxe};function cE(e,t,n,r,a,i){let s=a.strideHeight,o=a.strideWidth,l=a.dilationHeight,c=a.dilationWidth,u=a.effectiveFilterHeight,d=a.effectiveFilterWidth,p=a.padInfo.top,h=a.padInfo.left,f=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=et(a.outShape,n),g=m.values,y=a.outShape[1]*a.outShape[2]*a.outShape[3],b=a.outShape[2]*a.outShape[3],v=a.outShape[3];for(let x=0;x<a.batchSize;++x){let w=x*y,S=x*r[0];for(let C=0;C<a.inChannels;++C)for(let T=0;T<a.outHeight;++T){let E=T*s-p,R=Math.max(0,E),$=Math.min(a.inHeight,u+E),_=w+T*b;for(let D=0;D<a.outWidth;++D){let P=D*o-h,B=Math.max(0,P),W=Math.min(a.inWidth,d+P),Y=f,O=0,q=0;for(let X=R;X<$;X+=l){let ne=S+X*r[1];for(let te=B;te<W;te+=c){let se=ne+te*r[2],oe=e[se+C];i==="max"&&oe>Y?Y=oe:i==="avg"&&(O+=oe,q++)}if(isNaN(Y))break}let Z=_+D*v+C;g[Z]=i==="avg"?O/q:Y}}}return m}function C5(e,t,n,r,a=!1,i=!1){let s=et(r.outShape,"int32"),o=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,u=r.dilationWidth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,m=et(t,n,e);for(let g=0;g<r.batchSize;++g)for(let y=0;y<r.inChannels;++y)for(let b=0;b<r.outHeight;++b){let v=b*o-h,x=v;for(;x<0;)x+=c;let w=Math.min(r.inHeight,d+v);for(let S=0;S<r.outWidth;++S){let C=S*l-f,T=C;for(;T<0;)T+=u;let E=Math.min(r.inWidth,p+C),R=Number.NEGATIVE_INFINITY,$=-1;for(let _=x;_<w;_+=c){let D=_-v;for(let P=T;P<E;P+=u){let B=P-C,W=m.get(g,_,P,y);W>R&&(R=W,a?$=i?((g*r.inHeight+_)*r.inWidth+P)*r.inChannels+y:(_*r.inWidth+P)*r.inChannels+y:$=D*p+B)}}s.set($,g,b,S,y)}}return s}function _5(e,t,n,r,a,i){let s=a.strideDepth,o=a.strideHeight,l=a.strideWidth,c=a.dilationDepth,u=a.dilationHeight,d=a.dilationWidth,p=a.effectiveFilterDepth,h=a.effectiveFilterHeight,f=a.effectiveFilterWidth,m=a.padInfo.front,g=a.padInfo.top,y=a.padInfo.left,b=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=et(a.outShape,n),x=v.values,w=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],S=a.outShape[2]*a.outShape[3]*a.outShape[4],C=a.outShape[3]*a.outShape[4],T=a.outShape[4];for(let E=0;E<a.batchSize;++E){let R=E*w,$=E*r[0];for(let _=0;_<a.inChannels;++_)for(let D=0;D<a.outDepth;++D){let P=D*s-m,B=P;for(;B<0;)B+=c;let W=Math.min(a.inDepth,p+P),Y=R+D*S;for(let O=0;O<a.outHeight;++O){let q=O*o-g,Z=q;for(;Z<0;)Z+=u;let X=Math.min(a.inHeight,h+q),ne=Y+O*C;for(let te=0;te<a.outWidth;++te){let se=te*l-y,oe=se;for(;oe<0;)oe+=d;let fe=Math.min(a.inWidth,f+se),ce=ne+te*T,ue=b,ye=0,de=0;for(let Ae=B;Ae<W;Ae+=c){let Me=$+Ae*r[1];for(let Fe=Z;Fe<X;Fe+=u){let Ge=Me+Fe*r[2];for(let ze=oe;ze<fe;ze+=d){let nt=Ge+ze*r[3],vt=e[nt+_];if(i==="max"&&vt>ue?ue=vt:i==="avg"&&(ye+=vt,de++),isNaN(ue))break}if(isNaN(ue))break}if(isNaN(ue))break}let Ce=ce+_;x[Ce]=i==="avg"?ye/Math.max(de,1):ue}}}}return v}function Ixe(e,t){let n=et(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,s=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=t.padInfo.front,h=t.padInfo.top,f=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let g=0;g<t.inChannels;++g)for(let y=0;y<t.outDepth;++y){let b=y*r-p,v=b;for(;v<0;)v+=s;let x=Math.min(t.inDepth,c+b);for(let w=0;w<t.outHeight;++w){let S=w*a-h,C=S;for(;C<0;)C+=o;let T=Math.min(t.inHeight,u+S);for(let E=0;E<t.outWidth;++E){let R=E*i-f,$=R;for(;$<0;)$+=l;let _=Math.min(t.inWidth,d+R),D=Number.NEGATIVE_INFINITY,P=-1;for(let B=v;B<x;B+=s){let W=B-b;for(let Y=C;Y<T;Y+=o){let O=Y-S;for(let q=$;q<_;q+=l){let Z=q-R,X=e.get(m,B,Y,q,g);X>=D&&(D=X,P=W*u*d+O*u+Z)}}}n.set(P,m,y,w,E,g)}}}return n}function Cxe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;Ee(a,"avgPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=r,c=1;k.assert(N.eitherStridesOrDilationsAreOne(s,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);let u=N.computePool2DInfo(a.shape,i,s,c,o,l),d;if(u.filterWidth===1&&u.filterHeight===1&&k.arraysEqual(u.inShape,u.outShape))d=Ji({inputs:{x:a},backend:n});else{let p=n.data.get(a.dataId).values,h=k.computeStrides(a.shape),f=cE(p,a.shape,a.dtype,h,u,"avg");d=n.makeTensorInfo(u.outShape,a.dtype,f.values)}return d}var _xe={kernelName:Lu,backendName:"cpu",kernelFunc:Cxe};function Txe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=r;Ee(a,"avgPool3d");let u=N.computePool3DInfo(a.shape,i,s,1,o,l,c),d=n.data.get(a.dataId).values,p=_5(d,a.shape,a.dtype,k.computeStrides(a.shape),u,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}var Nxe={kernelName:Bp,backendName:"cpu",kernelFunc:Txe};function Exe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r;Ee([a,i],"avgPool3DGrad");let u=N.computePool3DInfo(i.shape,s,o,1,l,c),d=u.strideDepth,p=u.strideHeight,h=u.strideWidth,f=u.filterDepth,m=u.filterHeight,g=u.filterWidth,y=u.dilationDepth,b=u.dilationHeight,v=u.dilationWidth,x=u.effectiveFilterDepth,w=u.effectiveFilterHeight,S=u.effectiveFilterWidth,C=x-1-u.padInfo.front,T=S-1-u.padInfo.left,E=w-1-u.padInfo.top,R=et(i.shape,"float32"),$=1/(f*m*g),_=n.bufferSync(a);for(let D=0;D<u.batchSize;++D)for(let P=0;P<u.inChannels;++P)for(let B=0;B<u.inDepth;++B)for(let W=0;W<u.inHeight;++W)for(let Y=0;Y<u.inWidth;++Y){let O=B-C,q=W-E,Z=Y-T,X=0;for(let ne=0;ne<x;ne+=y){let te=(O+ne)/d;if(!(te<0||te>=u.outDepth||Math.floor(te)!==te))for(let se=0;se<w;se+=b){let oe=(q+se)/p;if(!(oe<0||oe>=u.outHeight||Math.floor(oe)!==oe))for(let fe=0;fe<S;fe+=v){let ce=(Z+fe)/h;if(ce<0||ce>=u.outWidth||Math.floor(ce)!==ce)continue;let ue=_.get(D,te,oe,ce,P);X+=ue}}}R.set(X*$,D,B,W,Y,P)}return n.makeTensorInfo(R.shape,R.dtype,R.values)}var $xe={kernelName:bg,backendName:"cpu",kernelFunc:Exe};function Axe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,s=i;Ee([a,i],"avgPoolGrad");let{filterSize:o,strides:l,pad:c}=r,u=N.computePool2DInfo(s.shape,o,l,1,c),d=u.strideHeight,p=u.strideWidth,h=u.filterHeight,f=u.filterWidth,m=u.dilationHeight,g=u.dilationWidth,y=u.effectiveFilterHeight,b=u.effectiveFilterWidth,v=b-1-u.padInfo.left,x=y-1-u.padInfo.top,w=et(s.shape,"float32"),S=1/(h*f),C=n.data.get(a.dataId).values,T=et(a.shape,"float32",C);for(let E=0;E<u.batchSize;++E)for(let R=0;R<u.inChannels;++R)for(let $=0;$<u.inHeight;++$)for(let _=0;_<u.inWidth;++_){let D=$-x,P=_-v,B=0;for(let W=0;W<y;W+=m){let Y=(D+W)/d;if(!(Y<0||Y>=u.outHeight||Math.floor(Y)!==Y))for(let O=0;O<b;O+=g){let q=(P+O)/p;if(q<0||q>=u.outWidth||Math.floor(q)!==q)continue;let Z=T.get(E,Y,q,R);B+=Z}}w.set(B*S,E,$,_,R)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}var Rxe={kernelName:yg,backendName:"cpu",kernelFunc:Axe};function Fxe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,scale:i,offset:s,mean:o,variance:l}=t;k.assert(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),k.assert(s==null||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),k.assert(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ee([a,o,l,i,s],"batchNorm");let{varianceEpsilon:c}=r;c==null&&(c=.001);let u=n.data.get(a.dataId).values,d=n.data.get(o.dataId).values,p=n.data.get(l.dataId).values,h=i?n.data.get(i.dataId).values:new Float32Array([1]),f=s?n.data.get(s.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),g=f.length,y=h.length,b=p.length,v=d.length,x=0,w=0,S=0,C=0;for(let T=0;T<u.length;++T)m[T]=f[x++]+(u[T]-d[w++])*h[S++]/Math.sqrt(p[C++]+c),x>=g&&(x=0),w>=v&&(w=0),S>=y&&(S=0),C>=b&&(C=0);return n.makeTensorInfo(a.shape,a.dtype,m)}var Dxe={kernelName:ac,backendName:"cpu",kernelFunc:Fxe};function Mxe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:s}=r;Ee([a],"batchToSpaceND");let o=i.reduce((y,b)=>y*b),l=N.getReshaped(a.shape,i,o),c=N.getPermuted(l.length,i.length),u=N.getReshapedPermuted(a.shape,i,o),d=N.getSliceBeginCoords(s,i.length),p=N.getSliceSize(u,s,i.length),h=Wt({inputs:{x:a},backend:n,attrs:{shape:l}}),f=Hr({inputs:{x:h},backend:n,attrs:{perm:c}}),m=Wt({inputs:{x:f},backend:n,attrs:{shape:u}}),g=vu({inputs:{x:m},backend:n,attrs:{begin:d,size:p}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}var Oxe={kernelName:Wp,backendName:"cpu",kernelFunc:Mxe};function Pxe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s}=r,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,c=JN(o,l,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,c)}var zxe={kernelName:Vp,backendName:"cpu",kernelFunc:Pxe};function Lxe(e){let{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,o=N.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}var Bxe={kernelName:vg,backendName:"cpu",kernelFunc:Lxe},Wxe=_t(el,(e,t)=>{let n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),Vxe={kernelName:el,backendName:"cpu",kernelFunc:Wxe},Uxe=e=>{let{x:t}=e.inputs,n=e.backend,r=new Float32Array(k.sizeFromShape(t.shape)),a=n.data.get(t.dataId),i=a.complexTensorInfos.real,s=a.complexTensorInfos.imag,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values;for(let c=0;c<o.length;c++){let u=o[c],d=l[c];r[c]=Math.hypot(u,d)}return n.makeOutput(r,t.shape,"float32")},jxe={kernelName:xg,backendName:"cpu",kernelFunc:Uxe};function Ip(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var Hxe={kernelName:Bx,backendName:"cpu",kernelFunc:Ip};function Cp(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,i=k.parseAxisParam(a,t[0].shape)[0],s=t.map(m=>m.shape);N.assertParamsConsistent(s,i);let o=N.computeOutShape(t.map(m=>m.shape),i);if(k.sizeFromShape(o)===0)return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(m=>k.sizeFromShape(m.shape)>0);if(l.length===1)return Ji({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){let m=l.map(x=>bu({inputs:{input:x},backend:n})),g=l.map(x=>Ip({inputs:{input:x},backend:n})),y=Cp({inputs:m,backend:n,attrs:{axis:i}}),b=Cp({inputs:g,backend:n,attrs:{axis:i}}),v=ta({inputs:{real:y,imag:b},backend:n});return m.forEach(x=>n.disposeIntermediateTensorInfo(x)),g.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),v}let c=l.map(m=>{let g=[-1,k.sizeFromShape(m.shape.slice(i))];return Wt({inputs:{x:m},backend:n,attrs:{shape:g}})}),u=c.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));o=N.computeOutShape(c.map(m=>m.shape),1);let d=c[0].shape[0]===1,p=eE(u,o,t[0].dtype,d),h=N.computeOutShape(l.map(m=>m.shape),i),f=n.makeTensorInfo(h,t[0].dtype,p);return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}var Gxe={kernelName:jp,backendName:"cpu",kernelFunc:Cp};function T5(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dataFormat:l,dilations:c,dimRoundingMode:u}=r;Ee([a,i],"conv2d");let d=N.convertConv2DDataFormat(l),p=N.computeConv2DInfo(a.shape,i.shape,s,c,o,u,!1,d),h=p.filterHeight,f=p.filterWidth,m=p.dilationHeight,g=p.dilationWidth,y=p.padInfo.left,b=p.padInfo.top,v=p.dataFormat==="channelsLast",x=new Sn(p.outShape,a.dtype),w=k.computeStrides(a.shape),S=k.computeStrides(i.shape),C=w[0],T=v?w[1]:w[2],E=v?w[2]:1,R=v?1:w[1],$=x.strides[0],_=v?x.strides[1]:x.strides[2],D=v?x.strides[2]:1,P=v?1:x.strides[1],B=n.data.get(a.dataId).values,W=n.data.get(i.dataId).values,Y=x.values;for(let O=0;O<p.batchSize;++O){let q=O*C,Z=O*$;for(let X=0;X<p.outHeight;++X){let ne=Z+X*_,te=X*p.strideHeight-b;for(let se=0;se<h;++se){let oe=te+se*m;if(oe<0||oe>=p.inHeight)continue;let fe=se*S[0],ce=q+oe*T;for(let ue=0;ue<p.outWidth;++ue){let ye=ne+ue*D,de=ue*p.strideWidth-y;for(let Ce=0;Ce<f;++Ce){let Ae=de+Ce*g;if(Ae<0||Ae>=p.inWidth)continue;let Me=fe+Ce*S[1],Fe=ce+Ae*E,Ge=Me;for(let ze=0;ze<p.inChannels;++ze){let nt=B[Fe+ze*R];for(let vt=0;vt<p.outChannels;++vt)Y[ye+vt*P]+=nt*W[Ge+vt];Ge+=p.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,Y)}var qxe={kernelName:Uu,backendName:"cpu",kernelFunc:T5};function Kxe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=r;Ee([a,i],"conv2dBackpropFilter");let d=N.convertConv2DDataFormat(l),p=N.computeConv2DInfo(a.shape,u,s,1,o,c,!1,d),{strideHeight:h,strideWidth:f,filterHeight:m,filterWidth:g}=p,y=p.dataFormat==="channelsLast",b=new Sn(p.filterShape,"float32"),v=p.padInfo.left,x=p.padInfo.top,w=n.data.get(a.dataId).values,S=n.data.get(i.dataId).values,C=new Sn(a.shape,a.dtype,w),T=new Sn(i.shape,i.dtype,S);for(let E=0;E<m;++E){let R=Math.max(0,Math.ceil((x-E)/h)),$=Math.min(p.outHeight,(p.inHeight+x-E)/h);for(let _=0;_<g;++_){let D=Math.max(0,Math.ceil((v-_)/f)),P=Math.min(p.outWidth,(p.inWidth+v-_)/f);for(let B=0;B<p.inChannels;++B)for(let W=0;W<p.outChannels;++W){let Y=0;for(let O=0;O<p.batchSize;++O)for(let q=R;q<$;++q){let Z=E+q*h-x;for(let X=D;X<P;++X){let ne=_+X*f-v;y?Y+=C.get(O,Z,ne,B)*T.get(O,q,X,W):Y+=C.get(O,B,Z,ne)*T.get(O,W,q,X)}}b.set(Y,E,_,B,W)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}var Xxe={kernelName:Dx,backendName:"cpu",kernelFunc:Kxe};function Yxe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{inputShape:s,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=r;Ee([a,i],"conv2dBackpropInput");let d=k.computeStrides(i.shape),p=k.computeStrides(a.shape),h=N.convertConv2DDataFormat(c),f=N.computeConv2DInfo(s,i.shape,o,1,l,u,!1,h),m=new Sn(f.inShape,"float32"),g=m.values,y=n.data.get(a.dataId).values,b=n.data.get(i.dataId).values,[v,x,w]=d,{batchSize:S,filterHeight:C,filterWidth:T,inChannels:E,inHeight:R,inWidth:$,outChannels:_,outHeight:D,outWidth:P,strideHeight:B,strideWidth:W}=f;h=f.dataFormat;let Y=C-1-f.padInfo.top,O=T-1-f.padInfo.left,q=h==="channelsLast",Z=m.strides[0],X=q?m.strides[1]:m.strides[2],ne=q?m.strides[2]:1,te=q?1:m.strides[1],se=p[0],oe=q?p[1]:p[2],fe=q?p[2]:1,ce=q?1:p[1];for(let ue=0;ue<S;++ue)for(let ye=0;ye<E;++ye)for(let de=0;de<R;++de){let Ce=de-Y,Ae=Math.max(0,Math.ceil(Ce/B)),Me=Math.min(D,(C+Ce)/B);for(let Fe=0;Fe<$;++Fe){let Ge=Fe-O,ze=Math.max(0,Math.ceil(Ge/W)),nt=Math.min(P,(T+Ge)/W),vt=0;for(let Mt=Ae;Mt<Me;++Mt){let ve=Mt*B-Ce;for(let Pe=ze;Pe<nt;++Pe){let ot=Pe*W-Ge,St=se*ue+oe*Mt+fe*Pe,Ft=v*(C-1-ve)+x*(T-1-ot)+w*ye;for(let yn=0;yn<_;++yn){let Yt=y[St+ce*yn],or=b[Ft+yn];vt+=Yt*or}}}let Kn=Z*ue+X*de+ne*Fe+te*ye;g[Kn]=vt}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}var Zxe={kernelName:ju,backendName:"cpu",kernelFunc:Yxe};function Qxe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r;Ee([a,i],"conv3d");let c=N.computeConv3DInfo(a.shape,i.shape,s,l,o),{filterDepth:u,filterHeight:d,filterWidth:p,dilationDepth:h,dilationHeight:f,dilationWidth:m,padInfo:g}=c,y=g.front,b=g.left,v=g.top,x=new Sn(c.outShape,a.dtype),w=n.data.get(a.dataId).values,S=n.data.get(i.dataId).values,C=x.values,T=k.computeStrides(a.shape),E=k.computeStrides(i.shape);for(let R=0;R<c.batchSize;++R){let $=R*T[0],_=R*x.strides[0];for(let D=0;D<c.outDepth;++D){let P=_+D*x.strides[1],B=D*c.strideDepth-y;for(let W=0;W<u;++W){let Y=B+W*h;if(Y<0||Y>=c.inDepth)continue;let O=W*E[0],q=$+Y*T[1];for(let Z=0;Z<c.outHeight;++Z){let X=P+Z*x.strides[2],ne=Z*c.strideHeight-v;for(let te=0;te<d;++te){let se=ne+te*f;if(se<0||se>=c.inHeight)continue;let oe=O+te*E[1],fe=q+se*T[2];for(let ce=0;ce<c.outWidth;++ce){let ue=X+ce*c.outChannels,ye=ce*c.strideWidth-b;for(let de=0;de<p;++de){let Ce=ye+de*m;if(Ce<0||Ce>=c.inWidth)continue;let Ae=oe+de*E[2],Me=fe+Ce*c.inChannels,Fe=Ae;for(let Ge=0;Ge<c.inChannels;++Ge){let ze=w[Me+Ge];for(let nt=0;nt<c.outChannels;++nt)C[ue+nt]+=ze*S[Fe+nt];Fe+=c.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}var Jxe={kernelName:Hu,backendName:"cpu",kernelFunc:Qxe};function e1e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,filterShape:l}=r;Ee([a,i],"conv3dBackpropFilterV2");let c=k.computeStrides(a.shape),u=k.computeStrides(i.shape),d=N.computeConv3DInfo(a.shape,l,s,1,o),p=d.strideDepth,h=d.strideHeight,f=d.strideWidth,m=d.filterDepth,g=d.filterHeight,y=d.filterWidth,b=new Sn(d.filterShape,"float32"),v=b.values,[x,w,S,C]=b.strides,T=n.data.get(i.dataId).values,[E,R,$,_]=u,D=n.data.get(a.dataId).values,[P,B,W,Y]=c,O=d.padInfo.front,q=d.padInfo.left,Z=d.padInfo.top;for(let X=0;X<m;++X){let ne=Math.max(0,Math.ceil((O-X)/p)),te=Math.min(d.outDepth,(d.inDepth+O-X)/p),se=X*x;for(let oe=0;oe<g;++oe){let fe=Math.max(0,Math.ceil((Z-oe)/h)),ce=Math.min(d.outHeight,(d.inHeight+Z-oe)/h),ue=oe*w+se;for(let ye=0;ye<y;++ye){let de=Math.max(0,Math.ceil((q-ye)/f)),Ce=Math.min(d.outWidth,(d.inWidth+q-ye)/f),Ae=ye*S+ue;for(let Me=0;Me<d.inChannels;++Me){let Fe=Me*C+Ae;for(let Ge=0;Ge<d.outChannels;++Ge){let ze=0;for(let nt=0;nt<d.batchSize;++nt){let vt=nt*P,Kn=nt*E;for(let Mt=ne;Mt<te;++Mt){let ve=(X+Mt*p-O)*B+vt,Pe=Mt*R+Kn;for(let ot=fe;ot<ce;++ot){let St=(oe+ot*h-Z)*W+ve,Ft=ot*$+Pe;for(let yn=de;yn<Ce;++yn){let Yt=(ye+yn*f-q)*Y+St,or=yn*_+Ft;ze+=D[Yt+Me]*T[or+Ge]}}}}v[Fe+Ge]=ze}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}var t1e={kernelName:Hp,backendName:"cpu",kernelFunc:e1e};function n1e(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:s,strides:o,inputShape:l}=r;Ee([a],"conv3dBackpropInputV2");let c=k.computeStrides(a.shape),u=k.computeStrides(i.shape),d=N.computeConv3DInfo(l,i.shape,o,1,s),p=new Sn(d.inShape,"float32"),h=p.values,[f,m,g,y]=p.strides,b=n.data.get(a.dataId).values,[v,x,w,S]=c,C=n.data.get(i.dataId).values,[T,E,R,$]=u,{batchSize:_,filterDepth:D,filterHeight:P,filterWidth:B,inChannels:W,inDepth:Y,inHeight:O,inWidth:q,outChannels:Z,outDepth:X,outHeight:ne,outWidth:te,strideDepth:se,strideHeight:oe,strideWidth:fe}=d,ce=D-1-d.padInfo.front,ue=P-1-d.padInfo.top,ye=B-1-d.padInfo.left;for(let de=0;de<_;++de)for(let Ce=0;Ce<W;++Ce)for(let Ae=0;Ae<Y;++Ae){let Me=Ae-ce,Fe=Math.max(0,Math.ceil(Me/se)),Ge=Math.min(X,(D+Me)/se);for(let ze=0;ze<O;++ze){let nt=ze-ue,vt=Math.max(0,Math.ceil(nt/oe)),Kn=Math.min(ne,(P+nt)/oe);for(let Mt=0;Mt<q;++Mt){let ve=Mt-ye,Pe=Math.max(0,Math.ceil(ve/fe)),ot=Math.min(te,(B+ve)/fe),St=0;for(let Ft=Fe;Ft<Ge;++Ft){let yn=Ft*se-Me;for(let Yt=vt;Yt<Kn;++Yt){let or=Yt*oe-nt;for(let La=Pe;La<ot;++La){let ui=La*fe-ve,Dr=v*de+x*Ft+w*Yt+S*La,os=T*(D-1-yn)+E*(P-1-or)+R*(B-1-ui)+$*Ce;for(let Ba=0;Ba<Z;++Ba){let qs=b[Dr+Ba],Xn=C[os+Ba];St+=qs*Xn}}}}h[f*de+m*Ae+g*ze+y*Mt+Ce]=St}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}var r1e={kernelName:Gp,backendName:"cpu",kernelFunc:n1e},a1e=_t(Gu,e=>Math.cos(e)),i1e={kernelName:Gu,backendName:"cpu",kernelFunc:a1e},s1e=_t(qu,e=>Math.cosh(e)),o1e={kernelName:qu,backendName:"cpu",kernelFunc:s1e};function l1e(e){let{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:i,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:c}=r,[u,d,p,h]=a.shape,f=i.shape[0],[m,g]=o,y=et([f,m,g,h],"float32"),b=n.data.get(i.dataId).values,v=n.data.get(s.dataId).values,x=n.data.get(a.dataId).values,w=k.computeStrides(a.shape),S=k.computeStrides(y.shape);for(let C=0;C<f;C++){let T=C*4,E=b[T],R=b[T+1],$=b[T+2],_=b[T+3],D=v[C];if(D>=u)continue;let P=m>1?($-E)*(d-1)/(m-1):0,B=g>1?(_-R)*(p-1)/(g-1):0;for(let W=0;W<m;W++){let Y=m>1?E*(d-1)+W*P:.5*(E+$)*(d-1);if(Y<0||Y>d-1){for(let O=0;O<g;O++)for(let q=0;q<h;q++){let Z=q+O*S[2]+W*S[1]+C*S[0];y.values[Z]=c}continue}if(l==="bilinear"){let O=Math.floor(Y),q=Math.ceil(Y),Z=Y-O;for(let X=0;X<g;X++){let ne=g>1?R*(p-1)+X*B:.5*(R+_)*(p-1);if(ne<0||ne>p-1){for(let fe=0;fe<h;fe++){let ce=fe+X*S[2]+W*S[1]+C*S[0];y.values[ce]=c}continue}let te=Math.floor(ne),se=Math.ceil(ne),oe=ne-te;for(let fe=0;fe<h;fe++){let ce=fe+te*w[2]+O*w[1]+D*w[0],ue=x[ce];ce=fe+se*w[2]+O*w[1]+D*w[0];let ye=x[ce];ce=fe+te*w[2]+q*w[1]+D*w[0];let de=x[ce];ce=fe+se*w[2]+q*w[1]+D*w[0];let Ce=x[ce],Ae=ue+(ye-ue)*oe,Me=de+(Ce-de)*oe;ce=fe+X*S[2]+W*S[1]+C*S[0],y.values[ce]=Ae+(Me-Ae)*Z}}}else for(let O=0;O<g;++O){let q=g>1?R*(p-1)+O*B:.5*(R+_)*(p-1);if(q<0||q>p-1){for(let ne=0;ne<h;ne++){let te=ne+O*S[2]+W*S[1]+C*S[0];y.values[te]=c}continue}let Z=Math.round(q),X=Math.round(Y);for(let ne=0;ne<h;ne++){let te=ne+Z*w[2]+X*w[1]+D*w[0],se=ne+O*S[2]+W*S[1]+C*S[0];y.values[se]=x[te]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}var u1e={kernelName:Kp,backendName:"cpu",kernelFunc:l1e};function c1e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;Ee(a,"cumprod");let l=N.getAxesPermutation([i],a.shape.length),c=a;l!=null&&(c=Hr({inputs:{x:a},backend:n,attrs:{perm:l}}));let u=N.getInnerMostAxes(1,a.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);let d=Fa(c.dtype,"int32"),p=k.makeOnesTypedArray(k.sizeFromShape(c.shape),d),h=n.data.get(c.dataId).values,f=c.shape[c.shape.length-1],m=o?(y,b)=>y+f-b-1:(y,b)=>y+b;for(let y=0;y<h.length;y+=f)for(let b=0;b<f;b++){let v=m(y,b);if(b===0)p[v]=s?1:h[v];else{let x=m(y,b-1);p[v]=s?h[x]*p[x]:h[v]*p[x]}}let g=n.makeTensorInfo(c.shape,d,p);if(l!=null){let y=N.getUndoAxesPermutation(l),b=Hr({inputs:{x:g},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),b}return g}var d1e={kernelName:qp,backendName:"cpu",kernelFunc:c1e};function p1e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;Ee(a,"cumsum");let l=N.getAxesPermutation([i],a.shape.length),c=a;l!=null&&(c=Hr({inputs:{x:a},backend:n,attrs:{perm:l}}));let u=N.getInnerMostAxes(1,a.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);let d=Fa(c.dtype,"int32"),p=k.makeZerosTypedArray(k.sizeFromShape(c.shape),d),h=n.data.get(c.dataId).values,f=c.shape[c.shape.length-1],m=o?(y,b)=>y+f-b-1:(y,b)=>y+b;for(let y=0;y<h.length;y+=f)for(let b=0;b<f;b++){let v=m(y,b);if(b===0)p[v]=s?0:h[v];else{let x=m(y,b-1);p[v]=s?h[x]+p[x]:h[v]+p[x]}}let g=n.makeTensorInfo(c.shape,d,p);if(l!=null){let y=N.getUndoAxesPermutation(l),b=Hr({inputs:{x:g},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),b}return g}var h1e={kernelName:Ku,backendName:"cpu",kernelFunc:p1e};function f1e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s,binaryOutput:o}=r;if(a.shape.length===1){let l=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,u=JN(l,c,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,u)}else if(a.shape.length===2){let l=n.bufferSync(a),c=n.bufferSync(i),u=MV(l,c,s,o);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}var m1e={kernelName:wg,backendName:"cpu",kernelFunc:f1e};function g1e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:i,dataFormat:s}=r;k.assert(s==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${s}`);let o=a.shape[0],l=a.shape[1],c=a.shape[2],u=a.shape[3],d=l*i,p=c*i,h=u/(i*i),f=n.data.get(a.dataId).values,m=new Float32Array(o*d*p*h),g=0;for(let y=0;y<o;++y)for(let b=0;b<d;++b){let v=Math.floor(b/i),x=b%i;for(let w=0;w<p;++w){let S=Math.floor(w/i),C=w%i,T=(x*i+C)*h;for(let E=0;E<h;++E){let R=E+T+u*(S+c*(v+l*y));m[g++]=f[R]}}}return n.makeTensorInfo([o,d,p,h],a.dtype,m)}var y1e={kernelName:Xp,backendName:"cpu",kernelFunc:g1e};function N5(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l,dimRoundingMode:c}=r;Ee([a,i],"depthwiseConv2DNative");let u=k.computeStrides(a.shape),d=k.computeStrides(i.shape),p=l;p==null&&(p=[1,1]),k.assert(N.eitherStridesOrDilationsAreOne(s,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${p}'`);let h=N.computeConv2DInfo(a.shape,i.shape,s,p,o,c,!0),{filterHeight:f,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:b}=h,v=b.left,x=b.top,w=h.outChannels/h.inChannels,S=new Sn(h.outShape,a.dtype),C=n.data.get(a.dataId).values,T=n.data.get(i.dataId).values,E=S.values;for(let R=0;R<h.batchSize;++R){let $=R*u[0],_=R*S.strides[0];for(let D=0;D<h.outHeight;++D){let P=_+D*S.strides[1],B=D*h.strideHeight-x;for(let W=0;W<f;++W){let Y=B+W*g;if(Y<0||Y>=h.inHeight)continue;let O=W*d[0],q=$+Y*u[1];for(let Z=0;Z<h.outWidth;++Z){let X=P+Z*S.strides[2],ne=Z*h.strideWidth-v;for(let te=0;te<m;++te){let se=ne+te*y;if(se<0||se>=h.inWidth)continue;let oe=O+te*d[1],fe=q+se*h.inChannels,ce=X,ue=oe;for(let ye=0;ye<h.inChannels;++ye){let de=C[fe+ye];for(let Ce=0;Ce<w;++Ce)E[ce+Ce]+=de*T[ue+Ce];ce+=w,ue+=w}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}var b1e={kernelName:Xu,backendName:"cpu",kernelFunc:N5};function v1e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=r;Ee([a,i],"depthwiseConv2dNativeBackpropFilter");let d=N.computeConv2DInfo(a.shape,u,s,o,l,c,!0),{strideHeight:p,strideWidth:h,filterHeight:f,filterWidth:m}=d,g=new Sn(d.filterShape,"float32"),y=d.padInfo.left,b=d.padInfo.top,v=d.outChannels/d.inChannels,x=n.data.get(a.dataId).values,w=new Sn(a.shape,a.dtype,x),S=n.data.get(i.dataId).values,C=new Sn(i.shape,i.dtype,S);for(let T=0;T<f;++T){let E=Math.max(0,Math.ceil((b-T)/p)),R=Math.min(d.outHeight,(d.inHeight+b-T)/p);for(let $=0;$<m;++$){let _=Math.max(0,Math.ceil((y-$)/h)),D=Math.min(d.outWidth,(d.inWidth+y-$)/h);for(let P=0;P<d.outChannels;++P){let B=Math.trunc(P/v),W=P%v,Y=0;for(let O=0;O<d.batchSize;++O)for(let q=E;q<R;++q){let Z=T+q*p-b;for(let X=_;X<D;++X){let ne=$+X*h-y;Y+=w.get(O,Z,ne,B)*C.get(O,q,X,P)}}g.set(Y,T,$,B,W)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}var x1e={kernelName:Mx,backendName:"cpu",kernelFunc:v1e};function w1e(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=r;Ee([a,i],"depthwiseConv2DNativeBackpropInput");let d=k.computeStrides(a.shape),p=k.computeStrides(i.shape),h=N.computeConv2DInfo(u,i.shape,s,o,l,c,!0),f=new Sn(h.inShape,"float32"),m=f.values,[g,y,b]=f.strides,v=n.data.get(a.dataId).values,[x,w,S]=d,C=n.data.get(i.dataId).values,[T,E,R]=p,{batchSize:$,filterHeight:_,filterWidth:D,inChannels:P,inHeight:B,inWidth:W,outChannels:Y,outHeight:O,outWidth:q,strideHeight:Z,strideWidth:X}=h,ne=_-1-h.padInfo.top,te=D-1-h.padInfo.left,se=Y/P;for(let oe=0;oe<$;++oe)for(let fe=0;fe<P;++fe)for(let ce=0;ce<B;++ce){let ue=ce-ne,ye=Math.max(0,Math.ceil(ue/Z)),de=Math.min(O,(_+ue)/Z);for(let Ce=0;Ce<W;++Ce){let Ae=Ce-te,Me=Math.max(0,Math.ceil(Ae/X)),Fe=Math.min(q,(D+Ae)/X),Ge=0;for(let ze=ye;ze<de;++ze){let nt=ze*Z-ue;for(let vt=Me;vt<Fe;++vt){let Kn=vt*X-Ae,Mt=x*oe+w*ze+S*vt,ve=T*(_-1-nt)+E*(D-1-Kn)+R*fe;for(let Pe=0;Pe<se;++Pe){let ot=fe*se+Pe,St=v[Mt+ot],Ft=C[ve+Pe];Ge+=St*Ft}}}m[g*oe+y*ce+b*Ce+fe]=Ge}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}var k1e={kernelName:Ox,backendName:"cpu",kernelFunc:w1e};function S1e(e){let{inputs:t,backend:n}=e,{x:r}=t,a=k.sizeFromShape(r.shape),i=n.data.get(r.dataId).values,s=et([a,a],r.dtype),o=s.values;for(let c=0;c<i.length;c++)o[c*a+c]=i[c];let l=[...r.shape,...r.shape];return n.makeTensorInfo(l,s.dtype,s.values)}var I1e={kernelName:kg,backendName:"cpu",kernelFunc:S1e},C1e={kernelName:Yu,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:a}=e,{strides:i,pad:s,dilations:o}=n,l=t,c=l.data.get(r.dataId).values,u=r.shape.length,d=l.data.get(a.dataId).values,p=a.shape.length,{batchSize:h,inHeight:f,inWidth:m,inChannels:g,outHeight:y,outWidth:b,padInfo:v,strideHeight:x,strideWidth:w,filterHeight:S,filterWidth:C,dilationHeight:T,dilationWidth:E,outShape:R}=N.computeDilation2DInfo(r.shape,a.shape,i,s,"NHWC",o),$=k.sizeFromShape(R),_=R.length,D=k.getArrayFromDType(r.dtype,$);for(let P=0;P<h;++P)for(let B=0;B<y;++B){let W=B*x-v.top;for(let Y=0;Y<b;++Y){let O=Y*w-v.left;for(let q=0;q<g;++q){let Z=Number.MIN_SAFE_INTEGER;for(let ne=0;ne<S;++ne){let te=W+ne*T;if(te>=0&&te<f)for(let se=0;se<C;++se){let oe=O+se*E;if(oe>=0&&oe<m){let fe=k.locToIndex([P,te,oe,q],u,k.computeStrides(r.shape)),ce=k.locToIndex([ne,se,q],p,k.computeStrides(a.shape)),ue=c[fe]+d[ce];ue>Z&&(Z=ue)}}}let X=k.locToIndex([P,B,Y,q],_,k.computeStrides(R));D[X]=Z}}}return{dataId:l.write(k.toTypedArray(D,r.dtype),R,r.dtype),shape:R,dtype:r.dtype}}},_1e={kernelName:lp,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:a,dy:i}=e,{strides:s,pad:o,dilations:l}=n,c=t,u=k.toNestedArray(r.shape,c.data.get(r.dataId).values),d=k.toNestedArray(a.shape,c.data.get(a.dataId).values),{batchSize:p,inHeight:h,inWidth:f,inChannels:m,outHeight:g,outWidth:y,padInfo:b,strideHeight:v,strideWidth:x,filterHeight:w,filterWidth:S,dilationHeight:C,dilationWidth:T,outShape:E}=N.computeDilation2DInfo(r.shape,a.shape,s,o,"NHWC",l);k.assert(i.rank===E.length,()=>`Error in ${lp}, dy must have the same rank as output ${E.length}, but got ${i.rank}`);let R=k.toNestedArray(E,c.data.get(i.dataId).values),$=k.makeZerosNestedTypedArray(a.shape,a.dtype);for(let _=0;_<p;++_)for(let D=0;D<g;++D){let P=D*v-b.top;for(let B=0;B<y;++B){let W=B*x-b.left;for(let Y=0;Y<m;++Y){let O=Number.MIN_SAFE_INTEGER,q=0,Z=0;for(let X=0;X<w;++X){let ne=P+X*C;if(ne>=0&&ne<h)for(let te=0;te<S;++te){let se=W+te*T;if(se>=0&&se<f){let oe=u[_][ne][se][Y]+d[X][te][Y];oe>O&&(O=oe,q=X,Z=te)}}}$[q][Z][Y]+=R[_][D][B][Y]}}}return{dataId:c.write(k.toTypedArray($,r.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},T1e={kernelName:op,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:a,dy:i}=e,{strides:s,pad:o,dilations:l}=n,c=t,u=k.toNestedArray(r.shape,c.data.get(r.dataId).values),d=k.toNestedArray(a.shape,c.data.get(a.dataId).values),{batchSize:p,inHeight:h,inWidth:f,inChannels:m,outHeight:g,outWidth:y,padInfo:b,strideHeight:v,strideWidth:x,filterHeight:w,filterWidth:S,dilationHeight:C,dilationWidth:T,outShape:E}=N.computeDilation2DInfo(r.shape,a.shape,s,o,"NHWC",l);k.assert(i.rank===E.length,()=>`Error in ${op}, dy must have the same rank as output ${E.length}, but got ${i.rank}`);let R=k.toNestedArray(E,c.data.get(i.dataId).values),$=k.makeZerosNestedTypedArray(r.shape,r.dtype);for(let _=0;_<p;++_)for(let D=0;D<g;++D){let P=D*v-b.top;for(let B=0;B<y;++B){let W=B*x-b.left;for(let Y=0;Y<m;++Y){let O=Number.MIN_SAFE_INTEGER,q=P<0?0:P,Z=W<0?0:W;for(let X=0;X<w;++X){let ne=P+X*C;if(ne>=0&&ne<h)for(let te=0;te<S;++te){let se=W+te*T;if(se>=0&&se<f){let oe=u[_][ne][se][Y]+d[X][te][Y];oe>O&&(O=oe,q=ne,Z=se)}}}$[_][q][Z][Y]+=R[_][D][B][Y]}}}return{dataId:c.write(k.toTypedArray($,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function N1e(e){let{inputs:t,backend:n,attrs:r}=e,{image:a}=t,{canvas:i,options:s}=r,{contextOptions:o,imageOptions:l}=s||{},c=(l==null?void 0:l.alpha)||1,u=(o==null?void 0:o.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);let d=i.getContext(u,(o==null?void 0:o.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${u} type.`);let[p,h]=a.shape.slice(0,2),f=a.shape.length===2?1:a.shape[2],m=n.data.get(a.dataId).values,g=a.dtype==="float32"?255:1,y=new Uint8ClampedArray(h*p*4);for(let v=0;v<p*h;++v){let x=[0,0,0,255*c];for(let S=0;S<f;S++){let C=m[v*f+S];if(a.dtype==="float32"){if(C<0||C>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${C}.`)}else if(a.dtype==="int32"&&(C<0||C>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${C}.`);f===1?(x[0]=C*g,x[1]=C*g,x[2]=C*g):x[S]=C*g}let w=v*4;y[w+0]=Math.round(x[0]),y[w+1]=Math.round(x[1]),y[w+2]=Math.round(x[2]),y[w+3]=Math.round(x[3])}i.width=h,i.height=p;let b=new ImageData(y,h,p);return d.putImageData(b,0,0),a}var E1e={kernelName:GC,backendName:"cpu",kernelFunc:N1e};function fy(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;Ee(a,"sum");let o;a.dtype==="bool"?o=Ho({inputs:{x:a},backend:n,attrs:{dtype:"int32"}}):o=Ji({inputs:{x:a},backend:n});let l=o.shape.length,c=k.parseAxisParam(i,o.shape),u=N.getAxesPermutation(c,l),d=c,p=o;u!=null&&(p=Hr({inputs:{x:o},backend:n,attrs:{perm:u}}),d=N.getInnerMostAxes(d.length,l)),N.assertAxesAreInnerMostDims("sum",d,p.shape.length);let[h,f]=N.computeOutAndReduceShapes(p.shape,d),m=N.upcastType(p.dtype,"int32"),g=mv(n,h,m),y=k.sizeFromShape(f),b=n.data.get(g.dataId).values,v=n.data.get(p.dataId).values;for(let x=0;x<b.length;++x){let w=x*y,S=0;for(let C=0;C<y;++C)S+=v[w+C];b[x]=S}if(s){let x=N.expandShapeToKeepDim(g.shape,c),w=g;g=Wt({inputs:{x:g},backend:n,attrs:{shape:x}}),n.disposeIntermediateTensorInfo(w)}return n.disposeIntermediateTensorInfo(o),u!=null&&n.disposeIntermediateTensorInfo(p),g}var $1e={kernelName:Uc,backendName:"cpu",kernelFunc:fy};function A1e(e){let{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,i=t,{allDims:s,summedDims:o,idDims:l}=N.decodeEinsumEquation(a,i.length);N.checkEinsumDimSizes(s.length,l,i);let{path:c,steps:u}=N.getEinsumComputePath(o,l),d=u.length,p=null,h=s.length,f=[];for(let m=0;m<d;++m){for(let g of u[m]){let{permutationIndices:y,expandDims:b}=N.getEinsumPermutation(h,l[g]),v;N.isIdentityPermutation(y)?v=i[g]:(v=Hr({inputs:{x:i[g]},backend:n,attrs:{perm:y}}),f.push(v));let x=v.shape.slice();for(let w=0;w<b.length;++w)x.splice(b[w],0,1);k.arraysEqual(v.shape,x)||(v=Wt({inputs:{x:v},backend:n,attrs:{shape:x}}),f.push(v)),p===null?p=v:(p=q1({inputs:{a:v,b:p},backend:n}),f.push(p))}m<d-1&&(c[m]>=0&&(p=fy({inputs:{x:p},backend:n,attrs:{axis:c[m]-(s.length-h),keepDims:!1}}),f.push(p)),h--)}for(let m of f)m!==p&&n.disposeIntermediateTensorInfo(m);return p}var R1e={kernelName:Px,backendName:"cpu",kernelFunc:A1e};function F1e(e){let{inputs:t,backend:n}=e,{dy:r,y:a}=t;Ee([r,a],"eluGrad");let i=new Float32Array(k.sizeFromShape(a.shape)),s=n.data.get(a.dataId).values,o=n.data.get(r.dataId).values;for(let l=0;l<s.length;++l){let c=s[l];c>=0?i[l]=o[l]:i[l]=o[l]*(c+1)}return n.makeTensorInfo(a.shape,"float32",i)}var D1e={kernelName:Yp,backendName:"cpu",kernelFunc:F1e},M1e=N.ERF_P,O1e=N.ERF_A1,P1e=N.ERF_A2,z1e=N.ERF_A3,L1e=N.ERF_A4,B1e=N.ERF_A5,W1e=_t(Ju,e=>{let t=Math.sign(e),n=Math.abs(e),r=1/(1+M1e*n);return t*(1-((((B1e*r+L1e)*r+z1e)*r+P1e)*r+O1e)*r*Math.exp(-n*n))}),V1e={kernelName:Ju,backendName:"cpu",kernelFunc:W1e};function bv(e){let{inputs:t,backend:n,attrs:r}=e,{input:a}=t,{dim:i}=r,s=a.shape.length,o=a.shape.slice(),l=i;return i<0&&(k.assert(-(s+1)<=i,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+i+1),o.splice(l,0,1),Wt({inputs:{x:a},backend:n,attrs:{shape:o}})}var U1e={kernelName:Qp,backendName:"cpu",kernelFunc:bv},j1e=gn((e,t)=>e/t),dE=Pn(Zu,j1e),FI={kernelName:Zu,backendName:"cpu",kernelFunc:dE};function E5(e,t,n){let r=e.shape,a=r[0],i=r[1],s=n.data.get(e.dataId),o=s.complexTensorInfos.real,l=s.complexTensorInfos.imag,c=[a,i],u=k.sizeFromShape(c),d=k.getTypedArrayFromDType("float32",u),p=k.getTypedArrayFromDType("float32",u);for(let g=0;g<a;g++){let y=vu({inputs:{x:o},backend:n,attrs:{begin:[g,0],size:[1,i]}}),b=vu({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,i]}}),v=ta({inputs:{real:y,imag:b},backend:n}),{real:x,imag:w}=H1e(v,t,n),S=N.mergeRealAndImagArrays(x,w);for(let C=0;C<i;C++){let T=N.getComplexWithIndex(S,C);d[g*i+C]=T.real,p[g*i+C]=T.imag}n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v)}let h=n.makeTensorInfo(c,"float32",d),f=n.makeTensorInfo(c,"float32",p),m=ta({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),m}function H1e(e,t,n){let r=k.sizeFromShape(e.shape),a=n.data.get(e.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,s=n.data.get(a.complexTensorInfos.imag.dataId).values;if(G1e(r)){let o=DI(i,s,r,t,n),l=[e.shape[0],e.shape[1]];if(t){let c=n.makeTensorInfo(l,"float32",o.real),u=n.makeTensorInfo(l,"float32",o.imag),d=n.makeTensorInfo([],"float32",k.createScalarValue(r,"float32")),p=Ji({inputs:{x:d},backend:n}),h=FI.kernelFunc({inputs:{a:c,b:d},backend:n}),f=FI.kernelFunc({inputs:{a:u,b:p},backend:n}),m=n.data.get(h.dataId).values,g=n.data.get(f.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),{real:m,imag:g}}return o}else{let o=N.mergeRealAndImagArrays(i,s),l=q1e(o,r,t);return N.splitRealAndImagArrays(l)}}function G1e(e){return(e&e-1)===0}function DI(e,t,n,r,a){if(n===1)return{real:e,imag:t};let i=N.mergeRealAndImagArrays(e,t),s=n/2,o=N.complexWithEvenIndex(i),l=o.real,c=o.imag,u=[l.length],d=a.makeTensorInfo(u,"float32",l),p=a.makeTensorInfo(u,"float32",c),h=ta({inputs:{real:d,imag:p},backend:a}),f=N.complexWithOddIndex(i),m=f.real,g=f.imag,y=[m.length],b=a.makeTensorInfo(y,"float32",m),v=a.makeTensorInfo(y,"float32",g),x=ta({inputs:{real:b,imag:v},backend:a}),w=DI(l,c,s,r,a),S=w.real,C=w.imag,T=[S.length],E=a.makeTensorInfo(T,"float32",S),R=a.makeTensorInfo(T,"float32",C),$=ta({inputs:{real:E,imag:R},backend:a}),_=DI(m,g,s,r,a),D=_.real,P=_.imag,B=[D.length],W=a.makeTensorInfo(B,"float32",D),Y=a.makeTensorInfo(B,"float32",P),O=ta({inputs:{real:W,imag:Y},backend:a}),q=N.exponents(n,r),Z=[q.real.length],X=a.makeTensorInfo(Z,"float32",q.real),ne=a.makeTensorInfo(Z,"float32",q.imag),te=ta({inputs:{real:X,imag:ne},backend:a}),se=q1({inputs:{a:te,b:O},backend:a}),oe=Sp({inputs:{a:$,b:se},backend:a}),fe=lE({inputs:{a:$,b:se},backend:a}),ce=bu({inputs:{input:oe},backend:a}),ue=bu({inputs:{input:fe},backend:a}),ye=Ip({inputs:{input:oe},backend:a}),de=Ip({inputs:{input:fe},backend:a}),Ce=Cp({inputs:[ce,ue],backend:a,attrs:{axis:0}}),Ae=Cp({inputs:[ye,de],backend:a,attrs:{axis:0}}),Me=a.data.get(Ce.dataId).values,Fe=a.data.get(Ae.dataId).values;return a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(v),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(E),a.disposeIntermediateTensorInfo(R),a.disposeIntermediateTensorInfo($),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(Y),a.disposeIntermediateTensorInfo(O),a.disposeIntermediateTensorInfo(X),a.disposeIntermediateTensorInfo(ne),a.disposeIntermediateTensorInfo(te),a.disposeIntermediateTensorInfo(se),a.disposeIntermediateTensorInfo(oe),a.disposeIntermediateTensorInfo(fe),a.disposeIntermediateTensorInfo(ce),a.disposeIntermediateTensorInfo(ye),a.disposeIntermediateTensorInfo(ue),a.disposeIntermediateTensorInfo(de),a.disposeIntermediateTensorInfo(Ce),a.disposeIntermediateTensorInfo(Ae),{real:Me,imag:Fe}}function q1e(e,t,n){let r=new Float32Array(t*2);for(let a=0;a<t;a++){let i=0,s=0;for(let o=0;o<t;o++){let l=N.exponent(a*o,t,n),c=N.getComplexWithIndex(e,o);i+=c.real*l.real-c.imag*l.imag,s+=c.real*l.imag+c.imag*l.real}n&&(i/=t,s/=t),N.assignToTypedArray(r,i,s,a)}return r}function K1e(e){let{inputs:t,backend:n}=e,{input:r}=t,a=k.sizeFromShape(r.shape),i=r.shape[r.shape.length-1],s=a/i,o=Wt({inputs:{x:r},backend:n,attrs:{shape:[s,i]}}),l=E5(o,!1,n),c=Wt({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}var X1e={kernelName:zx,backendName:"cpu",kernelFunc:K1e};function pE(e){let{backend:t,attrs:n}=e,{shape:r,value:a,dtype:i}=n,s=i||k.inferDtype(a),o=k.getArrayFromDType(s,k.sizeFromShape(r));return Z1e(o,a),t.makeTensorInfo(r,s,o)}var Y1e={kernelName:Sg,backendName:"cpu",kernelFunc:pE};function Z1e(e,t,n){e.fill(t)}var Q1e={kernelName:Jp,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,a=n,i=k.getTypedArrayFromDType(r.dtype,k.sizeFromShape(r.shape)),[s,o,l,c]=r.shape,u=a.data.get(r.dataId).values;for(let d=0;d<s;d++){let p=d*l*o*c;for(let h=0;h<o;h++){let f=h*(l*c);for(let m=0;m<l;m++){let g=m*c;for(let y=0;y<c;y++){let b=Math.round(l-m-1),v=p+f+g+y,x=u[v];if(b>=0&&b<l){let w=b*c,S=p+f+w+y;x=u[S]}i[v]=x}}}}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function J1e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=r,m=T5({inputs:{x:a,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p}});if(s){let g=m;if(u==="NCHW"&&s.shape.length===1&&s.shape[0]!==1){let y=Wt({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});m=Sp({inputs:{a:m,b:y},backend:n}),n.disposeIntermediateTensorInfo(y)}else m=Sp({inputs:{a:m,b:s},backend:n});n.disposeIntermediateTensorInfo(g)}if(h){let g=m;if(u==="NCHW"&&h==="prelu"&&o.shape.length===1&&o.shape[0]!==1){let y=Wt({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=yv(n,m,h,y,f),n.disposeIntermediateTensorInfo(y)}else m=yv(n,m,h,o,f);n.disposeIntermediateTensorInfo(g)}return m}var ewe={kernelName:su,backendName:"cpu",kernelFunc:J1e};function twe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=r,m=N5({inputs:{x:a,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p}});if(s){let g=m;m=Sp({inputs:{a:m,b:s},backend:n}),n.disposeIntermediateTensorInfo(g)}if(h){let g=m;m=yv(n,m,h,o,f),n.disposeIntermediateTensorInfo(g)}return m}var nwe={kernelName:ou,backendName:"cpu",kernelFunc:twe};function rwe(e){let{inputs:t,backend:n}=e,{params:r,indices:a}=t,i=k.sizeFromShape(r.shape),s=a.shape,o=s[s.length-1],[l,c,u,d]=N.prepareAndValidate(r,a);if(c===0)return n.makeTensorInfo(l,r.dtype,[]);let p=n.data.get(a.dataId).values,h=n.bufferSync(r),f=HV(p,h,r.dtype,c,o,u,d,r.shape,i);return n.makeTensorInfo(l,r.dtype,f.values)}var awe={kernelName:th,backendName:"cpu",kernelFunc:rwe};function iwe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,indices:i}=t,{axis:s,batchDims:o}=r;Ee([a,i],"gatherV2");let l=k.parseAxisParam(s,a.shape)[0],c=n.data.get(i.dataId).values,u=a.shape[l];for(let x=0;x<c.length;++x){let w=c[x];k.assert(w<=u-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${u-1}]`)}let d=o;o==null&&(d=0);let p=k.sizeFromShape(i.shape),h=N.segment_util.collectGatherOpShapeInfo(a,i,l,d),f=Wt({inputs:{x:a},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),m=Wt({inputs:{x:i},backend:n,attrs:{shape:[h.batchSize,p/h.batchSize]}}),g=[h.batchSize,h.outerSize,p/h.batchSize,h.sliceSize],y=n.bufferSync(m),b=n.bufferSync(f),v=GV(b,y,g);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(h.outputShape,v.dtype,v.values)}var swe={kernelName:eh,backendName:"cpu",kernelFunc:iwe};function owe(e){let{inputs:t,backend:n}=e,{input:r}=t,a=k.sizeFromShape(r.shape),i=r.shape[r.shape.length-1],s=a/i,o=Wt({inputs:{x:r},backend:n,attrs:{shape:[s,i]}}),l=E5(o,!0,n),c=Wt({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}var lwe={kernelName:Lx,backendName:"cpu",kernelFunc:owe},uwe=_t(oc,e=>Number.isFinite(e)?1:0,"bool"),cwe={kernelName:oc,backendName:"cpu",kernelFunc:uwe},dwe=_t(lc,e=>Math.abs(e)===1/0?1:0,"bool"),pwe={kernelName:lc,backendName:"cpu",kernelFunc:dwe},hwe=_t(uc,e=>Number.isNaN(e)?1:0,"bool"),fwe={kernelName:uc,backendName:"cpu",kernelFunc:hwe};function mwe(e){let{backend:t,attrs:n}=e,{start:r,stop:a,num:i}=n,s=ZV(r,a,i);return t.makeTensorInfo([s.length],"float32",s)}var gwe={kernelName:ih,backendName:"cpu",kernelFunc:mwe},ywe=_t(pc,e=>Math.log1p(e)),bwe={kernelName:pc,backendName:"cpu",kernelFunc:ywe},vwe=gn((e,t)=>e&&t),xwe=Pn(sh,vwe,null,"bool"),wwe={kernelName:sh,backendName:"cpu",kernelFunc:xwe},kwe=_t(oh,e=>e?0:1,"bool"),Swe={kernelName:oh,backendName:"cpu",kernelFunc:kwe},Iwe=gn((e,t)=>e||t),Cwe=Pn(lh,Iwe,null,"bool"),_we={kernelName:lh,backendName:"cpu",kernelFunc:Cwe};function Twe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=r;Ee(a,"LRN");let c=a.shape[3],u=c-1,d=n.data.get(a.dataId).values,p=k.sizeFromShape(a.shape),h=new Float32Array(p);function f(m){let g=m%c,y=m-g+Math.max(0,g-i),b=m-g+Math.min(g+i,u),v=0;for(;y<=b;y++){let x=d[y];v+=x*x}return v}for(let m=0;m<p;m++){let g=f(m),y=d[m]*Math.pow(s+o*g,-l);h[m]=y}return n.makeTensorInfo(a.shape,a.dtype,h)}var Nwe={kernelName:hc,backendName:"cpu",kernelFunc:Twe};function Ewe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=r;Ee(s,"LRNGrad");let d=k.sizeFromShape(s.shape),p=s.shape[3],h=n.data.get(s.dataId).values,f=n.data.get(a.dataId).values,m=n.data.get(i.dataId).values,g=new Float32Array(d),y=d;for(let b=0;b<y;b++){let v=b%p,x=b-v+Math.max(0,v-o),w=b-v+Math.min(p,v+o+1),S=0;for(let C=x;C<w;C++)S+=Math.pow(f[C],2);S=c*S+l;for(let C=x;C<w;C++){let T=-2*c*u*f[C]*m[b]/S;b===C&&(T+=Math.pow(S,-u)),T*=h[b],g[C]+=T}}return n.makeTensorInfo(s.shape,a.dtype,g)}var $we={kernelName:uh,backendName:"cpu",kernelFunc:Ewe};function $5(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:i,keepDims:s}=r,o=n,l=a.shape,c=l.length,u=k.parseAxisParam(i,l),d=u,p=N.getAxesPermutation(d,c),h=o.data.get(a.dataId).values;if(p!=null){let x=new Array(c);for(let w=0;w<x.length;w++)x[w]=l[p[w]];h=nE(h,l,a.dtype,p,x),d=N.getInnerMostAxes(d.length,c),l=x}Ee(a,"max"),N.assertAxesAreInnerMostDims("max",d,c);let[f,m]=N.computeOutAndReduceShapes(l,d),g=k.sizeFromShape(m),y=JV(h,g,f,a.dtype),b=o.write(y,f,a.dtype),v=f;return s&&(v=N.expandShapeToKeepDim(f,u)),{dataId:b,shape:v,dtype:a.dtype}}var Awe={kernelName:fc,backendName:"cpu",kernelFunc:$5};function Rwe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;Ee(a,"maxPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=r,c=1;k.assert(N.eitherStridesOrDilationsAreOne(s,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);let u=N.computePool2DInfo(a.shape,i,s,c,o,l),d;if(u.filterWidth===1&&u.filterHeight===1&&k.arraysEqual(u.inShape,u.outShape))d=Ji({inputs:{x:a},backend:n});else{let p=n.data.get(a.dataId).values,h=k.computeStrides(a.shape),f=cE(p,a.shape,a.dtype,h,u,"max");d=n.makeTensorInfo(u.outShape,a.dtype,f.values)}return d}var Fwe={kernelName:gc,backendName:"cpu",kernelFunc:Rwe};function Dwe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=r;Ee(a,"maxPool3d");let u=N.computePool3DInfo(a.shape,i,s,1,o,l,c),d=n.data.get(a.dataId).values,p=_5(d,a.shape,a.dtype,k.computeStrides(a.shape),u,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}var Mwe={kernelName:ch,backendName:"cpu",kernelFunc:Dwe};function Owe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r;Ee([a,i],"maxPool3DGrad");let u=N.computePool3DInfo(i.shape,s,o,1,l,c),d=n.bufferSync(i),p=Ixe(d,u),h=u.strideDepth,f=u.strideHeight,m=u.strideWidth,g=u.dilationDepth,y=u.dilationHeight,b=u.dilationWidth,v=u.effectiveFilterDepth,x=u.effectiveFilterHeight,w=u.effectiveFilterWidth,S=v-1-u.padInfo.front,C=w-1-u.padInfo.left,T=x-1-u.padInfo.top,E=et(i.shape,"float32"),R=n.bufferSync(a);for(let $=0;$<u.batchSize;++$)for(let _=0;_<u.inChannels;++_)for(let D=0;D<u.inDepth;++D)for(let P=0;P<u.inHeight;++P)for(let B=0;B<u.inWidth;++B){let W=D-S,Y=P-T,O=B-C,q=0;for(let Z=0;Z<v;Z+=g){let X=(W+Z)/h;if(!(X<0||X>=u.outDepth||Math.floor(X)!==X))for(let ne=0;ne<x;ne+=y){let te=(Y+ne)/f;if(!(te<0||te>=u.outHeight||Math.floor(te)!==te))for(let se=0;se<w;se+=b){let oe=(O+se)/m;if(oe<0||oe>=u.outWidth||Math.floor(oe)!==oe)continue;let fe=v*x*w-1-p.get($,X,te,oe,_),ce=Z*x*w+ne*w+se,ue=fe===ce?1:0;if(ue===0)continue;let ye=R.get($,X,te,oe,_);q+=ye*ue}}}E.set(q,$,D,P,B,_)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}var Pwe={kernelName:Cg,backendName:"cpu",kernelFunc:Owe};function zwe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i,output:s}=t,o=i;Ee([i,s],"maxPoolGrad");let{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=r,p=N.computePool2DInfo(o.shape,l,c,1,u,d),h=n.data.get(o.dataId).values,f=et(p.outShape,o.dtype,C5(h,o.shape,o.dtype,p).values),m=p.strideHeight,g=p.strideWidth,y=p.dilationHeight,b=p.dilationWidth,v=p.effectiveFilterHeight,x=p.effectiveFilterWidth,w=x-1-p.padInfo.left,S=v-1-p.padInfo.top,C=et(o.shape,"float32"),T=n.data.get(a.dataId).values,E=et(a.shape,"float32",T);for(let R=0;R<p.batchSize;++R)for(let $=0;$<p.inChannels;++$)for(let _=0;_<p.inHeight;++_)for(let D=0;D<p.inWidth;++D){let P=_-S,B=D-w,W=0;for(let Y=0;Y<v;Y+=y){let O=(P+Y)/m;if(!(O<0||O>=p.outHeight||Math.floor(O)!==O))for(let q=0;q<x;q+=b){let Z=(B+q)/g;if(Z<0||Z>=p.outWidth||Math.floor(Z)!==Z)continue;let X=v*x-1-f.get(R,O,Z,$),ne=Y*x+q,te=X===ne?1:0;if(te===0)continue;let se=E.get(R,O,Z,$);W+=se*te}}C.set(W,R,_,D,$)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}var Lwe={kernelName:Ig,backendName:"cpu",kernelFunc:zwe};function Bwe(e,t,n,r,a){let i=k.computeStrides(t),s=cE(e,t,n,i,a,"max"),o=C5(e,t,n,a,!0,r);return[s.values,o.values]}var Wwe={kernelName:_g,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:a,strides:i,pad:s,includeBatchInIndex:o}=t,l=n;Ee(r,"MaxPoolWithArgmax");let c=l.data.get(r.dataId).values,u=N.computePool2DInfo(r.shape,a,i,[1,1],s),[d,p]=Bwe(c,r.shape,r.dtype,o,u),h=l.write(d,u.outShape,r.dtype),f=l.write(p,u.outShape,r.dtype);return[{dataId:h,shape:u.outShape,dtype:r.dtype},{dataId:f,shape:u.outShape,dtype:"int32"}]}};function Vwe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=k.parseAxisParam(i,a.shape),l=N.computeOutAndReduceShapes(a.shape,o)[1],c=k.sizeFromShape(l),u=[],d=n.makeTensorInfo([],"float32",new Float32Array([c]));u.push(d);let p=Ho({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});u.push(p);let h=dE({inputs:{a:p,b:d},backend:n});u.push(h);let f=fy({inputs:{x:h},backend:n,attrs:{axis:i,keepDims:s}});return u.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}var Uwe={kernelName:yc,backendName:"cpu",kernelFunc:Vwe};function jwe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;Ee(a,"min");let o=k.parseAxisParam(i,a.shape),l=o,c=N.getAxesPermutation(l,a.shape.length),u=a;c!=null&&(u=Hr({inputs:{x:a},backend:n,attrs:{perm:c}}),l=N.getInnerMostAxes(l.length,a.shape.length)),N.assertAxesAreInnerMostDims("min",l,u.shape.length);let[d,p]=N.computeOutAndReduceShapes(u.shape,l),h=k.sizeFromShape(p),f=k.makeZerosTypedArray(k.sizeFromShape(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<f.length;++y){let b=y*h,v=m[b];for(let x=0;x<h;++x){let w=m[b+x];(Number.isNaN(w)||w<v)&&(v=w)}f[y]=v}c!=null&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(d,u.dtype,f);if(s){let y=N.expandShapeToKeepDim(d,o),b=Wt({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),b}return g}var Hwe={kernelName:bc,backendName:"cpu",kernelFunc:jwe};function Gwe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,mode:s}=r;Ee(a,"mirrorPad");let o=i.map((b,v)=>b[0]+a.shape[v]+b[1]),l=i.map(b=>b[0]),c=i.map((b,v)=>b[0]+a.shape[v]),u=s==="reflect"?0:1,d=n.data.get(a.dataId).values,p=a.shape.length,h=k.computeStrides(a.shape),f=k.sizeFromShape(o),m=o.length,g=k.computeStrides(o),y=k.getTypedArrayFromDType(a.dtype,f);for(let b=0;b<f;b++){let v=k.indexToLoc(b,m,g);for(let w=0;w<m;w++)v[w]<l[w]?v[w]=l[w]*2-v[w]-u:v[w]>=c[w]&&(v[w]=(c[w]-1)*2-v[w]+u);v=v.map((w,S)=>w-l[S]);let x=k.locToIndex(v,p,h);y[b]=d[x]}return{dataId:n.write(y,o,a.dtype),shape:o,dtype:a.dtype}}var qwe={kernelName:xc,backendName:"cpu",kernelFunc:Gwe},Kwe=gn((e,t)=>{let n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),Xwe=Pn(wc,Kwe),Ywe={kernelName:wc,backendName:"cpu",kernelFunc:Xwe},Zwe=Qo(Ex());function A5(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:i}=r,s=a.shape.length,o=i;if(o===-1&&(o=s-1),o!==s-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${s} and dim was ${o}`);let l=k.parseAxisParam([o],a.shape),c=$5({inputs:{x:a},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=N.expandShapeToKeepDim(c.shape,l),d=Wt({inputs:{x:c},backend:n,attrs:{shape:u}}),p=lE({inputs:{a,b:d},backend:n}),h=WV({inputs:{x:p},backend:n}),f=fy({inputs:{x:h},backend:n,attrs:{axis:l,keepDims:!1}}),m=Wt({inputs:{x:f},backend:n,attrs:{shape:u}}),g=dE({inputs:{a:h,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}var Qwe={kernelName:jc,backendName:"cpu",kernelFunc:A5};function Jwe(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:s,normalized:o}=r;Ee(a,"multinomial");let l=o?a:A5({inputs:{logits:a},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,p=[c,i],h=k.makeZerosTypedArray(k.sizeFromShape(p),"int32");for(let f=0;f<c;++f){let m=f*u,g=new Float32Array(u-1);g[0]=d[m];for(let v=1;v<g.length;++v)g[v]=g[v-1]+d[m+v];let y=Zwe.alea(s.toString()),b=f*i;for(let v=0;v<i;++v){let x=y();h[b+v]=g.length;for(let w=0;w<g.length;w++)if(x<g[w]){h[b+v]=w;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(p,"int32",h)}var eke={kernelName:dh,backendName:"cpu",kernelFunc:Jwe},tke=rs.nonMaxSuppressionV3Impl;function nke(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=r;Ee(a,"NonMaxSuppression");let c=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:d}=tke(c,u,s,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}var rke={kernelName:fh,backendName:"cpu",kernelFunc:nke},ake=rs.nonMaxSuppressionV4Impl;function ike(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=r;Ee(a,"NonMaxSuppressionPadded");let u=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:p,validOutputs:h}=ake(u,d,s,o,l,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}var ske={kernelName:mh,backendName:"cpu",kernelFunc:ike},oke=rs.nonMaxSuppressionV5Impl;function lke(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=r;Ee(a,"NonMaxSuppressionWithScore");let u=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,p=s,h=o,f=l,m=c,{selectedIndices:g,selectedScores:y}=oke(u,d,p,h,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}var uke={kernelName:gh,backendName:"cpu",kernelFunc:lke};function cke(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:s,onValue:o,offValue:l}=r;Ee(a,"oneHot");let c=k.sizeFromShape(a.shape),u=new Float32Array(c*s);u.fill(l);let d=n.data.get(a.dataId).values;for(let p=0;p<c;++p)d[p]>=0&&d[p]<s&&(u[p*s+d[p]]=o);return n.makeTensorInfo([...a.shape,s],i,u)}var dke={kernelName:Sc,backendName:"cpu",kernelFunc:cke};function vv(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){let a=bu({inputs:{input:r},backend:n}),i=vv({inputs:{x:a},backend:n}),s=Ip({inputs:{input:r},backend:n}),o=vv({inputs:{x:s},backend:n}),l=ta({inputs:{real:i,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return pE({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var pke={kernelName:Mh,backendName:"cpu",kernelFunc:vv};function R5(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){let a=bu({inputs:{input:r},backend:n}),i=R5({inputs:{x:a},backend:n}),s=Ip({inputs:{input:r},backend:n}),o=vv({inputs:{x:s},backend:n}),l=ta({inputs:{real:i,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return pE({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}var hke={kernelName:yh,backendName:"cpu",kernelFunc:R5};function F5(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(t.length===1)return bv({inputs:{input:t[0]},backend:n,attrs:{dim:a}});let i=t[0].shape,s=t[0].dtype;t.forEach(u=>{k.assertShapesMatch(i,u.shape,"All tensors passed to stack must have matching shapes"),k.assert(s===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=t.map(u=>{let d=bv({inputs:{input:u},backend:n,attrs:{dim:a}});return o.push(d),d}),c=Cp({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}var fke={kernelName:bh,backendName:"cpu",kernelFunc:F5};function mke(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,constantValue:s}=r;Ee(a,"pad");let o=i.map((y,b)=>y[0]+a.shape[b]+y[1]),l=i.map(y=>y[0]),c=n.data.get(a.dataId).values,u=k.sizeFromShape(a.shape),d=a.shape.length,p=k.computeStrides(a.shape),h=k.sizeFromShape(o),f=o.length,m=k.computeStrides(o),g=k.getTypedArrayFromDType(a.dtype,h);s!==0&&g.fill(s);for(let y=0;y<u;y++){let b=k.indexToLoc(y,d,p).map((x,w)=>x+l[w]),v=k.locToIndex(b,f,m);g[v]=c[y]}return{dataId:n.write(g,o,a.dtype),shape:o,dtype:a.dtype}}var D5={kernelName:Ic,backendName:"cpu",kernelFunc:mke},gke=gn((e,t)=>Math.pow(e,t)),yke=Pn(Cc,gke),bke={kernelName:Cc,backendName:"cpu",kernelFunc:yke};function vke(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:i,indices:s}=t,o=a.map(g=>n.data.get(g.dataId).values),l=a.map(g=>g.shape),c=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,[d,p,h]=i5(o,l,c,i.shape,i.dtype,u,s.shape),f=d.map(g=>n.makeTensorInfo([g.length],"int32",g)),m=n.makeTensorInfo(h,i.dtype,p);return f.concat([m])}var xke={kernelName:Wx,backendName:"cpu",kernelFunc:vke};function wke(e){let{inputs:t,backend:n}=e,{starts:r,limits:a,deltas:i}=t,s=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[c,u]=s5(s,r.shape,r.dtype,o,a.shape,l,i.shape),d=n.makeTensorInfo([c.length],"int32",c),p=n.makeTensorInfo([u.length],r.dtype,u);return[d,p]}var kke={kernelName:Vx,backendName:"cpu",kernelFunc:wke};function Ske(e){let{inputs:t,backend:n,attrs:r}=e,{shape:a,values:i,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,c=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,d=n.data.get(s.dataId).values,p=o.map(g=>n.data.get(g.dataId).values),h=o.map(g=>g.shape),[f,m]=o5(c,a.shape,u,i.shape,i.dtype,d,s.shape,p,h,l);return n.makeTensorInfo(f,i.dtype,m)}var Ike={kernelName:Ux,backendName:"cpu",kernelFunc:Ske};function Cke(e){let{backend:t,attrs:n}=e,{start:r,stop:a,dtype:i,step:s}=n,o=rE(r,a,s,i);return t.makeTensorInfo([o.length],i,o)}var _ke={kernelName:Tg,backendName:"cpu",kernelFunc:Cke},Tke=_t(Nc,e=>1/e),Nke={kernelName:Nc,backendName:"cpu",kernelFunc:Tke};function Eke(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r;Ee(a,"resizeBilinear");let l=k.computeStrides(a.shape),[c,u]=o,[d,p,h,f]=a.shape,m=n.data.get(a.dataId).values,g=new Float32Array(k.sizeFromShape([d,c,u,f])),y=[i&&c>1?p-1:p,i&&u>1?h-1:h],b=[i&&c>1?c-1:c,i&&u>1?u-1:u],v=0,x=y[0]/b[0],w=y[1]/b[1];for(let S=0;S<d;S++)for(let C=0;C<c;C++){let T;s?T=x*(C+.5)-.5:T=x*C;let E=Math.max(0,Math.floor(T)),R=T-E,$=Math.min(p-1,Math.ceil(T)),_=S*l[0]+E*l[1],D=S*l[0]+$*l[1];for(let P=0;P<u;P++){let B;s?B=w*(P+.5)-.5:B=w*P;let W=Math.max(0,Math.floor(B)),Y=B-W,O=Math.min(h-1,Math.ceil(B)),q=_+W*l[2],Z=D+W*l[2],X=_+O*l[2],ne=D+O*l[2];for(let te=0;te<f;te++){let se=m[q+te],oe=m[Z+te],fe=m[X+te],ce=m[ne+te],ue=se+(fe-se)*Y,ye=oe+(ce-oe)*Y,de=ue+(ye-ue)*R;g[v++]=de}}}return n.makeTensorInfo([d,c,u,f],"float32",g)}var $ke={kernelName:Ac,backendName:"cpu",kernelFunc:Eke};function Ake(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r;Ee([i,a],"resizeBilinearGrad");let o=k.computeStrides(a.shape),[l,c,u,d]=a.shape,[,p,h]=i.shape,f=new Float32Array(l*c*u*d),m=[s&&p>1?c-1:c,s&&h>1?u-1:u],g=[s&&p>1?p-1:p,s&&h>1?h-1:h],y=m[0]/g[0],b=m[1]/g[1],v=n.data.get(i.dataId).values,x=0;for(let w=0;w<l;w++){let S=w*o[0];for(let C=0;C<p;C++){let T=C*y,E=Math.floor(T),R=Math.min(Math.ceil(T),c-1),$=S+E*o[1],_=S+R*o[1],D=T-E,P=1-D;for(let B=0;B<h;B++){let W=B*b,Y=Math.floor(W),O=Math.min(Math.ceil(W),u-1),q=W-Y,Z=1-q,X=$+Y*o[2],ne=$+O*o[2],te=_+Y*o[2],se=_+O*o[2],oe=P*Z,fe=P*q,ce=D*Z,ue=D*q;for(let ye=0;ye<d;ye++){let de=v[x++];f[X+ye]+=de*oe,f[ne+ye]+=de*fe,f[te+ye]+=de*ce,f[se+ye]+=de*ue}}}}return n.makeTensorInfo([l,u,c,d],"float32",f)}var Rke={kernelName:wh,backendName:"cpu",kernelFunc:Ake};function Fke(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r;Ee(a,"resizeNearestNeighbor");let l=k.computeStrides(a.shape),[c,u]=o,[d,p,h,f]=a.shape,m=n.data.get(a.dataId).values,g=new Float32Array(d*c*u*f),y=[i&&c>1?p-1:p,i&&u>1?h-1:h],b=[i&&c>1?c-1:c,i&&u>1?u-1:u],v=y[0]/b[0],x=y[1]/b[1],w=0;for(let S=0;S<d;S++){let C=S*l[0];for(let T=0;T<c;T++){let E=s?v*(T+.5):v*T,R=Math.min(p-1,i?Math.round(E):Math.floor(E));s&&(R=Math.max(0,R));let $=C+R*l[1];for(let _=0;_<u;_++){let D=s?x*(_+.5):x*_,P=Math.min(h-1,i?Math.round(D):Math.floor(D));s&&(P=Math.max(0,P));let B=$+P*l[2];for(let W=0;W<f;W++){let Y=m[B+W];g[w++]=Y}}}}return n.makeTensorInfo([d,c,u,f],a.dtype,g)}var Dke={kernelName:$c,backendName:"cpu",kernelFunc:Fke};function Mke(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r;Ee([i,a],"resizeNearestNeighborGrad");let o=k.computeStrides(a.shape),l=k.computeStrides(i.shape),[c,u,d,p]=a.shape,[,h,f]=i.shape,m=new Float32Array(c*u*d*p),g=n.data.get(i.dataId).values,y=[s&&h>1?u-1:u,s&&f>1?d-1:d],b=[s&&h>1?h-1:h,s&&f>1?f-1:f],v=y[0]/b[0],x=y[1]/b[1],w=1/v,S=1/x,C=Math.ceil(w)*2+2,T=Math.ceil(S)*2+2;for(let E=0;E<c;E++){let R=E*o[0];for(let $=0;$<u;$++){let _=R+$*o[1],D=Math.floor($*w),P=Math.floor(D-C/2);for(let B=0;B<d;B++){let W=_+B*o[2],Y=Math.floor(B*S),O=Math.floor(Y-T/2);for(let q=0;q<p;q++){let Z=0;for(let X=0;X<C;X++){let ne=X+P;if(ne<0||ne>=h)continue;let te=R+ne*l[1],se=ne*v,oe=Math.min(u-1,s?Math.round(se):Math.floor(se));if($===oe)for(let fe=0;fe<T;fe++){let ce=fe+O;if(ce<0||ce>=f)continue;let ue=te+ce*l[2],ye=ce*x,de=Math.min(d-1,s?Math.round(ye):Math.floor(ye));B===de&&(Z+=g[ue+q])}}m[W+q]=Z}}}}return n.makeTensorInfo(a.shape,a.dtype,m)}var Oke={kernelName:xh,backendName:"cpu",kernelFunc:Mke};function Pke(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r;Ee(a,"reverse");let s=a.shape.length,o=k.parseAxisParam(i,a.shape);if(s===0)return Ji({inputs:{x:a},backend:n});let l=new Sn(a.shape,a.dtype),c=n.bufferSync(a);for(let u=0;u<l.size;u++){let d=l.indexToLoc(u),p=d.slice();o.forEach(h=>p[h]=a.shape[h]-1-p[h]),l.set(c.get(...p),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}var zke={kernelName:Fc,backendName:"cpu",kernelFunc:Pke},Lke={kernelName:Oh,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:a,fillValue:i,center:s}=t,o=n,l=k.getTypedArrayFromDType(r.dtype,k.sizeFromShape(r.shape)),[c,u,d,p]=r.shape,[h,f]=N.getImageCenter(s,u,d),m=255,g=Math.sin(a),y=Math.cos(a),b=o.data.get(r.dataId).values;for(let v=0;v<c;v++){let x=v*d*u*p;for(let w=0;w<u;w++){let S=w*(d*p);for(let C=0;C<d;C++){let T=C*p;for(let E=0;E<p;E++){let R=[c,w,C,E],$=R[2],_=R[1],D=($-h)*y-(_-f)*g,P=($-h)*g+(_-f)*y;D=Math.round(D+h),P=Math.round(P+f);let B=i;if(typeof i!="number"&&(E===3?B=m:B=i[E]),D>=0&&D<d&&P>=0&&P<u){let Y=P*(d*p),O=D*p,q=x+Y+O+E;B=b[q]}let W=x+S+T+E;l[W]=B}}}}return{dataId:o.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},Bke=_t(Dc,e=>{let t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),Wke={kernelName:Dc,backendName:"cpu",kernelFunc:Bke};function Vke(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:i}=t,{shape:s}=r,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=N.calculateShapes(i,a,s),p=!0,h=n.bufferSync(a),f=n.bufferSync(i),m=Vl(h,f,s,d,c,l,o,u,0,p);return n.makeTensorInfo(s,m.dtype,m.values)}var Uke={kernelName:kh,backendName:"cpu",kernelFunc:Vke};function jke(e,t){let n=0,r=e.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),e[a]<t?n=a+1:r=a;return r}function Hke(e,t){let n=0,r=e.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),e[a]<=t?n=a+1:r=a;return r}function Gke(e,t,n,r,a,i){let s=k.getArrayFromDType("int32",n*a);for(let o=0;o<n;++o){let l=e.slice(o*r,(o+1)*r),c=o*a;for(let u=0;u<a;++u)s[c+u]=i==="left"?jke(l,t[u+c]):Hke(l,t[u+c])}return s}function qke(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:s}=r,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,c=Gke(o,l,a.shape[0],a.shape[1],i.shape[1],s);return n.makeTensorInfo(i.shape,"int32",c)}var Kke={kernelName:Ih,backendName:"cpu",kernelFunc:qke};function Xke(e){let{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t;Ee([r,a,i],"select");let s=r.shape.length,o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,u=Fa(a.dtype,i.dtype),d=k.makeZerosTypedArray(k.sizeFromShape(a.shape),u),p=0,h=s===0||s>1||a.shape.length===1?1:k.sizeFromShape(a.shape.slice(1));for(let f=0;f<o.length;f++)for(let m=0;m<h;m++)o[f]===1?d[p++]=l[f]:d[p++]=c[f];return n.makeTensorInfo(a.shape,u,d)}var Yke={kernelName:Ch,backendName:"cpu",kernelFunc:Xke},Zke=N.SELU_SCALEALPHA,Qke=N.SELU_SCALE,Jke=_t(Oc,e=>e>=0?Qke*e:Zke*(Math.exp(e)-1)),eSe={kernelName:Oc,backendName:"cpu",kernelFunc:Jke},tSe=_t(Lc,e=>e<0?-1:e>0?1:0),nSe={kernelName:Lc,backendName:"cpu",kernelFunc:tSe},rSe=_t(Pc,e=>Math.sin(e)),aSe={kernelName:Pc,backendName:"cpu",kernelFunc:rSe},iSe=_t(zc,e=>Math.sinh(e)),sSe={kernelName:zc,backendName:"cpu",kernelFunc:iSe},oSe=11920928955078125e-23,kD=Math.log(oSe)+2,lSe=_t(Wc,e=>{let t=e>-kD,n=e<kD,r=Math.exp(e),a;return n?a=r:t?a=e:a=Math.log(1+r),a}),uSe={kernelName:Wc,backendName:"cpu",kernelFunc:lSe};function cSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:s}=r;Ee([a],"spaceToBatchND");let o=k.sizeFromShape(i),l=[[0,0]];l.push(...s);for(let g=1+i.length;g<a.shape.length;++g)l.push([0,0]);let c=D5.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),u=N.getReshaped(c.shape,i,o,!1),d=N.getPermuted(u.length,i.length,!1),p=N.getReshapedPermuted(c.shape,i,o,!1),h=Wt({inputs:{x:c},backend:n,attrs:{shape:u}}),f=Hr({inputs:{x:h},backend:n,attrs:{perm:d}}),m=Wt({inputs:{x:f},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),m}var dSe={kernelName:Th,backendName:"cpu",kernelFunc:cSe};function pSe(e){let{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:i,defaultValue:s}=t;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${a.shape}`);if(s.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${s.shape}`);let o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values[0],[d,p,h,f,m]=c5(o,r.shape,r.dtype,l,a.dtype,c,u);return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],a.dtype,h),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(g=>Number(g)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}var hSe={kernelName:Ng,backendName:"cpu",kernelFunc:pSe};function fSe(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:i}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${a.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);let s=Array.from(n.data.get(a.dataId).values),o=n.data.get(r.dataId).values,l=Array.from(n.data.get(i.dataId).values),[c,u,d]=d5(o,r.shape,r.dtype,s,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}var mSe={kernelName:Eh,backendName:"cpu",kernelFunc:fSe};function gSe(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${a.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");let s=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[c,u]=aE(s,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(u,r.dtype,c)}var ySe={kernelName:Eg,backendName:"cpu",kernelFunc:gSe};function bSe(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${a.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");let s=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[c,u]=aE(s,r.shape,r.dtype,o,l);return n.makeTensorInfo(u,r.dtype,c)}var vSe={kernelName:$g,backendName:"cpu",kernelFunc:bSe};function xSe(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:a,sparseValues:i,defaultValue:s}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:p}=N.calculateShapes(i,a,o),h=!1,f=n.bufferSync(a),m;switch(i.dtype){case"bool":{let g=n.bufferSync(i),y=!!n.data.get(s.dataId).values[0];m=Vl(f,g,o,p,u,c,l,d,y,h);break}case"float32":{let g=n.bufferSync(i),y=n.data.get(s.dataId).values[0];m=Vl(f,g,o,p,u,c,l,d,y,h);break}case"int32":{let g=n.bufferSync(i),y=n.data.get(s.dataId).values[0];m=Vl(f,g,o,p,u,c,l,d,y,h);break}case"string":{let g=n.bufferSync(i),y=k.decodeString(n.data.get(s.dataId).values[0]);m=Vl(f,g,o,p,u,c,l,d,y,h);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(o,m.dtype,m.values)}var wSe={kernelName:$h,backendName:"cpu",kernelFunc:xSe};function kSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:s}=r,o=k.parseAxisParam(s,a.shape)[0],l=N.prepareSplitSize(a,i,o),c=new Array(a.shape.length).fill(0),u=a.shape.slice();return l.map(d=>{let p=[...u];p[o]=d;let h=vu({inputs:{x:a},backend:n,attrs:{begin:c,size:p}});return c[o]+=d,h})}var SSe={kernelName:Nh,backendName:"cpu",kernelFunc:kSe},ISe={kernelName:Ag,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{let{x:n}=e,r=t;Ee(n,"square");let a=r.data.get(n.dataId).values,i=new Float32Array(a.length);for(let s=0;s<a.length;++s){let o=a[s];i[s]=o*o}return{dataId:r.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},CSe=_t(nl,(e,t)=>{let n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),_Se={kernelName:nl,backendName:"cpu",kernelFunc:CSe};function TSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,end:s,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:p}=r;Ee(a,"stridedSlice");let{finalShapeSparse:h,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:b,end:v,strides:x}=Dn.sliceInfo(a.shape,i,s,o,l,c,u,d,p),w;if(m)w=Wt({inputs:{x:a},backend:n,attrs:{shape:f}});else if(g||y){k.assert(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);let S=Dn.computeOutShape(b,v,x),C=vu({inputs:{x:a},backend:n,attrs:{begin:b,size:S}});w=Wt({inputs:{x:C},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(C)}else{let S=n.bufferSync(a),C=f5(h,S,x,b);w=n.makeTensorInfo(f,C.dtype,C.values)}return w}var NSe={kernelName:Ah,backendName:"cpu",kernelFunc:TSe};function ESe(e){let{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:i,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:d}=t,p=n.data.get(u.dataId).values,h=n.data.get(d.dataId).values,[f,m]=iE(p,h,a,i,s,o,l,c);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}var $Se={kernelName:Fg,backendName:"cpu",kernelFunc:ESe};function ASe(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:i,delimiter:s}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(s.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);let o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values[0],[c,u,d]=sE(o,l,a),p=u.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}var RSe={kernelName:Dg,backendName:"cpu",kernelFunc:ASe};function FSe(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:i}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");let s=n.data.get(i.dataId).values,o=oE(s,a);return n.makeTensorInfo(i.shape,"int32",o)}var DSe={kernelName:Mg,backendName:"cpu",kernelFunc:FSe},MSe=_t(qc,e=>Math.tan(e)),OSe={kernelName:qc,backendName:"cpu",kernelFunc:MSe},PSe=_t(Kc,e=>Math.tanh(e)),zSe={kernelName:Kc,backendName:"cpu",kernelFunc:PSe};function LSe(e){let{inputs:t,backend:n}=e,{tensor:r,indices:a,updates:i}=t,{sliceRank:s,numUpdates:o,sliceSize:l,strides:c,outputSize:u}=N.calculateShapes(i,a,r.shape),d=!1,p=n.bufferSync(a),h=n.bufferSync(i),f=n.bufferSync(r),m=Vl(p,h,r.shape,u,l,o,s,c,f,d);return n.makeTensorInfo(r.shape,m.dtype,m.values)}var BSe={kernelName:Sh,backendName:"cpu",kernelFunc:LSe};function WSe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:i}=r;Ee(a,"tile");let s=g5(n.bufferSync(a),i);return n.makeTensorInfo(s.shape,s.dtype,s.values)}var VSe={kernelName:tl,backendName:"cpu",kernelFunc:WSe};function USe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:i,sorted:s}=r;Ee(a,"topk");let o=n.data.get(a.dataId).values,[l,c]=b5(o,a.shape,a.dtype,i,s);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}var jSe={kernelName:Rh,backendName:"cpu",kernelFunc:USe};function HSe(e){let{inputs:t,attrs:n,backend:r}=e,{image:a,transforms:i}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:c}=n,[u,d,p,h]=a.shape,[f,m]=c??[d,p],g=[u,f,m,h],y=k.computeStrides(a.shape),b=y[0],v=y[1],x=y[2],w=k.computeStrides(g),S=w[0],C=w[1],T=w[2],E=k.getTypedArrayFromDType(a.dtype,k.sizeFromShape(g));E.fill(l);let R=r.data.get(a.dataId).values,$=r.data.get(i.dataId).values;for(let _=0;_<u;++_){let D=i.shape[0]===1?$:$.subarray(_*8,_*8+8);for(let P=0;P<f;++P)for(let B=0;B<m;++B)for(let W=0;W<h;++W){let Y,O=D[6]*B+D[7]*P+1;if(O===0)continue;let q=(D[0]*B+D[1]*P+D[2])/O,Z=(D[3]*B+D[4]*P+D[5])/O,X=SD(q,p,o),ne=SD(Z,d,o);switch(s){case"nearest":Y=ZSe(R,d,p,b,v,x,_,ne,X,W,l);break;case"bilinear":Y=QSe(R,d,p,b,v,x,_,ne,X,W,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${s}`)}let te=_*S+P*C+B*T+W;E[te]=Y}return r.makeTensorInfo(g,a.dtype,E)}return{dataId:r.write(E,g,a.dtype),shape:a.shape,dtype:a.dtype}}var GSe={kernelName:Fh,backendName:"cpu",kernelFunc:HSe};function SD(e,t,n){switch(n){case"reflect":return qSe(e,t);case"wrap":return KSe(e,t);case"nearest":return YSe(e,t);case"constant":default:return XSe(e)}}function qSe(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{let r=2*t;n-=r*Math.trunc(n/r),n>=t&&(n=r-n-1)}return k.clamp(0,n,t-1)}function KSe(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{let r=t-1;n-=t*Math.trunc(n/r)}return k.clamp(0,n,t-1)}function XSe(e,t){return e}function YSe(e,t){return k.clamp(0,e,t-1)}function Df(e,t,n,r,a,i,s,o,l,c,u){let d=s*r+o*a+l*i+c;return 0<=o&&o<t&&0<=l&&l<n?e[d]:u}function ZSe(e,t,n,r,a,i,s,o,l,c,u){let d=Math.round(o),p=Math.round(l);return Df(e,t,n,r,a,i,s,d,p,c,u)}function QSe(e,t,n,r,a,i,s,o,l,c,u){let d=Math.floor(o),p=Math.floor(l),h=d+1,f=p+1,m=(f-l)*Df(e,t,n,r,a,i,s,d,p,c,u)+(l-p)*Df(e,t,n,r,a,i,s,d,f,c,u),g=(f-l)*Df(e,t,n,r,a,i,s,h,p,c,u)+(l-p)*Df(e,t,n,r,a,i,s,h,f,c,u);return(h-o)*m+(o-d)*g}function JSe(e){let{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t;Ee(i,"unique");let s=r.data.get(i.dataId).values,{outputValues:o,outputShape:l,indices:c}=uE(s,a,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,o),r.makeTensorInfo([c.length],"int32",c)]}var eIe={kernelName:Og,backendName:"cpu",kernelFunc:JSe};function tIe(e){let{inputs:t,backend:n,attrs:r}=e,{value:a}=t,{axis:i}=r;i<0&&(i+=a.shape.length);let s=a.shape.length,o=a.shape[i],l=new Array(s-1),c=0;for(let h=0;h<s;h++)h!==i&&(l[c++]=a.shape[h]);let u=new Array(s).fill(0),d=a.shape.slice();d[i]=1;let p=new Array(o);for(let h=0;h<p.length;h++){u[i]=h;let f=vu({inputs:{x:a},backend:n,attrs:{begin:u,size:d}});p[h]=Wt({inputs:{x:f},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(f)}return p}var nIe={kernelName:Dh,backendName:"cpu",kernelFunc:tIe};function rIe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:i}=t,{numSegments:s}=r;Ee(a,"unsortedSegmentSum");let o=a.shape.length,l=i.shape.length,c=[],u=[],d=o-l,p=i;for(let f=0;f<d;++f){let m=bv({inputs:{input:p},backend:n,attrs:{dim:f+1}});p=m,u.push(m)}for(let f=0;f<s;++f){let m=k.createScalarValue(f,"int32"),g=n.makeTensorInfo([],"int32",m),y=LV({inputs:{a:g,b:p},backend:n}),b=Ho({inputs:{x:y},backend:n,attrs:{dtype:"float32"}}),v=q1({inputs:{a:b,b:a},backend:n}),x=fy({inputs:{x:v},backend:n,attrs:{axis:0,keepDims:!1}});c.push(x),u.push(g),u.push(y),u.push(b),u.push(v),u.push(x)}let h=F5({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(f=>n.disposeIntermediateTensorInfo(f)),h}var aIe={kernelName:Pg,backendName:"cpu",kernelFunc:rIe},iIe=[Qve,Rbe,exe,nxe,zbe,axe,sxe,lxe,cxe,pxe,fxe,gxe,bxe,wxe,Sxe,_xe,Nxe,$xe,Rxe,Yve,Dxe,Oxe,zxe,Bbe,Bxe,Obe,Vbe,Vxe,Fbe,jxe,Gxe,qxe,Xxe,Zxe,Jxe,t1e,r1e,i1e,o1e,u1e,d1e,h1e,m1e,y1e,b1e,x1e,k1e,I1e,C1e,_1e,T1e,E1e,R1e,Uve,D1e,Ube,V1e,jbe,U1e,Gbe,X1e,Y1e,Q1e,Kbe,Ybe,ewe,nwe,awe,swe,Qbe,eve,Dbe,lwe,Hxe,cwe,pwe,fwe,jve,nve,ave,gwe,sve,bwe,wwe,Swe,_we,Nwe,$we,Awe,lve,Fwe,Mwe,Pwe,Lwe,Wwe,Uwe,Hwe,cve,qwe,Ywe,eke,pve,fve,rke,ske,uke,gve,dke,hke,fke,D5,bke,Gve,vve,xke,kke,Ike,_ke,Mbe,FI,Nke,qve,Kve,Xve,$ke,Rke,Dke,Oke,zke,Lke,Wke,Tve,Uke,Kke,Yke,eSe,Eve,nSe,aSe,sSe,$ve,Qwe,uSe,dSe,hSe,mSe,ySe,vSe,wSe,SSe,Fve,ISe,Mve,Pve,_Se,NSe,$Se,RSe,DSe,Wve,$1e,OSe,zSe,BSe,VSe,jSe,GSe,yve,eIe,nIe,aIe,pke];for(let e of iIe)zg(e);var M5={};He(M5,{assertNotComplex:()=>Xh,bindCanvasToFramebuffer:()=>gIe,bindColorTextureToFramebuffer:()=>nb,bindTextureToProgramUniformSampler:()=>Z5,bindTextureUnit:()=>K5,bindVertexBufferToProgramAttribute:()=>MI,callAndCheck:()=>xe,canBeRepresented:()=>P5,createFragmentShader:()=>B5,createFramebuffer:()=>q5,createProgram:()=>W5,createStaticIndexBuffer:()=>j5,createStaticVertexBuffer:()=>U5,createTexture:()=>H5,createVertexShader:()=>L5,getBatchDim:()=>xu,getExtensionOrThrow:()=>Mf,getFramebufferErrorMessage:()=>Q5,getMaxTexturesInShader:()=>nU,getNumChannels:()=>fIe,getProgramUniformLocation:()=>Y5,getProgramUniformLocationOrThrow:()=>X5,getRowsCols:()=>wu,getShapeAs3D:()=>Pf,getTextureShapeFromLogicalShape:()=>eU,getWebGLDisjointQueryTimerVersion:()=>rU,getWebGLErrorMessage:()=>z5,getWebGLMaxTextureSize:()=>tU,hasExtension:()=>_a,isCapableOfRenderingToFloatTexture:()=>aU,isDownloadFloatTextureEnabled:()=>iU,isReshapeFree:()=>Qm,isWebGLFenceEnabled:()=>sU,isWebGLVersionEnabled:()=>PI,linkProgram:()=>V5,logShaderSourceAndInfoLog:()=>fE,resetMaxTextureSize:()=>yIe,resetMaxTexturesInShader:()=>bIe,unbindColorTextureFromFramebuffer:()=>OI,unbindTextureUnit:()=>mIe,validateFramebuffer:()=>Of,validateProgram:()=>tb,validateTextureSize:()=>G5});var Fl={},k0={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function O5(e,t){Fl[e]=t}function _i(e,t){if(!(e in Fl)||t!=null){let r=oIe(e,t);if(r!==null)Fl[e]=r;else return console.log("Could not get context for WebGL version",e),null}let n=Fl[e];return n==null||n.isContextLost()?(delete Fl[e],_i(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Fl[e])}function sIe(e){if(!Q().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&e===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function oIe(e,t){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let n=t??sIe(e);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Fl[e]},!1),Q().getBool("SOFTWARE_WEBGL_ENABLED")&&(k0.failIfMajorPerformanceCaveat=!1),e===1?n.getContext("webgl",k0)||n.getContext("experimental-webgl",k0):n.getContext("webgl2",k0)}var Zm;(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(Zm||(Zm={}));var Ca;(function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"})(Ca||(Ca={}));var er;(function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(er||(er={}));function my(e,t){return[t,e]}function lIe(e,t){return e*t}function S0(e){let t=k.sizeFromShape(e),n=Math.ceil(t/4);return k.sizeToSquarishShape(n)}function Kh(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function uIe(e,t){let[n,r]=Kh(e,t);return n*r*4}function hE(e,t){let n=e,r,a,i,s,o,l,c,u,d,p;return Q().getNumber("WEBGL_VERSION")===2?(r=n.R32F,a=n.R16F,i=n.RGBA16F,s=n.RGBA32F,o=n.RED,c=4,u=1,d=n.HALF_FLOAT,p=n.FLOAT,l=n.RGBA8):(r=e.RGBA,a=e.RGBA,i=e.RGBA,s=n.RGBA,o=e.RGBA,c=4,u=4,d=t!=null?t.HALF_FLOAT_OES:null,p=e.FLOAT,l=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:s,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:p}}function xe(e,t){let n=t();return Q().getBool("DEBUG")&&cIe(e),n}function cIe(e){let t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+z5(e,t))}var dIe=596e-10,pIe=65504;function P5(e){return!!(Q().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||dIe<Math.abs(e)&&Math.abs(e)<pIe)}function z5(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function Mf(e,t){return Gs(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function L5(e,t){let n=Gs(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(xe(e,()=>e.shaderSource(n,t)),xe(e,()=>e.compileShader(n)),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function B5(e,t){let n=Gs(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(xe(e,()=>e.shaderSource(n,t)),xe(e,()=>e.compileShader(n)),Q().get("ENGINE_COMPILE_ONLY"))return n;if(e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw fE(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var hIe=/ERROR: [0-9]+:([0-9]+):/g;function fE(e,t){let n=hIe.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}let r=+n[1],a=e.split(`
`),i=a.length.toString().length+2,s=a.map((d,p)=>k.rightPad((p+1).toString(),i)+d),o=0;for(let d=0;d<s.length;d++)o=Math.max(s[d].length,o);let l=s.slice(0,r-1),c=s.slice(r-1,r),u=s.slice(r);console.log(l.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${k.rightPad(c[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function W5(e){return Gs(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function V5(e,t){if(xe(e,()=>e.linkProgram(t)),!Q().get("ENGINE_COMPILE_ONLY")&&e.getProgramParameter(t,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function tb(e,t){if(xe(e,()=>e.validateProgram(t)),e.getProgramParameter(t,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function U5(e,t){let n=Gs(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return xe(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),xe(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function j5(e,t){let n=Gs(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return xe(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),xe(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function fIe(){return Q().getNumber("WEBGL_VERSION")===2?1:4}function H5(e){return Gs(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function G5(e,t){let n=Q().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){let r=`[${e}x${t}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){let r=`[${e}x${t}]`,a=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+a+".")}}function q5(e){return Gs(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function MI(e,t,n,r,a,i,s){let o=e.getAttribLocation(t,n);return o===-1?!1:(xe(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),xe(e,()=>e.vertexAttribPointer(o,a,e.FLOAT,!1,i,s)),xe(e,()=>e.enableVertexAttribArray(o)),!0)}function K5(e,t,n){J5(e,n),xe(e,()=>e.activeTexture(e.TEXTURE0+n)),xe(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function mIe(e,t){J5(e,t),xe(e,()=>e.activeTexture(e.TEXTURE0+t)),xe(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function X5(e,t,n){return Gs(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function Y5(e,t,n){return e.getUniformLocation(t,n)}function Z5(e,t,n,r){xe(e,()=>K5(e,t,r)),xe(e,()=>e.uniform1i(n,r))}function gIe(e){xe(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),xe(e,()=>e.viewport(0,0,e.canvas.width,e.canvas.height)),xe(e,()=>e.scissor(0,0,e.canvas.width,e.canvas.height))}function nb(e,t,n){xe(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),xe(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function OI(e,t){xe(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),xe(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function Of(e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Q5(e,t))}function Q5(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function Gs(e,t,n){let r=xe(e,()=>t());if(r==null)throw new Error(n);return r}function J5(e,t){let n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){let a=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${a}.`)}}function xu(e,t=2){return k.sizeFromShape(e.slice(0,e.length-t))}function wu(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Pf(e){let t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[xu(e),...wu(e)]),t}function eU(e,t=!1){let n=Q().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=Q().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&Q().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n=n*2,r=r*2,e=e.map((o,l)=>l>=e.length-2?k.nearestLargerEven(e[l]):e[l]),e.length===1&&(e=[2,e[0]])),e.length!==2&&(e=k.squeezeShape(e).newShape);let a=k.sizeFromShape(e),i=null;e.length<=1&&a<=n?i=[1,a]:e.length===2&&e[0]<=n&&e[1]<=n?i=e:e.length===3&&e[0]*e[1]<=n&&e[2]<=n?i=[e[0]*e[1],e[2]]:e.length===3&&e[0]<=n&&e[1]*e[2]<=n?i=[e[0],e[1]*e[2]]:e.length===4&&e[0]*e[1]*e[2]<=n&&e[3]<=n?i=[e[0]*e[1]*e[2],e[3]]:e.length===4&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(i=[e[0],e[1]*e[2]*e[3]]);let s=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(t?2:1)&&Math.min(...i)>0;if(i==null||s)if(t){let o=xu(e),l=2,c=2;e.length&&([l,c]=wu(e)),a=o*(l/2)*(c/2),i=k.sizeToSquarishShape(a).map(u=>u*2)}else i=k.sizeToSquarishShape(a);return i}function I0(e){return e%2===0}function Qm(e,t){if(e=e.slice(-2),t=t.slice(-2),k.arraysEqual(e,t)||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){let n=e[e.length-1],r=t[t.length-1];if(n===r||I0(n)&&I0(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&I0(e[0])&&I0(t[0])}var rb,ab;function tU(e){if(rb==null){let t=_i(e);rb=t.getParameter(t.MAX_TEXTURE_SIZE)}return rb}function yIe(){rb=null}function bIe(){ab=null}function nU(e){if(ab==null){let t=_i(e);ab=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ab)}function rU(e){if(e===0)return 0;let t,n=_i(e);return _a(n,"EXT_disjoint_timer_query_webgl2")&&e===2?t=2:_a(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function _a(e,t){return e.getExtension(t)!=null}function PI(e){try{if(_i(e)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function aU(e){if(e===0)return!1;let t=_i(e);if(e===1){if(!_a(t,"OES_texture_float"))return!1}else if(!_a(t,"EXT_color_buffer_float"))return!1;return zI(t)}function iU(e){if(e===0)return!1;let t=_i(e);if(e===1){if(!_a(t,"OES_texture_float")||!_a(t,"WEBGL_color_buffer_float"))return!1}else{if(_a(t,"EXT_color_buffer_float"))return zI(t);let n="EXT_color_buffer_half_float";if(_a(t,n)){let r=t.getExtension(n);return vIe(t,r)}return!1}return zI(t)}function zI(e){let t=hE(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);let r=1,a=1;e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,r,a,0,t.textureFormatFloat,t.textureTypeFloat,null);let i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);let s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(i),s}function vIe(e,t){let n=hE(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);let a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);let s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);let o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(s),o}function sU(e){return e!==2?!1:_i(e).fenceSync!=null}function Xh(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&k.assert(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}var $e=Q();$e.registerFlag("HAS_WEBGL",()=>$e.getNumber("WEBGL_VERSION")>0);$e.registerFlag("WEBGL_VERSION",()=>PI(2)?2:PI(1)?1:0);$e.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);$e.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>$e.get("WEBGL_VERSION")===2);$e.registerFlag("WEBGL_CPU_FORWARD",()=>!0);$e.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);$e.registerFlag("WEBGL_PACK",()=>$e.getBool("HAS_WEBGL"));$e.registerFlag("WEBGL_PACK_NORMALIZATION",()=>$e.getBool("WEBGL_PACK"));$e.registerFlag("WEBGL_PACK_CLIP",()=>$e.getBool("WEBGL_PACK"));$e.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>$e.getBool("WEBGL_PACK"));$e.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>$e.getBool("WEBGL_PACK"));$e.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>$e.getBool("WEBGL_PACK"));$e.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>$e.getBool("WEBGL_PACK"));$e.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>$e.getBool("WEBGL_PACK"));$e.registerFlag("WEBGL_PACK_REDUCE",()=>$e.getBool("WEBGL_PACK"));$e.registerFlag("WEBGL_LAZILY_UNPACK",()=>$e.getBool("WEBGL_PACK"));$e.registerFlag("WEBGL_CONV_IM2COL",()=>$e.getBool("WEBGL_PACK"));$e.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>tU($e.getNumber("WEBGL_VERSION")));$e.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>nU($e.getNumber("WEBGL_VERSION")));$e.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let e=$e.getNumber("WEBGL_VERSION");return e===0?0:rU(e)});$e.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>$e.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Wg.isMobile());$e.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>aU($e.getNumber("WEBGL_VERSION")));$e.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>$e.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:$e.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));$e.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>iU($e.getNumber("WEBGL_VERSION")));$e.registerFlag("WEBGL_FENCE_API_ENABLED",()=>sU($e.getNumber("WEBGL_VERSION")));$e.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>$e.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);$e.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if(e<0&&e!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)});$e.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Wg.isMobile()?1:-1,e=>{if(e<0&&e!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)});$e.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);$e.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);$e.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);$e.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);$e.registerFlag("WEBGL_EXP_CONV",()=>!1);$e.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>$e.getBool("IS_TEST"));$e.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);$e.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);$e.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);$e.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);function Fr(){let e,t,n,r,a,i,s,o,l,c;return Q().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",s="out vec4 outputColor;",o=Q().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",s="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:s,defineSpecialNaN:o,defineSpecialInf:l,defineRound:c}}function nd(e,t,n="index"){let r=k.computeStrides(t);return r.map((a,i)=>{let s=`int ${e[i]} = ${n} / ${a}`,o=i===r.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * ${a}`:`index -= ${e[i]} * ${a}`;return`${s}; ${o};`}).join("")}function K1(e,t,n="index"){let r=k.computeStrides(t);return r.map((a,i)=>{let s=`int ${e[i]} = ${n} / outShapeStrides[${i}]`,o=i===r.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * outShapeStrides[${i}]`:`index -= ${e[i]} * outShapeStrides[${i}]`;return`${s}; ${o};`}).join("")}function xIe(e,t){let n=e.length,r=e.map(i=>`${t}[${i}]`),a=new Array(n-1);a[n-2]=r[n-1];for(let i=n-3;i>=0;--i)a[i]=`(${a[i+1]} * ${r[i+1]})`;return a}function wIe(e,t,n="index"){let r=e.map((i,s)=>s),a=xIe(r,t);return a.map((i,s)=>{let o=`int ${e[s]} = ${n} / ${a[s]}`,l=s===a.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * ${a[s]}`:`index -= ${e[s]} * ${a[s]}`;return`${o}; ${l};`}).join("")}function mE(e){let t=k.computeStrides(e).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function gE(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}var oU=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`,{getBroadcastDims:lU}=N;function kIe(e,t,n){let r=[];if(e.forEach(p=>{let h=k.sizeFromShape(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?r.push(`uniform float ${p.name}${h>1?`[${h}]`:""};`):(r.push(`uniform sampler2D ${p.name};`),r.push(`uniform int offset${p.name};`)),n.enableShapeUniforms){let{uniformShape:f}=yE(n.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(f.length){case 1:r.push(`uniform int ${p.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${p.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${p.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${p.name}Shape;`);break}r.push(`uniform ivec2 ${p.name}TexShape;`)}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(p=>{r.push(`uniform ${p.type} ${p.name}${p.arrayIndex?`[${p.arrayIndex}]`:""};`)});let a=r.join(`
`),i=e.map(p=>SIe(p,t,n.packedInputs,n.enableShapeUniforms)).join(`
`),s=t.texShape,o=Fr(),l=_Ie(o),c,u,d=EIe(o);return t.isPacked?(c=IIe(t.logicalShape,s,n.enableShapeUniforms),u=NIe(o)):(c=CIe(t.logicalShape,s,n.enableShapeUniforms),u=TIe(o)),n.packedInputs&&(d+=FIe),[d,l,u,a,c,i,n.userCode].join(`
`)}function Yh(e,t=!1){let n=e.shapeInfo.logicalShape;switch(n.length){case 0:return HIe(e,t);case 1:return qIe(e,t);case 2:return XIe(e,t);case 3:return ZIe(e,t);case 4:return JIe(e,t);case 5:return e2e(e);case 6:return t2e(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function uU(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return jIe(e);case 1:return GIe(e,t);case 2:return KIe(e,t);case 3:return YIe(e,t);default:return QIe(e,t)}}function SIe(e,t,n=!1,r){let a="";n?a+=uU(e,r):a+=Yh(e,r);let i=e.shapeInfo.logicalShape,s=t.logicalShape;return i.length<=s.length&&(n?a+=n2e(e,t):a+=r2e(e,t)),a}function IIe(e,t,n){switch(e.length){case 0:return cU();case 1:return DIe(e,t,n);case 2:return VIe(e,t,n);case 3:return OIe(e,t,n);default:return zIe(e,t,n)}}function CIe(e,t,n){switch(e.length){case 0:return cU();case 1:return MIe(e,t,n);case 2:return UIe(e,t,n);case 3:return PIe(e,t,n);case 4:return LIe(e,t,n);case 5:return BIe(e,t);case 6:return WIe(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}function _Ie(e){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${e.texture2D}(textureSampler, uv).r;
    }
  `}function TIe(e){return`
    void setOutput(float val) {
      ${e.output} = vec4(val, 0, 0, 0);
    }
  `}function NIe(e){return`
    void setOutput(vec4 val) {
      ${e.output} = val;
    }
  `}function EIe(e){return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFs} vec2 resultUV;
    ${e.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${e.defineSpecialNaN}
    ${e.defineSpecialInf}
    ${e.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${$Ie}
    ${AIe}
    ${RIe}
  `}var $Ie=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,AIe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,RIe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,FIe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function cU(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function DIe(e,t,n){let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function MIe(e,t,n){return t[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function OIe(e,t,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[2]/2),i=a*Math.ceil(e[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec3(b, r, c);
    }
  `}function PIe(e,t,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${K1(["r","c","d"],e)}
    return ivec3(r, c, d);
  }
`;let r=nd(["r","c","d"],e);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function zIe(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[e.length-1]/2),i=a*Math.ceil(e[e.length-2]/2),s=i,o="",l="b, r, c";for(let c=2;c<e.length-1;c++)s*=e[e.length-c-1],o=`
      int b${c} = index / ${s};
      index -= b${c} * ${s};
    `+o,l=`b${c}, `+l;return`
    ivec${e.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${o}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec${e.length}(${l});
    }
  `}function LIe(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${K1(["r","c","d","d2"],e)}
      return ivec4(r, c, d, d2);
    }
  `;let r=nd(["r","c","d","d2"],e);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function BIe(e,t){let n=nd(["r","c","d","d2","d3"],e);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function WIe(e,t){let n=nd(["r","c","d","d2","d3","d4"],e);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function VIe(e,t,n){let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(k.arraysEqual(e,t))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;let a=Math.ceil(e[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec2(r, c);
    }
  `}function UIe(e,t,n){return k.arraysEqual(e,t)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:e[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:e[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${e[1]};
      int c = index - r * ${e[1]};
      return ivec2(r, c);
    }
  `}function rd(e){return`offset${e}`}function jIe(e){let t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Fr();return`
    vec4 ${n}() {
      return ${r.texture2D}(${t}, halfCR);
    }
  `}function HIe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;let[a,i]=e.shapeInfo.texShape;if(a===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;let s=rd(n);if(t)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${s});
      return sampleTexture(${n}, uv);
    }
  `;let[o,l]=e.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${s});
      return sampleTexture(${n}, uv);
    }
  `}function GIe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=Fr();if(t)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;let s=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${s[0]}, ${s[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function qIe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Zh(e)}
      }
    `;let a=e.shapeInfo.texShape,i=a[0],s=a[1];if(s===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;let o=rd(n);return s===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${s}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:t?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${o});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${s}, index + ${o});
      return sampleTexture(${n}, uv);
    }
  `}function KIe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,s=i[0],o=i[1],l=Fr();if(i!=null&&k.arraysEqual(n,i))return t?`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${s}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(t)return`
    vec4 ${a}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;let c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${a}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function XIe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape;if(i!=null&&k.arraysEqual(n,i)){if(t)return`
      float ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;let p=i[0],h=i[1];return`
    float ${a}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${h}.0, ${p}.0);
      return sampleTexture(${r}, uv);
    }
  `}let{newShape:s,keptDims:o}=k.squeezeShape(n),l=s;if(l.length<n.length){let p=Qh(e,l),h=["row","col"];return`
      ${Yh(p,t)}
      float ${a}(int row, int col) {
        return ${a}(${Jh(h,o)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${a}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Zh(e)}
      }
    `;let c=i[0],u=i[1],d=rd(r);return u===1?t?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${r}, uv);
    }
  `:c===1?t?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:t?`
      float ${a}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${a}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${r}, uv);
  }
`}function YIe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,s=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){let p=n.slice(1),h=[1,2],f=Qh(e,p),m=["b","row","col"];return`
        ${uU(f,t)}
        vec4 ${a}(int b, int row, int col) {
          return ${a}(${Jh(m,h)});
        }
      `}let o=Fr();if(t)return`
    vec4 ${a}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `;let l=s[0],c=s[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return`
    vec4 ${a}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${u}, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `}function ZIe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],s=n[2],{newShape:o,keptDims:l}=k.squeezeShape(n),c=o;if(c.length<n.length){let m=Qh(e,c),g=["row","col","depth"];return`
        ${Yh(m,t)}
        float ${a}(int row, int col, int depth) {
          return ${a}(${Jh(g,l)});
        }
      `}if(e.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${s}, 1)));
        ${Zh(e)}
      }
    `;let u=e.shapeInfo.texShape,d=u[0],p=u[1],h=e.shapeInfo.flatOffset;if(p===i&&h==null)return t?`
      float ${a}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${a}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${s}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(p===s&&h==null)return t?`
      float ${a}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;let f=rd(r);return t?`
    float ${a}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${f};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${a}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${s} + depth + ${f};
        vec2 uv = uvFromFlat(${d}, ${p}, index);
        return sampleTexture(${r}, uv);
      }
  `}function QIe(e,t){let n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=Fr();if(t)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${a.texture2D}(${n}, uv);
    }
  `;let i=e.shapeInfo.logicalShape,s=i.length,o=e.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=l[0],u=l[1],d=Math.ceil(i[s-1]/2),p=d*Math.ceil(i[s-2]/2),h="int b, int row, int col",f=`b * ${p} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<s-1;m++)h=`int b${m}, `+h,p*=i[s-m-1],f=`b${m} * ${p} + `+f;return`
    vec4 ${r}(${h}) {
      int index = ${f};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${a.texture2D}(${n}, uv);
    }
  `}function JIe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],s=n[2]*i,o=n[1]*s,{newShape:l,keptDims:c}=k.squeezeShape(n);if(l.length<n.length){let b=Qh(e,l),v=["row","col","depth","depth2"];return`
      ${Yh(b,t)}
      float ${a}(int row, int col, int depth, int depth2) {
        return ${a}(${Jh(v,c)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${s}, ${i}, 1)));
        ${Zh(e)}
      }
    `;let u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],h=d[1],f=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,g=`int stride0 = ${r}Shape[1] * stride1;`;if(h===o&&u==null)return t?`
      float ${a}(int row, int col, int depth, int depth2) {
        ${f}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${s}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(h===i&&u==null)return t?`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;let y=rd(r);return t?`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${f}
      ${m}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${y});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${s} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${p}, ${h}, index + ${y});
      return sampleTexture(${r}, uv);
    }
  `}function e2e(e){let t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,s=t[2]*i,o=t[1]*s,{newShape:l,keptDims:c}=k.squeezeShape(t);if(l.length<t.length){let m=Qh(e,l),g=["row","col","depth","depth2","depth3"];return`
      ${Yh(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${Jh(g,c)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${s}, ${i}, ${a})) +
          depth3;
        ${Zh(e)}
      }
    `;let u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],h=d[1];if(h===o&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${s}, ${i}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(h===a&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;let f=rd(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${s} + depth * ${i} +
          depth2 * ${a} + depth3 + ${f};
      vec2 uv = uvFromFlat(${p}, ${h}, index);
      return sampleTexture(${n}, uv);
    }
  `}function t2e(e){let t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:i}=k.squeezeShape(t);if(a.length<t.length){let g=Qh(e,a),y=["row","col","depth","depth2","depth3","depth4"];return`
      ${Yh(g)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${Jh(y,i)});
      }
    `}let s=t[5],o=t[4]*s,l=t[3]*o,c=t[2]*l,u=t[1]*c;if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${s}, 1)));
        ${Zh(e)}
      }
    `;let d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,h=p[0],f=p[1];if(f===u&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${o}, ${s})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===s&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;let m=rd(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${o} + depth3 * ${s} + depth4 + ${m};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Zh(e){let t=e.name,n=k.sizeFromShape(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function n2e(e,t){let n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,o=lU(e.shapeInfo.logicalShape,t.logicalShape),l=At(s),c=s-i,u,d=["x","y","z","w","u","v"];i===0?u="":s<2&&o.length>=1?u="coords = 0;":u=o.map(g=>`coords.${d[g+c]} = 0;`).join(`
`);let p="";s<2&&i>0?p="coords":p=e.shapeInfo.logicalShape.map((g,y)=>`coords.${d[y+c]}`).join(", ");let h="return outputValue;",f=k.sizeFromShape(e.shapeInfo.logicalShape)===1,m=k.sizeFromShape(t.logicalShape)===1;if(i===1&&!f&&!m)h=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(f&&!m)s===1?h=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:h=`
        return vec4(outputValue.x);
      `;else if(o.length){let g=i-2,y=i-1;o.indexOf(g)>-1&&o.indexOf(y)>-1?h="return vec4(outputValue.x);":o.indexOf(g)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(y)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${a}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${r}(${p});
      ${h}
    }
  `}function r2e(e,t){let n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,s=e.shapeInfo.texShape,o=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&o===l&&e.shapeInfo.flatOffset==null&&k.arraysEqual(s,i))return`
      float ${a}() {
        return sampleTexture(${n}, resultUV);
      }
    `;let c=At(l),u=lU(e.shapeInfo.logicalShape,t.logicalShape),d=l-o,p,h=["x","y","z","w","u","v"];o===0?p="":l<2&&u.length>=1?p="coords = 0;":p=u.map(m=>`coords.${h[m+d]} = 0;`).join(`
`);let f="";return l<2&&o>0?f="coords":f=e.shapeInfo.logicalShape.map((m,g)=>`coords.${h[g+d]}`).join(", "),`
    float ${a}() {
      ${c} coords = getOutputCoords();
      ${p}
      return get${r}(${f});
    }
  `}function At(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function yE(e,t,n){let{newShape:r,keptDims:a}=k.squeezeShape(t),i=t.length,s=e&&i===3&&t[0]===1,o=s?t.slice(1):r,l=!e&&i>1&&!k.arraysEqual(t,n)&&r.length<i||s;return{useSqueezeShape:l,uniformShape:l?o:t,keptDims:a}}function Qh(e,t){let n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Jh(e,t){return t.map(n=>e[n]).join(", ")}function a2e(e,t,n,r){let a=n.map((u,d)=>{let p={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(p.flatOffset=u.texData.slice.flatOffset),{name:t.variableNames[d],shapeInfo:p}}),i=a.map(u=>u.shapeInfo),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},o=kIe(a,s,t),l=B5(e.gl,o),c=e.createProgram(l);return Q().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:i,outShapeInfo:s,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(c),Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:i,outShapeInfo:s},dU(e,t,c)))}function dU(e,t,n){let r=[],a=[],i,s,o,l=null,c=null;c=e.getUniformLocation(n,"NAN",!1),Q().getNumber("WEBGL_VERSION")===1&&(l=e.getUniformLocation(n,"INFINITY",!1));let u=!1;for(let d of t.variableNames){let p={name:d,uniform:e.getUniformLocation(n,d,u),offset:e.getUniformLocation(n,`offset${d}`,u)};t.enableShapeUniforms&&(p.shape=e.getUniformLocation(n,`${d}Shape`,u),p.texShape=e.getUniformLocation(n,`${d}TexShape`,u)),r.push(p)}if(t.enableShapeUniforms&&(i=e.getUniformLocation(n,"outShape",u),o=e.getUniformLocation(n,"outShapeStrides",u),s=e.getUniformLocation(n,"outTexShape",u)),t.customUniforms)for(let d of t.customUniforms)a.push(e.getUniformLocation(n,d.name,u));return{variablesLocations:r,customUniformLocations:a,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:s}}function ID(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((n,r)=>{let a=n.logicalShape,i=t[r],s=i.shape;if(!k.arraysEqual(a,s))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${a} and ${s} must match`);if(n.isUniform&&i.isUniform)return;let o=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!k.arraysEqual(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function i2e(e,t,n,r,a){t.program.enableShapeUniforms||(ID(t.inShapeInfos,n),ID([t.outShapeInfo],[r]));let i=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,s[0],s[1]):e.setOutputMatrixTexture(i.texture,s[0],s[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),Q().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&e.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){let c=n[l],{uniform:u,offset:d,shape:p,texShape:h}=t.variablesLocations[l];if(p){let{uniformShape:f}=yE(t.program.packedInputs,c.shape,c.texData.texShape);switch(f.length){case 1:e.gl.uniform1iv(p,new Int32Array(f));break;case 2:e.gl.uniform2iv(p,new Int32Array(f));break;case 3:e.gl.uniform3iv(p,new Int32Array(f));break;case 4:e.gl.uniform4iv(p,new Int32Array(f));break}}if(h&&e.gl.uniform2i(h,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(k.sizeFromShape(c.shape)<2)e.gl.uniform1f(u,c.uniformValues[0]);else{let f=c.uniformValues;f instanceof Float32Array||(f=new Float32Array(f)),e.gl.uniform1fv(u,f)}continue}c.texData.slice!=null&&d!=null&&e.gl.uniform1i(d,c.texData.slice.flatOffset),e.setInputMatrixTexture(c.texData.texture.texture,u,l)}}let o=t.outShapeLocation;if(o)switch(r.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(r.shape));break}if(t.outShapeStridesLocation){let l=k.computeStrides(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(l));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(l));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(l));break}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&a)for(let l=0;l<t.program.customUniforms.length;++l){let c=t.program.customUniforms[l],u=t.customUniformLocations[l],d=a[l];if(c.type==="float")e.gl.uniform1fv(u,d);else if(c.type==="vec2")e.gl.uniform2fv(u,d);else if(c.type==="vec3")e.gl.uniform3fv(u,d);else if(c.type==="vec4")e.gl.uniform4fv(u,d);else if(c.type==="int")e.gl.uniform1iv(u,d);else if(c.type==="ivec2")e.gl.uniform2iv(u,d);else if(c.type==="ivec3")e.gl.uniform3iv(u,d);else if(c.type==="ivec4")e.gl.uniform4iv(u,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}e.executeProgram()}function s2e(e,t,n){let r="";t.concat(n).forEach(s=>{let o=s.texData!=null&&s.texData.slice!=null&&s.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!s.isUniform){let l=s.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=yE(e.packedInputs,s.shape,l),p="",h="",f="";if(u.length===1&&e.packedInputs){let w=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${w[0]>1}_${w[1]>1}`}else if(u.length===2&&!e.packedInputs)h=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!e.packedInputs){let w=k.computeStrides(u);f=`${w[0]===l[1]}_${w[w.length-1]===l[1]}`}let m=s.shape.length,g=u.length===2&&k.arraysEqual(s.shape,l),y=k.sizeFromShape(s.shape)===1,b=N.getBroadcastDims(s.shape,n.shape),v=!e.packedInputs&&m===n.shape.length&&k.arraysEqual(l,n.texData.texShape),x=e.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${m}_${v}_${c?d:""}_${u.length}_${y}_${b}_${g}_${p}_${h}_${f}_${x}_${o}`}else{let l=s.isUniform?"uniform":s.texData.texShape;r+=`${s.shape}_${l}_${o}`}});let a=e.userCode,i=e.constructor.name;return i+="_"+r+"_"+a+`${Q().getNumber("WEBGL_VERSION")}`,i}function fr(e){return Q().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var o2e=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Zm.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=Fr();this.outputShape=e,this.enableShapeUniforms=fr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?K1(["r","c","d"],e):nd(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}},l2e=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Zm.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=Fr();this.outputShape=e,this.enableShapeUniforms=fr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?K1(["r","c","d"],e):nd(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}},u2e=class{constructor(e){this.variableNames=["A"],this.outTexUsage=Ca.DOWNLOAD;let t=Fr();this.outputShape=e,this.userCode=`
      ${oU}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}},c2e=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ca.DOWNLOAD;let t=Fr();this.outputShape=e,this.userCode=`
      ${oU}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}},d2e={R:0,G:1,B:2,A:3},CD=class{constructor(e,t=!1,n="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let r=Fr();this.outputShape=e,this.enableShapeUniforms=fr(this.outputShape.length);let a="result";t&&(a="floor(result * 255. + 0.5)");let i="";for(let s=0;s<n.length;s++){let o=n[s];i+=`
          if(offset == ${s}) {
            result = values[${d2e[o]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?gE():mE(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${n.length});

        flatIndex = idiv(flatIndex, ${n.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${i}
        }
        ${r.output} = vec4(${a}, 0., 0., 0.);
      }
    `}},p2e=class{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=Fr();this.outputShape=e,this.enableShapeUniforms=fr(this.outputShape.length);let r="",a="result";t&&(a="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let s=0;s<=1;s++){let o=i*2+s;r+=`
          localCoords = coords;
          if(localCoords[2] + ${s} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${s};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${n.texture2D}(A, uv);

            if (offset == 0) {
              result[${o}] = values[0];
            } else if (offset == 1) {
              result[${o}] = values[1];
            } else if (offset == 2) {
              result[${o}] = values[2];
            } else {
              result[${o}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?gE():mE(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${n.output} = ${a};
        }
    `}},pU={};He(pU,{bindVertexProgramAttributeStreams:()=>wU,createBufferFromOutputTexture:()=>IU,createFloat16MatrixTexture:()=>yU,createFloat16PackedMatrixTexture:()=>xU,createFloat32MatrixTexture:()=>gU,createIndexBuffer:()=>mU,createPackedMatrixTexture:()=>vU,createUnsignedBytesMatrixTexture:()=>bU,createVertexBuffer:()=>fU,createVertexShader:()=>hU,downloadByteEncodedFloatMatrixFromOutputTexture:()=>_U,downloadFloat32MatrixFromBuffer:()=>CU,downloadMatrixFromPackedOutputTexture:()=>NU,downloadPackedMatrixFromBuffer:()=>TU,getInternalFormatForFloat16MatrixTexture:()=>vE,getInternalFormatForFloat16PackedMatrixTexture:()=>kE,getInternalFormatForFloat32MatrixTexture:()=>bE,getInternalFormatForPackedMatrixTexture:()=>wE,getInternalFormatForUnsignedBytesMatrixTexture:()=>xE,uploadDenseMatrixToTexture:()=>kU,uploadPixelDataToTexture:()=>SU});function hU(e){let t=Fr(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return L5(e,n)}function fU(e){let t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return U5(e,t)}function mU(e){let t=new Uint16Array([0,1,2,2,1,3]);return j5(e,t)}function gy(e,t,n,r,a,i){G5(t,n);let s=H5(e),o=e.TEXTURE_2D;return xe(e,()=>e.bindTexture(o,s)),xe(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),xe(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),xe(e,()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST)),xe(e,()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST)),Q().getNumber("WEBGL_VERSION")===1?xe(e,()=>e.texImage2D(o,0,r,t,n,0,a,i,null)):xe(e,()=>e.texStorage2D(o,1,r,t,n)),xe(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:s,texShape:[n,t]}}function bE(e){return e.internalFormatFloat}function gU(e,t,n,r){let[a,i]=my(t,n);return gy(e,a,i,bE(r),r.textureFormatFloat,e.FLOAT)}function vE(e){return e.internalFormatHalfFloat}function yU(e,t,n,r){let[a,i]=my(t,n);return gy(e,a,i,vE(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function xE(e){return e.downloadTextureFormat}function bU(e,t,n,r){let[a,i]=my(t,n);return gy(e,a,i,xE(r),e.RGBA,e.UNSIGNED_BYTE)}function wE(e){return e.internalFormatPackedFloat}function vU(e,t,n,r){let[a,i]=Kh(t,n);return gy(e,a,i,wE(r),e.RGBA,e.FLOAT)}function kE(e){return e.internalFormatPackedHalfFloat}function xU(e,t,n,r){let[a,i]=Kh(t,n);return gy(e,a,i,kE(r),e.RGBA,r.textureTypeHalfFloat)}function wU(e,t,n){return xe(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),MI(e,t,"clipSpacePos",n,3,20,0)&&MI(e,t,"uv",n,2,20,12)}function kU(e,t,n,r,a,i){xe(e,()=>e.bindTexture(e.TEXTURE_2D,t));let s,o,l;a instanceof Uint8Array?(s=new Uint8Array(n*r*4),o=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(n*r*4),o=e.FLOAT,l=i.internalFormatPackedFloat),s.set(a),Q().getNumber("WEBGL_VERSION")===2?xe(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,o,s)):xe(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,r,0,e.RGBA,o,s)),xe(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function SU(e,t,n){xe(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?Q().getNumber("WEBGL_VERSION")===2?xe(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):xe(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):Q().getNumber("WEBGL_VERSION")===2?xe(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):xe(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),xe(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function IU(e,t,n,r){let a=e.createBuffer();xe(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,a));let i=4*4*t*n;return xe(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)),xe(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),xe(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),a}function CU(e,t,n){let r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function _U(e,t,n,r){let[a,i]=my(t,n),s=4,o=new Uint8Array(lIe(t*n,s));return xe(e,()=>e.readPixels(0,0,a,i,r.downloadTextureFormat,e.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function TU(e,t,n,r,a,i,s,o){let l=e,c=new Float32Array(uIe(i,s));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function NU(e,t,n){let r=new Float32Array(t*n*4);return xe(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r}var ib=class{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let t=Q().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,O5(t,e)):this.gl=_i(t),e=this.gl,Q().getNumber("WEBGL_VERSION")===2){let a=e;this.createVertexArray=()=>xe(a,()=>a.createVertexArray()),this.bindVertexArray=i=>xe(a,()=>a.bindVertexArray(i)),this.deleteVertexArray=i=>xe(a,()=>a.deleteVertexArray(i)),this.getVertexArray=()=>xe(a,()=>a.getParameter(a.VERTEX_ARRAY_BINDING))}else if(e!=null){let a=e.getExtension("OES_vertex_array_object");if(a==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>xe(e,()=>a.createVertexArrayOES()),this.bindVertexArray=i=>xe(e,()=>a.bindVertexArrayOES(i)),this.deleteVertexArray=i=>xe(e,()=>a.deleteVertexArrayOES(i)),this.getVertexArray=()=>xe(e,()=>e.getParameter(a.VERTEX_ARRAY_BINDING_OES))}let n="WEBGL_color_buffer_float",r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Q().getNumber("WEBGL_VERSION")===1){let a="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Mf(this.gl,a),_a(this.gl,i))this.textureHalfFloatExtension=Mf(this.gl,i);else if(Q().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),_a(this.gl,r))this.colorBufferHalfFloatExtension=Mf(this.gl,r);else if(Q().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",_a(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else if(_a(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=fU(this.gl),this.indexBuffer=mU(this.gl),this.framebuffer=q5(this.gl),this.textureConfig=hE(this.gl,this.textureHalfFloatExtension)}get debug(){return Q().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let e=this.gl;xe(e,()=>e.finish()),xe(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),xe(e,()=>e.deleteFramebuffer(this.framebuffer)),xe(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),xe(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),xe(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),gU(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),yU(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),bU(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),SU(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),kU(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),xU(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),vU(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(OI(this.gl,this.framebuffer),this.outputTexture=null),xe(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>_U(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,r,a,i){return TU(this.gl,e,t,n,r,a,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return CU(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);let r=IU(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(Q().getBool("WEBGL_FENCE_API_ENABLED")){let r=e,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{let i=r.clientWaitSync(a,0,0);return i===r.ALREADY_SIGNALED||i===r.CONDITION_SATISFIED},t=a}else Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>NU(this.gl,t,n))}createProgram(e){this.throwIfDisposed();let t=this.gl;this.vertexShader==null&&(this.vertexShader=hU(t));let n=W5(t);xe(t,()=>t.attachShader(n,this.vertexShader)),xe(t,()=>t.attachShader(n,e)),V5(t,n);let r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&tb(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);let t=this.gl;xe(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),wU(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(xe(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&tb(this.gl,this.program),xe(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,n=!0){return this.throwIfDisposed(),n?X5(this.gl,e,t):Y5(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),xe(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),Z5(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();let[r,a]=Kh(t,n);this.setOutputMatrixTextureDriver(e,r,a)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&tb(this.gl,this.program),Of(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let e=this.gl;if(this.debug){let t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}xe(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),xe(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Mf(this.gl,Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.createQuery();return n.beginQuery(r.TIME_ELAPSED_EXT,a),a}let e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT);return}let e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await k.repeatedTry(()=>this.disposed||this.isQueryAvailable(e,Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){let n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}else{let n=this.getQueryTimerExtensionWebGL1();return n.getQueryObjectEXT(e,n.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){let n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{let n=this.getQueryTimerExtensionWebGL1(),r=n.getQueryObjectEXT(e,n.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){let e=h2e(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){let{resolveFn:n}=this.itemsToPoll[t];n()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in Q().platform&&(n=Q().platform.setTimeoutCustom.bind(Q().platform)),k.repeatedTry(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),nb(this.gl,e,this.framebuffer),this.debug&&Of(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(nb(this.gl,this.outputTexture,this.framebuffer),this.debug&&Of(this.gl)):OI(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);let n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();let r=this.gl;nb(r,e,this.framebuffer),this.debug&&Of(r),this.outputTexture=e,xe(r,()=>r.viewport(0,0,t,n)),xe(r,()=>r.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),xe(this.gl,()=>this.gl.scissor(e,t,n,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}};function h2e(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}var{addImpl:f2e,bincountImpl:EU,bincountReduceImpl:m2e,bitwiseAndImpl:g2e,castImpl:y2e,ceilImpl:b2e,concatImpl:v2e,equalImpl:x2e,expImpl:w2e,expm1Impl:k2e,floorImpl:S2e,gatherNdImpl:I2e,gatherV2Impl:C2e,greaterImpl:_2e,greaterEqualImpl:T2e,lessImpl:N2e,lessEqualImpl:E2e,linSpaceImpl:$2e,logImpl:A2e,maxImpl:R2e,maximumImpl:F2e,minimumImpl:D2e,multiplyImpl:M2e,negImpl:O2e,notEqualImpl:P2e,prodImpl:z2e,raggedGatherImpl:L2e,raggedRangeImpl:B2e,raggedTensorToTensorImpl:W2e,rangeImpl:V2e,rsqrtImpl:U2e,scatterImpl:j2e,sigmoidImpl:H2e,simpleAbsImpl:$U,sliceImpl:G2e,sparseFillEmptyRowsImpl:q2e,sparseReshapeImpl:K2e,sparseSegmentReductionImpl:AU,sqrtImpl:X2e,staticRegexReplaceImpl:Y2e,stridedSliceImpl:Z2e,stringNGramsImpl:Q2e,stringSplitImpl:J2e,stringToHashBucketFastImpl:eCe,subImpl:tCe,tileImpl:nCe,topKImpl:rCe,transposeImpl:SE,uniqueImpl:aCe}=ZN;function RU(e,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>`${e}.${n}`)}function kr(e,t){return t===1?[e]:RU(e,t)}function iCe(e,t){if(e===1)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}var sCe=class{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=fr(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{let t=kr("rc",this.rank),n=At(this.rank),r=this.getOutOfBoundsCondition(t),a=this.getSetup(t),i=this.getOutput(t);this.userCode=`
        void main() {
          ${n} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){let t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let a=`${n===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)a=`${e[e.length-1-i]},`+a;t.push(a)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let n=this.rank-2;n<this.rank;n++)t+=`${e[n]} >= ${this.enableShapeUniforms?`outShape[${n}]`:this.outputShape[n]}`,n<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";let t=e.slice(-2),n=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${n};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){let t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}},FU=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=fr(this.outputShape.length);let n="";for(let r=0;r<4;r++){let a="thisRC = rc;";r%2===1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),n+=`
        ${a}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${oCe(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?gE():mE(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${n}

        setOutput(result);
      }
    `}};function oCe(e,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?wIe(["r","c","d"],"inputShape"):nd(["r","c","d"],e)}
      return ivec3(r, c, d);
    }
  `}var lCe=class{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){let r=TD(t,n),a=ND(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);let i=_D(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();let o=this.freeTextures[a].pop();return this.usedTextures[a].push(o),o}let s;return r===er.PACKED_2X2_FLOAT32?s=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===er.PACKED_2X2_FLOAT16?s=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===er.UNPACKED_FLOAT32?s=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===er.UNPACKED_FLOAT16?s=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===er.PACKED_4X1_UNSIGNED_BYTE&&(s=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(s),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),s}releaseTexture(e,t,n,r){if(this.freeTextures==null)return;let a=TD(n,r),i=ND(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);let s=_D(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),o=Q().get("WEBGL_DELETE_TEXTURE_THRESHOLD");o!==-1&&this._numBytesAllocated>o?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=s):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;let l=this.usedTextures[i],c=l&&l.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[c]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;let e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);let t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(let e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(let e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}};function uCe(e,t){let n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F||t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function _D(e,t,n,r,a){let i=cCe(t,r),s;if(a){let[l,c]=Kh(e[0],e[1]);s=l*c}else{let[l,c]=my(e[0],e[1]);s=l*c}let o=uCe(n,i);return s*o}function cCe(e,t){switch(e){case er.PACKED_2X2_FLOAT32:return wE(t);case er.PACKED_2X2_FLOAT16:return kE(t);case er.UNPACKED_FLOAT32:return bE(t);case er.UNPACKED_FLOAT16:return vE(t);case er.PACKED_4X1_UNSIGNED_BYTE:return xE(t);default:throw new Error(`Unknown physical texture type ${e}`)}}function dCe(e){return Q().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?er.PACKED_2X2_FLOAT32:er.UNPACKED_FLOAT32:e?er.PACKED_2X2_FLOAT16:er.UNPACKED_FLOAT16}function TD(e,t){if(e===Ca.UPLOAD)return er.PACKED_2X2_FLOAT32;if(e===Ca.RENDER||e==null)return dCe(t);if(e===Ca.DOWNLOAD||e===Ca.PIXELS)return er.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function ND(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}var Ui=class{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=fr(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}},li="if (isnan(x)) return x;",pCe="return x;",ED="return abs(x);",hCe="return (x >= 0.0) ? x : (exp(x) - 1.0);",fCe=li+`
  return (x < 0.0) ? 0.0 : x;
`,mCe=li+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,ao="return x;",gCe="return 1.0 / (1.0 + exp(-1.0 * x));",yCe="return x;",bCe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,vCe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,xCe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,wCe="return 1.0 / (1.0 + exp(-1.0 * x));",mo=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=fr(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}},kCe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=fr(this.outputShape.length);let t=e.length,n=kr("rc",t),r=At(t),a=iCe(t,n),i=n.slice(-2),s=t<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${s}));
      }
    `}},SCe=rs.whereImpl,ICe=1e-7,CCe=1e-4,bk={};function _Ce(e){return e in bk||(bk[e]={}),bk[e]}var TCe=Q().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),NCe=600;function ECe(){return Q().global.screen==null?1024:Q().global.screen.height*Q().global.screen.width*window.devicePixelRatio*NCe/1024/1024}var X1=class extends mg{nextDataId(){return X1.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Q().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof ib)t=e;else{let n=_i(Q().getNumber("WEBGL_VERSION"),e);t=new ib(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{let n=_i(Q().getNumber("WEBGL_VERSION"));t=new ib(n),this.binaryCache=_Ce(Q().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new lCe(this.gpgpu),this.numMBBeforeWarning=ECe(),this.texData=new $x(this,Ga())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,r,a,i){let s=this.makeTensorInfo(t,n),o=this.texData.get(s.dataId);o.isPacked=!1,o.texture={texture:e,texShape:[r,a]},o.texShape=[r,a];let l=Pf(t),c=new CD(l,!1,i),u=this.runWebGLProgram(c,[s],n,[[r,a]]);return u.shape=t,o.texture=null,this.disposeIntermediateTensorInfo(s),u.dataId}write(e,t,n){if((Q().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Q().getBool("DEBUG"))&&this.checkNumericalProblems(e),n==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:Ca.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){let t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){let t=this.texData.get(e);t.refCount--}}move(e,t,n,r,a){if(Q().getBool("DEBUG")&&this.checkNumericalProblems(t),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:Ca.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){let t=this.texData.get(e),{values:n,dtype:r,complexTensorInfos:a,slice:i,shape:s,isPacked:o}=t;if(i!=null){let d;o?d=new mo(s,ao):d=new Ui(s,ao);let p=this.runWebGLProgram(d,[{dataId:e,shape:s,dtype:r}],r),h=this.readSync(p.dataId);return this.disposeIntermediateTensorInfo(p),h}if(n!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return n;let l=this.activeTimers!=null,c;l&&(c=k.now());let u;if(r==="complex64"){let d=this.readSync(a.real.dataId),p=this.readSync(a.imag.dataId);u=N.mergeRealAndImagArrays(d,p)}else u=this.getValuesFromTexture(e);return l&&(this.downloadWaitMs+=k.now()-c),this.convertAndCacheOnCPU(e,u)}async read(e){if(this.pendingRead.has(e)){let h=this.pendingRead.get(e);return new Promise(f=>h.push(f))}let t=this.texData.get(e),{values:n,shape:r,slice:a,dtype:i,complexTensorInfos:s,isPacked:o}=t;if(a!=null){let h;o?h=new mo(r,ao):h=new Ui(r,ao);let f=this.runWebGLProgram(h,[{dataId:e,shape:r,dtype:i}],i),m=this.read(f.dataId);return this.disposeIntermediateTensorInfo(f),m}if(n!=null)return this.convertAndCacheOnCPU(e);if(Q().getBool("DEBUG")&&!Q().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Q().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l=null,c;if(i!=="complex64"&&Q().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);let h=this.texData.get(c.dataId);l=this.gpgpu.createBufferFromTexture(h.texture.texture,...S0(r))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let u;if(i==="complex64"){let h=await Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]),f=h[0],m=h[1];u=N.mergeRealAndImagArrays(f,m)}else if(l==null)u=this.getValuesFromTexture(e);else{let h=k.sizeFromShape(r);u=this.gpgpu.downloadFloat32MatrixFromBuffer(l,h)}if(c!=null&&this.disposeIntermediateTensorInfo(c),l!=null){let h=this.gpgpu.gl;xe(h,()=>h.deleteBuffer(l))}let d=this.convertAndCacheOnCPU(e,u),p=this.pendingRead.get(e);return this.pendingRead.delete(e),p.forEach(h=>h(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Ga().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e,t={}){let n=this.texData.get(e),{values:r,shape:a,slice:i,dtype:s,isPacked:o,texture:l}=n;if(s==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let p;o?p=new mo(a,ao):p=new Ui(a,ao);let h=this.runWebGLProgram(p,[{dataId:e,shape:a,dtype:s}],s),f=this.readToGPU(h,t);return this.disposeIntermediateTensorInfo(h),f}if(l==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");let c=this.decode(e,t.customTexShape),u=Ga().makeTensorFromTensorInfo(c),d=this.texData.get(c.dataId);return Object.assign({tensorRef:u},d.texture)}bufferSync(e){let t=this.readSync(e.dataId);if(e.dtype==="string")try{let n=t.map(r=>k.decodeString(r));return et(e.shape,e.dtype,n)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return et(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){let n=e[t];if(!P5(n))throw Q().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${n} cannot be represented on this device.`)}}getValuesFromTexture(e){let{shape:t,dtype:n,isPacked:r}=this.texData.get(e),a=k.sizeFromShape(t);if(Q().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let d=this.decode(e),p=this.texData.get(d.dataId),h=this.gpgpu.downloadMatrixFromPackedTexture(p.texture.texture,...S0(t)).subarray(0,a);return this.disposeIntermediateTensorInfo(d),h}let i=Q().getBool("WEBGL_PACK")&&r===!0,s=i?Pf(t):t,o=i?new c2e(s):new u2e(s),l=this.runWebGLProgram(o,[{shape:s,dtype:n,dataId:e}],"float32"),c=this.texData.get(l.dataId),u=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(l),u}timerAvailable(){return Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){let t=this.activeTimers,n=[],r=!1;this.programTimersStack==null?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e();let a=k.flatten(this.activeTimers.map(o=>o.query)).filter(o=>o!=null),i=k.flatten(this.activeTimers.map(o=>o.name)).filter(o=>o!=null);this.activeTimers=t,r&&(this.programTimersStack=null);let s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let o=await Promise.all(a);s.kernelMs=k.sum(o),s.getExtraProfileInfo=()=>o.map((l,c)=>({name:i[c],ms:l})).map(l=>`${l.name}: ${l.ms}`).join(", ")}else s.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,s})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:k.now(),endMs:null}}endTimer(e){return Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=k.now(),e)}async getQueryTime(e){if(Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);let t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);let{complexTensorInfos:n}=this.texData.get(e);return n!=null&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){let{texture:t,dtype:n,texShape:r,usage:a,isPacked:i,slice:s}=this.texData.get(e),o=s&&s.origDataId||e,l=this.dataRefCount.get(o);l>1?this.dataRefCount.set(o,l-1):(this.dataRefCount.delete(o),t!=null&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(t,r,a,i)));let c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=TCe){return Q().getBool("WEBGL_CPU_FORWARD")&&e.every(n=>this.texData.get(n.dataId).texture==null&&k.sizeFromShape(n.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){N.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let t=e.dataSync();return SCe(e.shape,t)}packedUnaryOp(e,t,n){let r=new mo(e.shape,t),a=this.compileAndRun(r,[e],n);return Ga().makeTensorFromTensorInfo(a)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){let r=$U(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(Q().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ED,e.dtype);let t=new Ui(e.shape,ED),n=this.compileAndRun(t,[e]);return Ga().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let r;if(t==="string"&&n!=null&&n.length>0&&k.isString(n[0])){let a=n.map(i=>k.encodeString(i));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,n){return Ga().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){let t=new kCe(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){let t=new sCe(e.shape),n=!0;return this.runWebGLProgram(t,[e],e.dtype,null,n)}packedReshape(e,t){let n=[xu(e.shape),...wu(e.shape)],r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[xu(t),...wu(t)],i=new FU(a,n),s=!0,o=[n],l=this.runWebGLProgram(i,[r],e.dtype,o,s);return{dataId:l.dataId,shape:t,dtype:l.dtype}}decode(e,t){let n=this.texData.get(e),{isPacked:r,shape:a,dtype:i}=n;if(t!=null){let d=k.sizeFromShape(a),p=t[0]*t[1]*4;k.assert(d<=p,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}let s=Pf(a),o;r?o=new l2e(s):o=new o2e(s);let l=!0,c=[t??S0(s)],u=this.runWebGLProgram(o,[{shape:s,dtype:i,dataId:e}],i,c,l,t);return{dtype:i,shape:a,dataId:u.dataId}}runWebGLProgram(e,t,n,r,a=!1,i){let s=this.makeTensorInfo(e.outputShape,n),o=this.texData.get(s.dataId);if(e.packedOutput&&(o.isPacked=!0),e.outPackingScheme===Zm.DENSE){let g=i??S0(e.outputShape);o.texShape=g.map(y=>y*2)}if(e.outTexUsage!=null&&(o.usage=e.outTexUsage),k.sizeFromShape(s.shape)===0)return o.values=k.getTypedArrayFromDType(s.dtype,0),s;let l=[],c=t.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(g.dataId);if(y.texture==null){if(!e.packedInputs&&k.sizeFromShape(g.shape)<=Q().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:y.values};e.packedInputs&&(y.isPacked=!0,y.shape=g.shape)}if(this.uploadToGPU(g.dataId),!!y.isPacked!=!!e.packedInputs)g=y.isPacked?this.unpackTensor(g):this.packTensor(g),l.push(g),y=this.texData.get(g.dataId);else if(y.isPacked&&!Qm(y.shape,g.shape)){let b=g,v=g.shape;g.shape=y.shape,g=this.packedReshape(g,v),l.push(g),y=this.texData.get(g.dataId),b.shape=v}return{shape:g.shape,texData:y,isUniform:!1}});this.uploadToGPU(s.dataId);let u={shape:s.shape,texData:o,isUniform:!1},d=s2e(e,c,u),p=this.getAndSaveBinary(d,()=>a2e(this.gpgpu,e,c,u)),h=this.activeTimers!=null,f;h&&(f=this.startTimer()),Q().get("ENGINE_COMPILE_ONLY")||i2e(this.gpgpu,p,c,u,r),l.forEach(g=>this.disposeIntermediateTensorInfo(g)),h&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)}));let m=Q().get("WEBGL_FLUSH_THRESHOLD");if(m>0){let g=k.now();g-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!Q().getBool("WEBGL_LAZILY_UNPACK")&&o.isPacked&&a===!1){let g=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),g}return s}compileAndRun(e,t,n,r,a=!1){return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,r,a)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Q().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=G(()=>{if(!Q().get("WEBGL_RENDER_FLOAT32_ENABLED")){let e=Q().getBool("DEBUG");Q().set("DEBUG",!1);let t=this.abs(Re(1e-8)).dataSync()[0];if(Q().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?ICe:CCe}uploadToGPU(e){let t=this.texData.get(e),{shape:n,dtype:r,values:a,texture:i,usage:s,isPacked:o}=t;if(i!=null)return;let l=this.activeTimers!=null,c;l&&(c=k.now());let u=t.texShape;if(u==null&&(u=eU(n,o),t.texShape=u),a!=null){let d=Pf(n),p,h=u[1],f=u[0],m=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(o||!m)&&([h,f]=Kh(u[0],u[1])),o?p=new p2e(d,m):p=new CD(d,m);let g=m?[f,h]:u,y=this.makeTensorInfo(g,r),b=this.texData.get(y.dataId);m?b.usage=Ca.PIXELS:b.usage=Ca.UPLOAD,b.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),h,f,a);let v=[[f,h]],x=!0,w=this.runWebGLProgram(p,[y],r,v,x),S=this.texData.get(w.dataId);t.texShape=S.texShape,t.isPacked=S.isPacked,t.usage=S.usage,Q().get("ENGINE_COMPILE_ONLY")?this.disposeData(w.dataId):(t.texture=S.texture,t.values=null,this.texData.delete(w.dataId)),this.disposeIntermediateTensorInfo(y),l&&(this.uploadWaitMs+=k.now()-c)}else{let d=this.acquireTexture(u,s,r,o);t.texture=d}}convertAndCacheOnCPU(e,t){let n=this.texData.get(e),{dtype:r}=n;return t!=null&&(n.values=$Ce(t,r)),n.values}acquireTexture(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){let a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*k.bytesPerElement(t)}checkCompileCompletion(){for(let[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){let e=[];if(this.gpgpu.parallelCompilationExtension){for(let[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(let[,t]of Object.entries(this.binaryCache)){let n=new Promise(r=>{try{this.checkCompletion_(t),r(!0)}catch(a){throw a}});e.push(n)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await fT(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(fE(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(let e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);let{variablesLocations:t,customUniformLocations:n,infLoc:r,nanLoc:a,outShapeLocation:i,outShapeStridesLocation:s,outTexShapeLocation:o}=dU(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=r,e.nanLoc=a,e.outShapeLocation=i,e.outShapeStridesLocation=s,e.outTexShapeLocation=o}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";let{texture:r,height:a,width:i,channels:s}=e,o=Ga().backend;if(!o.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");let l=o.writeTexture(r,t,n,a,i,s);return Ga().makeTensorFromDataId(l,t,n,o)}};X1.nextDataId=0;function $Ce(e,t){if(t==="float32"||t==="complex64")return e;if(t==="int32"||t==="bool"){let n=t==="int32"?new Int32Array(e.length):new Uint8Array(e.length);for(let r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}else throw new Error(`Unknown dtype ${t}`)}var ACe="4.7.0";function DU(){Q().set("WEBGL_FORCE_F16_TEXTURES",!0)}Wg.isBrowser()&&qx("webgl",()=>new X1,2);var RCe={forceHalfFloat:DU},IE=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`,ku=class{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=N.assertAndGetBroadcastShape(t,n),this.enableShapeUniforms=fr(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}},ad=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`,ef=class{constructor(e,t,n,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=N.assertAndGetBroadcastShape(t,n);let a=this.outputShape.length;this.enableShapeUniforms=fr(a);let i="";if(r)if(a===0||k.sizeFromShape(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${At(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{let s=kr("coords",a);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${s[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${s[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${s[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${s[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}};function ma(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var FCe={kernelName:sc,backendName:"webgl",kernelFunc:ma};function ul(e){let{inputs:t,backend:n}=e,{real:r,imag:a}=t,i=n.makeTensorInfo(r.shape,"complex64"),s=n.texData.get(i.dataId),o=ma({inputs:{x:r},backend:n}),l=ma({inputs:{x:a},backend:n});return s.complexTensorInfos={real:o,imag:l},i}var DCe={kernelName:Fx,backendName:"webgl",kernelFunc:ul},MU="return (a < 0.) ? b * a : a;",OU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function MCe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:i}=r,s=n.makeTensorInfo([],"float32",k.createScalarValue(i,"float32")),o=Q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ef(OU,a.shape,s.shape):new ku(MU,a.shape,s.shape),l=n.runWebGLProgram(o,[a,s],"float32");return n.disposeIntermediateTensorInfo(s),l}var OCe={kernelName:cc,backendName:"webgl",kernelFunc:MCe},PU="return (a < 0.) ? b * a : a;",zU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function PCe(e){let{inputs:t,backend:n}=e,{x:r,alpha:a}=t,i=Q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ef(zU,r.shape,a.shape):new ku(PU,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}var zCe={kernelName:_c,backendName:"webgl",kernelFunc:PCe},tf="if (isnan(x)) return x;";function ft({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:a,backend:i})=>{let{x:s}=a,o=i,l=r||s.dtype;if(o.shouldExecuteOnCPU([s])&&n!=null){let d=o.texData.get(s.dataId),p=n(d.values,l);return o.makeTensorInfo(s.shape,l,p)}let c=Q().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null,u;return c?u=new mo(s.shape,t):u=new Ui(s.shape,e),o.runWebGLProgram(u,[s],l)}}function sr({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:a,dtype:i}){return({inputs:s,backend:o})=>{let{a:l,b:c}=s,u=o;if(r&&l.dtype==="complex64"){let f=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[g,y]=[[f.complexTensorInfos.real,m.complexTensorInfos.real],[f.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(v=>{let[x,w]=v,S={dataId:x.dataId,dtype:x.dtype,shape:l.shape},C={dataId:w.dataId,dtype:w.dtype,shape:c.shape},T=new ku(e,l.shape,c.shape);return u.runWebGLProgram(T,[S,C],Fa(x.dtype,w.dtype))}),b=ul({inputs:{real:g,imag:y},backend:u});return u.disposeIntermediateTensorInfo(g),u.disposeIntermediateTensorInfo(y),b}let d=i||Fa(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&a!=null){let f=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,g=l.dtype==="string"?N.fromUint8ToStringArray(f):f,y=l.dtype==="string"?N.fromUint8ToStringArray(m):m,[b,v]=a(l.shape,c.shape,g,y,d),x=u.makeTensorInfo(v,d),w=u.texData.get(x.dataId);return w.values=b,x}let p=Q().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null,h;return p?h=new ef(t,l.shape,c.shape,n):h=new ku(e,l.shape,c.shape),u.runWebGLProgram(h,[l,c],d)}}function Jm(e,t=!1){if(e==="linear")return t?yCe:pCe;if(e==="relu")return t?vCe:fCe;if(e==="elu")return t?bCe:hCe;if(e==="relu6")return t?xCe:mCe;if(e==="prelu")return t?zU:PU;if(e==="leakyrelu")return t?OU:MU;if(e==="sigmoid")return t?wCe:gCe;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}var LU=class{constructor(e,t,n,r=!1,a=!1,i=!1,s=null,o=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=fr(this.outputShape.length);let c=r?e[1]:e[2],u=Math.ceil(c/2),d=r?"i * 2, rc.y":"rc.y, i * 2",p=a?"rc.z, i * 2":"i * 2, rc.z",h=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",g="";s&&(o?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:l?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:m=`vec4 activation(vec4 x) {
          ${s}
        }`,g="result = activation(result);");let y=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let b="rc.x",v="rc.x";e[0]<t[0]?b=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(v=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${m}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${u}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${v};
        for (int i = 0; i < ${u}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${p});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${h[0]} * ${f[0]});
          result += (${h[1]} * ${f[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${g}

        setOutput(result);
      }
    `}},$D={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},AD=class{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=N.assertAndGetBroadcastShape(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}},RD="return a * b;";function CE(e){let{inputs:t,backend:n}=e,{a:r,b:a}=t,i=N.upcastType(r.dtype,a.dtype);if(r.dtype==="complex64"){let o=n.texData.get(r.dataId),l=n.texData.get(a.dataId),c=new AD($D.REAL,r.shape,a.shape),u=new AD($D.IMAG,r.shape,a.shape),d=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:r.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:a.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:a.shape}],p=n.runWebGLProgram(c,d,"float32"),h=n.runWebGLProgram(u,d,"float32"),f=ul({inputs:{real:p,imag:h},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),f}if(n.shouldExecuteOnCPU([r,a])){let o=n.texData.get(r.dataId),l=n.texData.get(a.dataId),[c,u]=M2e(r.shape,a.shape,o.values,l.values,i),d=n.makeTensorInfo(u,i),p=n.texData.get(d.dataId);return p.values=c,d}let s;return Q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?s=new ef(RD,r.shape,a.shape):s=new ku(RD,r.shape,a.shape),n.runWebGLProgram(s,[r,a],i)}var LCe={kernelName:kc,backendName:"webgl",kernelFunc:CE};function BCe(e,t,n){let r=[xu(e.shape),...wu(e.shape)],a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[xu(t),...wu(t)],s=new FU(i,r),o=!0,l=[r],c=n.runWebGLProgram(s,[a],e.dtype,l,o);return{dataId:c.dataId,shape:t,dtype:c.dtype}}function be(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:i}=r,s=n,o=k.sizeFromShape(a.shape),l=k.inferFromImplicitShape(i,o),c=k.sizeFromShape(l);k.assert(o===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${a.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);let u=s.texData.get(a.dataId);return u.isPacked&&!Qm(a.shape,l)&&!(u.texture!==null&&Qm(u.shape,l))?BCe(a,l,s):(s.incRef(a.dataId),{dataId:a.dataId,shape:l,dtype:a.dtype})}var WCe={kernelName:vh,backendName:"webgl",kernelFunc:be},FD=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];let s=Math.floor(n/4)*4,o=n%4,l="sumValue += dot(values, ones);";if(t!=null){let u=1/t;l=`sumValue += dot(values * ${k.isInt(u)?u.toPrecision(2):u}, ones);`}let c="";a%n>0&&(c=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        float sumValue = 0.0;

        for (int i = 0; i < ${s}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${l}
        }

        int inIdx = inOffset + ${s};
        if (${o===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${l}
        } else if (${o===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${l}
        } else if (${o===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${l}
        }
        setOutput(sumValue);
      }
    `}},VCe=class{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];let s="0.0",o="";t==="prod"?s="1.0":t==="min"?(s="1.0 / 1e-20",o="min"):t==="max"&&(s="-1.0 / 1e-20",o="max");let l=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?l="sumValue":t==="prod"?l="prodValue":t==="all"?l="allValue":t==="any"&&(l="anyValue");let c=Math.floor(n/4)*4,u=n%4,d=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${o}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${o}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,p="vec4";t==="all"?(s="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):t==="any"&&(s="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");let h="";a%n>0&&(h=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${s};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        vec4 minMaxValue = vec4(${s});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${c};
        if (${u===1}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${u===2}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${u===3}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${l});
      }
    `}};function UCe(e){let t=[];for(;t.length===0||t[t.length-1].outSize!==1;){let n=t.length?t[t.length-1].outSize:e[1],r=N.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}function id(e,t,n,r){let a=UCe(e.shape),i=e;for(let s=0;s<a.length;s++){let{inSize:o,windowSize:l,outSize:c}=a[s],u,d;n==="mean"?u=s===0?new FD({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c},o):new FD({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c}):u=new VCe({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c},n),d=i,i=r.runWebGLProgram(u,[i],t),d.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(d)}return i}var jCe=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[t[i]];this.outputShape=n,this.rank=n.length;let r=At(this.rank),a=HCe(t);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}};function HCe(e){let t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}var GCe=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let n=new Array(e.length);for(let c=0;c<n.length;c++)n[c]=e[t[c]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let r=At(this.rank),a=RU("rc",this.rank),i=new Array(this.rank);for(let c=0;c<t.length;c++)i[t[c]]=a[c];let s=`vec2(${i.slice(-2).join()})`,o=`++${a[this.rank-1]} < ${n[this.rank-1]}`,l=`getChannel(getA(${i.join()}), ${s})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${l};
      if(${o}) {
        result[1] = ${l};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${n[this.rank-2]}) {
        result[2] = ${l};
        if(${o}) {
          result[3] = ${l};
        }
      }
      setOutput(result);
    }
    `}};function Y1(e,t,n){let r=Q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new GCe(e.shape,t):new jCe(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function qCe(e,t,n,r){let a=t,i=e.shape.length,s=k.parseAxisParam(a,e.shape),o=s,l=N.getAxesPermutation(o,i),c=l!=null,u=e;c&&(u=Y1(e,l,r),o=N.getInnerMostAxes(o.length,i)),N.assertAxesAreInnerMostDims("sum",o,i);let[d,p]=N.computeOutAndReduceShapes(u.shape,o),h=d;n&&(h=N.expandShapeToKeepDim(d,s));let f=k.sizeFromShape(p),m=k.sizeFromShape(e.shape)/f,g=be({inputs:{x:u},attrs:{shape:[m,f]},backend:r}),y=Gx(e.dtype),b=id(g,y,"sum",r),v=be({inputs:{x:b},attrs:{shape:h},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(b),c&&r.disposeIntermediateTensorInfo(u),v}function Z1(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r;return qCe(a,i,s,n)}var KCe={kernelName:Uc,backendName:"webgl",kernelFunc:Z1};function Nr(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{perm:i}=r,s=n,o=a.shape.length,l=new Array(o);for(let u=0;u<l.length;u++)l[u]=a.shape[i[u]];let c;if(s.shouldExecuteOnCPU([a])){let u=s.texData.get(a.dataId).values,d=SE(u,a.shape,a.dtype,i,l);c=s.makeTensorInfo(l,a.dtype);let p=s.texData.get(c.dataId);p.values=d}else c=Y1(a,i,s);return c}var XCe={kernelName:Ts,backendName:"webgl",kernelFunc:Nr},BU=1e3;function xv({a:e,b:t,transposeA:n,transposeB:r,backend:a,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:l=null}){let c=e.shape.length,u=t.shape.length,d=n?e.shape[c-2]:e.shape[c-1],p=r?t.shape[u-1]:t.shape[u-2],h=n?e.shape[c-1]:e.shape[c-2],f=r?t.shape[u-2]:t.shape[u-1],m=e.shape.slice(0,-2),g=t.shape.slice(0,-2),y=k.sizeFromShape(m),b=k.sizeFromShape(g),v=Ph.assertAndGetBroadcastShape(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([h,f]);k.assert(d===p,()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`);let x=n?[y,d,h]:[y,h,d],w=r?[b,f,p]:[b,p,f],S=be({inputs:{x:e},backend:a,attrs:{shape:x}}),C=be({inputs:{x:t},backend:a,attrs:{shape:w}}),T=[S,C],E=Math.max(y,b),R=n?S.shape[1]:S.shape[2],$=i!=null,_=s!=null,D=l==="leakyrelu",P=l!=null?Jm(l,!0):null,B=$||_||D||P!=null,W;if((h===1||f===1)&&R>BU&&B===!1){let O=S,q=C;n&&(O=Nr({inputs:{x:S},backend:a,attrs:{perm:[0,2,1]}}),T.push(O)),r&&(q=Nr({inputs:{x:C},backend:a,attrs:{perm:[0,2,1]}}),T.push(q));let Z=f!==1,X=f===1,ne=O;Z&&(ne=be({inputs:{x:O},backend:a,attrs:{shape:[E,R,1]}}),T.push(ne));let te=f===1?2:1,se=q;X&&(se=be({inputs:{x:q},backend:a,attrs:{shape:[E,1,R]}}),T.push(se));let oe=CE({inputs:{a:ne,b:se},backend:a});W=Z1({inputs:{x:oe},backend:a,attrs:{axis:te,keepDims:!0}}),T.push(oe)}else{let O=Fa(e.dtype,t.dtype),q=new LU(x,w,[E,h,f],n,r,$,P,_,D),Z=[S,C];if(i!=null&&Z.push(i),_&&Z.push(s),D){let X=a.makeTensorInfo([],"float32",k.createScalarValue(o,"float32"));Z.push(X),T.push(X)}W=a.runWebGLProgram(q,Z,O)}let Y=be({inputs:{x:W},backend:a,attrs:{shape:v}});T.push(W);for(let O of T)a.disposeIntermediateTensorInfo(O);return Y}function YCe(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i,bias:s,preluActivationWeights:o}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r;return xv({a,b:i,transposeA:l,transposeB:c,backend:n,bias:s,preluActivationWeights:o,leakyreluAlpha:d,activation:u})}var ZCe={kernelName:iu,backendName:"webgl",kernelFunc:YCe},DD="return abs(x);";function QCe(e){let{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){let i=n.texData.get(r.dataId),s=$U(i.values);return n.makeTensorInfo(r.shape,r.dtype,s)}let a;return Q().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new mo(r.shape,DD):a=new Ui(r.shape,DD),n.runWebGLProgram(a,[r],r.dtype)}var JCe={kernelName:Mp,backendName:"webgl",kernelFunc:QCe},e_e=li+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,t_e=ft({opSnippet:e_e}),n_e={kernelName:Au,backendName:"webgl",kernelFunc:t_e},r_e=li+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,a_e=ft({opSnippet:r_e}),i_e={kernelName:Ru,backendName:"webgl",kernelFunc:a_e},MD="return a + b;",s_e=sr({opSnippet:MD,packedOpSnippet:MD,supportsComplex:!0,cpuKernelImpl:f2e}),o_e={kernelName:Jo,backendName:"webgl",kernelFunc:s_e},l_e=class{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((a,i)=>`T${i}`);let n=[];this.variableNames.forEach(a=>{n.push(`float v${a} = get${a}AtOutCoords();`)});let r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${n.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}},u_e=class{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((a,i)=>`T${i}`);let n=[];this.variableNames.forEach(a=>{n.push(`vec4 v${a} = get${a}AtOutCoords();`)});let r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${n.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}};function sb(e){let{inputs:t,backend:n}=e,r=t;if(r.length===1)return ma({inputs:{x:r[0]},backend:n});if(r.length>Q().get("WEBGL_MAX_TEXTURES_IN_SHADER")){let o=Math.floor(r.length/2),l=sb({inputs:r.slice(0,o),backend:n}),c=sb({inputs:r.slice(o),backend:n});return sb({inputs:[l,c],backend:n})}let a=r.map(o=>o.dtype).reduce((o,l)=>Fa(o,l)),i=r.map(o=>o.shape),s=Q().getBool("WEBGL_PACK")?new u_e(r[0].shape,i):new l_e(r[0].shape,i);return n.runWebGLProgram(s,r,a)}var c_e={kernelName:Fu,backendName:"webgl",kernelFunc:sb};function d_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=a.shape.length,l=k.parseAxisParam(i,a.shape),c=l,u=N.getAxesPermutation(c,o),d=a;u!=null&&(d=Nr({inputs:{x:a},backend:n,attrs:{perm:u}}),c=N.getInnerMostAxes(c.length,o)),N.assertAxesAreInnerMostDims("all",c,o);let[p,h]=N.computeOutAndReduceShapes(d.shape,c),f=k.sizeFromShape(h),m=be({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),g=id(m,m.dtype,"all",n),y;if(s){let b=N.expandShapeToKeepDim(p,l);y=be({inputs:{x:g},backend:n,attrs:{shape:b}})}else y=be({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),y}var p_e={kernelName:Op,backendName:"webgl",kernelFunc:d_e};function h_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=a.shape.length,l=k.parseAxisParam(i,a.shape),c=l,u=N.getAxesPermutation(c,o),d=a;u!=null&&(d=Nr({inputs:{x:a},backend:n,attrs:{perm:u}}),c=N.getInnerMostAxes(c.length,o)),N.assertAxesAreInnerMostDims("any",c,o);let[p,h]=N.computeOutAndReduceShapes(d.shape,c),f=k.sizeFromShape(h),m=be({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),g=id(m,m.dtype,"any",n),y;if(s){let b=N.expandShapeToKeepDim(p,l);y=be({inputs:{x:g},backend:n,attrs:{shape:b}})}else y=be({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),y}var f_e={kernelName:Pp,backendName:"webgl",kernelFunc:h_e},m_e=class{constructor(e,t,n){this.variableNames=["A"];let{windowSize:r,batchSize:a,outSize:i}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i];let s=t==="max"?">":"<",o=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${o};
          float candidate = getA(batch, inIdx);
          if (candidate ${s} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}},g_e=class{constructor(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,k.assert(e.length>2,()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`);let a=e[e.length-1],i=Math.ceil(a/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");let s=this.outputShape,o=s.length,l=At(o),c=kr("coords",o),u,d;if(i===1){d=o+1;let C=At(d);u=`
        ${C} sourceLocR = ${C}(${c.join()}, 0);
        ++${c[o-1]};
        ${C} sourceLocG = ${C}(${c.join()}, 0);
        ++${c[o-2]};
        ${C} sourceLocA = ${C}(${c.join()}, 0);
        --${c[o-1]};
        ${C} sourceLocB = ${C}(${c.join()}, 0);
        --${c[o-2]};`}else d=o,u=`
        ${l} sourceLocR = coords;
        ++${c[o-1]};
        ${l} sourceLocG = coords;
        ++${c[o-2]};
        ${l} sourceLocA = coords;
        --${c[o-1]};
        ${l} sourceLocB = coords;
        --${c[o-2]};`;let p=["x","y","z","w","u","v"].slice(0,d),h="."+p[d-1],f=p.map(C=>"int "+C),m=kr("sourceLocR",d-1).concat("inIdx.r"),g=kr("sourceLocG",d-1).concat("inIdx.g"),y=kr("sourceLocB",d-1).concat("inIdx.b"),b=kr("sourceLocA",d-1).concat("inIdx.a"),v=n==="max"?"greaterThan":"lessThan",x=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${b.join()})));`,w=`vec4(
            getAChannel(${m.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,S=r?"":`
      float getBestIndicesAChannel(${f.join()}) {
        return getChannel(getBestIndicesA(${p.join()}),
                                          vec2(${p.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${f.join()}) {
        return getChannel(getA(${p.join()}),
                               vec2(${p.slice(-2).join()}));
      }
      ${S}
      void main() {
        ${l} coords = getOutputCoords();
        bool hasNextCol = ${c[o-1]} < ${s[o-1]-1};
        bool hasNextRow = ${c[o-2]} < ${s[o-2]-1};
        ${u}
        ivec4 srcIdx = ivec4(sourceLocR${h}, sourceLocG${h},
          sourceLocB${h}, sourceLocA${h}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${w};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${x}
          vec4 candidate = ${w};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${v}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}};function WU(e,t,n,r=null){let a=t.shape[0],i=t.shape[1];r!=null&&(a=r.shape[0],i=r.shape[1]);let s=N.computeOptimalWindowSize(i),o={windowSize:s,inSize:i,batchSize:a,outSize:Math.ceil(i/s)},l=new m_e(o,n,r==null),c=[t];r!=null&&c.push(r);let u=e.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;let d=WU(e,t,n,u);return e.disposeIntermediateTensorInfo(u),d}function VU(e,t,n,r=null){let a=r!=null?r.shape:t.shape,i=a[a.length-1],s=N.computeOptimalWindowSize(i),o=new g_e(a,s,n,r==null),l=r==null?[t]:[t,r],c=e.runWebGLProgram(o,l,"int32");if(c.shape.length===t.shape.length){let u=VU(e,t,n,c);return e.disposeIntermediateTensorInfo(c),u}return c}function UU(e,t,n,r){let a=[n];if(N.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!Q().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){let i=[],s=e.texData.get(t.dataId),o=s!==null&&s.isPacked,l=t;o&&(l=e.unpackTensor(t),i.push(l));let[c,u]=N.computeOutAndReduceShapes(l.shape,a),d=k.sizeFromShape(u),p=be({inputs:{x:l},backend:e,attrs:{shape:[-1,d]}});i.push(p);let h=WU(e,p,r);i.push(h);let f=be({inputs:{x:h},backend:e,attrs:{shape:c}});return i.forEach(m=>e.disposeIntermediateTensorInfo(m)),f}return VU(e,t,r)}function y_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r,s=k.parseAxisParam(i,a.shape),o=N.getAxesPermutation(s,a.shape.length),l=a,c=[];o!=null&&(l=Nr({inputs:{x:a},backend:n,attrs:{perm:o}}),c.push(l),s=N.getInnerMostAxes(s.length,l.shape.length)),N.assertAxesAreInnerMostDims("argMax",[s[0]],l.shape.length);let u=UU(n,l,s[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}var b_e={kernelName:zp,backendName:"webgl",kernelFunc:y_e};function v_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r,s=k.parseAxisParam(i,a.shape),o=N.getAxesPermutation(s,a.shape.length),l=a,c=[];o!=null&&(l=Nr({inputs:{x:a},backend:n,attrs:{perm:o}}),c.push(l),s=N.getInnerMostAxes(s.length,l.shape.length)),N.assertAxesAreInnerMostDims("argMin",[s[0]],l.shape.length);let u=UU(n,l,s[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}var x_e={kernelName:Lp,backendName:"webgl",kernelFunc:v_e},w_e=li+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,k_e=ft({opSnippet:w_e}),S_e={kernelName:Du,backendName:"webgl",kernelFunc:k_e},I_e=li+"return log(x + sqrt(x * x + 1.0));",C_e=ft({opSnippet:I_e}),__e={kernelName:Mu,backendName:"webgl",kernelFunc:C_e},T_e=li+`
  return atan(x);
`,N_e=ft({opSnippet:T_e}),E_e={kernelName:Ou,backendName:"webgl",kernelFunc:N_e},$_e=IE+`
  return atan(a, b);
`,A_e=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ad+`
  return result;
`,R_e=sr({opSnippet:$_e,packedOpSnippet:A_e}),F_e={kernelName:zu,backendName:"webgl",kernelFunc:R_e},D_e=li+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,M_e=ft({opSnippet:D_e}),O_e={kernelName:Pu,backendName:"webgl",kernelFunc:M_e},eg=class{constructor(e,t,n,r=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");let i=e.filterWidth,s=e.strideHeight,o=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;let f=t==="avg",m=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`,y="0.0";if(f||(y="-1.0 / 1e-20"),n){let C=">=";this.userCode=`
        const ivec2 strides = ivec2(${s}, ${o});
        const ivec2 pads = ivec2(${p}, ${h});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${u};
              wR += ${l}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${C} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?a?m:g:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let b="max",v=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(v="avgValue / max(count, 1.0)");let x=Math.floor(i/4)*4,w=i%4,S=`
      if (${f}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${o});
      const ivec2 pads = ivec2(${p}, ${h});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${u};
            wR += ${l}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${x}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${S}
          }

          int xC = xCCorner + ${x};
          if (${w===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${S}
          } else if (${w===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${S}
          } else if (${w===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${S}
          }
        }
        setOutput(${v});
      }
    `}},_E=class{constructor(e,t,n,r=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");let i=e.filterWidth,s=e.strideDepth,o=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,p=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;let b=t==="avg",v="0.0";if(b||(v="-1.0 / 1e-20"),n){let E=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${s}, ${o}, ${l});
        const ivec3 pads = ivec3(${m}, ${g}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${p};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${h};
                wR += ${u}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${f};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${E} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?a?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${h} * ${f} +
                      wR * ${f} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let x="max",w=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(w="avgValue / max(count, 1.0)");let S=Math.floor(i/4)*4,C=i%4,T=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${x}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${s}, ${o}, ${l});
      const ivec3 pads = ivec3(${m}, ${g}, ${y});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h};
            wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${S}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${T}
            }

            int xC = xCCorner + ${S};
            if (${C===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${T}
            } else if (${C===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${T}
            } else if (${C===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${T}
            }
          }
        }
        setOutput(${w});
      }
    `}};function P_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;Xh(a,"avgPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=r,c=1;k.assert(N.eitherStridesOrDilationsAreOne(s,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);let u=N.computePool2DInfo(a.shape,i,s,c,o,l);if(u.filterWidth===1&&u.filterHeight===1&&k.arraysEqual(u.inShape,u.outShape))return ma({inputs:{x:a},backend:n});let d=new eg(u,"avg",!1);return n.runWebGLProgram(d,[a],"float32")}var z_e={kernelName:Lu,backendName:"webgl",kernelFunc:P_e};function L_e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=r,u=[1,1,1],d=N.computePool3DInfo(a.shape,i,s,u,o,l,c),p=new _E(d,"avg",!1);return n.runWebGLProgram(p,[a],"float32")}var B_e={kernelName:Bp,backendName:"webgl",kernelFunc:L_e},W_e=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=o-1-e.padInfo.top,u=l-1-e.padInfo.left,d=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${u});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${l};
            wC+= ${s}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}},V_e=class{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,h=u-1-e.padInfo.front,f=d-1-e.padInfo.top,m=p-1-e.padInfo.left,g=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(${h}, ${f}, ${m});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${u};
            wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${l}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${p};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function U_e(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,s=i,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=r,d=[1,1,1],p=N.computePool3DInfo(s.shape,o,l,d,c,u),h=new V_e(p);return n.runWebGLProgram(h,[a],s.dtype)}var j_e={kernelName:bg,backendName:"webgl",kernelFunc:U_e};function H_e(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,s=i;Xh([a,i],"avgPoolGrad");let{filterSize:o,strides:l,pad:c}=r,u=N.computePool2DInfo(s.shape,o,l,1,c),d=new W_e(u);return n.runWebGLProgram(d,[a],s.dtype)}var G_e={kernelName:yg,backendName:"webgl",kernelFunc:H_e};function q_e(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i}=t,{transposeA:s,transposeB:o}=r;return xv({a,b:i,transposeA:s,transposeB:o,backend:n})}var K_e={kernelName:Bu,backendName:"webgl",kernelFunc:q_e},X_e=class{constructor(e,t,n,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],N.assertAndGetBroadcastShape(e,t),N.assertAndGetBroadcastShape(e,n);let s="0.0";r!=null&&(N.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="1.0";a!=null&&(N.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${s};
        float scale = ${o};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}},Y_e=class{constructor(e,t,n,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],N.assertAndGetBroadcastShape(e,t),N.assertAndGetBroadcastShape(e,n);let s="vec4(0.0)";r!=null&&(N.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let o="vec4(1.0)";a!=null&&(N.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${s};
        vec4 scale = ${o};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}},Z_e=({inputs:e,backend:t,attrs:n})=>{let{x:r,mean:a,variance:i,offset:s,scale:o}=e;k.assert(a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),k.assert(s==null||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),k.assert(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);let c=[r,a,i],u=null;s!=null&&(u=s.shape,c.push(s));let d=null;o!=null&&(d=o.shape,c.push(o));let p=Q().getBool("WEBGL_PACK_NORMALIZATION")?new Y_e(r.shape,a.shape,i.shape,u,d,l):new X_e(r.shape,a.shape,i.shape,u,d,l);return t.runWebGLProgram(p,c,c[0].dtype)},Q_e={kernelName:ac,backendName:"webgl",kernelFunc:Z_e},J_e=class{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;let t=At(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let n=eTe(this.rank),r,a=e.map((i,s)=>`sourceLoc.${LI[s]} = start[${s}] + coords.${LI[s]};`);r=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${n}));
      }
    `}},LI=["x","y","z","w","u","v"];function eTe(e){if(e===1)return"sourceLoc";if(e<=6)return LI.slice(0,e).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}var tTe=class{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let t=At(this.rank),n=kr("coords",this.rank),r=kr("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${a})`,s=`
      result.x = ${i};
      if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${i};
        --${r[this.rank-1]};
      }
    `,o=this.rank===1?"":`
      --${n[this.rank-1]};
      if (++${n[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${i};
        if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${i};
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((c,u)=>`start[${u}]`).join()});`:e.map((c,u)=>`${r[u]} = ${n[u]} + start[${u}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${l}
        vec4 result = vec4(0.);
        ${s}
        ${o}
        setOutput(result);
      }
    `}};function nTe(e,t,n,r){let a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),s=r.texData.get(i.dataId);Object.assign(s,a),s.refCount=1,s.shape=n,s.dtype=e.dtype;let o=Dn.computeFlatOffset(t,k.computeStrides(e.shape));a.slice&&(o+=a.slice.flatOffset),s.slice={flatOffset:o,origDataId:a.slice&&a.slice.origDataId||e.dataId};let l=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,l+1),i}function nf(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,size:s}=r,[o,l]=Dn.parseSliceParams(a,i,s);if(Dn.assertParamsValid(a,o,l),k.sizeFromShape(l)===0)return n.makeTensorInfo(l,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||a.dtype==="string"){let d=n.texData.get(a.dataId),p=G2e(d.values,o,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,p)}let{isPacked:c}=n.texData.get(a.dataId),u=Dn.isSliceContinous(a.shape,o,l);if(c||!u){let d=Q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tTe(l):new J_e(l),p=[o];return n.runWebGLProgram(d,[a],a.dtype,p)}return n.uploadToGPU(a.dataId),nTe(a,o,l,n)}var rTe={kernelName:_h,backendName:"webgl",kernelFunc:nf},aTe=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:s}=r;k.assert(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let o=i.reduce((b,v)=>b*v),l=N.getReshaped(a.shape,i,o),c=N.getPermuted(l.length,i.length),u=N.getReshapedPermuted(a.shape,i,o),d=N.getSliceBeginCoords(s,i.length),p=N.getSliceSize(u,s,i.length),h=[],f=be({inputs:{x:a},backend:n,attrs:{shape:l}}),m=Nr({inputs:{x:f},backend:n,attrs:{perm:c}}),g=be({inputs:{x:m},backend:n,attrs:{shape:u}}),y=nf({inputs:{x:g},backend:n,attrs:{begin:d,size:p}});return h.push(f),h.push(m),h.push(g),h.forEach(b=>n.disposeIntermediateTensorInfo(b)),y},iTe={kernelName:Wp,backendName:"webgl",kernelFunc:aTe};function sTe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s}=r,o=n.readSync(a.dataId),l=n.readSync(i.dataId),c=EU(o,l,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,c)}var oTe={kernelName:Vp,backendName:"webgl",kernelFunc:sTe},lTe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,uTe=`
  return float(int(a.r) & int(b.r));
`;function cTe(e){let{inputs:t,backend:n}=e,{a:r,b:a}=t,i=Q().getBool("WEBGL_PACK_BINARY_OPERATIONS"),s=Q().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,a])||s===1){let l=n.texData.get(r.dataId).values,c=n.texData.get(a.dataId).values,[u,d]=g2e(r.shape,a.shape,l,c,r.dtype),p=n.makeTensorInfo(d,r.dtype),h=n.texData.get(p.dataId);return h.values=u,p}let o;return i?o=new ef(lTe,r.shape,a.shape,!1):o=new ku(uTe,r.shape,a.shape),n.runWebGLProgram(o,[r,a],r.dtype)}var dTe={kernelName:Up,backendName:"webgl",kernelFunc:cTe};function pTe(e){let{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.readSync(r.dataId),s=n.readSync(a.dataId),o=N.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}var hTe={kernelName:vg,backendName:"webgl",kernelFunc:pTe},fTe="return float(a != b);",jU=sr({opSnippet:fTe,cpuKernelImpl:P2e,dtype:"bool"}),mTe={kernelName:hh,backendName:"webgl",kernelFunc:jU};function yy(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.texData.get(r.dataId);return ma({inputs:{x:a.complexTensorInfos.real},backend:n})}var gTe={kernelName:jx,backendName:"webgl",kernelFunc:yy},yTe="return float(int(x));";function bTe(e,t){let n=new Ui(e.shape,yTe),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}function BI(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dtype:i}=r;if(i==="complex64"){if(a.dtype==="complex64")return ma({inputs:{x:a},backend:n});let s=en(a.shape),o=BI({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=ul({inputs:{real:o,imag:s},backend:n});return s.dispose(),n.disposeIntermediateTensorInfo(o),l}if(a.dtype==="complex64"){let s=yy({inputs:{input:a},backend:n}),o=BI({inputs:{x:s},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(s),o}if(!k.hasEncodingLoss(a.dtype,i)){let s=ma({inputs:{x:a},backend:n});return{dataId:s.dataId,shape:s.shape,dtype:i}}if(n.shouldExecuteOnCPU([a])){let s=n.texData.get(a.dataId).values,[o,l,c]=y2e(s,a.shape,a.dtype,i);return n.makeTensorInfo(o,l,c)}if(i==="int32")return bTe(a,n);if(i==="bool"){let s=n.makeTensorInfo([],"bool",k.getTypedArrayFromDType("bool",1)),o=jU({inputs:{a,b:s},backend:n});return n.disposeIntermediateTensorInfo(s),o}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${i}`)}var vTe={kernelName:Wu,backendName:"webgl",kernelFunc:BI},OD="return ceil(x);",xTe=ft({opSnippet:OD,packedOpSnippet:OD,cpuKernelImpl:b2e}),wTe={kernelName:Vu,backendName:"webgl",kernelFunc:xTe},kTe=class{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}},STe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}};function ITe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{clipValueMin:i,clipValueMax:s}=r,o;Q().getBool("WEBGL_PACK_CLIP")?o=new STe(a.shape):o=new kTe(a.shape);let l=[[i],[s]];return n.runWebGLProgram(o,[a],a.dtype,l)}var CTe={kernelName:el,backendName:"webgl",kernelFunc:ITe},_Te=class{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}};function PD(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}function TTe(e){let{inputs:t,backend:n}=e,{x:r}=t,a=n.texData.get(r.dataId),i=new _Te(r.shape),s=[PD(r,a.complexTensorInfos.real),PD(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,s,s[0].dtype)}var NTe={kernelName:xg,backendName:"webgl",kernelFunc:TTe},ETe=class{constructor(e){this.outputShape=[],this.outputShape=N.computeOutShape(e,1),this.variableNames=e.map((i,s)=>`T${s}`);let t=new Array(e.length-1);t[0]=e[0][1];for(let i=1;i<t.length;i++)t[i]=t[i-1]+e[i][1];let n=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<t.length;i++){let s=t[i-1];n.push(`else if (yC < ${t[i]}) setOutput(getT${i}(yR, yC-${s}));`)}let r=t.length,a=t[t.length-1];n.push(`else setOutput(getT${r}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${n.join(`
        `)}
      }
    `}},$Te=class{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=N.computeOutShape(e,t);let n=this.outputShape,r=n.length,a=At(r),i=kr("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((f,m)=>`T${m}`);let o=new Array(e.length-1);o[0]=e[0][t];for(let f=1;f<o.length;f++)o[f]=o[f-1]+e[f][t];let l=s[t],c=s.slice(-2),u=s.join(),d=`if (${l} < ${o[0]}) {
        return getChannel(
            getT0(${u}), vec2(${c.join()}));
        }`;for(let f=1;f<o.length;f++){let m=o[f-1];d+=`
        if (${l} < ${o[f]}  && ${l} >= ${o[f-1]}) {
          return getChannel(
            getT${f}(${C0(s,l,m)}),
            vec2(${C0(c,l,m)}));
        }`}let p=o.length,h=o[o.length-1];d+=`
        return getChannel(
          getT${p}(${C0(s,l,h)}),
          vec2(${C0(c,l,h)}));`,this.userCode=`
      float getValue(${s.map(f=>"int "+f)}) {
        ${d}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[r-1]} = ${i[r-1]} + 1;
        if (${i[r-1]} < ${n[r-1]}) {
          result.g = getValue(${i});
        }

        ${i[r-2]} = ${i[r-2]} + 1;
        if (${i[r-2]} < ${n[r-2]}) {
          result.a = getValue(${i});
        }

        ${i[r-1]} = ${i[r-1]} - 1;
        if (${i[r-2]} < ${n[r-2]} &&
            ${i[r-1]} < ${n[r-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}};function C0(e,t,n){let r=e.indexOf(t);return e.map((a,i)=>i===r?`${a} - ${n}`:a).join()}function Q1(e){let{inputs:t,backend:n}=e,{input:r}=t,a=n.texData.get(r.dataId);return ma({inputs:{x:a.complexTensorInfos.imag},backend:n})}var ATe={kernelName:Bx,backendName:"webgl",kernelFunc:Q1};function zf(e,t,n){let r=e[0].dtype;if(r==="complex64"){let h=e.map(b=>yy({inputs:{input:b},backend:n})),f=e.map(b=>Q1({inputs:{input:b},backend:n})),m=zf(h,t,n),g=zf(f,t,n),y=ul({inputs:{real:m,imag:g},backend:n});return h.forEach(b=>n.disposeIntermediateTensorInfo(b)),f.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),y}let a=n.shouldExecuteOnCPU(e);if(r==="string"&&(a=!0),a){let h=e.map(x=>{let w=[-1,k.sizeFromShape(x.shape.slice(t))];return be({inputs:{x},backend:n,attrs:{shape:w}})}),f=h.map(x=>({vals:n.readSync(x.dataId),shape:x.shape})),m=N.computeOutShape(h.map(x=>x.shape),1),g=h[0].shape[0]===1,y=v2e(f,m,r,g),b=N.computeOutShape(e.map(x=>x.shape),t),v=n.makeTensorInfo(b,r,y);return h.forEach(x=>n.disposeIntermediateTensorInfo(x)),v}let i=e.filter(h=>k.sizeFromShape(h.shape)>0),s=Q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){let h=s?new Ui(e[0].shape,ao):new mo(e[0].shape,ao);return n.runWebGLProgram(h,e,r)}let o=Q().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>o){let h=[];for(let m=0;m<i.length;m+=o){let g=i.slice(m,m+o);h.push(zf(g,t,n))}let f=zf(h,t,n);for(let m of h)n.disposeIntermediateTensorInfo(m);return f}if(s){let h=new $Te(i.map(f=>f.shape),t);return n.runWebGLProgram(h,i,r)}let{tensors2D:l,outShape:c}=RTe(i,t,n),u=new ETe(l.map(h=>h.shape)),d=n.runWebGLProgram(u,l,r);l.forEach(h=>n.disposeIntermediateTensorInfo(h));let p=be({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),p}function RTe(e,t,n){let r=N.computeOutShape(e.map(a=>a.shape),t);return{tensors2D:e.map(a=>be({inputs:{x:a},attrs:{shape:[-1,k.sizeFromShape(a.shape.slice(t))]},backend:n})),outShape:r}}function HU(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,i=k.parseAxisParam(a,t[0].shape)[0],s=t.map(c=>c.shape);N.assertParamsConsistent(s,i);let o=N.computeOutShape(t.map(c=>c.shape),i);if(k.sizeFromShape(o)===0)return n.makeTensorInfo(o,t[0].dtype,[]);let l=t.filter(c=>k.sizeFromShape(c.shape)>0);return l.length===1?ma({inputs:{x:l[0]},backend:n}):zf(l,i,n)}var FTe={kernelName:jp,backendName:"webgl",kernelFunc:HU},GU=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;let i=e.padInfo.top,s=e.padInfo.left,o=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterHeight,p=e.filterWidth,h=Math.floor(e.inChannels/4)*4,f=e.inChannels%4,m=e.dataFormat==="channelsLast",g=m?1:2,y=m?2:3,b=m?3:1,v="",x="";n&&(r?v=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:a?v=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:v=`
          float activation(float x) {
            ${n}
          }
        `,x="result = activation(result);");let w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${v}

      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${i}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${p}; wC++) {
            int xC = xCCorner + wC * ${u};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${h}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${m}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${f===1}) {

              if (${m}) {
                dotProd +=
                    getX(batch, xR, xC, ${h}) *
                    getW(wR, wC, ${h}, d2);
              } else {
                dotProd +=
                    getX(batch, ${h}, xR, xC) *
                    getW(wR, wC, ${h}, d2);
              }

            } else if (${f===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${h}, d2),
                getW(wR, wC, ${h} + 1, d2)
              );

              if (${m}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${h}),
                  getX(batch, xR, xC, ${h} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${h}, xR, xC),
                  getX(batch, ${h} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${f===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${h}, d2),
                getW(wR, wC, ${h} + 1, d2),
                getW(wR, wC, ${h} + 2, d2)
              );

              if (${m}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${h}),
                  getX(batch, xR, xC, ${h} + 1),
                  getX(batch, xR, xC, ${h} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${h}, xR, xC),
                  getX(batch, ${h} + 1, xR, xC),
                  getX(batch, ${h} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${w}
        ${x}
        setOutput(result);
      }
    `}},DTe=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.filterDepth,d=e.filterHeight,p=e.filterWidth,h=Math.floor(e.inChannels/4)*4,f=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${i}, ${s});
      const ivec3 pads = ivec3(${t}, ${n}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${u}; wF++) {
          int xF = xFCorner + wF * ${o};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${l};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${h}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${f===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${h}) *
                  getW(wF, wR, wC, ${h}, d2);
              } else if (${f===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${h}),
                  getX(batch, xF, xR, xC, ${h} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${h}, d2),
                  getW(wF, wR, wC, ${h} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${f===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${h}),
                  getX(batch, xF, xR, xC, ${h} + 1),
                  getX(batch, xF, xR, xC, ${h} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${h}, d2),
                  getW(wF, wR, wC, ${h} + 1, d2),
                  getW(wF, wR, wC, ${h} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},qU=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=fr(this.outputShape.length);let i=e.padInfo.left,s=e.strideWidth,o=e.dilationWidth,l=e.filterHeight,c=e.filterWidth,u=c,d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let m=0;m<c;m++)d+=`
           vec4 xTexelC${m*2};
           int xTexelC${m*2}Ready;
           vec4 xTexelC${m*2+1};
           int xTexelC${m*2+1}Ready;
           vec4 xC${m};`;d+=`
     for (int r = 0; r < ${l}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let m=0;m<c;m++)d+=`
           xTexelC${m*2} = vec4(0.0);
           xTexelC${m*2}Ready = 0;
           xTexelC${m*2+1} = vec4(0.0);
           xTexelC${m*2+1}Ready = 0;
           xC${m} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let m=0;m<(u+1)/2;m++){let g=m*2;if(d+=`
           xC = xCCorner + ${g*o};
           `,s===1){if(g<c&&(i%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }
               `,o===1&&g>0?d+=`
                 xC${g} = vec4(xTexelC${g-2}.zw, xTexelC${g}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${g} = vec4(previous.zw, xTexelC${g}.xy);
                   } else {
                     xC${g} = vec4(0.0, 0.0, xTexelC${g}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xC${g} = xTexelC${g};
                 `,g+1<c)){let y=i%2===0?k.nearestLargerEven(o):o;o%2===0&&i%2===1||o%2!==0&&i%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${y};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                     xTexelC${g+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${g+1}.zw = vec2(0.0);
                     }
                     xTexelC${g+1}Ready = 1;
                   }
                   `,o>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${g+1} = vec4(previous.zw, xTexelC${g+1}.xy);
                     } else {
                      xC${g+1} = vec4(0.0, 0.0, xTexelC${g+1}.xy);
                     }
                     `:d+=`
                     xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.xy);
                     `):y===1?d+=`
                     xC${g+1} = xTexelC${g};
                     `:d+=`
                     xCOffset = xC + ${y};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                       xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${g+1}.zw = vec2(0.0);
                       }
                       xTexelC${g+1}Ready = 1;
                     }

                     xC${g+1} = xTexelC${g+1};
                     `}}else g<c&&(i%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.0);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
               `,g+1<c&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${g+1} = vec4(xTexelC${g+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(
                   xTexelC${g}.xy, xTexelC${g+1}.xy);
               `,g+1<c&&(d+=`
                   xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
                 `)));g<c&&(d+=`
             wTexel = getW(r, ${g}, d1, d2);
             dotProd += xC${g}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${g}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,g+1<c&&(d+=`
               wTexel = getW(r, ${g+1}, d1, d2);
               dotProd += xC${g+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${g+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let p="",h="";n&&(r?p=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${n}
         }`:a?p=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${n}
         }`:p=`vec4 activation(vec4 x) {
           ${n}
         }`,h="result = activation(result);");let f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${p}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${f}
         ${h}
         setOutput(result);
       }
     `}},MTe=class{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=fr(this.outputShape.length);let{dataFormat:n}=t,r=Fr(),a=n==="channelsLast",i=a?1:2,s=a?2:3,o=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`,l="";for(let c=0;c<=1;c++)for(let u=0;u<=1;u++)l+=`
          blockIndex = rc.z + ${u};
          pos = rc.y + ${c};

          ${o}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${s}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+u}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+u}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${l}

        ${r.output} = result;
      }
    `}};function wv(e,t){let n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&n===1&&e[0]>1?[e[0],1]:null}function KU({x:e,filter:t,convInfo:n,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:o=null}){let l=e.shape,c=r.texData.get(e.dataId),u=n.inChannels,d=l[0]*l[1]*l[2],p=n.outChannels,h=n.dataFormat==="channelsLast",f=!1,m=!1,g,y=[];if(i!=null){let b=wv(i.shape,h);b!=null&&(i=be({inputs:{x:i},backend:r,attrs:{shape:b}}),y.push(i))}if(a!=null){let b=wv(a.shape,h);b!=null&&(a=be({inputs:{x:a},backend:r,attrs:{shape:b}}),y.push(a))}if(!((d===1||p===1)&&u>BU)&&c.isPacked&&h&&c.texture!=null&&l[2]%2!==0&&k.arraysEqual(c.shape.slice(-3),l.slice(-3))){let b=l[0]*l[1]*(l[2]+1),v={dataId:e.dataId,shape:[1,b,n.inChannels],dtype:e.dtype},x=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,k.assert(Qm(c.shape,v.shape),()=>`packed reshape ${c.shape} to ${v.shape} isn't free`);let w=be({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});y.push(w);let S=xv({a:v,b:w,backend:r,transposeA:f,transposeB:m,bias:a,activation:o,preluActivationWeights:i,leakyreluAlpha:s}),C=r.texData.get(S.dataId);k.assert(C.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=x,C.shape=n.outShape,g=ma({inputs:{x:S},backend:r}),g.shape=n.outShape,y.push(S)}else{let b=n.outHeight*n.outWidth,v=be({inputs:{x:e},backend:r,attrs:{shape:h?[n.batchSize,b,n.inChannels]:[n.batchSize,n.inChannels,b]}}),x=be({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),w=xv({a:h?v:x,b:h?x:v,transposeA:!h,transposeB:m,backend:r,bias:a,activation:o,preluActivationWeights:i,leakyreluAlpha:s});g=be({inputs:{x:w},backend:r,attrs:{shape:n.outShape}}),y.push(v),y.push(x),y.push(w)}for(let b of y)r.disposeIntermediateTensorInfo(b);return g}function XU({x:e,filter:t,convInfo:n,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:o=null}){let{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:p,dataFormat:h}=n,f=h==="channelsLast",m=l*c*u,g=p*d,y=[n.batchSize,m,g],b=!0,v=!1,x=[];if(i!=null){let O=wv(i.shape,f);O!=null&&(i=be({inputs:{x:i},backend:r,attrs:{shape:O}}),x.push(i))}if(a!=null){let O=wv(a.shape,f);O!=null&&(a=be({inputs:{x:a},backend:r,attrs:{shape:O}}),x.push(a))}let w=be({inputs:{x:t},backend:r,attrs:{shape:[1,m,k.sizeFromShape(t.shape)/m]}});x.push(w);let S=new MTe(y,n),C=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],T=r.runWebGLProgram(S,[e],"float32",C),E=be({inputs:{x:T},backend:r,attrs:{shape:y}});x.push(T),x.push(E);let R=a!=null,$=i!=null,_=o==="leakyrelu",D=o?Jm(o,!0):null,P=new LU(f?E.shape:w.shape,f?w.shape:E.shape,f?[n.batchSize,g,n.outChannels]:[n.batchSize,n.outChannels,g],b,v,R,D,$,_),B=f?[E,w]:[w,E];if(a&&B.push(a),$&&B.push(i),_){let O=r.makeTensorInfo([],"float32",k.createScalarValue(s,"float32"));B.push(O),x.push(O)}let W=r.runWebGLProgram(P,B,"float32"),Y=be({inputs:{x:W},backend:r,attrs:{shape:n.outShape}});x.push(W);for(let O of x)r.disposeIntermediateTensorInfo(O);return Y}function OTe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dataFormat:l,dilations:c,dimRoundingMode:u}=r,d=N.convertConv2DDataFormat(l),p=N.computeConv2DInfo(a.shape,i.shape,s,c,o,u,!1,d),h;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))h=KU({x:a,filter:i,convInfo:p,backend:n});else if(p.strideWidth<=2&&d==="channelsLast"&&Q().getBool("WEBGL_EXP_CONV")){let m=new qU(p),g=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];h=n.runWebGLProgram(m,[a,i],"float32",g)}else if(Q().getBool("WEBGL_CONV_IM2COL"))h=XU({x:a,filter:i,convInfo:p,backend:n});else{let m=new GU(p);h=n.runWebGLProgram(m,[a,i],"float32")}let f=be({inputs:{x:h},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(h),f}var PTe={kernelName:Uu,backendName:"webgl",kernelFunc:OTe},zTe=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}},LTe=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dataFormat==="channelsLast",s=t-1-e.padInfo.top,o=n-1-e.padInfo.left,l=i?1:2,c=i?2:3,u=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${u}];

        ivec2 dyCorner = ivec2(coords[${l}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}},BTe=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,s=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${a};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${n} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${s};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},WTe=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,s=e.strideWidth,o=t-1-e.padInfo.front,l=n-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${o}, ${l}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${n}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${n} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function VTe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=r,d=N.convertConv2DDataFormat(l),p=N.computeConv2DInfo(a.shape,u,s,1,o,c,!1,d),h=new zTe(p);return n.runWebGLProgram(h,[a,i],"float32")}var UTe={kernelName:Dx,backendName:"webgl",kernelFunc:VTe},jTe=class{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=fr(this.outputShape.length);let t=e.filterHeight,n=e.filterWidth,r=t-1-e.padInfo.top,a=n-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            int wCPerm = ${n} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}};function HTe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{inputShape:s,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=r,d=N.convertConv2DDataFormat(c),p=N.computeConv2DInfo(s,i.shape,o,1,l,u,!1,d);if(Q().getBool("WEBGL_PACK")&&d==="channelsLast"){let h=[[p.strideHeight,p.strideWidth]],f=new jTe(p);return n.runWebGLProgram(f,[a,i],"float32",h)}else{let h=new LTe(p);return n.runWebGLProgram(h,[a,i],"float32")}}var GTe={kernelName:ju,backendName:"webgl",kernelFunc:HTe};function qTe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r,c=N.computeConv3DInfo(a.shape,i.shape,s,l,o),u=new DTe(c);return n.runWebGLProgram(u,[a,i],"float32")}var KTe={kernelName:Hu,backendName:"webgl",kernelFunc:qTe};function XTe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,filterShape:l}=r,c=N.computeConv3DInfo(a.shape,l,s,1,o),u=new BTe(c);return n.runWebGLProgram(u,[a,i],"float32")}var YTe={kernelName:Hp,backendName:"webgl",kernelFunc:XTe};function ZTe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:s,strides:o,inputShape:l}=r,c=N.computeConv3DInfo(l,i.shape,o,1,s),u=new WTe(c);return n.runWebGLProgram(u,[a,i],"float32")}var QTe={kernelName:Gp,backendName:"webgl",kernelFunc:ZTe},JTe=tf+`
  return cos(x);
`,eNe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${ad}
  return result;
`,tNe=ft({opSnippet:JTe,packedOpSnippet:eNe}),nNe={kernelName:Gu,backendName:"webgl",kernelFunc:tNe},rNe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,aNe=ft({opSnippet:rNe}),iNe={kernelName:qu,backendName:"webgl",kernelFunc:aNe},sNe=class{constructor(e,t,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[i,s,o,l]=e,[c]=t,[u,d]=n;this.outputShape=[c,u,d,l];let p=r==="bilinear"?1:0,[h,f]=[`${s-1}.0`,`${o-1}.0`],[m,g,y]=u>1?[`${(s-1)/(u-1)}`,"(y2-y1) * height_ratio",`y1*${h} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${h}`],[b,v,x]=d>1?[`${(o-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${f} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${f}`];this.userCode=`
      const float height_ratio = float(${m});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${v};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${h} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${x};
        if( in_x < 0.0 || in_x > ${f} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${p} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}},oNe=e=>{let{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:i,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:c}=r,u=new sNe(a.shape,i.shape,o,l,c);return n.runWebGLProgram(u,[a,i,s],"float32")},lNe={kernelName:Kp,backendName:"webgl",kernelFunc:oNe},tg;(function(e){e.Prod="*",e.Sum="+"})(tg||(tg={}));var zD=class{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let a=this.outputShape.length,i=this.op===tg.Prod?"1.0":"0.0",s=n?i:`getX(${LD(a,"coords",this.op)})`,o=this.outputShape[this.outputShape.length-1],l="",c="";n?(l=r?`end != ${o-1}`:"end != 0",c=r?"end + 1":"end - 1"):(l=r?`end + pow2 < ${o}`:"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${At(a)} coords = getOutputCoords();
        int end = ${BD(a,"coords",this.op)};
        float val = ${s};
        int pow2 = int(pow(2.0, index));
        if (${l}) {
          int idx = ${c};
          ${BD(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${LD(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}};function LD(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.x, ${t}.y`;if(e===3)return`${t}.x, ${t}.y, ${t}.z`;if(e===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function BD(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.y`;if(e===3)return`${t}.z`;if(e===4)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function YU(e,t,n,r,a,i){let s=t.shape.length,o=N.getAxesPermutation([r],s),l=t;o!=null&&(l=Nr({inputs:{x:t},backend:n,attrs:{perm:o}}));let c=N.getInnerMostAxes(1,s)[0];if(c!==s-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);let u=l.shape[c],d=ma({inputs:{x:l},backend:n});for(let p=0;p<=Math.ceil(Math.log2(u))-1;p++){let h=new zD(e,l.shape,!1,i),f=[[p]],m=d;d=n.runWebGLProgram(h,[d],d.dtype,f),n.disposeIntermediateTensorInfo(m)}if(a){let p=new zD(e,l.shape,a,i),h=d;d=n.runWebGLProgram(p,[d],d.dtype),n.disposeIntermediateTensorInfo(h)}if(o!=null){let p=N.getUndoAxesPermutation(o),h=Nr({inputs:{x:d},backend:n,attrs:{perm:p}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),h}return d}function uNe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;return YU(tg.Prod,a,n,i,s,o)}var cNe={kernelName:qp,backendName:"webgl",kernelFunc:uNe};function dNe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r;return YU(tg.Sum,a,n,i,s,o)}var pNe={kernelName:Ku,backendName:"webgl",kernelFunc:dNe};function hNe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:s,binaryOutput:o}=r;if(a.shape.length===1){let l=n.readSync(a.dataId),c=n.readSync(i.dataId),u=EU(l,c,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,u)}else if(a.shape.length===2){let l=n.bufferSync(a),c=n.bufferSync(i),u=m2e(l,c,s,o);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}var fNe={kernelName:wg,backendName:"webgl",kernelFunc:hNe},mNe=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};function gNe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:i,dataFormat:s}=r,o=a.shape[0],l=s==="NHWC"?a.shape[1]:a.shape[2],c=s==="NHWC"?a.shape[2]:a.shape[3],u=s==="NHWC"?a.shape[3]:a.shape[1],d=l*i,p=c*i,h=u/(i*i),f=s==="NHWC"?[o,d,p,h]:[o,h,d,p],m=new mNe(f,i,s);return n.runWebGLProgram(m,[a],a.dtype)}var yNe={kernelName:Xp,backendName:"webgl",kernelFunc:gNe},ZU=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=fr(this.outputShape.length);let i=e.filterHeight,s=e.filterWidth,o=e.outChannels/e.inChannels,l="",c="";n&&(r?l=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:a?l=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:l=`
          float activation(float x) {
            ${n}
          }
        `,c="result = activation(result);");let u=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${l}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${s}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${u}
        ${c}
        setOutput(result);
      }
    `}},QU=class{constructor(e,t=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=fr(this.outputShape.length);let i=e.outChannels/e.inChannels,s=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u,p=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<u;g++)p+=`
          vec4 xTexelC${g*2};
          int xTexelC${g*2}Ready;
          vec4 xTexelC${g*2+1};
          int xTexelC${g*2+1}Ready;
          vec4 xC${g};`;p+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let g=0;g<u;g++)p+=`
          xTexelC${g*2} = vec4(0.0);
          xTexelC${g*2}Ready = 0;
          xTexelC${g*2+1} = vec4(0.0);
          xTexelC${g*2+1}Ready = 0;
          xC${g} = vec4(0.0);`;p+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let g=0;g<(d+1)/2;g++){let y=g*2;if(p+=`
          xC = xCCorner + ${y*l};
          `,o===1){if(y<u&&(s%2===1?(p+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }
              `,l===1&&y>0?p+=`
                xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                `:p+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                  } else {
                    xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                  }
                  `):p+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xC${y} = xTexelC${y};
                `,y+1<u)){let b=s%2===0?k.nearestLargerEven(l):l;l%2===0&&s%2===1||l%2!==0&&s%2!==1?(p+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                    xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${y+1}.zw = vec2(0.0);
                    }
                    xTexelC${y+1}Ready = 1;
                  }
                  `,l>1?p+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                    } else {
                     xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                    }
                    `:p+=`
                    xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                    `):b===1?p+=`
                    xC${y+1} = xTexelC${y};
                    `:p+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                      xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${y+1}.zw = vec2(0.0);
                      }
                      xTexelC${y+1}Ready = 1;
                    }

                    xC${y+1} = xTexelC${y+1};
                    `}}else y<u&&(s%2===1?(p+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.0);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
              `,y+1<u&&(p+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(
                  xTexelC${y}.xy, xTexelC${y+1}.xy);
              `,y+1<u&&(p+=`
                  xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                `)));y<u&&(p+=`
            wTexel = getW(r, ${y}, d1, q);
            dotProd += xC${y} * vec4(wTexel.xz, wTexel.xz);
          `,y+1<u&&(p+=`
              wTexel = getW(r, ${y+1}, d1, q);
              dotProd += xC${y+1} * vec4(wTexel.xz, wTexel.xz);
            `))}p+=`
    }
  `,p+=`
      }
    `;let h="",f="";n&&(r?h=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:a?h=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:h=`vec4 activation(vec4 x) {
          ${n}
        }`,f="result = activation(result);");let m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${h}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${p}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${m}
        ${f}
        setOutput(result);
      }
    `}};function bNe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l,dimRoundingMode:c}=r,u=l;u==null&&(u=[1,1]),k.assert(N.eitherStridesOrDilationsAreOne(s,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);let d=N.computeConv2DInfo(a.shape,i.shape,s,u,o,c,!0),p;Q().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?p=new QU(d):p=new ZU(d);let h=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(p,[a,i],"float32",h)}var vNe={kernelName:Xu,backendName:"webgl",kernelFunc:bNe},xNe=class{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}},wNe=class{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=t-1-e.padInfo.top,s=n-1-e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${o}; dm++) {
              int d2 = d1 * ${o} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function kNe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=r,d=N.computeConv2DInfo(a.shape,u,s,o,l,c,!0),p=new xNe(d);return n.runWebGLProgram(p,[a,i],"float32")}var SNe={kernelName:Mx,backendName:"webgl",kernelFunc:kNe};function INe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=r,d=N.computeConv2DInfo(u,i.shape,s,o,l,c,!0),p=new wNe(d);return n.runWebGLProgram(p,[a,i],"float32")}var CNe={kernelName:Ox,backendName:"webgl",kernelFunc:INe},_Ne=class{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}};function TNe(e){let{inputs:t,backend:n}=e,{x:r}=t,a=[...r.shape,...r.shape],i=k.sizeFromShape(r.shape),s=be({inputs:{x:r},backend:n,attrs:{shape:[i]}}),o=new _Ne(i),l=n.runWebGLProgram(o,[s],s.dtype),c=be({inputs:{x:l},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),c}var NNe={kernelName:kg,backendName:"webgl",kernelFunc:TNe},ENe=class{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let{inHeight:t,inWidth:n,padInfo:r,strideHeight:a,strideWidth:i,filterHeight:s,filterWidth:o,dilationHeight:l,dilationWidth:c}=e,{top:u,left:d}=r;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${i});
      const ivec2 pads = ivec2(${u}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${s}; h++) {
          int hIn = hBeg + h * ${l};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${o}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${n}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}};function $Ne(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r,c=N.computeDilation2DInfo(a.shape,i.shape,s,o,"NHWC",l),u,d=new ENe(c);u=n.runWebGLProgram(d,[a,i],"float32");let p=be({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),p}var ANe={kernelName:Yu,backendName:"webgl",kernelFunc:$Ne};function RNe(e){let{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,i=t,{allDims:s,summedDims:o,idDims:l}=N.decodeEinsumEquation(a,i.length);N.checkEinsumDimSizes(s.length,l,i);let{path:c,steps:u}=N.getEinsumComputePath(o,l),d=u.length,p=null,h=s.length,f=[];for(let m=0;m<d;++m){for(let g of u[m]){let{permutationIndices:y,expandDims:b}=N.getEinsumPermutation(h,l[g]),v;N.isIdentityPermutation(y)?v=i[g]:(v=Nr({inputs:{x:i[g]},backend:n,attrs:{perm:y}}),f.push(v));let x=v.shape.slice();for(let w=0;w<b.length;++w)x.splice(b[w],0,1);k.arraysEqual(v.shape,x)||(v=be({inputs:{x:v},backend:n,attrs:{shape:x}}),f.push(v)),p===null?p=v:(p=CE({inputs:{a:v,b:p},backend:n}),f.push(p))}m<d-1&&(c[m]>=0&&(p=Z1({inputs:{x:p},backend:n,attrs:{axis:c[m]-(s.length-h),keepDims:!1}}),f.push(p)),h--)}for(let m of f)m!==p&&n.disposeIntermediateTensorInfo(m);return p}var FNe={kernelName:Px,backendName:"webgl",kernelFunc:RNe},DNe="return (x >= 0.0) ? x : (exp(x) - 1.0);",MNe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,ONe=ft({opSnippet:DNe,packedOpSnippet:MNe}),PNe={kernelName:Qu,backendName:"webgl",kernelFunc:ONe},zNe="return (b >= 0.0) ? a : a * (b + 1.0);",LNe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,BNe=e=>{let{inputs:t,backend:n}=e,{dy:r,y:a}=t,i=Q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ef(LNe,r.shape,a.shape):new ku(zNe,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)},WNe={kernelName:Yp,backendName:"webgl",kernelFunc:BNe},VNe=`
  return vec4(equal(a, b));
`,UNe="return float(a == b);",jNe=sr({opSnippet:UNe,packedOpSnippet:VNe,dtype:"bool",cpuKernelImpl:x2e}),HNe={kernelName:Zp,backendName:"webgl",kernelFunc:jNe},GNe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${N.ERF_P};
  float a1 = ${N.ERF_A1};
  float a2 = ${N.ERF_A2};
  float a3 = ${N.ERF_A3};
  float a4 = ${N.ERF_A4};
  float a5 = ${N.ERF_A5};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,qNe=ft({opSnippet:GNe}),KNe={kernelName:Ju,backendName:"webgl",kernelFunc:qNe},XNe=tf+`
  return exp(x);
`,YNe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,JU=ft({opSnippet:XNe,packedOpSnippet:YNe,cpuKernelImpl:w2e,dtype:"float32"}),ZNe={kernelName:ec,backendName:"webgl",kernelFunc:JU};function WI(e){let{inputs:t,attrs:n,backend:r}=e,{dim:a}=n,{input:i}=t,s=i.shape.length,o=i.shape.slice(),l=a;return a<0&&(k.assert(-(s+1)<=a,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+a+1),o.splice(l,0,1),be({inputs:{x:i},backend:r,attrs:{shape:o}})}var QNe={kernelName:Qp,backendName:"webgl",kernelFunc:WI},WD="return exp(x) - 1.0;",JNe=ft({opSnippet:WD,packedOpSnippet:WD,cpuKernelImpl:k2e}),eEe={kernelName:tc,backendName:"webgl",kernelFunc:JNe},VD=class{constructor(e,t,n){this.variableNames=["real","imag"];let r=t[1];this.outputShape=t;let a=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=n?`${r}.0`:"1.0",s;if(e==="real")s="return real * expR - imag * expI;";else if(e==="imag")s="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${s}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}};function e6(e,t,n){let r=n.texData.get(e.dataId),a=k.sizeFromShape(e.shape),i=e.shape[e.shape.length-1],s=a/i,o=be({inputs:{x:e},backend:n,attrs:{shape:[s,i]}}),l=o.shape,c=new VD("real",l,t),u=new VD("imag",l,t),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],p=n.runWebGLProgram(c,d,"float32"),h=n.runWebGLProgram(u,d,"float32"),f=ul({inputs:{real:p,imag:h},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h);let m=be({inputs:{x:f},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(f),m}function tEe(e){let{inputs:t,backend:n}=e,{input:r}=t;return e6(r,!1,n)}var nEe={kernelName:zx,backendName:"webgl",kernelFunc:tEe},rEe=class{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}};function by(e){let{backend:t,attrs:n}=e,{shape:r,value:a}=n,{dtype:i}=n;if(i=i||k.inferDtype(a),i==="string"){let s=k.getArrayFromDType(i,k.sizeFromShape(r));return s.fill(a),t.makeTensorInfo(r,i,s)}else{let s=new rEe(r,a),o=[[a]];return t.runWebGLProgram(s,[],i,o)}}var aEe={kernelName:Sg,backendName:"webgl",kernelFunc:by},iEe=class{constructor(e){this.variableNames=["Image"],this.outputShape=[];let t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}},sEe={kernelName:Jp,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{let{image:n}=e,r=t,a=new iEe(n.shape);return r.runWebGLProgram(a,[n],n.dtype)}},UD="return floor(x);",oEe=ft({opSnippet:UD,packedOpSnippet:UD,cpuKernelImpl:S2e}),lEe={kernelName:nc,backendName:"webgl",kernelFunc:oEe},uEe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,cEe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,dEe=sr({opSnippet:uEe,packedOpSnippet:cEe,dtype:"int32"}),pEe={kernelName:rc,backendName:"webgl",kernelFunc:dEe},hEe=class{constructor(e){this.variableNames=["A"];let t=Fr(),[n,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}},fEe=class{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let t=Fr(),[n,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${n}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}},mEe={kernelName:Zb,backendName:"webgl",kernelFunc:gEe},gd,vk=Q().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function gEe(e){let{inputs:t,backend:n,attrs:r}=e,{pixels:a}=t,{numChannels:i}=r,s=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,[l,c]=s?[a.videoWidth,a.videoHeight]:[a.width,a.height],u=[c,l],d=[c,l,i];if(o||s){let m=Q().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(gd==null||m!==vk)&&(vk=m,gd=document.createElement("canvas").getContext("2d",{willReadFrequently:vk})),gd.canvas.width=l,gd.canvas.height=c,gd.drawImage(a,0,0,l,c),a=gd.canvas}let p=n.makeTensorInfo(u,"int32");n.texData.get(p.dataId).usage=Ca.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);let h=Q().getBool("WEBGL_PACK")?new fEe(d):new hEe(d),f=n.runWebGLProgram(h,[p],"int32");return n.disposeData(p.dataId),f}function yEe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=r,m=N.convertConv2DDataFormat(u),g=N.computeConv2DInfo(a.shape,i.shape,l,d,c,p,!1,m),y,b=[],v=s!=null,x=o!=null,w=h==="leakyrelu",S=()=>{let T=[a,i],E=(R,$)=>{if($==="NCHW"&&R.shape.length===1&&R.shape[0]!==1){let _=be({inputs:{x:R},backend:n,attrs:{shape:[R.shape[0],1,1]}});return b.push(_),_}return R};if(v&&T.push(E(s,u)),x&&T.push(E(o,u)),w){let R=n.makeTensorInfo([],"float32",k.createScalarValue(f,"float32"));T.push(R),b.push(R)}return T};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))y=KU({x:a,filter:i,convInfo:g,backend:n,bias:s,activation:h,preluActivationWeights:o,leakyreluAlpha:f});else if(g.strideWidth<=2&&m==="channelsLast"&&Q().getBool("WEBGL_EXP_CONV")){let T=h?Jm(h,!0):null,E=new qU(g,v,T,x,w),R=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],$=S();y=n.runWebGLProgram(E,$,"float32",R)}else if(Q().getBool("WEBGL_CONV_IM2COL"))y=XU({x:a,filter:i,convInfo:g,backend:n,bias:s,activation:h,preluActivationWeights:o,leakyreluAlpha:f});else{let T=h?Jm(h,!1):null,E=new GU(g,v,T,x,w),R=S();y=n.runWebGLProgram(E,R,"float32")}let C=be({inputs:{x:y},backend:n,attrs:{shape:g.outShape}});return b.push(y),b.forEach(T=>n.disposeIntermediateTensorInfo(T)),C}var bEe={kernelName:su,backendName:"webgl",kernelFunc:yEe};function vEe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:p,leakyreluAlpha:h}=r,f=[],m=u;m==null&&(m=[1,1]),k.assert(N.eitherStridesOrDilationsAreOne(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);let g=N.computeConv2DInfo(a.shape,i.shape,l,m,c,d,!0),y=Q().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,b=p?Jm(p,y):null,v=[a,i],x=s!=null,w=o!=null,S=p==="leakyrelu";if(x&&v.push(s),w&&v.push(o),S){let R=n.makeTensorInfo([],"float32",k.createScalarValue(h,"float32"));v.push(R),f.push(R)}let C;y?C=new QU(g,x,b,w,S):C=new ZU(g,x,b,w,S);let T=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],E=n.runWebGLProgram(C,v,"float32",T);return f.forEach(R=>n.disposeIntermediateTensorInfo(R)),E}var xEe={kernelName:ou,backendName:"webgl",kernelFunc:vEe},wEe=class{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;let a=At(n.length),i=`
    int index;`;for(let s=0;s<this.sliceDim;s++)i+=`
          index = round(getIndices(coords[0], ${s}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[s]};
          flattenIndex += index * ${this.strides[s]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}};function kEe(e){let{inputs:t,backend:n}=e,{params:r,indices:a}=t,i=a.shape,s=i[i.length-1],o=k.sizeFromShape(r.shape),[l,c,u,d]=N.prepareAndValidate(r,a),p=be({inputs:{x:a},backend:n,attrs:{shape:[c,s]}}),h=be({inputs:{x:r},backend:n,attrs:{shape:[k.sizeFromShape(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,a])||r.dtype==="string"){let y=n.readSync(a.dataId),b=n.bufferSync(r),v=I2e(y,b,r.dtype,c,s,u,d,r.shape,o);return n.makeTensorInfo(l,r.dtype,v.values)}let f=new wEe(s,d,[c,u],r.shape),m=n.runWebGLProgram(f,[h,p],h.dtype),g=be({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),g}var SEe={kernelName:th,backendName:"webgl",kernelFunc:kEe},IEe=class{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;let n=At(this.rank),r=CEe(e);this.userCode=`
      void main() {
        ${n} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}};function CEe(e,t){let n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let a=0;a<e.length;a++)a===2?r.push("index"):r.push(`${n[a]}`);return r.join()}function t6(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,indices:i}=t,{axis:s,batchDims:o}=r,l=k.parseAxisParam(s,a.shape)[0];if(Q().get("DEBUG")){let b=n.readSync(i.dataId),v=a.shape[l];for(let x=0;x<b.length;++x){let w=b[x];k.assert(w<=v-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${v-1}]`)}}let c=N.segment_util.collectGatherOpShapeInfo(a,i,l,o),u=k.sizeFromShape(i.shape),d=[],p=be({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),h=be({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(p),d.push(h);let f=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([a,i])||a.dtype==="string"){let b=n.bufferSync(h),v=n.bufferSync(p),x=C2e(v,b,f);return d.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(c.outputShape,x.dtype,x.values)}let m=new IEe(p.shape,f),g=n.runWebGLProgram(m,[p,h],p.dtype);d.push(g);let y=be({inputs:{x:g},backend:n,attrs:{shape:c.outputShape}});return d.forEach(b=>n.disposeIntermediateTensorInfo(b)),y}var _Ee={kernelName:eh,backendName:"webgl",kernelFunc:t6},TEe="return float(a > b);",NEe=`
  return vec4(greaterThan(a, b));
`,EEe=sr({opSnippet:TEe,packedOpSnippet:NEe,cpuKernelImpl:_2e,dtype:"bool"}),$Ee={kernelName:nh,backendName:"webgl",kernelFunc:EEe},AEe="return float(a >= b);",REe=`
  return vec4(greaterThanEqual(a, b));
`,FEe=sr({opSnippet:AEe,packedOpSnippet:REe,dtype:"bool",cpuKernelImpl:T2e}),DEe={kernelName:ic,backendName:"webgl",kernelFunc:FEe};function MEe(e){let{inputs:t,backend:n}=e,{input:r}=t;return e6(r,!0,n)}var OEe={kernelName:Lx,backendName:"webgl",kernelFunc:MEe},PEe="return float(!isnan(x) && !isinf(x));",zEe=ft({opSnippet:PEe,dtype:"bool"}),LEe={kernelName:oc,backendName:"webgl",kernelFunc:zEe},BEe="return float(isinf(x));",WEe=ft({opSnippet:BEe,dtype:"bool"}),VEe={kernelName:lc,backendName:"webgl",kernelFunc:WEe},UEe="return float(isnan(x));",jEe=ft({opSnippet:UEe,dtype:"bool"}),HEe={kernelName:uc,backendName:"webgl",kernelFunc:jEe},GEe="return float(a < b);",qEe=`
  return vec4(lessThan(a, b));
`,KEe=sr({opSnippet:GEe,packedOpSnippet:qEe,cpuKernelImpl:N2e,dtype:"bool"}),XEe={kernelName:rh,backendName:"webgl",kernelFunc:KEe},YEe="return float(a <= b);",ZEe=`
  return vec4(lessThanEqual(a, b));
`,QEe=sr({opSnippet:YEe,packedOpSnippet:ZEe,cpuKernelImpl:E2e,dtype:"bool"}),JEe={kernelName:ah,backendName:"webgl",kernelFunc:QEe};function e$e(e){let{backend:t,attrs:n}=e,{start:r,stop:a,num:i}=n,s=$2e(r,a,i);return t.makeTensorInfo([s.length],"float32",s)}var t$e={kernelName:ih,backendName:"webgl",kernelFunc:e$e},n$e=tf+`
  return x < 0.0 ? 0./0. : log(x);
`,r$e=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,a$e=ft({opSnippet:n$e,packedOpSnippet:r$e,cpuKernelImpl:A2e}),i$e={kernelName:dc,backendName:"webgl",kernelFunc:a$e},s$e=tf+`
  return log(1.0 + x);
`,o$e=ft({opSnippet:s$e}),l$e={kernelName:pc,backendName:"webgl",kernelFunc:o$e},u$e="return float(a >= 1.0 && b >= 1.0);",c$e=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,d$e=sr({opSnippet:u$e,packedOpSnippet:c$e,dtype:"bool"}),p$e={kernelName:sh,backendName:"webgl",kernelFunc:d$e},h$e="return float(!(x >= 1.0));",f$e=ft({opSnippet:h$e}),m$e={kernelName:oh,backendName:"webgl",kernelFunc:f$e},g$e="return float(a >= 1.0 || b >= 1.0);",y$e=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,b$e=sr({opSnippet:g$e,packedOpSnippet:y$e,dtype:"bool"}),v$e={kernelName:lh,backendName:"webgl",kernelFunc:b$e},x$e=class{constructor(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[];let i=t,s=e[3]-1;this.outputShape=e;let o,l=`float(${n}) + float(${r}) * sum`;a===.5?o=`inversesqrt(${l})`:a===1?o=`1.0/(${l})`:o=`exp(log(${l}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${s}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${o};
        setOutput(val);
      }
    `}},w$e=class{constructor(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let i=t,s=e[3]-1;this.outputShape=e;let o,l=`float(${n}) + float(${r}) * sum`;a===.5?o=`inversesqrt(${l})`:a===1?o=`1.0/(${l})`:o=`exp(log(${l}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${s}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${o};
        setOutput(result);
      }
    `}},k$e=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=r,c=Q().getBool("WEBGL_PACK_NORMALIZATION")?new w$e(a.shape,i,s,o,l):new x$e(a.shape,i,s,o,l);return n.runWebGLProgram(c,[a],a.dtype)},S$e={kernelName:hc,backendName:"webgl",kernelFunc:k$e},I$e=class{constructor(e,t,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${n});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${a})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}},C$e=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=r,d=new I$e(a.shape,o,l,c,u);return n.runWebGLProgram(d,[a,i,s],a.dtype)},_$e={kernelName:uh,backendName:"webgl",kernelFunc:C$e};function T$e(e,t,n,r){let a=k.sizeFromShape(t),i=k.sizeFromShape(e.shape)/a,s=be({inputs:{x:e},attrs:{shape:[i,a]},backend:r}),o=id(s,e.dtype,"max",r),l=be({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(o),l}function n6(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:i,keepDims:s}=r,o=a.shape.length,l=k.parseAxisParam(i,a.shape),c=l,u=N.getAxesPermutation(c,o),d=u!=null,p=n.shouldExecuteOnCPU([a]),h=a;if(d){if(p){let b=n.texData.get(h.dataId).values,v=new Array(o);for(let S=0;S<v.length;S++)v[S]=a.shape[u[S]];let x=SE(b,a.shape,a.dtype,u,v);h=n.makeTensorInfo(v,a.dtype);let w=n.texData.get(h.dataId);w.values=x}else h=Y1(a,u,n);c=N.getInnerMostAxes(c.length,o)}N.assertAxesAreInnerMostDims("max",c,o);let[f,m]=N.computeOutAndReduceShapes(h.shape,c),g=f;s&&(g=N.expandShapeToKeepDim(f,l));let y;if(p){let b=n.texData.get(h.dataId).values,v=R2e(b,k.sizeFromShape(m),g,a.dtype);y=n.makeTensorInfo(g,a.dtype);let x=n.texData.get(y.dataId);x.values=v}else y=T$e(h,m,g,n);return d&&n.disposeIntermediateTensorInfo(h),y}var N$e={kernelName:fc,backendName:"webgl",kernelFunc:n6},E$e=IE+`
  return max(a, b);
`,$$e=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ad+`
  return result;
`,A$e=sr({opSnippet:E$e,packedOpSnippet:$$e,cpuKernelImpl:F2e}),R$e={kernelName:mc,backendName:"webgl",kernelFunc:A$e};function F$e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;Xh(a,"maxPool");let{filterSize:i,strides:s,pad:o,dimRoundingMode:l}=r,c=1;k.assert(N.eitherStridesOrDilationsAreOne(s,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);let u=N.computePool2DInfo(a.shape,i,s,c,o,l);if(u.filterWidth===1&&u.filterHeight===1&&k.arraysEqual(u.inShape,u.outShape))return ma({inputs:{x:a},backend:n});let d=new eg(u,"max",!1);return n.runWebGLProgram(d,[a],a.dtype)}var D$e={kernelName:gc,backendName:"webgl",kernelFunc:F$e};function M$e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dataFormat:l,dimRoundingMode:c}=r,u=[1,1,1],d=N.computePool3DInfo(a.shape,i,s,u,o,c,l),p=new _E(d,"max",!1);return n.runWebGLProgram(p,[a],a.dtype)}var O$e={kernelName:ch,backendName:"webgl",kernelFunc:M$e},P$e=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,s=a-1-e.padInfo.top,o=i-1-e.padInfo.left,l=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${n}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}},z$e=class{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,s=e.dilationWidth,o=e.effectiveFilterDepth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=o-1-e.padInfo.front,d=l-1-e.padInfo.top,p=c-1-e.padInfo.left,h=o*l*c-1;this.userCode=`
      const ivec3 pads = ivec3(${u}, ${d}, ${p});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${o};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${l};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${n}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${s}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${h} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${l} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function L$e(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,s=i,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=r,d=[1,1,1],p=N.computePool3DInfo(s.shape,o,l,d,c,u),h=new _E(p,"max",!0),f=n.runWebGLProgram(h,[s],s.dtype),m=new z$e(p),g=n.runWebGLProgram(m,[a,f],s.dtype);return n.disposeIntermediateTensorInfo(f),g}var B$e={kernelName:Cg,backendName:"webgl",kernelFunc:L$e};function W$e(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i,output:s}=t,o=i;Xh([i,s],"maxPoolGrad");let{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=r,p=N.computePool2DInfo(o.shape,l,c,1,u,d),h=!0,f=new eg(p,"max",h),m=n.runWebGLProgram(f,[o],o.dtype),g=new P$e(p),y=n.runWebGLProgram(g,[a,m],o.dtype);return n.disposeIntermediateTensorInfo(m),y}var V$e={kernelName:Ig,backendName:"webgl",kernelFunc:W$e};function U$e(e,t,n,r){let a=new eg(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");a=new eg(n,"max",!0,!0,t);let s=r.runWebGLProgram(a,[e],"float32");return[i,s]}var j$e={kernelName:_g,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:a,strides:i,pad:s,includeBatchInIndex:o}=t,l=n;k.assert(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);let c=[1,1];k.assert(N.eitherStridesOrDilationsAreOne(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let u=N.computePool2DInfo(r.shape,a,i,c,s),[d,p]=U$e(r,o,u,l);return[d,p]}};function H$e(e,t,n,r){let a=k.sizeFromShape(t),i=k.sizeFromShape(e.shape)/a,s=be({inputs:{x:e},attrs:{shape:[i,a]},backend:r}),o=id(s,"float32","mean",r),l=be({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(o),l}var G$e={kernelName:yc,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{keepDims:a,axis:i}=t,s=n,o=r.shape.length,l=k.parseAxisParam(i,r.shape),c=l,u=N.getAxesPermutation(c,o),d=u!=null,p=s.shouldExecuteOnCPU([r]),h=[],f=r;if(d){if(p){let v=s.texData.get(f.dataId).values,x=new Array(o);for(let C=0;C<x.length;C++)x[C]=r.shape[u[C]];let w=SE(v,r.shape,r.dtype,u,x);f=s.makeTensorInfo(x,r.dtype);let S=s.texData.get(f.dataId);S.values=w}else f=Y1(r,u,s);h.push(f),c=N.getInnerMostAxes(c.length,o)}N.assertAxesAreInnerMostDims("sum",c,o);let[m,g]=N.computeOutAndReduceShapes(f.shape,c),y=m;a&&(y=N.expandShapeToKeepDim(m,l));let b=H$e(f,g,y,s);for(let v of h)s.disposeIntermediateTensorInfo(v);return b}};function q$e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=a.shape.length,l=k.parseAxisParam(i,a.shape),c=l,u=N.getAxesPermutation(c,o),d=a;u!=null&&(d=Nr({inputs:{x:a},backend:n,attrs:{perm:u}}),c=N.getInnerMostAxes(c.length,a.shape.length)),N.assertAxesAreInnerMostDims("min",c,o);let[p,h]=N.computeOutAndReduceShapes(d.shape,c),f=k.sizeFromShape(h),m=be({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),g=id(m,m.dtype,"min",n),y;if(s){let b=N.expandShapeToKeepDim(p,l);y=be({inputs:{x:g},backend:n,attrs:{shape:b}})}else y=be({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),y}var K$e={kernelName:bc,backendName:"webgl",kernelFunc:q$e},X$e=IE+`
  return min(a, b);
`,Y$e=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ad+`
  return result;
`,Z$e=sr({opSnippet:X$e,packedOpSnippet:Y$e,cpuKernelImpl:D2e}),Q$e={kernelName:vc,backendName:"webgl",kernelFunc:Z$e},J$e=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((c,u)=>c[0]+e[u]+c[1]);let r=e.length,a=At(r),i=t.map(c=>c[0]).join(","),s=t.map((c,u)=>c[0]+e[u]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),l=n==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${i};
        int end = ${s};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${l};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${l};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${s});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${l};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${o}));
      }
    `}},eAe=class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((h,f)=>h[0]+e[f]+h[1]);let r=e.length,a=At(r),i=t.map(h=>h[0]).join(","),s=t.map((h,f)=>h[0]+e[f]).join(","),o=kr("rc",r),l=kr("source",r),c=`${o[r-1]} < ${this.outputShape[r-1]}`,u=r===1?"source":`vec2(${l.slice(-2).join()})`,d=n==="reflect"?0:1,p="";if(r===1){let h=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;p=`
        ${a} rc = outputLoc;
        ${h}
        result[0] = getChannel(getX(${l.join()}), ${u});
        ${o[r-1]} += 1;
        if(${c}) {
          ${h}
          result[1] = getChannel(getX(${l.join()}), ${u});
        }
      `}else{let h=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;p=`
        ${a} rc = outputLoc;
        ${h}
        result[0] = getChannel(getX(${l.join()}), ${u});
        ${o[r-1]} += 1;
        if(${c}) {
          ${h}
          result[1] = getChannel(getX(${l.join()}), ${u});
        }
        rc = outputLoc;
        ${o[r-2]} += 1;
        if(${o[r-2]} < ${this.outputShape[r-2]}) {
          ${h}
          result[2] = getChannel(getX(${l.join()}), ${u});
          ${o[r-1]} += 1;
          if(${c}) {
            ${h}
            result[3] = getChannel(getX(${l.join()}), ${u});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${s});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}},tAe=({inputs:e,backend:t,attrs:n})=>{let{x:r}=e,{paddings:a,mode:i}=n,s=Q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new eAe(r.shape,a,i):new J$e(r.shape,a,i);return t.runWebGLProgram(s,[r],r.dtype)},nAe={kernelName:xc,backendName:"webgl",kernelFunc:tAe},rAe=`if (b == 0.0) return NAN;
  return mod(a, b);`,aAe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+ad+`
  return result;
`,iAe=sr({opSnippet:rAe,packedOpSnippet:aAe}),sAe={kernelName:wc,backendName:"webgl",kernelFunc:iAe},oAe=class{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}},lAe=`
if (a == b) {
  return 1.0;
};
return a / b;`,uAe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,r6=sr({opSnippet:lAe,packedOpSnippet:uAe,checkOutOfBounds:!0}),cAe={kernelName:Zu,backendName:"webgl",kernelFunc:r6},jD="return a - b;",a6=sr({opSnippet:jD,packedOpSnippet:jD,supportsComplex:!0,cpuKernelImpl:tCe}),dAe={kernelName:Gc,backendName:"webgl",kernelFunc:a6};function i6(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:i}=r,s=k.parseAxisParam([i],a.shape),o=n6({inputs:{x:a},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),l=N.expandShapeToKeepDim(o.shape,s),c=be({inputs:{x:o},backend:n,attrs:{shape:l}}),u=a6({inputs:{a,b:c},backend:n}),d=JU({inputs:{x:u},backend:n}),p=Z1({inputs:{x:d},backend:n,attrs:{axis:s,keepDims:!1}}),h=be({inputs:{x:p},backend:n,attrs:{shape:l}}),f=r6({inputs:{a:d,b:h},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),f}var pAe={kernelName:jc,backendName:"webgl",kernelFunc:i6};function hAe(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:s,normalized:o}=r,l=o?a:i6({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new oAe(c,u,i),p=[[s]],h=n.runWebGLProgram(d,[l],"int32",p);return o||n.disposeIntermediateTensorInfo(l),h}var fAe={kernelName:dh,backendName:"webgl",kernelFunc:hAe},mAe=li+`
  return -x;
`,gAe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function yAe(e){let{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){let i=n.texData.get(r.dataId),[s,o]=O2e(i.values,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,s)}let a;return Q().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new mo(r.shape,gAe):a=new Ui(r.shape,mAe),n.runWebGLProgram(a,[r],r.dtype)}var bAe={kernelName:ph,backendName:"webgl",kernelFunc:yAe},vAe=rs.nonMaxSuppressionV3Impl;function xAe(e){N.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=r,c=n.readSync(a.dataId),u=n.readSync(i.dataId),{selectedIndices:d}=vAe(c,u,s,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}var wAe={kernelName:fh,backendName:"webgl",kernelFunc:xAe},kAe=rs.nonMaxSuppressionV4Impl;function SAe(e){N.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=r,u=n.readSync(a.dataId),d=n.readSync(i.dataId),{selectedIndices:p,validOutputs:h}=kAe(u,d,s,o,l,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}var IAe={kernelName:mh,backendName:"webgl",kernelFunc:SAe},CAe=rs.nonMaxSuppressionV5Impl;function _Ae(e){N.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=r,u=n.readSync(a.dataId),d=n.readSync(i.dataId),p=s,h=o,f=l,m=c,{selectedIndices:g,selectedScores:y}=CAe(u,d,p,h,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}var TAe={kernelName:gh,backendName:"webgl",kernelFunc:_Ae},NAe=class{constructor(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${n}),
                      float(index == coords.y)));
      }
    `}},EAe=e=>{let{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:s,onValue:o,offValue:l}=r,c=k.sizeFromShape(a.shape),u=new NAe(c,s,o,l),d=be({inputs:{x:a},backend:n,attrs:{shape:[c]}}),p=n.runWebGLProgram(u,[d],i);n.disposeIntermediateTensorInfo(d);let h=[...a.shape,s],f=be({inputs:{x:p},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(p),f},$Ae={kernelName:Sc,backendName:"webgl",kernelFunc:EAe};function kv(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="complex64"){let a=yy({inputs:{input:r},backend:n}),i=kv({inputs:{x:a},backend:n}),s=Q1({inputs:{input:r},backend:n}),o=kv({inputs:{x:s},backend:n}),l=ul({inputs:{real:i,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return by({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}var AAe={kernelName:Mh,backendName:"webgl",kernelFunc:kv};function s6(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){let a=yy({inputs:{input:r},backend:n}),i=s6({inputs:{x:a},backend:n}),s=Q1({inputs:{input:r},backend:n}),o=kv({inputs:{x:s},backend:n}),l=ul({inputs:{real:i,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return by({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}var RAe={kernelName:yh,backendName:"webgl",kernelFunc:s6};function FAe(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(t.length===1)return WI({inputs:{input:t[0]},backend:n,attrs:{dim:a}});let i=t[0].shape,s=t[0].dtype;t.forEach(u=>{k.assertShapesMatch(i,u.shape,"All tensors passed to stack must have matching shapes"),k.assert(s===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=t.map(u=>{let d=WI({inputs:{input:u},backend:n,attrs:{dim:a}});return o.push(d),d}),c=HU({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}var DAe={kernelName:bh,backendName:"webgl",kernelFunc:FAe},MAe=class{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((l,c)=>l[0]+e[c]+l[1]);let r=e.length,a=At(r),i=t.map(l=>l[0]).join(","),s=t.map((l,c)=>l[0]+e[c]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${i};
        int end = ${s};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${s});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${o}));
        }
      }
    `}},OAe=class{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((f,m)=>f[0]+e[m]+f[1]);let r=e.length,a=At(r),i=t.map(f=>f[0]).join(","),s=t.map((f,m)=>f[0]+e[m]).join(","),o=kr("rc",r),l=kr("source",r),c=`${o[r-1]} < ${this.outputShape[r-1]}`,u=r===1?"source":`vec2(${l.slice(-2).join()})`,d=[`${a} rc = outputLoc;`,`${o[r-1]} += 1;
       if(${c}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${o[r-2]} += 1;
       if(${o[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${o[r-1]} += 1;
         if(${c}) {`],p=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="";for(let f=0,m=r===1?2:4;f<m;f++)h+=`
        ${d[f]}
        if (${p}) {
          result[${f}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${f}] = getChannel(getX(${l.join()}), ${u});
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${s});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}},o6=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,constantValue:s}=r;if(k.sizeFromShape(a.shape)===0){let c=i.map((u,d)=>u[0]+a.shape[d]+u[1]);return by({backend:n,attrs:{shape:c,value:s,dtype:a.dtype}})}let o=Q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new OAe(a.shape,i,s):new MAe(a.shape,i,s),l=[[s]];return n.runWebGLProgram(o,[a],a.dtype,l)},PAe={kernelName:Ic,backendName:"webgl",kernelFunc:o6},zAe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,LAe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+ad+`
  return result;
`,BAe=sr({opSnippet:zAe,packedOpSnippet:LAe}),WAe={kernelName:Cc,backendName:"webgl",kernelFunc:BAe};function VAe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:s}=r,o=a.shape.length,l=[],c=k.parseAxisParam(i,a.shape),u=c,d=N.getAxesPermutation(u,o),p=a;d!=null&&(p=Nr({inputs:{x:a},backend:n,attrs:{perm:d}}),u=N.getInnerMostAxes(u.length,o),l.push(p)),N.assertAxesAreInnerMostDims("prod",u,o);let h;if(n.shouldExecuteOnCPU([p])){let f=n.texData.get(p.dataId).values,{outVals:m,outShape:g,outDtype:y}=z2e(p.shape,p.dtype,f,u);h=n.makeTensorInfo(g,y,m)}else{let[f,m]=N.computeOutAndReduceShapes(p.shape,u),g=k.sizeFromShape(m),y=be({inputs:{x:p},backend:n,attrs:{shape:[-1,g]}}),b=Gx(a.dtype),v=id(y,b,"prod",n);h=be({inputs:{x:v},backend:n,attrs:{shape:f}}),l.push(y),l.push(v)}if(s){l.push(h);let f=N.expandShapeToKeepDim(h.shape,c);h=be({inputs:{x:h},backend:n,attrs:{shape:f}})}return l.forEach(f=>n.disposeIntermediateTensorInfo(f)),h}var UAe={kernelName:Tc,backendName:"webgl",kernelFunc:VAe};function jAe(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:i,indices:s}=t,{outputRaggedRank:o}=r,l=a.map(y=>n.readSync(y.dataId)),c=a.map(y=>y.shape),u=n.readSync(i.dataId),d=n.readSync(s.dataId),[p,h,f]=L2e(l,c,u,i.shape,i.dtype,d,s.shape,o),m=p.map(y=>n.makeTensorInfo([y.length],"int32",y)),g=n.makeTensorInfo(f,i.dtype,h);return m.concat([g])}var HAe={kernelName:Wx,backendName:"webgl",kernelFunc:jAe};function GAe(e){let{inputs:t,backend:n}=e,{starts:r,limits:a,deltas:i}=t,s=n.readSync(r.dataId),o=n.readSync(a.dataId),l=n.readSync(i.dataId),[c,u]=B2e(s,r.shape,r.dtype,o,a.shape,l,i.shape),d=n.makeTensorInfo([c.length],"int32",c),p=n.makeTensorInfo([u.length],r.dtype,u);return[d,p]}var qAe={kernelName:Vx,backendName:"webgl",kernelFunc:GAe};function KAe(e){let{inputs:t,backend:n,attrs:r}=e,{shape:a,values:i,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,c=n.readSync(a.dataId),u=n.readSync(i.dataId),d=n.readSync(s.dataId),p=o.map(g=>n.readSync(g.dataId)),h=o.map(g=>g.shape),[f,m]=W2e(c,a.shape,u,i.shape,i.dtype,d,s.shape,p,h,l);return n.makeTensorInfo(f,i.dtype,m)}var XAe={kernelName:Ux,backendName:"webgl",kernelFunc:KAe},l6=e=>{let{backend:t,attrs:n}=e,{start:r,stop:a,step:i,dtype:s}=n,o=V2e(r,a,i,s);return t.makeTensorInfo([o.length],s,o)},YAe={kernelName:Tg,backendName:"webgl",kernelFunc:l6},ZAe="return 1.0 / x;",QAe=ft({opSnippet:ZAe}),JAe={kernelName:Nc,backendName:"webgl",kernelFunc:QAe},eRe=li+`
  return (x < 0.0) ? 0.0 : x;
`,tRe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,nRe=ft({opSnippet:eRe,packedOpSnippet:tRe}),rRe={kernelName:Ec,backendName:"webgl",kernelFunc:nRe},aRe=li+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,iRe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,sRe=ft({opSnippet:aRe,packedOpSnippet:iRe}),oRe={kernelName:Rc,backendName:"webgl",kernelFunc:sRe},lRe=class{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let c=[r&&t>1?s-1:s,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d;a?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/u[0]},
          ${c[1]/u[1]});
      const vec2 inputShapeRC = vec2(${s}.0, ${o}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}},uRe=class{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let c=[r&&t>1?s-1:s,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d;a?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/u[0]},
          ${c[1]/u[1]},
          ${c[1]/u[1]});
      const vec3 inputShapeRC = vec3(${s}.0, ${o}.0,
                                     ${o}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${n-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}};function cRe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r,[l,c]=o,u=Q().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new uRe(a.shape,l,c,i,s):new lRe(a.shape,l,c,i,s);return n.runWebGLProgram(u,[a],"float32")}var dRe={kernelName:Ac,backendName:"webgl",kernelFunc:cRe},pRe=class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,r,a]=t,[,i,s]=e,o=[n&&i>1?r-1:r,n&&s>1?a-1:a],l=[n&&i>1?i-1:i,n&&s>1?s-1:s],c=o[0]/l[0],u=o[1]/l[1],d=1/c,p=1/u,h=Math.ceil(d)*2+2,f=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${u});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${p});

        const int winHeight = int(${h});
        const int winWidth = int(${f});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${s}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function hRe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r,o=new pRe(i.shape,a.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}var fRe={kernelName:wh,backendName:"webgl",kernelFunc:hRe},mRe=class{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let c=[r&&t>1?s-1:s,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?"0.5":"0.0",p;a?p="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/u[0]},
          ${c[1]/u[1]});
      const vec2 inputShapeRC = vec2(${s}.0, ${o}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}},gRe=class{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,s,o,l]=e;this.outputShape=[i,t,n,l];let c=[r&&t>1?s-1:s,r&&n>1?o-1:o],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?"0.5":"0.0",p;a?p="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/u[0]},
          ${c[1]/u[1]},
          ${c[1]/u[1]});
      const vec3 inputShapeRC = vec3(${s}.0, ${o}.0,
                                     ${o}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${n-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}};function yRe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:s,size:o}=r,[l,c]=o,u=Q().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new gRe(a.shape,l,c,i,s):new mRe(a.shape,l,c,i,s);return n.runWebGLProgram(u,[a],a.dtype)}var bRe={kernelName:$c,backendName:"webgl",kernelFunc:yRe},vRe=class{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,r,a]=t,[,i,s]=e,o=[n&&i>1?r-1:r,n&&s>1?a-1:a],l=[n&&i>1?i-1:i,n&&s>1?s-1:s],c=o[0]/l[0],u=o[1]/l[1],d=1/c,p=1/u,h=Math.ceil(d)*2+2,f=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${u});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${p});

        const int winHeight = int(${h});
        const int winWidth = int(${f});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${s}) {
              continue;
            }

            float sourceFracRow =
              float(${o[0]}) *
                (float(dyR) / float(${l[0]}));

            float sourceFracCol =
                float(${o[1]}) *
                  (float(dyC) / float(${l[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${n} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${n} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function xRe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r,o=new vRe(i.shape,a.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}var wRe={kernelName:xh,backendName:"webgl",kernelFunc:xRe},kRe=class{constructor(e,t){this.variableNames=["x"];let n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=e,n===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}let r=s=>t.indexOf(s)!==-1&&e[s]!==1?`${e[s]} - coords[${s}] - 1`:`coords[${s}]`,a=e.map((s,o)=>r(o)).join(","),i=At(n);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}},SRe=class{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=e;let r=kr("rc",n),a=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,i=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,s=At(n);n===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${o(r.slice())};
          if(${a}){
            result.g = ${l(r.slice())};
          }
          if(${i}) {
            result.b = ${c(r.slice())};
            if(${a}) {
              result.a = ${u(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function o(h){return d(h)}function l(h){return h[n-1]="("+h[n-1]+" + 1)",d(h)}function c(h){return h[n-2]="("+h[n-2]+" + 1)",d(h)}function u(h){return h[n-1]="("+h[n-1]+" + 1)",h[n-2]="("+h[n-2]+" + 1)",d(h)}function d(h){let f=e.map((y,b)=>p(b,h)),m=f.join(","),g=f.slice(-2).join(",");return`getChannel(getX(${m}), vec2(${g}))`}function p(h,f){return t.indexOf(h)!==-1&&e[h]!==1?`${e[h]} - ${f[h]} - 1`:`${f[h]}`}}};function IRe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r,s=a.shape.length,o=k.parseAxisParam(i,a.shape);if(s===0)return ma({inputs:{x:a},backend:n});let l=Q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new SRe(a.shape,o):new kRe(a.shape,o);return n.runWebGLProgram(l,[a],a.dtype)}var CRe={kernelName:Fc,backendName:"webgl",kernelFunc:IRe},_Re=class{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let n=e[1],r=e[2];this.outputShape=e;let a="";typeof t=="number"?a=`float outputValue = ${t.toFixed(2)};`:a=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${n}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}},TRe={kernelName:Oh,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:a,fillValue:i,center:s}=t,o=n,l=new _Re(r.shape,i),[c,u]=N.getImageCenter(s,r.shape[1],r.shape[2]),d=[[c,u,Math.sin(a),Math.cos(a)]];return o.runWebGLProgram(l,[r],r.dtype,d)}},NRe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,ERe=ft({opSnippet:NRe}),$Re={kernelName:Dc,backendName:"webgl",kernelFunc:ERe},ARe="return inversesqrt(x);",RRe=ft({opSnippet:ARe,cpuKernelImpl:U2e}),FRe={kernelName:Mc,backendName:"webgl",kernelFunc:RRe},TE=class{constructor(e,t,n,r,a,i,s=!0,o=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;let l=At(a.length),c=At(i.length),u="";n===1?u="i":n===2&&(u="i, j");let d=`getIndices(${u})`,p="";r===1?p="i":r===2&&(p="i, coords[1]");let h=`getUpdates(${p})`,f="";o&&(f="coords[0], coords[1]");let m=`getDefaultValue(${f})`,g=t>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${a});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${h};
              found = true;
            }
          }
          setOutput(mix(${m}, sum, float(found)));
        }
      `}},DRe=class{constructor(e,t,n,r,a,i,s=!0,o=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;let l=At(a.length),c=At(i.length),u="";n===1?u="i":n===2&&(u="i, j");let d=`getIndices(${u})`,p="";r===1?p="i":r===2&&(p="i, coords[1]");let h=`getUpdates(${p})`,f="";o&&(f="coords[0], coords[1]");let m=`getDefaultValue(${f})`,g=t>1?"strides[j]":"strides",y=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${l} strides = ${l}(${a});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${g};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${y};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${h};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${m}, sum, found));
        }
      `}};function MRe(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:i}=t,{shape:s}=r,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=N.calculateShapes(i,a,s),p=[d/c,c];if(d===0)return n.makeTensorInfo(s,a.dtype);let h=be({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),f=be({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0])),g;Q().getBool("WEBGL_PACK")?g=new DRe(l,o,h.shape.length,f.shape.length,u,p):g=new TE(l,o,h.shape.length,f.shape.length,u,p);let y=n.runWebGLProgram(g,[f,h,m],f.dtype),b=be({inputs:{x:y},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),b}var ORe={kernelName:kh,backendName:"webgl",kernelFunc:MRe},PRe=class{constructor(e,t,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];let a="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,s=Q().getNumber("WEBGL_VERSION")===2?a:i,o=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${s}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${o} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}};function zRe(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:s}=r,o=new PRe(a.shape[0],a.shape[1],i.shape[1],s),l=[[a.shape[1]]];return n.runWebGLProgram(o,[a,i],"int32",l)}var LRe={kernelName:Ih,backendName:"webgl",kernelFunc:zRe},BRe=class{constructor(e,t,n){this.variableNames=["c","a","b"],this.outputShape=t;let r,a;if(n>4)throw Error(`Where for rank ${n} is not yet supported`);if(n===1)a="resRC",r="resRC";else{let s=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],l=[];for(let c=0;c<t.length;c++)l.push(`${s[c]}`),c<e&&o.push(`${s[c]}`);r=o.join(),a=l.join()}let i=At(n);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}};function WRe(e){let{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t,s=new BRe(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(s,[r,a,i],Fa(a.dtype,i.dtype))}var VRe={kernelName:Ch,backendName:"webgl",kernelFunc:WRe},URe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${N.SELU_SCALEALPHA};
  float scale = ${N.SELU_SCALE};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,jRe=ft({opSnippet:URe}),HRe={kernelName:Oc,backendName:"webgl",kernelFunc:jRe},GRe=tf+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,qRe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,KRe=ft({opSnippet:GRe,packedOpSnippet:qRe,cpuKernelImpl:H2e}),XRe={kernelName:Bc,backendName:"webgl",kernelFunc:KRe},YRe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,ZRe=ft({opSnippet:YRe}),QRe={kernelName:Lc,backendName:"webgl",kernelFunc:ZRe},JRe=tf+`
  return sin(x);
`,eFe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${ad}
  return result;
`,tFe=ft({opSnippet:JRe,packedOpSnippet:eFe}),nFe={kernelName:Pc,backendName:"webgl",kernelFunc:tFe},rFe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,aFe=ft({opSnippet:rFe}),iFe={kernelName:zc,backendName:"webgl",kernelFunc:aFe},sFe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,oFe=ft({opSnippet:sFe}),lFe={kernelName:Wc,backendName:"webgl",kernelFunc:oFe},uFe=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:s}=r;k.assert(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let o=i.reduce((y,b)=>y*b),l=[[0,0]];l.push(...s);for(let y=1+i.length;y<a.shape.length;++y)l.push([0,0]);let c=[],u=o6({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),d=N.getReshaped(u.shape,i,o,!1),p=N.getPermuted(d.length,i.length,!1),h=N.getReshapedPermuted(u.shape,i,o,!1),f=be({inputs:{x:u},backend:n,attrs:{shape:d}}),m=Nr({inputs:{x:f},backend:n,attrs:{perm:p}}),g=be({inputs:{x:m},backend:n,attrs:{shape:h}});return c.push(u),c.push(f),c.push(m),c.forEach(y=>n.disposeIntermediateTensorInfo(y)),g},cFe={kernelName:Th,backendName:"webgl",kernelFunc:uFe};function dFe(e){let{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:i,defaultValue:s}=t;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${a.shape}`);if(s.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${s.shape}`);let o=n.readSync(r.dataId),l=n.readSync(a.dataId),c=n.readSync(i.dataId),u=n.readSync(s.dataId)[0],[d,p,h,f,m]=q2e(o,r.shape,r.dtype,l,a.dtype,c,u);return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],a.dtype,h),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(g=>Number(g)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}var pFe={kernelName:Ng,backendName:"webgl",kernelFunc:dFe};function hFe(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:i}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${a.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);let s=Array.from(n.readSync(a.dataId)),o=n.readSync(r.dataId),l=Array.from(n.readSync(i.dataId)),[c,u,d]=K2e(o,r.shape,r.dtype,s,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}var fFe={kernelName:Eh,backendName:"webgl",kernelFunc:hFe};function mFe(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${a.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);let s=n.readSync(r.dataId),o=n.readSync(a.dataId),l=n.readSync(i.dataId),[c,u]=AU(s,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(u,r.dtype,c)}var gFe={kernelName:Eg,backendName:"webgl",kernelFunc:mFe};function yFe(e){let{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${a.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);let s=n.readSync(r.dataId),o=n.readSync(a.dataId),l=n.readSync(i.dataId),[c,u]=AU(s,r.shape,r.dtype,o,l);return n.makeTensorInfo(u,r.dtype,c)}var bFe={kernelName:$g,backendName:"webgl",kernelFunc:yFe};function vFe(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:a,sparseValues:i,defaultValue:s}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:p}=N.calculateShapes(i,a,o),h=!1;if(i.dtype==="string"){let y=n.bufferSync(a),b=n.bufferSync(i),v=k.decodeString(n.readSync(s.dataId)[0]),x=j2e(y,b,o,p,u,c,l,d,v,h);return n.makeTensorInfo(o,x.dtype,x.values)}let f=new TE(c,l,a.shape.length,i.shape.length,d,[p,1],h),m=n.runWebGLProgram(f,[i,a,s],i.dtype),g=be({inputs:{x:m},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(m),g}var xFe={kernelName:$h,backendName:"webgl",kernelFunc:vFe};function wFe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:s}=r,o=k.parseAxisParam(s,a.shape)[0],l=N.prepareSplitSize(a,i,o),c=a.shape.length,u=new Array(c).fill(0),d=a.shape.slice();return l.map(p=>{let h=[...d];h[o]=p;let f=nf({inputs:{x:a},backend:n,attrs:{begin:u,size:h}});return u[o]+=p,f})}var kFe={kernelName:Nh,backendName:"webgl",kernelFunc:wFe},HD="return sqrt(x);",SFe=ft({opSnippet:HD,packedOpSnippet:HD,cpuKernelImpl:X2e}),IFe={kernelName:Vc,backendName:"webgl",kernelFunc:SFe},CFe="return x * x;",_Fe=ft({opSnippet:CFe}),TFe={kernelName:Ag,backendName:"webgl",kernelFunc:_Fe},GD="return (a - b) * (a - b);",NFe=sr({opSnippet:GD,packedOpSnippet:GD}),EFe={kernelName:Hc,backendName:"webgl",kernelFunc:NFe};function $Fe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");let i=n.readSync(a.dataId),s=N.fromUint8ToStringArray(i),o=Y2e(s,"string",r);return n.makeTensorInfo(a.shape,"string",o)}var AFe={kernelName:Rg,backendName:"webgl",kernelFunc:$Fe};function RFe({inputs:e,attrs:t,backend:n}){let{x:r}=e,a=li+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,i=new Ui(r.shape,a);return n.runWebGLProgram(i,[r],r.dtype)}var FFe={kernelName:nl,backendName:"webgl",kernelFunc:RFe},DFe=class{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;let r=n.length,a=At(n.length),i=At(n.length),s="";if(r===1)s="coords * strides + begin";else{let o=0;s=n.map((l,c)=>(o++,n.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${o-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${e});
      ${a} strides = ${a}(${t});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}};function MFe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,end:s,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:p}=r,{finalShapeSparse:h,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:b,end:v,strides:x}=Dn.sliceInfo(a.shape,i,s,o,l,c,u,d,p),w;if(m)w=be({inputs:{x:a},backend:n,attrs:{shape:f}});else if(g||y){k.assert(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);let C=Dn.computeOutShape(b,v,x),T=nf({inputs:{x:a},backend:n,attrs:{begin:b,size:C}});w=be({inputs:{x:T},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(T)}else if(n.shouldExecuteOnCPU([a])){let C=n.readSync(a.dataId),T=et(a.shape,a.dtype,C),E=Z2e(h,T,x,b);w=n.makeTensorInfo(f,a.dtype,E.values)}else{let C=new DFe(b,x,h);w=n.runWebGLProgram(C,[a],a.dtype)}let S=be({inputs:{x:w},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(w),S}var OFe={kernelName:Ah,backendName:"webgl",kernelFunc:MFe};function PFe(e){let{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:i,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:d}=t,p=n.readSync(u.dataId),h=n.readSync(d.dataId),[f,m]=Q2e(p,h,a,i,s,o,l,c);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}var zFe={kernelName:Fg,backendName:"webgl",kernelFunc:PFe};function LFe(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:i,delimiter:s}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(s.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);let o=n.readSync(i.dataId),l=n.readSync(s.dataId)[0],[c,u,d]=J2e(o,l,a),p=u.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}var BFe={kernelName:Dg,backendName:"webgl",kernelFunc:LFe};function WFe(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:i}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");let s=n.readSync(i.dataId),o=eCe(s,a);return n.makeTensorInfo(i.shape,"int32",o)}var VFe={kernelName:Mg,backendName:"webgl",kernelFunc:WFe},UFe="return tan(x);",jFe=ft({opSnippet:UFe}),HFe={kernelName:qc,backendName:"webgl",kernelFunc:jFe},GFe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,qFe=ft({opSnippet:GFe}),KFe={kernelName:Kc,backendName:"webgl",kernelFunc:qFe};function XFe(e){let{inputs:t,backend:n,attrs:r}=e,{tensor:a,indices:i,updates:s}=t,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=N.calculateShapes(s,i,a.shape),p=[d/c,c];if(d===0)return n.makeTensorInfo(a.shape,i.dtype);let h=be({inputs:{x:i},backend:n,attrs:{shape:[l,o]}}),f=be({inputs:{x:s},backend:n,attrs:{shape:[l,c]}}),m=be({inputs:{x:a},backend:n,attrs:{shape:p}}),g=new TE(l,o,h.shape.length,f.shape.length,u,p,!1,!0),y=n.runWebGLProgram(g,[f,h,m],m.dtype),b=be({inputs:{x:y},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),b}var YFe={kernelName:Sh,backendName:"webgl",kernelFunc:XFe},ZFe=class{constructor(e,t){this.variableNames=["A"];let n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[i]*t[i];this.outputShape=n,this.rank=n.length;let r=At(this.rank),a=QFe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}};function QFe(e){let t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${e[0]})`;let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let a=0;a<e.length;a++)r.push(`imod(${n[a]}, ${e[a]})`);return r.join()}function u6(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:i}=r;if(a.dtype==="string"||a.shape.length>5){let o=n.readSync(a.dataId),l=a.dtype==="string"?o.map(d=>k.decodeString(d)):o,c=et(a.shape,a.dtype,l),u=nCe(c,i);return n.makeTensorInfo(u.shape,u.dtype,u.values)}let s=new ZFe(a.shape,i);return n.runWebGLProgram(s,[a],a.dtype)}var JFe={kernelName:tl,backendName:"webgl",kernelFunc:u6},eDe=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}},tDe=class{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}};function vl(e,t){t!==null&&e.disposeIntermediateTensorInfo(t)}function qD(e){let t=1;for(;t<e;)t*=2;return t}function nDe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:i,sorted:s}=r,o=Q().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=Q().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=a.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([a])||u<o||i>l){let E=n.readSync(a.dataId),[R,$]=rCe(E,c,a.dtype,i,s);return[n.makeTensorInfo(R.shape,R.dtype,R.values),n.makeTensorInfo($.shape,$.dtype,$.values)]}if(i===0)return c[c.length-1]=0,[n.makeTensorInfo(c,a.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[a,by({attrs:{shape:c,dtype:"int32",value:0},backend:n})];let d=n.texData.get(a.dataId),p=d!==null&&d.isPacked,h=p?n.unpackTensor(a):a,f=k.sizeFromShape(c)/u,m=be({inputs:{x:h},attrs:{shape:[f,u]},backend:n});p&&vl(n,h);let g=qD(i),y=qD(u),b=null,v=()=>b===null?[m,m]:[m,b],x=(E,R,$)=>{let _=v(),D=new eDe($),P=[[u],[b===null?1:0],[Number.NEGATIVE_INFINITY],[E],[R]],B=b;b=n.runWebGLProgram(D,_,"int32",P),vl(n,B)};for(let E=1;E<g;E*=2){let R=E*2;for(let $=E;$>=1;$/=2)x(R,$,[f,y])}for(let E=y;E>g;E/=2){let R=v(),$=new tDe([f,E/2]),_=[[u],[b===null?1:0],[g]],D=b;b=n.runWebGLProgram($,R,"int32",_),vl(n,D);let P=g/2,B=P*2;for(let W=P;W>=1;W/=2)x(B,W,b.shape)}let w=b;b=nf({inputs:{x:b},backend:n,attrs:{begin:0,size:[f,i]}}),vl(n,w);let S=t6({inputs:{x:m,indices:b},backend:n,attrs:{axis:1,batchDims:1}});vl(n,m);let C=c.slice(0,-1);C.push(i),w=b,b=be({inputs:{x:b},attrs:{shape:C},backend:n}),vl(n,w);let T=S;return S=be({inputs:{x:S},attrs:{shape:C},backend:n}),vl(n,T),[S,b]}var rDe={kernelName:Rh,backendName:"webgl",kernelFunc:nDe},aDe=class{constructor(e,t,n,r,a,i){this.variableNames=["Image","Transforms"],this.outputShape=i;let s=n==="nearest"?1:2,o;switch(r){case"constant":o=1;break;case"reflect":o=2;break;case"wrap":o=3;break;case"nearest":o=4;break;default:o=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${o} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${o} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${o} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${s} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}};function iDe(e){let{inputs:t,backend:n,attrs:r}=e,{image:a,transforms:i}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:c}=r,[u,d,p,h]=a.shape,[f,m]=c??[d,p],g=[u,f,m,h],y=new aDe(d,p,s,o,l,g);return n.runWebGLProgram(y,[a,i],"float32")}var sDe={kernelName:Fh,backendName:"webgl",kernelFunc:iDe};function oDe(e){let{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t;Xh(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let s=r.readSync(i.dataId),{outputValues:o,outputShape:l,indices:c}=aCe(s,a,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,o),r.makeTensorInfo([c.length],"int32",c)]}var lDe={kernelName:Og,backendName:"webgl",kernelFunc:oDe};function uDe(e){let{inputs:t,backend:n,attrs:r}=e,{value:a}=t,{axis:i}=r;i<0&&(i+=a.shape.length);let s=a,o=s.shape.length,l=a.shape[i],c=new Array(o-1),u=0;for(let m=0;m<o;m++)m!==i&&(c[u++]=s.shape[m]);let d=[],p=new Array(o).fill(0),h=s.shape.slice();h[i]=1;let f=new Array(l);for(let m=0;m<f.length;m++){p[i]=m;let g=nf({inputs:{x:s},backend:n,attrs:{begin:p,size:h}}),y=be({inputs:{x:g},backend:n,attrs:{shape:c}});f[m]=y,d.push(g)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}var cDe={kernelName:Dh,backendName:"webgl",kernelFunc:uDe},dDe=class{constructor(e,t){this.variableNames=["x","segmentIds"];let n=e.windowSize,r=e.batchSize,a=e.inSize,i=e.numSegments,s=i*Math.ceil(a/n);this.outputShape=[r,s];let o="0.0",l="sumValue",c=Math.floor(n/4)*4,u=n%4,d=`
        sumValue += dot(values, segFilter);
    `,p="";a%n>0&&(p=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let h="";a%n>0&&(h=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${o};

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${h}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${n}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${c};
        if (${u===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${u===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${u===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${l});
      }
    `}};function pDe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:i}=t,{numSegments:s}=r,o=a.shape.length,l=[],c=0,u=N.getAxesPermutation([c],o),d=a;u!=null&&(d=Nr({inputs:{x:a},backend:n,attrs:{perm:u}}),l.push(d),c=N.getInnerMostAxes(1,o)[0]);let p=N.segment_util.computeOutShape(d.shape,c,s),h=k.sizeFromShape([d.shape[c]]),f=be({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}});l.push(f);let m=Gx(a.dtype),g=(x,w,S,C,T)=>{let E=x.shape[0],R=x.shape[1],$=N.segment_util.segOpComputeOptimalWindowSize(R,T),_={windowSize:$,inSize:R,batchSize:E,numSegments:T},D=new dDe(_,w),P=n.compileAndRun(D,[x,S],C);if(l.push(P),P.shape[1]===T)return P;let B=l6({backend:n,attrs:{start:0,stop:T,step:1,dtype:"float32"}}),W=u6({inputs:{x:B},backend:n,attrs:{reps:[R/$]}});return l.push(B),l.push(W),g(P,w,W,C,T)},y=g(f,"unsortedSegmentSum",i,m,s),b=be({inputs:{x:y},backend:n,attrs:{shape:p}}),v=b;if(u!=null){l.push(b);let x=N.getUndoAxesPermutation(u);v=Nr({inputs:{x:v},backend:n,attrs:{perm:x}})}return l.forEach(x=>n.disposeIntermediateTensorInfo(x)),v}var hDe={kernelName:Pg,backendName:"webgl",kernelFunc:pDe},fDe=[ZCe,JCe,n_e,i_e,o_e,c_e,p_e,f_e,b_e,x_e,S_e,__e,E_e,F_e,O_e,z_e,B_e,j_e,G_e,K_e,Q_e,iTe,oTe,dTe,hTe,vTe,wTe,CTe,DCe,NTe,FTe,PTe,UTe,GTe,KTe,YTe,QTe,nNe,iNe,lNe,cNe,pNe,fNe,yNe,vNe,SNe,CNe,NNe,ANe,FNe,PNe,WNe,HNe,KNe,ZNe,QNe,eEe,nEe,aEe,sEe,lEe,pEe,mEe,bEe,xEe,SEe,_Ee,$Ee,DEe,FCe,OEe,ATe,LEe,VEe,HEe,OCe,XEe,JEe,t$e,i$e,l$e,p$e,m$e,v$e,S$e,_$e,N$e,R$e,D$e,O$e,B$e,V$e,j$e,G$e,K$e,Q$e,nAe,sAe,fAe,LCe,bAe,wAe,IAe,TAe,mTe,$Ae,RAe,DAe,PAe,WAe,zCe,UAe,HAe,qAe,XAe,YAe,gTe,cAe,JAe,rRe,oRe,WCe,dRe,fRe,bRe,wRe,CRe,TRe,$Re,FRe,ORe,LRe,VRe,HRe,XRe,QRe,nFe,iFe,rTe,pAe,lFe,cFe,pFe,fFe,gFe,bFe,xFe,kFe,IFe,TFe,EFe,AFe,FFe,OFe,zFe,BFe,VFe,dAe,KCe,HFe,KFe,YFe,JFe,rDe,sDe,XCe,lDe,cDe,hDe,AAe];for(let e of fDe)zg(e);var yt;(function(e){e[e.float32=0]="float32",e[e.int32=1]="int32",e[e.bool=2]="bool",e[e.string=3]="string",e[e.complex64=4]="complex64"})(yt||(yt={}));var ng;(function(e){e[e.linear=0]="linear",e[e.relu=1]="relu",e[e.relu6=2]="relu6",e[e.prelu=3]="prelu",e[e.leakyrelu=4]="leakyrelu",e[e.sigmoid=5]="sigmoid",e[e.elu=6]="elu"})(ng||(ng={}));var c6;function mDe(e){c6=e.wasm.cwrap(iu,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])}function gDe(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i,bias:s,preluActivationWeights:o}=t;if(a.dtype!=="float32"||i.dtype!=="float32")throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");let{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r,p=n.dataIdMap.get(a.dataId).id,h=n.dataIdMap.get(i.dataId).id,f=0;if(s!=null){let T=n.dataIdMap.get(s.dataId);if(T.shape.length!==1)throw new Error(`_FusedMatMul only supports rank-1 bias but got rank ${T.shape.length}.`);f=T.id}let m=o==null?0:n.dataIdMap.get(o.dataId).id,g=ng[u];if(g==null)throw new Error(`${u} activation not yet supported for FusedConv2D in the wasm backend.`);let y=l?a.shape[2]:a.shape[1],b=c?i.shape[1]:i.shape[2],v=Ph.assertAndGetBroadcastShape(a.shape.slice(0,-2),i.shape.slice(0,-2)),x=n.makeOutput([...v,y,b],a.dtype),w=n.dataIdMap.get(x.dataId).id,S=new Uint8Array(new Int32Array(a.shape).buffer),C=new Uint8Array(new Int32Array(i.shape).buffer);return c6(p,S,a.shape.length,h,C,i.shape.length,l,c,g,f,m,d||0,w),x}var yDe={kernelName:iu,backendName:"wasm",setupFunc:mDe,kernelFunc:gDe};function pt(e,t){let n;function r(i){n=i.wasm.cwrap(e,null,["number","number","number"])}function a(i){let{backend:s,inputs:{x:o}}=i,l=s.dataIdMap.get(o.dataId).id,c=s.makeOutput(o.shape,t||o.dtype),u=s.dataIdMap.get(c.dataId).id;return k.sizeFromShape(c.shape)===0||n(l,yt[o.dtype],u),c}return{kernelName:e,backendName:"wasm",setupFunc:r,kernelFunc:a}}var bDe=pt(Mp),vDe=pt(Au),xDe=pt(Ru);function _n(e,t,n){let r;function a(s){r=s.wasm.cwrap(e,null,["number","array","number","number","array","number","number","number"])}function i(s){let{backend:o,inputs:l}=s,{a:c,b:u}=l,d=o.dataIdMap.get(c.dataId).id,p=o.dataIdMap.get(u.dataId).id,h=n??c.dtype,f=N.assertAndGetBroadcastShape(c.shape,u.shape),m=o.makeOutput(f,h);if(k.sizeFromShape(f)===0)return m;let g=new Uint8Array(new Int32Array(c.shape).buffer),y=new Uint8Array(new Int32Array(u.shape).buffer),b=o.dataIdMap.get(m.dataId).id;return r(d,g,c.shape.length,p,y,u.shape.length,yt[c.dtype],b),m}return{kernelName:e,backendName:"wasm",setupFunc:a,kernelFunc:i}}var wDe=_n(Jo),d6;function kDe(e){d6=e.wasm.cwrap(Fu,null,["array","number","number","number"])}function SDe(e){let{inputs:t,backend:n}=e,r=n.makeOutput(t[0].shape,t[0].dtype);if(k.sizeFromShape(r.shape)===0)return r;let a=t.map(o=>n.dataIdMap.get(o.dataId).id),i=new Uint8Array(new Int32Array(a).buffer),s=n.dataIdMap.get(r.dataId).id;return d6(i,a.length,yt[r.dtype],s),r}var IDe={kernelName:Fu,backendName:"wasm",setupFunc:kDe,kernelFunc:SDe};function J1(e){let{inputs:{x:t},backend:n}=e;if(t.dtype==="string")return Ir(n.readSync(t.dataId),t.shape,t.dtype);let r=n.makeOutput(t.shape,t.dtype),a=n.typedArrayFromHeap(t);return n.typedArrayFromHeap(r).set(a),r}var CDe={kernelName:sc,backendName:"wasm",kernelFunc:J1},p6;function _De(e){p6=e.wasm.cwrap(Ts,null,["number","array","number","number","number","array","number"])}function Go(e){let{inputs:t,backend:n,attrs:r}=e,[a,i]=NDe(t.x.shape,r.perm),s=!0;for(let f=0;f<i.length;f++)i[f]!==f&&(s=!1);let o=TDe(t.x.shape,r.perm),l={dataId:t.x.dataId,shape:a,dtype:t.x.dtype};if(s){let f=J1({inputs:t,backend:n});return f.shape=o,f}let c=n.makeOutput(o,l.dtype),u=n.dataIdMap.get(l.dataId).id,d=n.dataIdMap.get(c.dataId).id,p=new Uint8Array(new Int32Array(i).buffer),h=new Uint8Array(new Int32Array(l.shape).buffer);return p6(u,h,l.shape.length,yt[l.dtype],d,p,i.length),c}function TDe(e,t){let n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];return n}function NDe(e,t){let n=[],r=[];for(let a=0;a<e.length;++a)e[a]!==1&&n.push(e[a]),e[t[a]]!==1&&r.push(t[a]);for(let a=0;a<r.length;++a){let i=-1;for(let s=0;s<r.length;++s)r[s]>=a&&(i===-1||r[i]>r[s])&&(i=s);r[i]=a}return[n,r]}var EDe={kernelName:Ts,backendName:"wasm",kernelFunc:Go,setupFunc:_De};function cl(e,t,n){let r=e.shape,a=e.shape.length,i=k.parseAxisParam(t,r),s=i,o=N.getAxesPermutation(s,a),l=null,c=!1;if(o!=null){let u=new Array(a);for(let p=0;p<u.length;p++)u[p]=r[o[p]];s=N.getInnerMostAxes(s.length,a),l=Go({inputs:{x:e},attrs:{perm:o},backend:n});let d=n.dataIdMap.get(e.dataId).id;n.dataIdMap.get(l.dataId).id!==d&&(c=!0)}return{transposed:l,originalAxes:i,axes:s,inputWasTransposed:c}}var h6;function $De(e){h6=e.wasm.cwrap(Op,null,["number, number, number"])}function ADe(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:c,axes:u,originalAxes:d,inputWasTransposed:p}=cl(s,a,t);if(p){let b=t.dataIdMap.get(c.dataId).id;l=c,o=b}let h=l.shape.length;N.assertAxesAreInnerMostDims("all",u,h);let[f,m]=N.computeOutAndReduceShapes(l.shape,u),g=k.sizeFromShape(m),y=t.makeOutput(f,s.dtype);if(k.sizeFromShape(l.shape)!==0){let b=t.dataIdMap.get(y.dataId).id;h6(o,g,b)}if(p&&t.disposeData(c.dataId),i){let b=N.expandShapeToKeepDim(y.shape,d);y.shape=b}return y}var RDe={kernelName:Op,backendName:"wasm",setupFunc:$De,kernelFunc:ADe},f6;function FDe(e){f6=e.wasm.cwrap(Pp,null,["number, number, number"])}function DDe(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:c,axes:u,originalAxes:d,inputWasTransposed:p}=cl(s,a,t);if(p){let b=t.dataIdMap.get(c.dataId).id;l=c,o=b}let h=l.shape.length;N.assertAxesAreInnerMostDims("any",u,h);let[f,m]=N.computeOutAndReduceShapes(l.shape,u),g=k.sizeFromShape(m),y=t.makeOutput(f,s.dtype);if(k.sizeFromShape(l.shape)!==0){let b=t.dataIdMap.get(y.dataId).id;f6(o,g,b)}if(p&&t.disposeData(c.dataId),i){let b=N.expandShapeToKeepDim(y.shape,d);y.shape=b}return y}var MDe={kernelName:Pp,backendName:"wasm",setupFunc:FDe,kernelFunc:DDe};function m6(e){let t;function n(a){t=a.wasm.cwrap(e,null,["number","number","number","number","number"])}function r(a){let{backend:i,inputs:s,attrs:o}=a,{axis:l}=o,{x:c}=s,u=i.dataIdMap.get(c.dataId).id,d=u,p=c,{transposed:h,axes:f,inputWasTransposed:m}=cl(c,l,i);if(m){let w=i.dataIdMap.get(h.dataId).id;w!==u&&(p=h,d=w)}let g=p.shape.slice(0,-1),y=i.makeOutput(g,"int32"),b=i.dataIdMap.get(y.dataId).id,v=k.sizeFromShape(y.shape),x=p.shape[f[0]];return t(d,yt[p.dtype],v,x,b),m&&i.disposeData(h.dataId),y}return{kernelName:e,backendName:"wasm",setupFunc:n,kernelFunc:r}}var ODe=m6(zp),PDe=m6(Lp),zDe=pt(Du),LDe=pt(Mu),BDe=pt(Ou),WDe=_n(zu),VDe=pt(Pu),g6;function UDe(e){g6=e.wasm.cwrap(Lu,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function jDe(e){let{inputs:t,attrs:n,backend:r}=e,a=t.x,i=r.dataIdMap.get(a.dataId).id,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=n,u=N.computePool2DInfo(a.shape,s,o,1,l,c),d=u.filterHeight,p=u.filterWidth,h=u.padInfo.top,f=u.padInfo.right,m=u.padInfo.bottom,g=u.padInfo.left,y=u.strideHeight,b=u.strideWidth,v=u.inChannels;if(u.dataFormat!=="channelsLast")throw new Error(`wasm backend does not support dataFormat:'${u.dataFormat}'. Please use 'channelsLast'.`);if(u.dilationWidth!==1||u.dilationHeight!==1)throw new Error(`was backend only supports average pooling with dilation = [1, 1], got [${u.dilationHeight}, ${u.dilationWidth}].`);let x=r.makeOutput(u.outShape,"float32"),w=r.dataIdMap.get(x.dataId).id;return g6(i,a.shape[0],a.shape[1],a.shape[2],d,p,h,f,m,g,y,b,v,w),x}var HDe={kernelName:Lu,backendName:"wasm",setupFunc:UDe,kernelFunc:jDe},y6;function GDe(e){y6=e.wasm.cwrap("AvgPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function qDe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=r,u=N.computePool3DInfo(a.shape,i,s,1,o,l,c),d=n.makeOutput(u.outShape,a.dtype);return y6(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),d}var KDe={kernelName:Bp,backendName:"wasm",setupFunc:GDe,kernelFunc:qDe},b6;function XDe(e){b6=e.wasm.cwrap("AvgPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function YDe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r,u=N.computePool3DInfo(i.shape,s,o,1,l,c),d=n.makeOutput(i.shape,i.dtype);return b6(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left,u.filterDepth,u.filterHeight,u.filterWidth),d}var ZDe={kernelName:bg,backendName:"wasm",setupFunc:XDe,kernelFunc:YDe},v6;function QDe(e){v6=e.wasm.cwrap("AvgPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function JDe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l}=r,c=N.computePool2DInfo(i.shape,s,o,1,l),u=n.makeOutput(i.shape,i.dtype);return v6(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.top,c.padInfo.left,c.filterHeight,c.filterWidth),u}var eMe={kernelName:yg,backendName:"wasm",setupFunc:QDe,kernelFunc:JDe};function Vr(e){let{inputs:t,attrs:n}=e,{x:r}=t,{shape:a}=n,i=k.sizeFromShape(r.shape),s=k.inferFromImplicitShape(a,i);return k.assert(i===k.sizeFromShape(s),()=>`new shape: ${s}, old shape: ${r.shape}. New shape and old shape must have the same number of elements.`),e.backend.incRef(r.dataId),{dataId:r.dataId,shape:s,dtype:r.dtype}}var tMe={kernelName:vh,backendName:"wasm",kernelFunc:Vr},x6;function nMe(e){x6=e.wasm.cwrap(Bu,null,["number","array","number","number","array","number","number","number","number"])}function rMe(e){let{inputs:t,backend:n,attrs:r}=e,{a,b:i}=t,{transposeA:s,transposeB:o}=r;if(a.dtype!=="float32"||i.dtype!=="float32")throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");let l=a.shape.length,c=i.shape.length,u=s?a.shape[l-2]:a.shape[l-1],d=o?i.shape[c-1]:i.shape[c-2],p=s?a.shape[l-1]:a.shape[l-2],h=o?i.shape[c-2]:i.shape[c-1],f=a.shape.slice(0,-2),m=i.shape.slice(0,-2),g=k.sizeFromShape(f),y=k.sizeFromShape(m),b=Ph.assertAndGetBroadcastShape(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([p,h]);k.assert(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${a.shape} and ${i.shape} and transposeA=${s} and transposeB=${o} must match.`);let v=s?[g,u,p]:[g,p,u],x=o?[y,h,d]:[y,d,h],w=Vr({inputs:{x:a},backend:n,attrs:{shape:v}}),S=Vr({inputs:{x:i},backend:n,attrs:{shape:x}}),C=n.dataIdMap.get(w.dataId).id,T=n.dataIdMap.get(S.dataId).id,E=s?w.shape[2]:w.shape[1],R=o?S.shape[1]:S.shape[2],$=Math.max(g,y),_=n.makeOutput([$,E,R],w.dtype),D=n.dataIdMap.get(_.dataId).id,P=new Uint8Array(new Int32Array(w.shape).buffer),B=new Uint8Array(new Int32Array(S.shape).buffer);return x6(C,P,w.shape.length,T,B,S.shape.length,s,o,D),n.disposeData(w.dataId),n.disposeData(S.dataId),_.shape=b,_}var aMe={kernelName:Bu,backendName:"wasm",setupFunc:nMe,kernelFunc:rMe};function Su(e){let{inputs:{x:t},attrs:{begin:n,size:r},backend:a}=e,[i,s]=Dn.parseSliceParams(t,n,r),o=Dn.isSliceContinous(t.shape,i,s),l=a.readSync(t.dataId),c=a.makeOutput(s,t.dtype),u=k.computeStrides(t.shape),d=a.dataIdMap.get(c.dataId);if(o){let f=Dn.computeFlatOffset(i,u);return t.dtype==="string"?d.stringBytes=l.slice(f,f+k.sizeFromShape(s)):a.typedArrayFromHeap(c).set(l.subarray(f,f+k.sizeFromShape(s))),c}if(t.dtype==="string"){let f=gv(l,i,s,t.shape,t.dtype);return d.stringBytes=f,c}let p=a.typedArrayFromHeap(c),h=t.shape.length;if(h===2)iMe(l,u[0],p,i,s);else if(h===3)sMe(l,u[0],u[1],p,i,s);else if(h===4)oMe(l,u[0],u[1],u[2],p,i,s);else{let f=gv(l,i,s,t.shape,t.dtype);p.set(f)}return c}function iMe(e,t,n,r,a){let i=0,s=r[0],o=r[1],l=s+a[0];for(let c=s;c<l;c++){let u=c*t+o;n.set(e.subarray(u,u+a[1]),i),i+=a[1]}}function sMe(e,t,n,r,a,i){let s=0,o=a[0],l=a[1],c=a[2],u=o+i[0],d=l+i[1];for(let p=o;p<u;p++)for(let h=l;h<d;h++){let f=p*t+h*n+c;r.set(e.subarray(f,f+i[2]),s),s+=i[2]}}function oMe(e,t,n,r,a,i,s){let o=0,l=i[0],c=i[1],u=i[2],d=l+s[0],p=c+s[1],h=u+s[2],f=i[3];for(let m=l;m<d;m++)for(let g=c;g<p;g++)for(let y=u;y<h;y++){let b=m*t+g*n+y*r+f;a.set(e.subarray(b,b+s[3]),o),o+=s[3]}}var lMe={kernelName:_h,backendName:"wasm",kernelFunc:Su};function uMe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:s}=r,o=i.reduce((y,b)=>y*b),l=N.getReshaped(a.shape,i,o),c=N.getPermuted(l.length,i.length),u=N.getReshapedPermuted(a.shape,i,o),d=N.getSliceBeginCoords(s,i.length),p=N.getSliceSize(u,s,i.length),h=Vr({inputs:{x:a},backend:n,attrs:{shape:l}}),f=Go({inputs:{x:h},backend:n,attrs:{perm:c}}),m=Vr({inputs:{x:f},backend:n,attrs:{shape:u}}),g=Su({inputs:{x:m},backend:n,attrs:{begin:d,size:p}});return n.disposeData(h.dataId),n.disposeData(f.dataId),n.disposeData(h.dataId),g}var cMe={kernelName:Wp,backendName:"wasm",kernelFunc:uMe},w6;function dMe(e){w6=e.wasm.cwrap(Vp,null,["number","number","boolean","number","number","number"])}function pMe(e){let{backend:t,inputs:n,attrs:r}=e,{x:a,weights:i}=n,{size:s}=r,o=i.shape.reduce((d,p)=>d*p,1)!==0,l=a.shape.length===1?[s]:[a.shape[0],s],c=t.makeOutput(l,i.dtype);function u(d){return t.dataIdMap.get(d.dataId).id}return w6(u(a),s,o,u(i),yt[i.dtype],u(c)),c}var hMe={kernelName:Vp,backendName:"wasm",setupFunc:dMe,kernelFunc:pMe},fMe=_n(Up);function mMe(e){let{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.typedArrayFromHeap(r),s=n.typedArrayFromHeap(a),o=N.assertAndGetBroadcastShape(Array.from(i),Array.from(s));return n.makeOutput([o.length],"int32",void 0,new Int32Array(o))}var gMe={kernelName:vg,backendName:"wasm",kernelFunc:mMe};function dl(e){let{inputs:{x:t},attrs:{dtype:n},backend:r}=e,a=r.makeOutput(t.shape,n),i=r.typedArrayFromHeap(t);return r.typedArrayFromHeap(a).set(i),a}var yMe={kernelName:Wu,backendName:"wasm",kernelFunc:dl},bMe=pt(Vu),k6;function vMe(e){k6=e.wasm.cwrap(el,null,["number","number","number","number"])}function xMe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{clipValueMin:i,clipValueMax:s}=r,o=n.dataIdMap.get(a.dataId).id,l=n.makeOutput(a.shape,a.dtype),c=n.dataIdMap.get(l.dataId).id;return k6(o,i,s,c),l}var wMe={kernelName:el,backendName:"wasm",setupFunc:vMe,kernelFunc:xMe};function S6(e){let{inputs:t,backend:n}=e,r=k.parseAxisParam(e.attrs.axis,t[0].shape)[0],a=t.map(h=>h.shape);N.assertParamsConsistent(a,r);let i=N.computeOutShape(t.map(h=>h.shape),r),s=t.filter(h=>k.sizeFromShape(h.shape)>0);if(s.length===1)return J1({inputs:{x:s[0]},backend:n});let o=n.makeOutput(i,t[0].dtype);if(k.sizeFromShape(i)===0)return o;if(s[0].dtype==="string"){let h=s.map(v=>{let x=[-1,k.sizeFromShape(v.shape.slice(r))];return Vr({inputs:{x:v},backend:n,attrs:{shape:x}})}),f=h.map(v=>({vals:n.readSync(v.dataId),shape:v.shape}));i=N.computeOutShape(h.map(v=>v.shape),1);let m=h[0].shape[0]===1,g=eE(f,i,t[0].dtype,m),y=N.computeOutShape(s.map(v=>v.shape),r);o.shape=y;let b=n.dataIdMap.get(o.dataId);return b.stringBytes=N.fromStringArrayToUint8(g),h.forEach(v=>n.disposeData(v.dataId)),o}let l=k.sizeFromShape(s[0].shape.slice(0,r)),c=0,u=s.map(h=>{let f=k.sizeFromShape(h.shape.slice(r));return c+=f,f}),d=s.map(h=>n.typedArrayFromHeap(h)),p=n.typedArrayFromHeap(o);for(let h=0;h<l;h++){let f=h*c;for(let m=0;m<d.length;m++){let g=u[m],y=h*g,b=d[m].subarray(y,y+g);p.set(b,f),f+=g}}return o}var kMe={kernelName:jp,backendName:"wasm",kernelFunc:S6},I6;function SMe(e){I6=e.wasm.cwrap(Uu,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function IMe(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:i}=t,s=r.dataIdMap.get(a.dataId).id,o=r.dataIdMap.get(i.dataId).id,{strides:l,dilations:c,pad:u,dimRoundingMode:d,dataFormat:p}=n,h=N.convertConv2DDataFormat(p),f=N.computeConv2DInfo(a.shape,i.shape,l,c,u,d,!1,h),m=f.filterHeight,g=f.filterWidth,y=f.padInfo.top,b=f.padInfo.right,v=f.padInfo.bottom,x=f.padInfo.left,w=f.dilationHeight,S=f.dilationWidth,C=f.strideHeight,T=f.strideWidth,E=f.inChannels,R=f.outChannels,$=f.padInfo.type==="SAME"?1:0;if(f.dataFormat!=="channelsLast")throw new Error(`wasm backend Conv2D does not support dataFormat:'${f.dataFormat}'. Please use 'channelsLast'.`);let _=r.makeOutput(f.outShape,"float32"),D=r.dataIdMap.get(_.dataId).id;return I6(s,a.shape[0],a.shape[1],a.shape[2],o,m,g,y,b,v,x,$,w,S,C,T,E,R,D),_}var CMe={kernelName:Uu,backendName:"wasm",setupFunc:SMe,kernelFunc:IMe},C6;function _Me(e){C6=e.wasm.cwrap(ju,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function TMe(e){let{backend:t,inputs:n,attrs:r}=e,{dy:a,filter:i}=n,{strides:s,pad:o,dataFormat:l,dimRoundingMode:c,inputShape:u}=r,d=1,p=N.convertConv2DDataFormat(l),h=N.computeConv2DInfo(u,i.shape,s,d,o,c,!1,p),{batchSize:f,filterHeight:m,filterWidth:g,inChannels:y,inHeight:b,inWidth:v,outChannels:x,outHeight:w,outWidth:S,strideHeight:C,strideWidth:T}=h,E=m-1-h.padInfo.top,R=g-1-h.padInfo.left,$=h.dataFormat==="channelsLast",_=k.computeStrides(h.inShape),D=k.computeStrides(a.shape),[P,B,W]=k.computeStrides(i.shape),Y=_[0],O=$?_[1]:_[2],q=$?_[2]:1,Z=$?1:_[1],X=D[0],ne=$?D[1]:D[2],te=$?D[2]:1,se=$?1:D[1],oe=t.makeOutput(h.inShape,"float32"),fe=t.dataIdMap.get(oe.dataId).id,ce=t.dataIdMap.get(a.dataId).id,ue=t.dataIdMap.get(i.dataId).id;return C6(ce,ue,f,m,g,b,v,y,w,S,x,C,T,E,R,P,B,W,Y,O,q,Z,X,ne,te,se,fe),oe}var NMe={kernelName:ju,backendName:"wasm",setupFunc:_Me,kernelFunc:TMe},_6;function EMe(e){_6=e.wasm.cwrap(Hu,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function $Me(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r;if(a.dtype!=="float32")throw new Error(`Tensor x must have dtype float32, got ${a.dtype}`);if(i.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${i.dtype}`);let c=N.computeConv3DInfo(a.shape,i.shape,s,l,o),u=n.makeOutput(c.outShape,a.dtype);return _6(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),u}var AMe={kernelName:Hu,backendName:"wasm",setupFunc:EMe,kernelFunc:$Me},T6;function RMe(e){T6=e.wasm.cwrap(Hp,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function FMe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:s,pad:o,filterShape:l}=r;if(a.dtype!=="float32")throw new Error(`Tensor dy must have dtype float32, got ${a.dtype}`);if(i.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${i.dtype}`);let c=N.computeConv3DInfo(a.shape,l,s,1,o),u=n.makeOutput(c.filterShape,i.dtype);return T6(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),u}var DMe={kernelName:Hp,backendName:"wasm",setupFunc:RMe,kernelFunc:FMe},N6;function MMe(e){N6=e.wasm.cwrap(Gp,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function OMe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:s,strides:o,inputShape:l}=r;if(a.dtype!=="float32")throw new Error(`Tensor dy must have dtype float32, got ${a.dtype}`);if(i.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${i.dtype}`);let c=N.computeConv3DInfo(l,i.shape,o,1,s),u=n.makeOutput(c.inShape,a.dtype);return N6(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(u.dataId).id,c.batchSize,c.inDepth,c.inHeight,c.inWidth,c.inChannels,c.outDepth,c.outHeight,c.outWidth,c.outChannels,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.filterDepth,c.filterHeight,c.filterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),u}var PMe={kernelName:Gp,backendName:"wasm",setupFunc:MMe,kernelFunc:OMe},zMe=pt(Gu),LMe=pt(qu),VI;(function(e){e[e.bilinear=0]="bilinear",e[e.nearest=1]="nearest"})(VI||(VI={}));var E6;function BMe(e){E6=e.wasm.cwrap(Kp,null,["number","number","number","number","array","number","number","number","number","number"])}function WMe(e){let{backend:t,inputs:n,attrs:r}=e,{method:a,extrapolationValue:i,cropSize:s}=r,{image:o,boxes:l,boxInd:c}=n,u=l.shape[0],[d,p]=s,h=[u,d,p,o.shape[3]],f=t.dataIdMap.get(o.dataId),m;o.dtype!=="float32"&&(m=dl({backend:t,inputs:{x:o},attrs:{dtype:"float32"}}),f=t.dataIdMap.get(m.dataId));let g=f.id,y=t.dataIdMap.get(l.dataId).id,b=t.dataIdMap.get(c.dataId).id,v=t.makeOutput(h,"float32"),x=t.dataIdMap.get(v.dataId).id,w=new Uint8Array(new Int32Array(o.shape).buffer);return E6(g,y,b,u,w,d,p,VI[a],i,x),m!=null&&t.disposeData(m.dataId),v}var VMe={kernelName:Kp,backendName:"wasm",setupFunc:BMe,kernelFunc:WMe},$6;function UMe(e){$6=e.wasm.cwrap(qp,null,["number","number","number","number","number","number"])}function jMe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r,l=a.shape.length;k.assert(a.dtype==="float32"||a.dtype==="int32",()=>`cumprod does not support ${a.dtype} tensors in the WASM backend`);let c=N.getAxesPermutation([i],l),u=a;c!==null&&(u=Go({inputs:{x:a},attrs:{perm:c},backend:n}));let d=N.getInnerMostAxes(1,l)[0];N.assertAxesAreInnerMostDims("cumprod",[d],l);let p=n.makeOutput(u.shape,u.dtype),h=u.shape[d],f=n.dataIdMap.get(u.dataId).id,m=n.dataIdMap.get(p.dataId).id;$6(f,s?1:0,o?1:0,h,m,yt[a.dtype]);let g=p;if(c!==null){let y=N.getUndoAxesPermutation(c);g=Go({inputs:{x:p},attrs:{perm:y},backend:n}),n.disposeData(u.dataId),n.disposeData(p.dataId)}return g}var HMe={kernelName:qp,backendName:"wasm",setupFunc:UMe,kernelFunc:jMe},A6;function GMe(e){A6=e.wasm.cwrap(Ku,null,["number","number","number","number","number","number"])}function qMe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:s,reverse:o}=r,l=a.shape.length;k.assert(a.dtype==="float32"||a.dtype==="int32",()=>`cumsum does not support ${a.dtype} tensors in the WASM backend`);let c=N.getAxesPermutation([i],l),u=a;c!==null&&(u=Go({inputs:{x:a},attrs:{perm:c},backend:n}));let d=N.getInnerMostAxes(1,l)[0];N.assertAxesAreInnerMostDims("cumsum",[d],l);let p=n.makeOutput(u.shape,u.dtype),h=u.shape[d],f=n.dataIdMap.get(u.dataId).id,m=n.dataIdMap.get(p.dataId).id;A6(f,s?1:0,o?1:0,h,m,yt[a.dtype]);let g=p;if(c!==null){let y=N.getUndoAxesPermutation(c);g=Go({inputs:{x:p},attrs:{perm:y},backend:n}),n.disposeData(u.dataId),n.disposeData(p.dataId)}return g}var KMe={kernelName:Ku,backendName:"wasm",setupFunc:GMe,kernelFunc:qMe},R6;function XMe(e){R6=e.wasm.cwrap("DenseBincount",null,["number","array","number","number","boolean","number","number","boolean","number"])}function YMe(e){let{backend:t,inputs:n,attrs:r}=e,{x:a,weights:i}=n,{size:s,binaryOutput:o}=r,l=i.shape.reduce((p,h)=>p*h,1)!==0,c=a.shape.length===1?[s]:[a.shape[0],s],u=t.makeOutput(c,i.dtype);function d(p){return t.dataIdMap.get(p.dataId).id}return R6(d(a),new Uint8Array(new Int32Array(a.shape).buffer),a.shape.length,s,l,d(i),yt[i.dtype],o,d(u)),u}var ZMe={kernelName:wg,backendName:"wasm",setupFunc:XMe,kernelFunc:YMe},F6;function QMe(e){F6=e.wasm.cwrap(Xp,null,["number","number","number","array","number","array","array","number","number"])}function JMe(e){let{backend:t,inputs:n,attrs:r}=e,{x:a}=n,{blockSize:i,dataFormat:s}=r,o=a.shape[0],l=s==="NHWC"?a.shape[1]:a.shape[2],c=s==="NHWC"?a.shape[2]:a.shape[3],u=s==="NHWC"?a.shape[3]:a.shape[1],d=l*i,p=c*i,h=u/(i*i),f=s==="NHWC"?[o,d,p,h]:[o,h,d,p],m=t.makeOutput(f,"float32"),g=t.dataIdMap.get(a.dataId).id,y=new Uint8Array(new Int32Array(k.computeStrides(a.shape)).buffer),b=new Uint8Array(new Int32Array(f).buffer),v=new Uint8Array(new Int32Array(k.computeStrides(f)).buffer),x=t.dataIdMap.get(m.dataId).id;return F6(g,i,s==="NHWC"?1:0,y,a.shape.length-1,b,v,f.length,x),m}var eOe={kernelName:Xp,backendName:"wasm",setupFunc:QMe,kernelFunc:JMe},D6;function tOe(e){D6=e.wasm.cwrap(Xu,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function nOe(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:i}=t,s=r.dataIdMap.get(a.dataId).id,o=r.dataIdMap.get(i.dataId).id,{strides:l,dilations:c,pad:u,dimRoundingMode:d}=n,p=c??[1,1],h=N.computeConv2DInfo(a.shape,i.shape,l,p,u,d,!0),f=h.filterHeight,m=h.filterWidth,g=h.padInfo.top,y=h.padInfo.right,b=h.padInfo.bottom,v=h.padInfo.left,x=h.dilationHeight,w=h.dilationWidth,S=h.strideHeight,C=h.strideWidth,T=h.inChannels,E=h.outChannels,R=h.padInfo.type==="SAME"?1:0;if(h.dataFormat!=="channelsLast")throw new Error(`wasm backend DepthwiseConv2dNative does not support dataFormat:'${h.dataFormat}'. Please use 'channelsLast'.`);let $=r.makeOutput(h.outShape,"float32"),_=r.dataIdMap.get($.dataId).id;return D6(s,a.shape[0],a.shape[1],a.shape[2],o,f,m,g,y,b,v,R,x,w,S,C,T,E,_),$}var rOe={kernelName:Xu,backendName:"wasm",setupFunc:tOe,kernelFunc:nOe},M6;function aOe(e){M6=e.wasm.cwrap("Diag",null,["number","number","number","number"])}function iOe(e){let{inputs:t,backend:n}=e,{x:r}=t,a=k.sizeFromShape(r.shape),i=n.makeOutput([...r.shape,...r.shape],r.dtype);return M6(n.dataIdMap.get(r.dataId).id,yt[r.dtype],a,n.dataIdMap.get(i.dataId).id),i}var sOe={kernelName:kg,backendName:"wasm",setupFunc:aOe,kernelFunc:iOe},O6;function oOe(e){O6=e.wasm.cwrap(Yu,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function lOe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:s,pad:o,dilations:l}=r;if(a.dtype!==i.dtype)throw new Error(`Dilation2D error: x must have the same dtype as filter. Got ${a.dtype} and ${i.dtype}`);let c=N.computeDilation2DInfo(a.shape,i.shape,s,o,"NHWC",l),u=n.makeOutput(c.outShape,a.dtype);return O6(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(u.dataId).id,yt[a.dtype],c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.filterHeight,c.filterWidth,c.padInfo.top,c.padInfo.left),u}var uOe={kernelName:Yu,backendName:"wasm",setupFunc:oOe,kernelFunc:lOe},P6;function cOe(e){P6=e.wasm.cwrap(lp,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function dOe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,dy:s}=t,{strides:o,pad:l,dilations:c}=r;if(a.dtype!==i.dtype||a.dtype!==s.dtype)throw new Error(`Dilation2DBackpropFilter error: x must have the same dtype as filter and dy. Got ${a.dtype}, ${i.dtype}, and ${s.dtype}`);let u=N.computeDilation2DInfo(a.shape,i.shape,o,l,"NHWC",c),d=n.makeOutput(i.shape,i.dtype);return P6(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,yt[a.dtype],u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.filterHeight,u.filterWidth,u.padInfo.top,u.padInfo.left),d}var pOe={kernelName:lp,backendName:"wasm",setupFunc:cOe,kernelFunc:dOe},z6;function hOe(e){z6=e.wasm.cwrap(op,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function fOe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,dy:s}=t,{strides:o,pad:l,dilations:c}=r;if(a.dtype!==i.dtype||a.dtype!==s.dtype)throw new Error(`Dilation2DBackpropInput error: x must have the same dtype as filter and dy. Got ${a.dtype}, ${i.dtype}, and ${s.dtype}`);let u=N.computeDilation2DInfo(a.shape,i.shape,o,l,"NHWC",c),d=n.makeOutput(a.shape,a.dtype);return z6(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,yt[a.dtype],u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.filterHeight,u.filterWidth,u.padInfo.top,u.padInfo.left),d}var mOe={kernelName:op,backendName:"wasm",setupFunc:hOe,kernelFunc:fOe},gOe=pt(Qu),L6;function yOe(e){L6=e.wasm.cwrap(Yp,null,["number","number","number"])}function bOe(e){let{inputs:t,backend:n}=e,{dy:r,y:a}=t,i=n.makeOutput(a.shape,"float32"),s=o=>n.dataIdMap.get(o.dataId).id;return L6(s(a),s(r),s(i)),i}var vOe={kernelName:Yp,backendName:"wasm",setupFunc:yOe,kernelFunc:bOe},xOe=!1,wOe=_n(Zp,xOe,"bool"),kOe=pt(Ju),SOe=pt(ec,"float32");function UI(e){let{inputs:t,attrs:n,backend:r}=e,{input:a}=t,{dim:i}=n,s=a.shape.length,o=a.shape.slice(),l=i;return i<0&&(k.assert(-(s+1)<=i,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+i+1),o.splice(l,0,1),Vr({inputs:{x:a},backend:r,attrs:{shape:o}})}var IOe={kernelName:Qp,backendName:"wasm",kernelFunc:UI},COe=pt(tc,"float32");function B6(e){let{attrs:{shape:t,value:n,dtype:r},backend:a}=e,i=a.makeOutput(t,r);return a.typedArrayFromHeap(i).fill(n),i}var _Oe={kernelName:Sg,backendName:"wasm",kernelFunc:B6},W6;function TOe(e){W6=e.wasm.cwrap(Jp,null,["number","number","number","number","number","number"])}function NOe(e){let{inputs:t,backend:n}=e,{image:r}=t,a=n.makeOutput(r.shape,r.dtype),i=n.dataIdMap.get(r.dataId).id,s=n.dataIdMap.get(a.dataId).id,[o,l,c,u]=r.shape;return W6(i,o,l,c,u,s),a}var EOe={kernelName:Jp,backendName:"wasm",kernelFunc:NOe,setupFunc:TOe},$Oe=pt(nc),AOe=_n(rc),V6;function ROe(e){V6=e.wasm.cwrap(ac,null,["number","number","number","number","number","number","number"])}function FOe(e){let{backend:t,inputs:n,attrs:r}=e,{varianceEpsilon:a}=r,{x:i,mean:s,variance:o,offset:l,scale:c}=n,u=t.dataIdMap.get(i.dataId).id,d=t.dataIdMap.get(s.dataId).id,p=t.dataIdMap.get(o.dataId).id,h=l!=null?t.dataIdMap.get(l.dataId).id:0,f=c!=null?t.dataIdMap.get(c.dataId).id:0,m=t.makeOutput(i.shape,i.dtype);if(k.sizeFromShape(i.shape)===0)return m;let g=t.dataIdMap.get(m.dataId).id;return V6(u,d,p,h,f,a,g),m}var DOe={kernelName:ac,backendName:"wasm",setupFunc:ROe,kernelFunc:FOe},U6;function MOe(e){U6=e.wasm.cwrap(su,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function OOe(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:u,dataFormat:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=n,m=N.computeConv2DInfo(a.shape,i.shape,l,u,c,p),g=ng[h];if(g==null)throw new Error(`${h} activation not yet supported for FusedConv2D in the wasm backend.`);let y=r.dataIdMap.get(a.dataId).id,b=r.dataIdMap.get(i.dataId).id,v=m.outChannels,x=0;if(s!=null){let te=r.dataIdMap.get(s.dataId);if(te.shape.length!==1)throw new Error(`FusedConv2D only supports rank-1 bias but got rank ${te.shape.length}.`);if(te.shape[0]!==v)throw new Error(`FusedConv2D bias shape (${te.shape}) does not match the number of output channels (${v})`);x=te.id}let w=m.filterHeight,S=m.filterWidth,C=m.padInfo.top,T=m.padInfo.right,E=m.padInfo.bottom,R=m.padInfo.left,$=m.dilationHeight,_=m.dilationWidth,D=m.strideHeight,P=m.strideWidth,B=m.inChannels,W=m.padInfo.type==="SAME"?1:0,Y=m.batchSize,O=m.inHeight,q=m.inWidth;if(d!=="NHWC")throw new Error(`wasm backend FusedConv2D does not support dataFormat:'${d}'. Please use 'NHWC'.`);let Z=r.makeOutput(m.outShape,"float32"),X=r.dataIdMap.get(Z.dataId).id,ne=o==null?0:r.dataIdMap.get(o.dataId).id;return U6(y,Y,O,q,b,w,S,x,C,T,E,R,W,$,_,D,P,B,v,g,ne,f||0,X),Z}var POe={kernelName:su,backendName:"wasm",setupFunc:MOe,kernelFunc:OOe},j6;function zOe(e){j6=e.wasm.cwrap(ou,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function LOe(e){let{inputs:t,attrs:n,backend:r}=e,{x:a,filter:i,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:u,dataFormat:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=n,m=N.computeConv2DInfo(a.shape,i.shape,l,u,c,p,!0),g=ng[h];if(g==null)throw new Error(`${h} activation not yet supported for FusedDepthwiseConv2D in the wasm backend.`);let y=r.dataIdMap.get(a.dataId).id,b=r.dataIdMap.get(i.dataId).id,v=m.outChannels,x=0;if(s!=null){let te=r.dataIdMap.get(s.dataId);if(te.shape.length!==1)throw new Error(`FusedDepthwiseConv2D only supports rank-1 bias but got rank ${te.shape.length}.`);if(te.shape[0]!==v)throw new Error(`FusedDepthwiseConv2D bias shape (${te.shape}) does not match the number of output channels (${v})`);x=te.id}let w=m.filterHeight,S=m.filterWidth,C=m.padInfo.top,T=m.padInfo.right,E=m.padInfo.bottom,R=m.padInfo.left,$=m.dilationHeight,_=m.dilationWidth,D=m.strideHeight,P=m.strideWidth,B=m.inChannels,W=m.padInfo.type==="SAME"?1:0,Y=m.batchSize,O=m.inHeight,q=m.inWidth;if(d!=="NHWC")throw new Error(`wasm backend FusedDepthwiseConv2D does not support dataFormat:'${d}'. Please use 'NHWC'.`);let Z=r.makeOutput(m.outShape,"float32"),X=r.dataIdMap.get(Z.dataId).id,ne=o==null?0:r.dataIdMap.get(o.dataId).id;return j6(y,Y,O,q,b,w,S,x,C,T,E,R,W,$,_,D,P,B,v,g,ne,f||0,X),Z}var BOe={kernelName:ou,backendName:"wasm",setupFunc:zOe,kernelFunc:LOe},H6;function WOe(e){H6=e.wasm.cwrap(th,null,["number","number","number","number","number","number","array","number"])}function VOe(e){let{backend:t,inputs:n}=e,{params:r,indices:a}=n,[i,s,o,l]=hT.prepareAndValidate(r,a),c=t.makeOutput(i,r.dtype);if(s===0)return c;let u=a.shape,d=u[u.length-1],p=t.dataIdMap.get(r.dataId).id,h=t.dataIdMap.get(a.dataId).id,f=new Uint8Array(new Int32Array(l).buffer),m=t.dataIdMap.get(c.dataId).id;return H6(p,yt[r.dtype],h,s,d,o,f,m),c}var UOe={kernelName:th,backendName:"wasm",setupFunc:WOe,kernelFunc:VOe},G6;function jOe(e){G6=e.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])}function HOe(e){let{backend:t,inputs:n,attrs:r}=e,{x:a,indices:i}=n,{axis:s,batchDims:o}=r,l=k.parseAxisParam(s,a.shape)[0],c=t.readSync(i.dataId),u=a.shape[l];for(let C=0;C<c.length;++C){let T=c[C];k.assert(T<=u-1&&T>=0,()=>`GatherV2: the index value ${T} is not in [0, ${u-1}]`)}let d=N.segment_util.collectGatherOpShapeInfo(a,i,l,o),p=Vr({inputs:{x:a},attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]},backend:t}),h=k.sizeFromShape(i.shape),f=Vr({inputs:{x:i},attrs:{shape:[d.batchSize,h/d.batchSize]},backend:t}),m=[d.batchSize,d.outerSize,h/d.batchSize,d.sliceSize],g=t.makeOutput(m,a.dtype);if(k.sizeFromShape(a.shape)===0)return g;let y=p.shape.length-1,b=t.dataIdMap.get(p.dataId).id,v=t.dataIdMap.get(f.dataId).id,x=t.dataIdMap.get(g.dataId).id,w=new Uint8Array(new Int32Array(k.computeStrides(p.shape)).buffer),S=new Uint8Array(new Int32Array(k.computeStrides(m)).buffer);return G6(b,yt[a.dtype],w,y,v,d.batchSize,S,x),t.disposeData(p.dataId),t.disposeData(f.dataId),g.shape=d.outputShape,g}var GOe={kernelName:eh,backendName:"wasm",setupFunc:jOe,kernelFunc:HOe},qOe=!1,KOe=_n(nh,qOe,"bool"),XOe=!1,YOe=_n(ic,XOe,"bool"),ZOe=pt(oc,"bool"),QOe=pt(lc,"bool"),JOe=pt(uc,"bool"),q6;function e3e(e){q6=e.wasm.cwrap(cc,null,["number","number","number","number"])}function t3e(e){let{inputs:{x:t},attrs:{alpha:n},backend:r}=e,a=r.dataIdMap.get(t.dataId).id,i=r.makeOutput(t.shape,"float32");if(k.sizeFromShape(t.shape)!==0){let s=r.dataIdMap.get(i.dataId).id;q6(a,yt[t.dtype],n,s)}return i}var n3e={kernelName:cc,backendName:"wasm",setupFunc:e3e,kernelFunc:t3e},r3e=!1,a3e=_n(rh,r3e,"bool"),i3e=!1,s3e=_n(ah,i3e,"bool"),K6;function o3e(e){K6=e.wasm.cwrap(ih,null,["number","number","number","number"])}function l3e(e){let{attrs:t,backend:n}=e,{start:r,stop:a,num:i}=t,s=Math.floor(i),o=n.makeOutput([s],"float32");return K6(n.dataIdMap.get(o.dataId).id,r,a,s),o}var u3e={kernelName:ih,backendName:"wasm",setupFunc:o3e,kernelFunc:l3e},c3e=pt(dc),d3e=pt(pc),p3e=!1,h3e=_n(sh,p3e,"bool"),f3e=pt(oh),m3e=!1,g3e=_n(lh,m3e,"bool"),y3e=!1,b3e=_n(fL,y3e,"bool"),X6;function v3e(e){X6=e.wasm.cwrap(hc,null,["number","number","number","number","number","number","number"])}function x3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:s,alpha:o,beta:l}=r;if(a.dtype!=="float32")throw new Error("LRN error: x must have dtype float32");let c=n.makeOutput(a.shape,a.dtype);return X6(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(c.dataId).id,a.shape[3],i,s,o,l),c}var w3e={kernelName:hc,backendName:"wasm",setupFunc:v3e,kernelFunc:x3e},Y6;function k3e(e){Y6=e.wasm.cwrap(uh,null,["number","number","number","number","number","number","number","number","number"])}function S3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:s}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=r;if(a.dtype!=="float32"||i.dtype!=="float32"||s.dtype!=="float32")throw new Error("LRNGrad error: x, y, and dy must have dtype float32");let d=n.makeOutput(a.shape,a.dtype);return Y6(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(d.dataId).id,s.shape[3],o,l,c,u),d}var I3e={kernelName:uh,backendName:"wasm",setupFunc:k3e,kernelFunc:S3e},Z6;function C3e(e){Z6=e.wasm.cwrap(fc,null,["number","number","number","number"])}function _3e(e){let{backend:t,inputs:n,attrs:r}=e,{reductionIndices:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=s,{transposed:c,axes:u,originalAxes:d,inputWasTransposed:p}=cl(s,a,t);if(p){let b=t.dataIdMap.get(c.dataId).id;l=c,o=b}let h=l.shape.length;N.assertAxesAreInnerMostDims("max",u,h);let[f,m]=N.computeOutAndReduceShapes(l.shape,u),g=k.sizeFromShape(m),y=t.makeOutput(f,s.dtype);if(k.sizeFromShape(l.shape)!==0){let b=t.dataIdMap.get(y.dataId).id;Z6(o,yt[s.dtype],g,b)}if(p&&t.disposeData(c.dataId),i){let b=N.expandShapeToKeepDim(y.shape,d);y.shape=b}return y}var T3e={kernelName:fc,backendName:"wasm",setupFunc:C3e,kernelFunc:_3e},N3e=_n(mc),Q6;function E3e(e){Q6=e.wasm.cwrap(gc,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function $3e(e){let{inputs:t,attrs:n,backend:r}=e,a=t.x,i=r.dataIdMap.get(a.dataId).id;k.assert(a.dtype==="float32",()=>`Error in MaxPool: only float32 input is supported. Got ${a.dtype}.`);let{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=n,u=N.computePool2DInfo(a.shape,s,o,1,l,c),d=u.filterHeight,p=u.filterWidth,h=u.padInfo.top,f=u.padInfo.right,m=u.padInfo.bottom,g=u.padInfo.left,y=u.dilationHeight,b=u.dilationWidth,v=u.strideHeight,x=u.strideWidth,w=u.inChannels,S=u.outChannels;if(u.dataFormat!=="channelsLast")throw new Error(`wasm backend does not support dataFormat:'${u.dataFormat}'. Please use 'channelsLast'.`);let C=r.makeOutput(u.outShape,"float32"),T=r.dataIdMap.get(C.dataId).id;return Q6(i,a.shape[0],a.shape[1],a.shape[2],d,p,h,f,m,g,y,b,v,x,w,S,T),C}var A3e={kernelName:gc,backendName:"wasm",setupFunc:E3e,kernelFunc:$3e},J6;function R3e(e){J6=e.wasm.cwrap("MaxPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function F3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=r,u=N.computePool3DInfo(a.shape,i,s,1,o,l,c),d=n.makeOutput(u.outShape,a.dtype);return J6(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),d}var D3e={kernelName:ch,backendName:"wasm",setupFunc:R3e,kernelFunc:F3e},ej;function M3e(e){ej=e.wasm.cwrap("MaxPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function O3e(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r,u=N.computePool3DInfo(i.shape,s,o,1,l,c),d=n.makeOutput(i.shape,i.dtype);return ej(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inDepth,u.inHeight,u.inWidth,u.outDepth,u.outHeight,u.outWidth,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),d}var P3e={kernelName:Cg,backendName:"wasm",setupFunc:M3e,kernelFunc:O3e},tj;function z3e(e){tj=e.wasm.cwrap("MaxPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function L3e(e){let{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r,u=N.computePool2DInfo(i.shape,s,o,1,l,c),d=n.makeOutput(i.shape,i.dtype);return tj(n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.top,u.padInfo.left),d}var B3e={kernelName:Ig,backendName:"wasm",setupFunc:z3e,kernelFunc:L3e},nj;function W3e(e){nj=e.wasm.cwrap("MaxPoolWithArgmax",null,["number","number","number","number","boolean","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function V3e(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:s,pad:o,includeBatchInIndex:l}=r;k.assert(a.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.shape.length}.`);let c=[1,1];k.assert(N.eitherStridesOrDilationsAreOne(s,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);let u=N.computePool2DInfo(a.shape,i,s,[1,1],o),d=n.makeOutput(u.outShape,a.dtype),p=n.makeOutput(u.outShape,"int32");return nj(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,n.dataIdMap.get(p.dataId).id,yt[a.dtype],l,u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.top,u.padInfo.left),[d,p]}var U3e={kernelName:_g,backendName:"wasm",setupFunc:W3e,kernelFunc:V3e},rj;function j3e(e){rj=e.wasm.cwrap(yc,null,["number, number, number"])}function H3e(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,c=s,{transposed:u,axes:d,originalAxes:p,inputWasTransposed:h}=cl(s,a,t),f=d;if(h){let x=t.dataIdMap.get(u.dataId).id;x!==o&&(c=u,l=x,f=N.getInnerMostAxes(f.length,c.shape.length))}N.assertAxesAreInnerMostDims("mean",f,c.shape.length);let[m,g]=N.computeOutAndReduceShapes(c.shape,f),y=k.sizeFromShape(g),b=c;c.dtype!=="float32"&&(b=dl({backend:t,inputs:{x:c},attrs:{dtype:"float32"}}),l=t.dataIdMap.get(b.dataId).id);let v=t.makeOutput(m,"float32");if(k.sizeFromShape(c.shape)!==0){let x=t.dataIdMap.get(v.dataId).id;rj(l,y,x)}if(h&&t.disposeData(u.dataId),i){let x=N.expandShapeToKeepDim(v.shape,p);v.shape=x}return c.dtype!=="float32"&&t.disposeData(b.dataId),v}var G3e={kernelName:yc,backendName:"wasm",setupFunc:j3e,kernelFunc:H3e},aj;function q3e(e){aj=e.wasm.cwrap(bc,null,["number","number","number","number"])}function K3e(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,c=s,{transposed:u,axes:d,originalAxes:p,inputWasTransposed:h}=cl(s,a,t);if(h){let v=t.dataIdMap.get(u.dataId).id;v!==o&&(c=u,l=v)}let f=c.shape.length;N.assertAxesAreInnerMostDims("min",d,f);let[m,g]=N.computeOutAndReduceShapes(c.shape,d),y=k.sizeFromShape(g),b=t.makeOutput(m,c.dtype);if(k.sizeFromShape(c.shape)!==0){let v=t.dataIdMap.get(b.dataId).id;aj(l,yt[s.dtype],y,v)}if(h&&t.disposeData(u.dataId),i){let v=N.expandShapeToKeepDim(b.shape,p);b.shape=v}return b}var X3e={kernelName:bc,backendName:"wasm",setupFunc:q3e,kernelFunc:K3e},Y3e=_n(vc),jI;(function(e){e[e.reflect=0]="reflect",e[e.symmetric=1]="symmetric"})(jI||(jI={}));var ij;function Z3e(e){ij=e.wasm.cwrap(xc,null,["number","array","number","number","array","array","number","number"])}function Q3e(e){let{inputs:{x:t},backend:n,attrs:{paddings:r,mode:a}}=e,i=r.map((f,m)=>f[0]+t.shape[m]+f[1]),s=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(i,t.dtype),l=n.dataIdMap.get(o.dataId).id,c=new Uint8Array(new Int32Array(t.shape).buffer),u=r.map(f=>f[0]),d=r.map(f=>f[1]),p=new Uint8Array(new Int32Array(u).buffer),h=new Uint8Array(new Int32Array(d).buffer);return ij(s,c,t.shape.length,yt[t.dtype],p,h,jI[a],l),o}var J3e={kernelName:xc,backendName:"wasm",kernelFunc:Q3e,setupFunc:Z3e},sj;function ePe(e){sj=e.wasm.cwrap(jc,null,["number","number","number","number"])}function oj(e){let{backend:t,inputs:{logits:n},attrs:{dim:r}}=e,a=t.dataIdMap.get(n.dataId).id,i=t.makeOutput(n.shape,n.dtype),s=t.dataIdMap.get(i.dataId).id,o=n.shape[r],l=k.sizeFromShape(n.shape)/o;return k.sizeFromShape(i.shape)===0||sj(a,s,o,l),i}var tPe={kernelName:jc,backendName:"wasm",setupFunc:ePe,kernelFunc:oj},lj;function nPe(e){lj=e.wasm.cwrap(dh,null,["number","number","number","number","number","number"])}function rPe(e){let{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:s,normalized:o}=r;if(a.dtype!=="float32")throw new Error(`Tensor logits must have dtype float32, got ${a.dtype}`);let l=o?a:oj({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),[c,u]=l.shape,d=n.makeOutput([c,i],"int32");return lj(n.dataIdMap.get(l.dataId).id,c,u,i,s,n.dataIdMap.get(d.dataId).id),o||n.disposeData(l.dataId),d}var aPe={kernelName:dh,backendName:"wasm",setupFunc:nPe,kernelFunc:rPe},iPe=_n(wc),sPe=_n(kc),oPe=pt(ph);function NE(e,t){let n=new Int32Array(e.wasm.HEAPU8.buffer,t,4),r=n[0],a=n[1],i=n[2],s=n[3];return e.wasm._free(t),{pSelectedIndices:r,selectedSize:a,pSelectedScores:i,pValidOutputs:s}}var uj;function lPe(e){uj=e.wasm.cwrap(fh,"number",["number","number","number","number","number"])}function uPe(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:i,scoreThreshold:s}=r,{boxes:o,scores:l}=n,c=t.dataIdMap.get(o.dataId).id,u=t.dataIdMap.get(l.dataId).id,d=uj(c,u,i,a,s),{pSelectedIndices:p,selectedSize:h,pSelectedScores:f,pValidOutputs:m}=NE(t,d);return t.wasm._free(f),t.wasm._free(m),t.makeOutput([h],"int32",p)}var cPe={kernelName:fh,backendName:"wasm",setupFunc:lPe,kernelFunc:uPe},cj;function dPe(e){cj=e.wasm.cwrap(mh,"number",["number","number","number","number","number","bool"])}function pPe(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:i,scoreThreshold:s,padToMaxOutputSize:o}=r,{boxes:l,scores:c}=n,u=t.dataIdMap.get(l.dataId).id,d=t.dataIdMap.get(c.dataId).id,p=cj(u,d,i,a,s,o),{pSelectedIndices:h,selectedSize:f,pSelectedScores:m,pValidOutputs:g}=NE(t,p);t.wasm._free(m);let y=t.makeOutput([f],"int32",h),b=t.makeOutput([],"int32",g);return[y,b]}var hPe={kernelName:mh,backendName:"wasm",setupFunc:dPe,kernelFunc:pPe},dj;function fPe(e){dj=e.wasm.cwrap(gh,"number",["number","number","number","number","number","number"])}function mPe(e){let{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:i,scoreThreshold:s,softNmsSigma:o}=r,{boxes:l,scores:c}=n,u=t.dataIdMap.get(l.dataId).id,d=t.dataIdMap.get(c.dataId).id,p=dj(u,d,i,a,s,o),{pSelectedIndices:h,selectedSize:f,pSelectedScores:m,pValidOutputs:g}=NE(t,p);t.wasm._free(g);let y=t.makeOutput([f],"int32",h),b=t.makeOutput([f],"float32",m);return[y,b]}var gPe={kernelName:gh,backendName:"wasm",setupFunc:fPe,kernelFunc:mPe},yPe=!1,bPe=_n(hh,yPe,"bool"),pj;function vPe(e){pj=e.wasm.cwrap(Sc,null,["number","number","number","number","number"])}function xPe(e){let{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:s,onValue:o,offValue:l}=r,c=n.makeOutput([...a.shape,s],i),u=n.dataIdMap.get(c.dataId).id,d=n.dataIdMap.get(a.dataId).id;return pj(d,s,o,l,u),c}var wPe={kernelName:Sc,backendName:"wasm",setupFunc:vPe,kernelFunc:xPe};function kPe(e){let{inputs:{x:t},backend:n}=e,r=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(r).fill(1),r}var SPe={kernelName:yh,backendName:"wasm",kernelFunc:kPe};function IPe(e){let{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(t.length===1)return UI({inputs:{input:t[0]},backend:n,attrs:{dim:a}});let i=t[0].shape,s=t[0].dtype;t.forEach(u=>{k.assertShapesMatch(i,u.shape,"All tensors passed to stack must have matching shapes"),k.assert(s===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let o=[],l=t.map(u=>{let d=UI({inputs:{input:u},backend:n,attrs:{dim:a}});return o.push(d),d}),c=S6({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(u=>n.disposeData(u.dataId)),c}var CPe={kernelName:bh,backendName:"wasm",kernelFunc:IPe},hj;function _Pe(e){hj=e.wasm.cwrap(Ic,null,["number","array","number","number","array","array","number","number"])}function TPe(e){let{inputs:{x:t},backend:n,attrs:{paddings:r,constantValue:a}}=e,i=r.map((f,m)=>f[0]+t.shape[m]+f[1]);if(k.sizeFromShape(t.shape)===0)return B6({backend:n,attrs:{shape:i,value:a,dtype:t.dtype}});let s=n.dataIdMap.get(t.dataId).id,o=n.makeOutput(i,t.dtype),l=n.dataIdMap.get(o.dataId).id,c=new Uint8Array(new Int32Array(t.shape).buffer),u=r.map(f=>f[0]),d=r.map(f=>f[1]),p=new Uint8Array(new Int32Array(u).buffer),h=new Uint8Array(new Int32Array(d).buffer);return hj(s,c,t.shape.length,yt[t.dtype],p,h,a,l),o}var fj={kernelName:Ic,backendName:"wasm",kernelFunc:TPe,setupFunc:_Pe},NPe=_n(Cc),mj;function EPe(e){mj=e.wasm.cwrap(_c,null,["number","number","number"])}function $Pe(e){let{inputs:t,backend:n}=e,{x:r,alpha:a}=t,i=n.dataIdMap.get(r.dataId).id,s=n.dataIdMap.get(a.dataId).id,o=i,l=r,c=l;l.dtype!=="float32"&&(c=dl({backend:n,inputs:{x:r},attrs:{dtype:"float32"}}),o=n.dataIdMap.get(c.dataId).id);let u=n.makeOutput(r.shape,"float32"),d=n.dataIdMap.get(u.dataId).id;return mj(o,s,d),l.dtype!=="float32"&&n.disposeData(c.dataId),u}var APe={kernelName:_c,backendName:"wasm",setupFunc:EPe,kernelFunc:$Pe},gj;function RPe(e){gj=e.wasm.cwrap(Tc,null,["number","number","number","number"])}function FPe(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,c=s,{transposed:u,axes:d,originalAxes:p,inputWasTransposed:h}=cl(s,a,t),f=d;if(h){let v=t.dataIdMap.get(u.dataId).id;v!==o&&(c=u,l=v,f=N.getInnerMostAxes(f.length,c.shape.length))}N.assertAxesAreInnerMostDims("prod",f,c.shape.length);let[m,g]=N.computeOutAndReduceShapes(c.shape,f),y=k.sizeFromShape(g),b=t.makeOutput(m,c.dtype);if(k.sizeFromShape(c.shape)!==0){let v=t.dataIdMap.get(b.dataId).id;gj(l,y,yt[b.dtype],v)}if(h&&t.disposeData(u.dataId),i){let v=N.expandShapeToKeepDim(b.shape,p);b.shape=v}return b}var DPe={kernelName:Tc,backendName:"wasm",setupFunc:RPe,kernelFunc:FPe},MPe=e=>{let{backend:t,attrs:n}=e,{start:r,stop:a,step:i,dtype:s}=n,o=rE(r,a,i,s),l=t.makeOutput([o.length],s);return t.typedArrayFromHeap(l).set(o),l},OPe={kernelName:Tg,backendName:"wasm",kernelFunc:MPe},PPe=_n(Zu),zPe=pt(Nc),LPe=pt(Ec),BPe=pt(Rc),yj;function WPe(e){yj=e.wasm.cwrap(Ac,null,["number","number","number","number","number","number","number","number","number","number"])}function VPe(e){let{backend:t,inputs:n,attrs:r}=e,{images:a}=n,{alignCorners:i,halfPixelCenters:s,size:o}=r,[l,c]=o,[u,d,p,h]=a.shape,f=[u,l,c,h],m=t.dataIdMap.get(a.dataId),g;m.dtype!=="float32"&&(g=dl({backend:t,inputs:{x:a},attrs:{dtype:"float32"}}),m=t.dataIdMap.get(g.dataId));let y=m.id,b=t.makeOutput(f,"float32");if(k.sizeFromShape(a.shape)===0)return b;let v=t.dataIdMap.get(b.dataId).id;return yj(y,u,d,p,h,l,c,i?1:0,s?1:0,v),g!=null&&t.disposeData(g.dataId),b}var UPe={kernelName:Ac,backendName:"wasm",setupFunc:WPe,kernelFunc:VPe},bj;function jPe(e){bj=e.wasm.cwrap(wh,null,["number","number","number","array","array","boolean"])}function HPe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r,o=n.makeOutput(a.shape,"float32"),l=n.dataIdMap.get(a.dataId),c;return l.dtype!=="float32"&&(c=dl({backend:n,inputs:{x:a},attrs:{dtype:"float32"}}),l=n.dataIdMap.get(c.dataId)),bj(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(o.dataId).id,new Uint8Array(new Int32Array(a.shape).buffer),new Uint8Array(new Int32Array(i.shape).buffer),s),c!=null&&n.disposeData(c.dataId),o}var GPe={kernelName:wh,backendName:"wasm",setupFunc:jPe,kernelFunc:HPe},vj;function qPe(e){vj=e.wasm.cwrap($c,null,["number","number","number","number","number","number","number","number","number","number"])}function KPe(e){let{backend:t,inputs:n,attrs:r}=e,{images:a}=n,{alignCorners:i,halfPixelCenters:s,size:o}=r,[l,c]=o,[u,d,p,h]=a.shape,f=[u,l,c,h],m=t.makeOutput(f,"float32");if(k.sizeFromShape(a.shape)===0)return m;let g=t.dataIdMap.get(a.dataId),y;g.dtype!=="float32"&&(y=dl({backend:t,inputs:{x:a},attrs:{dtype:"float32"}}),g=t.dataIdMap.get(y.dataId));let b=g.id,v=t.dataIdMap.get(m.dataId).id;return vj(b,u,d,p,h,l,c,i?1:0,s?1:0,v),y!=null&&t.disposeData(y.dataId),m}var XPe={kernelName:$c,backendName:"wasm",setupFunc:qPe,kernelFunc:KPe},xj;function YPe(e){xj=e.wasm.cwrap(xh,null,["number","number","number","array","array","boolean"])}function ZPe(e){let{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:s}=r,o=n.makeOutput(a.shape,"float32"),l=n.dataIdMap.get(a.dataId),c;return l.dtype!=="float32"&&(c=dl({backend:n,inputs:{x:a},attrs:{dtype:"float32"}}),l=n.dataIdMap.get(c.dataId)),xj(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(i.dataId).id,n.dataIdMap.get(o.dataId).id,new Uint8Array(new Int32Array(a.shape).buffer),new Uint8Array(new Int32Array(i.shape).buffer),s),c!=null&&n.disposeData(c.dataId),o}var QPe={kernelName:xh,backendName:"wasm",setupFunc:YPe,kernelFunc:ZPe},wj;function JPe(e){wj=e.wasm.cwrap(Fc,null,["number","array","number","array","number","number"])}function eze(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r,s=k.parseAxisParam(i,a.shape);if(a.shape.length===0)return J1({inputs:{x:a},backend:n});let o=n.makeOutput(a.shape,a.dtype),l=n.dataIdMap.get(a.dataId).id,c=n.dataIdMap.get(o.dataId).id,u=new Uint8Array(new Int32Array(s).buffer),d=new Uint8Array(new Int32Array(a.shape).buffer);wj(l,u,s.length,d,a.shape.length,c);let p=Vr({inputs:{x:o},attrs:{shape:a.shape},backend:n});return n.disposeData(o.dataId),p}var tze={kernelName:Fc,backendName:"wasm",kernelFunc:eze,setupFunc:JPe},kj;function nze(e){kj=e.wasm.cwrap(Oh,null,["number","number","number","number","number","number","number","number","array","number","number"])}function rze(e){let{inputs:t,backend:n,attrs:r}=e,{image:a}=t,{radians:i,fillValue:s,center:o}=r,l=n.makeOutput(a.shape,a.dtype),c=n.dataIdMap.get(a.dataId).id,u=n.dataIdMap.get(l.dataId).id,[d,p,h,f]=a.shape,[m,g]=N.getImageCenter(o,p,h),y=s===0,b=255,v=typeof s=="number"?[s,s,s,y?0:b]:[...s,b],x=new Uint8Array(new Int32Array(v).buffer);return kj(c,d,p,h,f,i,m,g,x,v.length,u),l}var aze={kernelName:Oh,backendName:"wasm",kernelFunc:rze,setupFunc:nze},ize=pt(Dc),sze=pt(Mc),Sj;function oze(e){Sj=e.wasm.cwrap(kh,null,["number","number","number","number","number","number","array","number","number"])}function lze(e){let{backend:t,inputs:n,attrs:r}=e,{indices:a,updates:i}=n,{shape:s}=r,o=t.makeOutput(s,i.dtype);if(k.sizeFromShape(s)===0)return o;let{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:p}=y1.calculateShapes(i,a,s),h=t.dataIdMap.get(a.dataId).id,f=t.dataIdMap.get(i.dataId).id,m=new Uint8Array(new Int32Array(d).buffer),g=t.dataIdMap.get(o.dataId).id;return Sj(h,f,yt[i.dtype],l,c,u,m,p,g),o}var uze={kernelName:kh,backendName:"wasm",setupFunc:oze,kernelFunc:lze},Ij;function cze(e){Ij=e.wasm.cwrap(Ih,null,["number","number","number","number","number","number","bool","number"])}function dze(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:s}=r;if(a.dtype!==i.dtype)throw new Error(`SearchSorted error: sorted_sequence must have the same dtype as values. Got ${a.dtype} and ${i.dtype}`);let o=n.makeOutput(i.shape,"int32");function l(c){return n.dataIdMap.get(c.dataId).id}return Ij(l(a),l(i),a.shape[0],a.shape[1],i.shape[1],yt[a.dtype],s==="left",l(o)),o}var pze={kernelName:Ih,backendName:"wasm",setupFunc:cze,kernelFunc:dze},Cj;function hze(e){Cj=e.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}function fze(e){let{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t,s=n.dataIdMap.get(r.dataId).id,o=n.dataIdMap.get(a.dataId).id,l=n.dataIdMap.get(i.dataId).id,c=n.makeOutput(a.shape,a.dtype),u=n.dataIdMap.get(c.dataId).id,d=r.shape.length,p=a.shape.length,h=d===0||d>1||p===1?1:k.sizeFromShape(a.shape.slice(1));return Cj(s,o,l,h,u),c}var mze={kernelName:Ch,backendName:"wasm",kernelFunc:fze,setupFunc:hze},gze=pt(Oc),_j;function yze(e){_j=e.wasm.cwrap(Bc,null,["number","number"])}function bze(e){let{backend:t,inputs:{x:n}}=e,r=t.dataIdMap.get(n.dataId).id,a=t.makeOutput(n.shape,n.dtype),i=t.dataIdMap.get(a.dataId).id;return k.sizeFromShape(a.shape)===0||_j(r,i),a}var vze={kernelName:"Sigmoid",backendName:"wasm",setupFunc:yze,kernelFunc:bze},xze=pt(Lc),wze=pt(Pc),kze=pt(zc),Sze=pt(Wc);function Ize(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:s}=r,o=k.sizeFromShape(i),l=[[0,0]];l.push(...s);for(let g=1+i.length;g<a.shape.length;++g)l.push([0,0]);let c=fj.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),u=N.getReshaped(c.shape,i,o,!1),d=N.getPermuted(u.length,i.length,!1),p=N.getReshapedPermuted(c.shape,i,o,!1),h=Vr({inputs:{x:c},backend:n,attrs:{shape:u}}),f=Go({inputs:{x:h},backend:n,attrs:{perm:d}}),m=Vr({inputs:{x:f},backend:n,attrs:{shape:p}});return n.disposeData(c.dataId),n.disposeData(h.dataId),n.disposeData(f.dataId),m}var Cze={kernelName:Th,backendName:"wasm",kernelFunc:Ize},Tj;function _ze(e){Tj=e.wasm.cwrap("SparseFillEmptyRows","number",["number","number","number","number","number","number","number","number","number","number","number","number"])}function Tze(e){let{backend:t,inputs:n}=e,{indices:r,values:a,denseShape:i,defaultValue:s}=n,o=r.shape[0],l=r.shape[1],c=t.readSync(i.dataId)[0],u=[o+c,l],d=t.dataIdMap.get(r.dataId).id,p=t.dataIdMap.get(a.dataId).id,h=t.dataIdMap.get(s.dataId).id,f=t.makeOutput(u,r.dtype),m=t.dataIdMap.get(f.dataId).id,g=t.makeOutput(u.slice(0,1),a.dtype),y=t.dataIdMap.get(g.dataId).id,b=t.makeOutput([c],"bool"),v=t.dataIdMap.get(b.dataId).id,x=t.makeOutput([o],r.dtype),w=t.dataIdMap.get(x.dataId).id,S=t.makeOutput([4],"int32"),C=t.dataIdMap.get(S.dataId).id,T=Tj(d,p,yt[a.dtype],o,c,l,h,m,y,v,w,C),E=t.readSync(S.dataId),R;switch(E[0]){case 1:{R=N.getSparseFillEmptyRowsIndicesDenseShapeMismatch(E[1]);break}case 2:{R=N.getSparseFillEmptyRowsNegativeIndexErrorMessage(E[1],E[2]);break}case 3:R=N.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(E[1],E[2],E[3]);break;default:R=""}if(t.disposeData(S.dataId),R)throw t.disposeData(f.dataId),t.disposeData(g.dataId),t.disposeData(b.dataId),t.disposeData(x.dataId),new Error(R);let $=f,_=g;return T!==u[0]&&($=Su({inputs:{x:f},attrs:{begin:0,size:[T,l]},backend:t}),_=Su({inputs:{x:g},attrs:{begin:0,size:T},backend:t}),t.disposeData(f.dataId),t.disposeData(g.dataId)),[$,_,b,x]}var Nze={kernelName:Ng,backendName:"wasm",setupFunc:_ze,kernelFunc:Tze},Nj;function Eze(e){Nj=e.wasm.cwrap(Eh,null,["number","number","number","number","number","number","number"])}function $ze(e){let{backend:t,inputs:n}=e,{inputIndices:r,inputShape:a,newShape:i}=n;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${a.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);let s=t.dataIdMap.get(r.dataId).id,o=t.dataIdMap.get(a.dataId).id,l=t.dataIdMap.get(i.dataId).id,c=r.shape[0],u=k.sizeFromShape(i.shape),d=t.makeOutput([c,u],r.dtype),p=t.dataIdMap.get(d.dataId).id,h=t.makeOutput([u],i.dtype),f=t.dataIdMap.get(h.dataId).id,m=t.makeOutput([3],"int32"),g=t.dataIdMap.get(m.dataId).id;Nj(s,o,l,c,p,f,g);let y=t.readSync(m.dataId),b;switch(y[0]){case 0:{b=N.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(y[1],y[2]);break}case 1:{b=N.getSparseReshapeNegativeOutputDimErrorMessage(y[1],y[2]);break}case 2:b=N.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage();break;case 3:{let v=Array.from(t.readSync(a.dataId)),x=Array.from(t.readSync(h.dataId));b=N.getSparseReshapeInputOutputMultipleErrorMessage(v,x);break}case 4:{let v=Array.from(t.readSync(a.dataId)),x=Array.from(t.readSync(h.dataId));b=N.getSparseReshapeInputOutputMismatchErrorMessage(v,x);break}default:b=""}if(t.disposeData(m.dataId),b)throw t.disposeData(d.dataId),t.disposeData(h.dataId),new Error(b);return[d,h]}var Aze={kernelName:Eh,backendName:"wasm",setupFunc:Eze,kernelFunc:$ze},Ej;function $j(e){Ej=e.wasm.cwrap("SparseSegmentReduction",null,["number","number","number","number","number","number","number","number","number"])}function Aj(e,t){let{backend:n,inputs:r}=e,{data:a,indices:i,segmentIds:s}=r,o=i.shape[0],l=n.readSync(s.dataId,o-1,o)[0],c=o>0?l+1:0;if(c<0)throw new Error(N.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let u=a.shape.slice();u[0]=c;let d=n.dataIdMap.get(a.dataId).id,p=n.dataIdMap.get(i.dataId).id,h=n.dataIdMap.get(s.dataId).id,f=n.makeOutput(u,a.dtype),m=n.dataIdMap.get(f.dataId).id,g=n.makeOutput([4],"int32"),y=n.dataIdMap.get(g.dataId).id;Ej(d,yt[a.dtype],a.shape[0],p,h,m,y,t,0);let b=n.readSync(g.dataId),v;switch(b[0]){case 0:{v=N.getSparseSegmentReductionNegativeSegmentIdsErrorMessage();break}case 1:{v=N.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage();break}case 2:v=N.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(b[1],b[2]);break;case 3:v=N.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(b[1],b[2],b[3]);break;default:v=""}if(n.disposeData(g.dataId),v)throw n.disposeData(f.dataId),new Error(v);return f}function Rze(e){return Aj(e,!0)}var Fze={kernelName:Eg,backendName:"wasm",setupFunc:$j,kernelFunc:Rze};function Dze(e){return Aj(e,!1)}var Mze={kernelName:$g,backendName:"wasm",setupFunc:$j,kernelFunc:Dze},Rj;function Oze(e){Rj=e.wasm.cwrap($h,null,["number","number","number","number","number","number","number","number","array","number","number"])}function Pze(e){let{backend:t,inputs:n,attrs:r}=e,{sparseIndices:a,sparseValues:i,defaultValue:s}=n,{outputShape:o}=r,l=t.makeOutput(o,s.dtype);if(k.sizeFromShape(o)===0)return l;let{sliceRank:c,numUpdates:u,sliceSize:d,strides:p,outputSize:h}=N.calculateShapes(i,a,o),f=t.dataIdMap.get(a.dataId).id,m=t.dataIdMap.get(i.dataId).id,g=t.dataIdMap.get(s.dataId).id,y=new Uint8Array(new Int32Array(p).buffer),b=t.dataIdMap.get(l.dataId).id;return Rj(f,m,i.shape.length,g,yt[s.dtype],c,u,d,y,h,b),l}var zze={kernelName:$h,backendName:"wasm",setupFunc:Oze,kernelFunc:Pze};function Lze(e){let{inputs:t,attrs:n,backend:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:s}=n,o=k.parseAxisParam(s,a.shape)[0],l=N.prepareSplitSize(a,i,o),c=new Array(a.shape.length).fill(0),u=a.shape.slice();return l.map(d=>{let p=[...u];p[o]=d;let h=Su({inputs:{x:a},attrs:{begin:c,size:p},backend:r});return c[o]+=d,h})}var Bze={kernelName:Nh,backendName:"wasm",kernelFunc:Lze},Wze=pt(Vc),Vze=pt(Ag),Uze=_n(Hc),Fj;function jze(e){Fj=e.wasm.cwrap(nl,null,["number","number","number","number"])}function Hze(e){let{backend:t,inputs:n,attrs:r}=e,{alpha:a}=r,{x:i}=n,s=t.dataIdMap.get(i.dataId).id,o=t.makeOutput(i.shape,i.dtype),l=t.dataIdMap.get(o.dataId).id;return Fj(s,a,yt[i.dtype],l),o}var Gze={kernelName:nl,backendName:"wasm",setupFunc:jze,kernelFunc:Hze},Dj;function qze(e){Dj=e.wasm.cwrap(Ah,null,["number","array","number","array","array","array","array","array","number","number"])}function Kze(e){let{backend:t,inputs:n,attrs:r}=e,{x:a}=n,{begin:i,end:s,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:p}=r,{finalShapeSparse:h,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:b,end:v,strides:x}=Dn.sliceInfo(a.shape,i,s,o,l,c,u,d,p),w;if(m)w=Vr({inputs:{x:a},backend:t,attrs:{shape:f}});else if(g||y){k.assert(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);let S=Dn.computeOutShape(b,v,x),C=Su({inputs:{x:a},backend:t,attrs:{begin:b,size:S}});w=Vr({inputs:{x:C},backend:t,attrs:{shape:f}}),t.disposeData(C.dataId)}else{let S=t.makeOutput(h,"float32"),C=t.dataIdMap.get(a.dataId).id,T=new Uint8Array(new Int32Array(k.computeStrides(a.shape)).buffer),E=new Uint8Array(new Int32Array(b).buffer),R=new Uint8Array(new Int32Array(v).buffer),$=new Uint8Array(new Int32Array(x).buffer),_=new Uint8Array(new Int32Array(h).buffer),D=new Uint8Array(new Int32Array(k.computeStrides(h)).buffer),P=t.dataIdMap.get(S.dataId).id;Dj(C,T,a.shape.length,E,R,$,_,D,h.length,P),w=Vr({inputs:{x:S},backend:t,attrs:{shape:f}}),t.disposeData(S.dataId)}return w}var Xze={kernelName:Ah,backendName:"wasm",setupFunc:qze,kernelFunc:Kze};function Yze(e){let{backend:t,inputs:n,attrs:r}=e,{data:a,dataSplits:i}=n,{separator:s,nGramWidths:o,leftPad:l,rightPad:c,padWidth:u,preserveShortSequences:d}=r,p=t.readSync(a.dataId),h=t.readSync(i.dataId),[f,m]=iE(p,h,s,o,l,c,u,d),g=t.makeOutput([f.length],"string"),y=t.dataIdMap.get(g.dataId);y.stringBytes=f;let b=t.makeOutput(i.shape,"int32");return t.typedArrayFromHeap(b).set(m),[g,b]}var Zze={kernelName:Fg,backendName:"wasm",kernelFunc:Yze};function Qze(e){let{backend:t,inputs:n,attrs:r}=e,{input:a,delimiter:i}=n,{skipEmpty:s}=r,o=t.readSync(a.dataId),l=t.readSync(i.dataId),[c,u,d]=sE(o,l[0],s),p=u.length,h=t.makeOutput([p,2],"int32");t.typedArrayFromHeap(h).set(c);let f=t.makeOutput([p],"string"),m=t.dataIdMap.get(f.dataId);m.stringBytes=u;let g=t.makeOutput([2],"int32");return t.typedArrayFromHeap(g).set(d),[h,f,g]}var Jze={kernelName:Dg,backendName:"wasm",kernelFunc:Qze};function eLe(e){let{backend:t,inputs:n,attrs:r}=e,{input:a}=n,{numBuckets:i}=r,s=t.readSync(a.dataId),o=oE(s,i),l=t.makeOutput(a.shape,"int32");return t.typedArrayFromHeap(l).set(o),l}var tLe={kernelName:Mg,backendName:"wasm",kernelFunc:eLe},nLe=_n(Gc),Mj;function rLe(e){Mj=e.wasm.cwrap(Uc,null,["number","number","number","number"])}function aLe(e){let{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:i}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,l=o,c=s,{transposed:u,axes:d,originalAxes:p,inputWasTransposed:h}=cl(s,a,t),f=d;if(h){let v=t.dataIdMap.get(u.dataId).id;v!==o&&(c=u,l=v,f=N.getInnerMostAxes(f.length,c.shape.length))}N.assertAxesAreInnerMostDims("sum",f,c.shape.length);let[m,g]=N.computeOutAndReduceShapes(c.shape,f),y=k.sizeFromShape(g),b=t.makeOutput(m,c.dtype);if(k.sizeFromShape(c.shape)!==0){let v=t.dataIdMap.get(b.dataId).id;Mj(l,y,yt[b.dtype],v)}if(h&&t.disposeData(u.dataId),i){let v=N.expandShapeToKeepDim(b.shape,p);b.shape=v}return b}var iLe={kernelName:Uc,backendName:"wasm",setupFunc:rLe,kernelFunc:aLe},sLe=pt(qc),oLe=pt(Kc),Oj;function lLe(e){Oj=e.wasm.cwrap(Sh,null,["number","number","number","number","number","number","array","number","number","number"])}function uLe(e){let{backend:t,inputs:n,attrs:r}=e,{tensor:a,indices:i,updates:s}=n,o=t.makeOutput(a.shape,a.dtype);if(k.sizeFromShape(a.shape)===0)return o;let{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:p}=y1.calculateShapes(s,i,a.shape),h=t.dataIdMap.get(i.dataId).id,f=t.dataIdMap.get(s.dataId).id,m=t.dataIdMap.get(a.dataId).id,g=new Uint8Array(new Int32Array(d).buffer),y=t.dataIdMap.get(o.dataId).id;return Oj(h,f,yt[s.dtype],l,c,u,g,p,y,m),o}var cLe={kernelName:Sh,backendName:"wasm",setupFunc:lLe,kernelFunc:uLe},Pj;function dLe(e){Pj=e.wasm.cwrap(tl,null,["number","array","number","array","number","number"])}function pLe(e){let{inputs:t,backend:n,attrs:r}=e,{x:a}=t,i=n.dataIdMap.get(a.dataId).id,{reps:s}=r,o=new Array(a.shape.length);for(let p=0;p<o.length;p++)o[p]=a.shape[p]*s[p];let l=new Uint8Array(new Int32Array(a.shape).buffer),c=new Uint8Array(new Int32Array(o).buffer),u=n.makeOutput(o,a.dtype),d=n.dataIdMap.get(u.dataId).id;return Pj(i,l,a.shape.length,c,o.length,yt[u.dtype],d),u}var hLe={kernelName:tl,backendName:"wasm",setupFunc:dLe,kernelFunc:pLe},zj;function fLe(e){zj=e.wasm.cwrap(Rh,null,["number","array","number","number","number","bool","number","number"])}var mLe=({inputs:e,backend:t,attrs:n})=>{let{x:r}=e,{k:a,sorted:i}=n,s=t.dataIdMap.get(r.dataId).id,o=new Uint8Array(new Int32Array(r.shape).buffer),l=r.shape.slice();l[l.length-1]=a;let c=t.makeOutput(l,r.dtype),u=t.dataIdMap.get(c.dataId).id,d=t.makeOutput(l,"int32"),p=t.dataIdMap.get(d.dataId).id;return zj(s,o,r.shape.length,yt[r.dtype],a,i,u,p),[c,d]},gLe={kernelName:Rh,backendName:"wasm",setupFunc:fLe,kernelFunc:mLe},Lj;function yLe(e){Lj=e.wasm.cwrap(Fh,null,["number","number","bool","number","number","number","number","number","number","array","number","array","number","number","number","number","number"])}function bLe(e){let{backend:t,inputs:n,attrs:r}=e,{image:a,transforms:i}=n,{interpolation:s,fillMode:o,fillValue:l,outputShape:c}=r,[u,d,p,h]=a.shape,[f,m]=c??[d,p],g=[u,f,m,h],y=new Uint8Array(new Int32Array(k.computeStrides(a.shape)).buffer),b=new Uint8Array(new Int32Array(k.computeStrides(g)).buffer),v=t.makeOutput(g,a.dtype),x=t.dataIdMap.get(v.dataId).id,w=t.dataIdMap.get(a.dataId).id,S=t.dataIdMap.get(i.dataId).id,C=s==="nearest"?1:2,T;switch(o){case"constant":T=1;break;case"reflect":T=2;break;case"wrap":T=3;break;case"nearest":T=4;break;default:T=1;break}return Lj(w,S,i.shape[0]>1,u,f,m,h,p,d,y,a.shape.length-1,b,g.length-1,C,T,l,x),v}var vLe={kernelName:Fh,backendName:"wasm",setupFunc:yLe,kernelFunc:bLe};function xLe(e){let{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t,{outputValues:s,outputShape:o,indices:l}=uE(r.readSync(i.dataId),a,i.shape,i.dtype);return[r.makeOutput(o,i.dtype,void 0,s),r.makeOutput([l.length],"int32",void 0,l)]}var wLe={kernelName:Og,backendName:"wasm",kernelFunc:xLe};function kLe(e){let{inputs:t,backend:n,attrs:r}=e,{value:a}=t,{axis:i}=r;i<0&&(i+=a.shape.length);let s=a.shape[i],o=a.shape.length,l=new Array(o-1),c=0;for(let h=0;h<o;h++)h!==i&&(l[c++]=a.shape[h]);let u=new Array(s),d=new Array(o).fill(0),p=a.shape.slice();p[i]=1;for(let h=0;h<u.length;h++)d[i]=h,u[h]=Su({inputs:{x:a},attrs:{begin:d,size:p},backend:n});return u.map(({dataId:h,dtype:f})=>({dataId:h,dtype:f,shape:l}))}var SLe={kernelName:Dh,backendName:"wasm",kernelFunc:kLe};function ILe(e){let{inputs:{x:t},backend:n}=e,r=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(r).fill(0),r}var CLe={kernelName:Mh,backendName:"wasm",kernelFunc:ILe},_Le=[yDe,bDe,vDe,xDe,wDe,IDe,RDe,MDe,ODe,PDe,zDe,LDe,BDe,WDe,VDe,HDe,eMe,KDe,ZDe,aMe,cMe,hMe,fMe,gMe,yMe,bMe,wMe,kMe,CMe,NMe,AMe,DMe,PMe,zMe,LMe,VMe,HMe,KMe,ZMe,eOe,rOe,sOe,uOe,pOe,mOe,gOe,vOe,wOe,kOe,SOe,IOe,COe,_Oe,EOe,$Oe,AOe,DOe,POe,BOe,UOe,GOe,KOe,YOe,CDe,ZOe,QOe,JOe,n3e,a3e,s3e,u3e,d3e,c3e,h3e,f3e,g3e,b3e,w3e,I3e,T3e,N3e,A3e,D3e,P3e,B3e,U3e,G3e,X3e,Y3e,J3e,aPe,iPe,sPe,oPe,cPe,hPe,gPe,bPe,wPe,SPe,CPe,fj,NPe,APe,DPe,OPe,PPe,zPe,LPe,BPe,tMe,UPe,GPe,XPe,QPe,tze,aze,ize,sze,uze,pze,mze,gze,vze,xze,wze,kze,lMe,tPe,Sze,Cze,Nze,Aze,Fze,Mze,zze,Bze,Wze,Vze,Uze,Gze,Xze,Zze,Jze,tLe,nLe,iLe,sLe,oLe,cLe,hLe,gLe,vLe,EDe,wLe,SLe,CLe];for(let e of _Le)zg(e);var HI=Q();HI.registerFlag("WASM_HAS_SIMD_SUPPORT",async()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]))}catch{return!1}});HI.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",async()=>{if(HI.get("IS_NODE"))return!1;try{return new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}});var KD=Qo(Sne()),TLe=Qo(Ine()),XD=Qo(Cne()),YD=KD.default||KD,NLe=XD.default||XD,Bj=class extends mg{constructor(e){super(),this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.initWithThreadsCount(Wj),GI=this.wasm.tfjs.getThreadsCount(),this.dataIdMap=new $x(this,Ga())}write(e,t,n){let r={id:this.dataIdNextNumber++};return this.move(r,e,t,n,1),r}numDataIds(){return this.dataIdMap.numDataIds()}async time(e){let t=k.now();return e(),{kernelMs:k.now()-t}}move(e,t,n,r,a){let i=this.dataIdNextNumber++;if(r==="string"){let c=t;this.dataIdMap.set(e,{id:i,stringBytes:c,shape:n,dtype:r,memoryOffset:null,refCount:a});return}let s=k.sizeFromShape(n),o=s*k.bytesPerElement(r),l=this.wasm._malloc(o)>>>0;this.dataIdMap.set(e,{id:i,memoryOffset:l,shape:n,dtype:r,refCount:a}),this.wasm.tfjs.registerTensor(i,s,l),t!=null&&this.wasm.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,o),l)}async read(e){return this.readSync(e)}readSync(e,t,n){let{memoryOffset:r,dtype:a,shape:i,stringBytes:s}=this.dataIdMap.get(e);if(a==="string")return(t==null||t===0)&&(n==null||n>=s.length)?s:s.slice(t,n);t=t||0,n=n||k.sizeFromShape(i);let o=k.bytesPerElement(a),l=this.wasm.HEAPU8.slice(r+t*o,r+n*o);return ALe(l.buffer,a)}disposeData(e,t=!1){if(this.dataIdMap.has(e)){let n=this.dataIdMap.get(e);if(n.refCount--,!t&&n.refCount>0)return!1;this.wasm._free(n.memoryOffset),this.wasm.tfjs.disposeData(n.id),this.dataIdMap.delete(e)}return!0}refCount(e){return this.dataIdMap.has(e)?this.dataIdMap.get(e).refCount:0}incRef(e){let t=this.dataIdMap.get(e);t!=null&&t.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,t,n,r){let a;if(n==null)a=this.write(r??null,e,t);else{let i=this.dataIdNextNumber++;a={id:i},this.dataIdMap.set(a,{id:i,memoryOffset:n,shape:e,dtype:t,refCount:1});let s=k.sizeFromShape(e);this.wasm.tfjs.registerTensor(i,s,n)}return{dataId:a,shape:e,dtype:t}}typedArrayFromHeap({shape:e,dtype:t,dataId:n}){let r=this.wasm.HEAPU8.buffer,{memoryOffset:a}=this.dataIdMap.get(n),i=k.sizeFromShape(e);switch(t){case"float32":return new Float32Array(r,a,i);case"int32":return new Int32Array(r,a,i);case"bool":return new Uint8Array(r,a,i);default:throw new Error(`Unknown dtype ${t}`)}}};function ELe(e){return(t,n)=>(k.fetch(e,{credentials:"same-origin"}).then(r=>{r.ok||t.env.a(`failed to load wasm binary file at '${e}'`),r.arrayBuffer().then(a=>{WebAssembly.instantiate(a,t).then(i=>{n(i.instance,i.module)})})}),{})}function ZD(e,t,n){if(Sv!=null)return Sv;let r="tfjs-backend-wasm.wasm";return e&&t?r="tfjs-backend-wasm-threaded-simd.wasm":e&&(r="tfjs-backend-wasm-simd.wasm"),sm!=null&&sm[r]!=null?sm[r]:n+r}async function $Le(){let[e,t]=await Promise.all([Q().getAsync("WASM_HAS_SIMD_SUPPORT"),Q().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise((n,r)=>{let a={};a.locateFile=(o,l)=>{if(o.endsWith(".worker.js")){let c=TLe.wasmWorkerContents.replace(/\n/g,"\\n"),u=new Blob([c],{type:"application/javascript"});return URL.createObjectURL(u)}return o.endsWith(".wasm")?ZD(e,t,Lf??l):l+o},EE&&(a.instantiateWasm=ELe(ZD(e,t,Lf??"")));let i=!1;a.onAbort=()=>{i||om||(om=!0,r({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"}))};let s;t&&e&&Sv==null?(a.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+YD.toString()],{type:"text/javascript"}),s=YD(a)):s=NLe(a),s.then(o=>{i=!0,om=!1;let l=null;o.tfjs={init:o.cwrap("init",null,[]),initWithThreadsCount:o.cwrap("init_with_threads_count",null,["number"]),getThreadsCount:o.cwrap("get_threads_count","number",[]),registerTensor:o.cwrap("register_tensor",null,["number","number","number"]),disposeData:o.cwrap("dispose_data",l,["number"]),dispose:o.cwrap("dispose",l,[])},n({wasm:o})}).catch(r)})}function ALe(e,t){switch(t){case"float32":return new Float32Array(e);case"int32":return new Int32Array(e);case"bool":return new Uint8Array(e);default:throw new Error(`Unknown dtype ${t}`)}}var RLe=["tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm"],Sv=null,Lf=null,sm={},om=!1,EE=!1;function FLe(e,t=!1){if(LL("setWasmPath has been deprecated in favor of setWasmPaths and will be removed in a future release."),om)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPath()` before you call `tf.setBackend()` or `tf.ready()`");Sv=e,EE=t}function DLe(e,t=!1){if(om)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPaths()` before you call `tf.setBackend()` or `tf.ready()`");if(typeof e=="string")Lf=e;else{sm=e;let n=RLe.filter(r=>sm[r]==null);if(n.length>0)throw new Error(`There were no entries found for the following binaries: ${n.join(",")}. Please either call setWasmPaths with a map providing a path for each binary, or with a string indicating the directory where all the binaries can be found.`)}EE=t}var Wj=-1,GI=-1;function MLe(e){Wj=e}function OLe(){if(GI===-1)throw new Error("WASM backend not initialized.");return GI}var PLe="4.7.0",zLe=2;qx("wasm",async()=>{let{wasm:e}=await $Le();return new Bj(e)},zLe);var QD="4.7.0",LLe="4.7.0",BLe="4.7.0",WLe="4.7.0",VLe="4.7.0",ULe={tfjs:QD,"tfjs-core":QD,"tfjs-converter":LLe,"tfjs-backend-cpu":BLe,"tfjs-backend-webgl":WLe,"tfjs-backend-wasm":VLe},jLe={};LC(jLe,{AnchorPosition:()=>Qj,DrawBox:()=>eH,DrawBoxOptions:()=>Jj,DrawFaceLandmarks:()=>yH,DrawFaceLandmarksOptions:()=>gH,DrawTextField:()=>ew,DrawTextFieldOptions:()=>OE,drawContour:()=>eo,drawDetections:()=>a4e,drawFaceExpressions:()=>b4e,drawFaceLandmarks:()=>w4e});function eo(e,t,n=!1){if(e.beginPath(),t.slice(1).forEach(({x:r,y:a},i)=>{let s=t[i];e.moveTo(s.x,s.y),e.lineTo(r,a)}),n){let r=t[t.length-1],a=t[0];if(!r||!a)return;e.moveTo(r.x,r.y),e.lineTo(a.x,a.y)}e.stroke()}var HLe={};LC(HLe,{computeReshapedDimensions:()=>jj,getCenterPoint:()=>AE,isDimensions:()=>KI,isEven:()=>qI,isFloat:()=>Uj,isTensor:()=>rf,isTensor1D:()=>GLe,isTensor2D:()=>Vj,isTensor3D:()=>vy,isTensor4D:()=>Es,isValidNumber:()=>Xl,isValidProbablitiy:()=>qLe,range:()=>_p,round:()=>$E});var Kl=class{constructor(e,t){if(!Xl(e)||!Xl(t))throw new Error(`Dimensions.constructor - expected width and height to be valid numbers, instead have ${JSON.stringify({width:e,height:t})}`);this._width=e,this._height=t}get width(){return this._width}get height(){return this._height}reverse(){return new Kl(1/this.width,1/this.height)}};function rf(e,t){return e instanceof Ze&&e.shape.length===t}function GLe(e){return rf(e,1)}function Vj(e){return rf(e,2)}function vy(e){return rf(e,3)}function Es(e){return rf(e,4)}function Uj(e){return e%1!==0}function qI(e){return e%2===0}function $E(e,t=2){let n=10**t;return Math.floor(e*n)/n}function KI(e){return e&&e.width&&e.height}function jj({width:e,height:t},n){let r=n/Math.max(t,e);return new Kl(Math.round(e*r),Math.round(t*r))}function AE(e){return e.reduce((t,n)=>t.add(n),new mt(0,0)).div(new mt(e.length,e.length))}function _p(e,t,n){return Array(e).fill(0).map((r,a)=>t+a*n)}function Xl(e){return!!e&&e!==1/0&&e!==-1/0&&!Number.isNaN(e)||e===0}function qLe(e){return Xl(e)&&e>=0&&e<=1}var mt=class{constructor(e,t){this._x=e,this._y=t}get x(){return this._x}get y(){return this._y}add(e){return new mt(this.x+e.x,this.y+e.y)}sub(e){return new mt(this.x-e.x,this.y-e.y)}mul(e){return new mt(this.x*e.x,this.y*e.y)}div(e){return new mt(this.x/e.x,this.y/e.y)}abs(){return new mt(Math.abs(this.x),Math.abs(this.y))}magnitude(){return Math.sqrt(this.x**2+this.y**2)}floor(){return new mt(Math.floor(this.x),Math.floor(this.y))}},ur=class{static isRect(e){return!!e&&[e.x,e.y,e.width,e.height].every(Xl)}static assertIsValidBox(e,t,n=!1){if(!ur.isRect(e))throw new Error(`${t} - invalid box: ${JSON.stringify(e)}, expected object with properties x, y, width, height`);if(!n&&(e.width<0||e.height<0))throw new Error(`${t} - width (${e.width}) and height (${e.height}) must be positive numbers`)}constructor(e,t=!0){let n=e||{},r=[n.left,n.top,n.right,n.bottom].every(Xl),a=[n.x,n.y,n.width,n.height].every(Xl);if(!a&&!r)throw new Error(`Box.constructor - expected box to be IBoundingBox | IRect, instead have ${JSON.stringify(n)}`);let[i,s,o,l]=a?[n.x,n.y,n.width,n.height]:[n.left,n.top,n.right-n.left,n.bottom-n.top];ur.assertIsValidBox({x:i,y:s,width:o,height:l},"Box.constructor",t),this._x=i,this._y=s,this._width=o,this._height=l}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get area(){return this.width*this.height}get topLeft(){return new mt(this.left,this.top)}get topRight(){return new mt(this.right,this.top)}get bottomLeft(){return new mt(this.left,this.bottom)}get bottomRight(){return new mt(this.right,this.bottom)}round(){let[e,t,n,r]=[this.x,this.y,this.width,this.height].map(a=>Math.round(a));return new ur({x:e,y:t,width:n,height:r})}floor(){let[e,t,n,r]=[this.x,this.y,this.width,this.height].map(a=>Math.floor(a));return new ur({x:e,y:t,width:n,height:r})}toSquare(){let{x:e,y:t,width:n,height:r}=this,a=Math.abs(n-r);return n<r&&(e-=a/2,n+=a),r<n&&(t-=a/2,r+=a),new ur({x:e,y:t,width:n,height:r})}rescale(e){let t=KI(e)?e.width:e,n=KI(e)?e.height:e;return new ur({x:this.x*t,y:this.y*n,width:this.width*t,height:this.height*n})}pad(e,t){let[n,r,a,i]=[this.x-e/2,this.y-t/2,this.width+e,this.height+t];return new ur({x:n,y:r,width:a,height:i})}clipAtImageBorders(e,t){let{x:n,y:r,right:a,bottom:i}=this,s=Math.max(n,0),o=Math.max(r,0),l=a-s,c=i-o,u=Math.min(l,e-s),d=Math.min(c,t-o);return new ur({x:s,y:o,width:u,height:d}).floor()}shift(e,t){let{width:n,height:r}=this,a=this.x+e,i=this.y+t;return new ur({x:a,y:i,width:n,height:r})}padAtBorders(e,t){let n=this.width+1,r=this.height+1,a=1,i=1,s=n,o=r,l=this.left,c=this.top,u=this.right,d=this.bottom;return u>t&&(s=-u+t+n,u=t),d>e&&(o=-d+e+r,d=e),l<1&&(o=2-l,l=1),c<1&&(o=2-c,c=1),{dy:i,edy:o,dx:a,edx:s,y:c,ey:d,x:l,ex:u,w:n,h:r}}calibrate(e){return new ur({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()}},Hj=class extends ur{constructor(e,t,n,r,a=!1){super({left:e,top:t,right:n,bottom:r},a)}},RE=class{constructor(e,t,n,r,a){this._imageDims=new Kl(a.width,a.height),this._score=e,this._classScore=t,this._className=n,this._box=new ur(r).rescale(this._imageDims)}get score(){return this._score}get classScore(){return this._classScore}get className(){return this._className}get box(){return this._box}get imageDims(){return this._imageDims}get imageWidth(){return this.imageDims.width}get imageHeight(){return this.imageDims.height}get relativeBox(){return new ur(this._box).rescale(this.imageDims.reverse())}forSize(e,t){return new RE(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:t})}},ai=class extends RE{constructor(e,t,n){super(e,e,"",t,n)}forSize(e,t){let{score:n,relativeBox:r,imageDims:a}=super.forSize(e,t);return new ai(n,r,a)}};function KLe(e,t,n=!0){let r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),a=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),i=r*a;return n?i/(e.area+t.area-i):i/Math.min(e.area,t.area)}function XLe(e){let t=e.map(o=>o.x),n=e.map(o=>o.y),r=t.reduce((o,l)=>l<o?l:o,1/0),a=n.reduce((o,l)=>l<o?l:o,1/0),i=t.reduce((o,l)=>o<l?l:o,0),s=n.reduce((o,l)=>o<l?l:o,0);return new Hj(r,a,i,s)}function YLe(e,t,n,r=!0){let a=t.map((s,o)=>({score:s,boxIndex:o})).sort((s,o)=>s.score-o.score).map(s=>s.boxIndex),i=[];for(;a.length>0;){let s=a.pop();i.push(s);let o=a,l=[];for(let c=0;c<o.length;c++){let u=o[c],d=e[s],p=e[u];l.push(KLe(d,p,r))}a=a.filter((c,u)=>l[u]<=n)}return i}function xy(e,t){return G(()=>{let[n,r,a]=t,i=ua([...e.shape.slice(0,3),1],n,"float32"),s=ua([...e.shape.slice(0,3),1],r,"float32"),o=ua([...e.shape.slice(0,3),1],a,"float32"),l=Et([i,s,o],3);return we(e,l)})}function ZLe(e,t=!1){return G(()=>{let[n,r]=e.shape.slice(1);if(n===r)return e;let a=Math.abs(n-r),i=Math.round(a*(t?.5:1)),s=n>r?2:1,o=d=>{let p=e.shape.slice();return p[s]=d,ua(p,0,"float32")},l=o(i),c=a-l.shape[s],u=[t&&c?o(c):null,e,l].filter(d=>!!d).map(d=>he(d,"float32"));return Et(u,s)})}function xk(e){return 1/(1+Math.exp(-e))}var Gj=class extends ur{constructor(e,t,n,r,a=!1){super({x:e,y:t,width:n,height:r},a)}},QLe=.5,JLe=.43,e4e=.45,Iv=class{constructor(e,t,n=new mt(0,0)){let{width:r,height:a}=t;this._imgDims=new Kl(r,a),this._shift=n,this._positions=e.map(i=>i.mul(new mt(r,a)).add(n))}get shift(){return new mt(this._shift.x,this._shift.y)}get imageWidth(){return this._imgDims.width}get imageHeight(){return this._imgDims.height}get positions(){return this._positions}get relativePositions(){return this._positions.map(e=>e.sub(this._shift).div(new mt(this.imageWidth,this.imageHeight)))}forSize(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})}shiftBy(e,t){return new this.constructor(this.relativePositions,this._imgDims,new mt(e,t))}shiftByPoint(e){return this.shiftBy(e.x,e.y)}align(e,t={}){if(e){let a=e instanceof ai?e.box.floor():new ur(e);return this.shiftBy(a.x,a.y).align(null,t)}let{useDlibAlignment:n,minBoxPadding:r}={useDlibAlignment:!1,minBoxPadding:.2,...t};return n?this.alignDlib():this.alignMinBbox(r)}alignDlib(){let e=this.getRefPointsForAlignment(),[t,n,r]=e,a=u=>r.sub(u).magnitude(),i=(a(t)+a(n))/2,s=Math.floor(i/e4e),o=AE(e),l=Math.floor(Math.max(0,o.x-QLe*s)),c=Math.floor(Math.max(0,o.y-JLe*s));return new Gj(l,c,Math.min(s,this.imageWidth+l),Math.min(s,this.imageHeight+c))}alignMinBbox(e){let t=XLe(this.positions);return t.pad(t.width*e,t.height*e)}getRefPointsForAlignment(){throw new Error("getRefPointsForAlignment not implemented by base class")}},qj=class extends Iv{getJawOutline(){return this.positions.slice(0,17)}getLeftEyeBrow(){return this.positions.slice(17,22)}getRightEyeBrow(){return this.positions.slice(22,27)}getNose(){return this.positions.slice(27,36)}getLeftEye(){return this.positions.slice(36,42)}getRightEye(){return this.positions.slice(42,48)}getMouth(){return this.positions.slice(48,68)}getRefPointsForAlignment(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(AE)}};function Cv(e){return e.detection instanceof ai}function t4e(e,t){return{...e,detection:t}}function Kj(){let e=window.fetch;if(!e)throw new Error("fetch - missing fetch implementation for browser environment");return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:()=>document.createElement("canvas"),createImageElement:()=>document.createElement("img"),createVideoElement:()=>document.createElement("video"),fetch:e,readFile:()=>{throw new Error("readFile - filesystem not available for browser environment")}}}function FE(){return typeof global=="object"&&typeof process<"u"&&process.versions!=null&&process.versions.node!=null}function Xj(e){let t="";if(!e&&FE())try{e=tne("fs")}catch(n){t=n.toString()}return{readFile:e?n=>new Promise((r,a)=>{e.readFile(n,(i,s)=>i?a(i):r(s))}):()=>{throw new Error(`readFile - failed to require fs in nodejs environment with error: ${t}`)}}}function Yj(){let e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=global.Video||global.HTMLVideoElement,r=()=>{if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},a=()=>{if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},i=()=>{if(n)return new n;throw new Error("createVideoElement - missing Video implementation for nodejs environment")},s=global.fetch,o=Xj();return{Canvas:e||class{},CanvasRenderingContext2D:global.CanvasRenderingContext2D||class{},Image:t||class{},ImageData:global.ImageData||class{},Video:global.HTMLVideoElement||class{},createCanvasElement:r,createImageElement:a,createVideoElement:i,fetch:s,...o}}function Zj(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}var zn;function n4e(){if(!zn)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return zn}function XI(e){zn=e}function DE(){return Zj()?XI(Kj()):FE()?XI(Yj()):null}function r4e(e){if(zn||DE(),!zn)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");let{Canvas:t=zn.Canvas,Image:n=zn.Image}=e;zn.Canvas=t,zn.Image=n,zn.createCanvasElement=e.createCanvasElement||(()=>new t),zn.createImageElement=e.createImageElement||(()=>new n),zn.ImageData=e.ImageData||zn.ImageData,zn.Video=e.Video||zn.Video,zn.fetch=e.fetch||zn.fetch,zn.readFile=e.readFile||zn.readFile}var Gr={getEnv:n4e,setEnv:XI,initialize:DE,createBrowserEnv:Kj,createFileSystem:Xj,createNodejsEnv:Yj,monkeyPatch:r4e,isBrowser:Zj,isNodejs:FE};DE();function ME(e){return!Gr.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function qo(e){let{Canvas:t,CanvasRenderingContext2D:n}=Gr.getEnv();if(e instanceof n)return e;let r=ME(e);if(!(r instanceof t))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");let a=r.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("resolveContext2d - canvas 2d context is null");return a}var Qj=(e=>(e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT",e))(Qj||{}),OE=class{constructor(e={}){let{anchorPosition:t,backgroundColor:n,fontColor:r,fontSize:a,fontStyle:i,padding:s}=e;this.anchorPosition=t||"TOP_LEFT",this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=a||14,this.fontStyle=i||"Georgia",this.padding=s||4}},ew=class{constructor(e,t,n={}){this.text=typeof e=="string"?[e]:e instanceof ew?e.text:e,this.anchor=t,this.options=new OE(n)}measureWidth(e){let{padding:t}=this.options;return this.text.map(n=>e.measureText(n).width).reduce((n,r)=>n<r?r:n,0)+2*t}measureHeight(){let{fontSize:e,padding:t}=this.options;return this.text.length*e+2*t}getUpperLeft(e,t){let{anchorPosition:n}=this.options,r=n==="BOTTOM_RIGHT"||n==="TOP_RIGHT",a=n==="BOTTOM_LEFT"||n==="BOTTOM_RIGHT",i=this.measureWidth(e),s=this.measureHeight(),o=r?this.anchor.x-i:this.anchor.x,l=a?this.anchor.y-s:this.anchor.y;if(t){let{width:c,height:u}=t,d=Math.max(Math.min(o,c-i),0),p=Math.max(Math.min(l,u-s),0);return{x:d,y:p}}return{x:o,y:l}}draw(e){let t=ME(e),n=qo(t),{backgroundColor:r,fontColor:a,fontSize:i,fontStyle:s,padding:o}=this.options;n.font=`${i}px ${s}`;let l=this.measureWidth(n),c=this.measureHeight();n.fillStyle=r;let u=this.getUpperLeft(n,t);n.fillRect(u.x,u.y,l,c),n.fillStyle=a,this.text.forEach((d,p)=>{let h=o+u.x,f=o+u.y+(p+1)*i;n.fillText(d,h,f)})}},Jj=class{constructor(e={}){let{boxColor:t,lineWidth:n,label:r,drawLabelOptions:a}=e;this.boxColor=t||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;let i={anchorPosition:"BOTTOM_LEFT",backgroundColor:this.boxColor};this.drawLabelOptions=new OE({...i,...a})}},eH=class{constructor(e,t={}){this.box=new ur(e),this.options=new Jj(t)}draw(e){let t=qo(e),{boxColor:n,lineWidth:r}=this.options,{x:a,y:i,width:s,height:o}=this.box;t.strokeStyle=n,t.lineWidth=r,t.strokeRect(a,i,s,o);let{label:l}=this.options;l&&new ew([l],{x:a-r/2,y:i},this.options.drawLabelOptions).draw(e)}};function a4e(e,t){(Array.isArray(t)?t:[t]).forEach(n=>{let r=n instanceof ai?n.score:Cv(n)?n.detection.score:void 0,a=n instanceof ai?n.box:Cv(n)?n.detection.box:new ur(n),i=r?`${$E(r)}`:void 0;new eH(a,{label:i}).draw(e)})}function tH(e){let{Image:t,Video:n}=Gr.getEnv();return e instanceof t&&e.complete||e instanceof n&&e.readyState>=3}function i4e(e){return new Promise((t,n)=>{(e instanceof Gr.getEnv().Canvas||tH(e))&&t(null);function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",a),i.currentTarget.removeEventListener("error",r),n(i))}function a(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",a),i.currentTarget.removeEventListener("error",r),t(i))}e.addEventListener("load",a),e.addEventListener("error",r)})}function nH(e){let{Image:t,Video:n}=Gr.getEnv();return e instanceof t?new Kl(e.naturalWidth,e.naturalHeight):e instanceof n?new Kl(e.videoWidth,e.videoHeight):new Kl(e.width,e.height)}function _v({width:e,height:t}){let{createCanvasElement:n}=Gr.getEnv(),r=n();return r.width=e,r.height=t,r}function rH(e,t){let{ImageData:n}=Gr.getEnv();if(!(e instanceof n)&&!tH(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");let{width:r,height:a}=t||nH(e),i=_v({width:r,height:a});return e instanceof n?qo(i).putImageData(e,0,0):qo(i).drawImage(e,0,0,r,a),i}async function s4e(e,t){let n=t||Gr.getEnv().createCanvasElement(),[r,a,i]=e.shape.slice(Es(e)?1:0),s=G(()=>e.as3D(r,a,i).toInt());return await ny.toPixels(s,n),s.dispose(),n}function JD(e){let{Image:t,Canvas:n,Video:r}=Gr.getEnv();return e instanceof t||e instanceof n||e instanceof r}function o4e(e,t,n=!1){let{Image:r,Canvas:a}=Gr.getEnv();if(!(e instanceof r||e instanceof a))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");if(t<=0)return _v({width:1,height:1});let i=nH(e),s=t/Math.max(i.height,i.width),o=s*i.width,l=s*i.height,c=_v({width:t,height:t}),u=e instanceof a?e:rH(e),d=Math.abs(o-l)/2,p=n&&o<l?d:0,h=n&&l<o?d:0;return u.width>0&&u.height>0&&qo(c).drawImage(u,p,h,o,l),c}var Tv=class{constructor(e,t=!1){if(this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],this._inputSize=0,!Array.isArray(e))throw new Error(`NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have ${e}`);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach((n,r)=>{if(vy(n)){this._imageTensors[r]=n,this._inputDimensions[r]=n.shape;return}if(Es(n)){let i=n.shape[0];if(i!==1)throw new Error(`NetInput - tf.Tensor4D with batchSize ${i} passed, but not supported in input array`);this._imageTensors[r]=n,this._inputDimensions[r]=n.shape.slice(1);return}let a=n instanceof Gr.getEnv().Canvas?n:rH(n);this._canvases[r]=a,this._inputDimensions[r]=[a.height,a.width,3]})}get imageTensors(){return this._imageTensors}get canvases(){return this._canvases}get isBatchInput(){return this.batchSize>1||this._treatAsBatchInput}get batchSize(){return this._batchSize}get inputDimensions(){return this._inputDimensions}get inputSize(){return this._inputSize}get reshapedInputDimensions(){return _p(this.batchSize,0,1).map((e,t)=>this.getReshapedInputDimensions(t))}getInput(e){return this.canvases[e]||this.imageTensors[e]}getInputDimensions(e){return this._inputDimensions[e]}getInputHeight(e){return this._inputDimensions[e][0]}getInputWidth(e){return this._inputDimensions[e][1]}getReshapedInputDimensions(e){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");let t=this.getInputWidth(e),n=this.getInputHeight(e);return jj({width:t,height:n},this.inputSize)}toBatchTensor(e,t=!0){return this._inputSize=e,G(()=>{let n=_p(this.batchSize,0,1).map(r=>{let a=this.getInput(r);if(a instanceof Ze){let i=Es(a)?a:Qn(a);return i=ZLe(i,t),(i.shape[1]!==e||i.shape[2]!==e)&&(i=Ia.resizeBilinear(i,[e,e],!1,!1)),i.as3D(e,e,3)}if(a instanceof Gr.getEnv().Canvas)return ny.fromPixels(o4e(a,e,t));throw new Error(`toBatchTensor - at batchIdx ${r}, expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have ${a}`)});return Fn(n.map(r=>he(r,"float32"))).as4D(this.batchSize,e,e,3)})}};async function Er(e){if(e instanceof Tv)return e;let t=Array.isArray(e)?e:[e];if(!t.length)throw new Error("toNetInput - empty array passed as input");let n=a=>Array.isArray(e)?` at input index ${a}:`:"",r=t.map(ME);return r.forEach((a,i)=>{if(!JD(a)&&!vy(a)&&!Es(a))throw typeof t[i]=="string"?new Error(`toNetInput -${n(i)} string passed, but could not resolve HTMLElement for element id ${t[i]}`):new Error(`toNetInput -${n(i)} expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id`);if(Es(a)){let s=a.shape[0];if(s!==1)throw new Error(`toNetInput -${n(i)} tf.Tensor4D with batchSize ${s} passed, but not supported in input array`)}}),await Promise.all(r.map(a=>JD(a)&&i4e(a))),new Tv(r,Array.isArray(e))}async function aH(e,t){let{Canvas:n}=Gr.getEnv(),r=e;if(!(e instanceof n)){let i=await Er(e);if(i.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");let s=i.getInput(0);r=s instanceof n?s:await s4e(s)}let a=qo(r);return t.map(i=>i instanceof ai?i.forSize(r.width,r.height).box.floor():i).map(i=>i.clipAtImageBorders(r.width,r.height)).map(({x:i,y:s,width:o,height:l})=>{let c=_v({width:o,height:l});return o>0&&l>0&&qo(c).putImageData(a.getImageData(i,s,o,l),0,0),c})}async function iH(e,t){if(!vy(e)&&!Es(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Es(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return G(()=>{let[n,r,a]=e.shape.slice(Es(e)?1:0);return t.map(i=>i instanceof ai?i.forSize(r,n).box:i).map(i=>i.clipAtImageBorders(r,n)).filter(i=>i.width>0&&i.height>0).map(({x:i,y:s,width:o,height:l})=>Uh(e.as3D(n,r,a),[s,i,0],[l,o,a]))})}async function l4e(e,t){let{fetch:n}=Gr.getEnv(),r=await n(e,t);if(!(r.status<400))throw new Error(`failed to fetch: (${r.status}) ${r.statusText}, from url: ${r.url}`);return r}async function u4e(e){return(await l4e(e)).json()}function sH(e,t){let n=`${t}-weights_manifest.json`;if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:`/${n}`};let r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");let a=e.split("/").filter(o=>o),i=e.endsWith(".json")?a[a.length-1]:n,s=r+(e.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return s=e.startsWith("/")?`/${s}`:s,{modelBaseUri:s,manifestUri:s==="/"?`/${i}`:`${s}/${i}`}}async function c4e(e,t){let{manifestUri:n,modelBaseUri:r}=sH(e,t),a=await u4e(n);return tr.loadWeights(a,r)}var pl=class{constructor(e){this._params=void 0,this._paramMappings=[],this._name=e}get params(){return this._params}get paramMappings(){return this._paramMappings}get isLoaded(){return!!this.params}getParamFromPath(e){let{obj:t,objProp:n}=this.traversePropertyPath(e);return t[n]}reassignParamFromPath(e,t){let{obj:n,objProp:r}=this.traversePropertyPath(e);n[r].dispose(),n[r]=t}getParamList(){return this._paramMappings.map(({paramPath:e})=>({path:e,tensor:this.getParamFromPath(e)}))}getTrainableParams(){return this.getParamList().filter(e=>e.tensor instanceof lu)}getFrozenParams(){return this.getParamList().filter(e=>!(e.tensor instanceof lu))}variable(){this.getFrozenParams().forEach(({path:e,tensor:t})=>{this.reassignParamFromPath(e,t.variable())})}freeze(){this.getTrainableParams().forEach(({path:e,tensor:t})=>{let n=Ir(t.dataSync());t.dispose(),this.reassignParamFromPath(e,n)})}dispose(e=!0){this.getParamList().forEach(t=>{if(e&&t.tensor.isDisposed)throw new Error(`param tensor has already been disposed for path ${t.path}`);t.tensor.dispose()}),this._params=void 0}serializeParams(){return new Float32Array(this.getParamList().map(({tensor:e})=>Array.from(e.dataSync())).reduce((e,t)=>e.concat(t)))}async load(e){if(e instanceof Float32Array){this.extractWeights(e);return}await this.loadFromUri(e)}async loadFromUri(e){if(e&&typeof e!="string")throw new Error(`${this._name}.loadFromUri - expected model uri`);let t=await c4e(e,this.getDefaultModelName());this.loadFromWeightMap(t)}async loadFromDisk(e){if(e&&typeof e!="string")throw new Error(`${this._name}.loadFromDisk - expected model file path`);let{readFile:t}=Gr.getEnv(),{manifestUri:n,modelBaseUri:r}=sH(e,this.getDefaultModelName()),a=l=>Promise.all(l.map(c=>t(c).then(u=>u.buffer))),i=tr.weightsLoaderFactory(a),s=JSON.parse((await t(n)).toString()),o=await i(s,r);this.loadFromWeightMap(o)}loadFromWeightMap(e){let{paramMappings:t,params:n}=this.extractParamsFromWeightMap(e);this._paramMappings=t,this._params=n}extractWeights(e){let{paramMappings:t,params:n}=this.extractParams(e);this._paramMappings=t,this._params=n}traversePropertyPath(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");let t=e.split("/").reduce((a,i)=>{if(!a.nextObj.hasOwnProperty(i))throw new Error(`traversePropertyPath - object does not have property ${i}, for path ${e}`);return{obj:a.nextObj,objProp:i,nextObj:a.nextObj[i]}},{nextObj:this.params}),{obj:n,objProp:r}=t;if(!n||!r||!(n[r]instanceof Ze))throw new Error(`traversePropertyPath - parameter is not a tensor, for path ${e}`);return{obj:n,objProp:r}}};function Ta(e,t,n){return G(()=>{let r=Vh(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=re(r,t.bias),r})}function wk(e,t,n=!1){return G(()=>{let r=Ct(n?re(_r(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Ta(e,t.conv0,[2,2])),a=Ta(r,t.conv1,[1,1]),i=Ct(re(r,a)),s=Ta(i,t.conv2,[1,1]);return Ct(re(r,re(a,s)))})}function _0(e,t,n=!1,r=!0){return G(()=>{let a=Ct(n?re(_r(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Ta(e,t.conv0,r?[2,2]:[1,1])),i=Ta(a,t.conv1,[1,1]),s=Ct(re(a,i)),o=Ta(s,t.conv2,[1,1]),l=Ct(re(a,re(i,o))),c=Ta(l,t.conv3,[1,1]);return Ct(re(a,re(i,re(o,c))))})}function lm(e,t,n="same",r=!1){return G(()=>{let a=re(_r(e,t.filters,[1,1],n),t.bias);return r?Ct(a):a})}function hl(e,t){Object.keys(e).forEach(n=>{t.some(r=>r.originalPath===n)||e[n].dispose()})}function PE(e,t){return(n,r,a,i)=>{let s=Bo(e(n*r*a*a),[a,a,n,r]),o=It(e(r));return t.push({paramPath:`${i}/filters`},{paramPath:`${i}/bias`}),{filters:s,bias:o}}}function oH(e,t){return(n,r,a)=>{let i=Xi(e(n*r),[n,r]),s=It(e(r));return t.push({paramPath:`${a}/weights`},{paramPath:`${a}/bias`}),{weights:i,bias:s}}}var lH=class{constructor(e,t,n){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=n}};function zE(e,t){return(n,r,a)=>{let i=Bo(e(9*n),[3,3,n,1]),s=Bo(e(n*r),[1,1,n,r]),o=It(e(r));return t.push({paramPath:`${a}/depthwise_filter`},{paramPath:`${a}/pointwise_filter`},{paramPath:`${a}/bias`}),new lH(i,s,o)}}function LE(e){return t=>{let n=e(`${t}/depthwise_filter`,4),r=e(`${t}/pointwise_filter`,4),a=e(`${t}/bias`,1);return new lH(n,r,a)}}function sd(e,t){return(n,r,a)=>{let i=e[n];if(!rf(i,r))throw new Error(`expected weightMap[${n}] to be a Tensor${r}D, instead have ${i}`);return t.push({originalPath:n,paramPath:a||n}),i}}function fl(e){let t=e;function n(a){let i=t.slice(0,a);return t=t.slice(a),i}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function uH(e,t){let n=PE(e,t),r=zE(e,t);function a(s,o,l,c=!1){let u=c?n(s,o,3,`${l}/conv0`):r(s,o,`${l}/conv0`),d=r(o,o,`${l}/conv1`),p=r(o,o,`${l}/conv2`);return{conv0:u,conv1:d,conv2:p}}function i(s,o,l,c=!1){let{conv0:u,conv1:d,conv2:p}=a(s,o,l,c),h=r(o,o,`${l}/conv3`);return{conv0:u,conv1:d,conv2:p,conv3:h}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:i}}function d4e(e){let t=[],{extractWeights:n,getRemainingWeights:r}=fl(e),{extractDenseBlock4Params:a}=uH(n,t),i=a(3,32,"dense0",!0),s=a(32,64,"dense1"),o=a(64,128,"dense2"),l=a(128,256,"dense3");if(r().length!==0)throw new Error(`weights remaing after extract: ${r().length}`);return{paramMappings:t,params:{dense0:i,dense1:s,dense2:o,dense3:l}}}function cH(e){return t=>{let n=e(`${t}/filters`,4),r=e(`${t}/bias`,1);return{filters:n,bias:r}}}function dH(e,t){let n=sd(e,t),r=cH(n),a=LE(n);function i(o,l=!1){let c=l?r(`${o}/conv0`):a(`${o}/conv0`),u=a(`${o}/conv1`),d=a(`${o}/conv2`);return{conv0:c,conv1:u,conv2:d}}function s(o,l=!1){let c=l?r(`${o}/conv0`):a(`${o}/conv0`),u=a(`${o}/conv1`),d=a(`${o}/conv2`),p=a(`${o}/conv3`);return{conv0:c,conv1:u,conv2:d,conv3:p}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:s}}function p4e(e){let t=[],{extractDenseBlock4Params:n}=dH(e,t),r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return hl(e,t),{params:r,paramMappings:t}}var pH=class extends pl{constructor(){super("FaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return G(()=>{let n=he(e.toBatchTensor(112,!0),"float32"),r=xy(n,[122.782,117.001,104.298]).div(255),a=_0(r,t.dense0,!0);return a=_0(a,t.dense1),a=_0(a,t.dense2),a=_0(a,t.dense3),a=Vs(a,[7,7],[2,2],"valid"),a})}async forward(e){return this.forwardInput(await Er(e))}getDefaultModelName(){return"face_feature_extractor_model"}extractParamsFromWeightMap(e){return p4e(e)}extractParams(e){return d4e(e)}};function YI(e,t){return G(()=>re(Ye(e,t.weights),t.bias))}function h4e(e,t,n){let r=[],{extractWeights:a,getRemainingWeights:i}=fl(e),s=oH(a,r)(t,n,"fc");if(i().length!==0)throw new Error(`weights remaing after extract: ${i().length}`);return{paramMappings:r,params:{fc:s}}}function f4e(e){let t=[],n=sd(e,t);function r(i){let s=n(`${i}/weights`,2),o=n(`${i}/bias`,1);return{weights:s,bias:o}}let a={fc:r("fc")};return hl(e,t),{params:a,paramMappings:t}}function hH(e){let t={},n={};return Object.keys(e).forEach(r=>{let a=r.startsWith("fc")?n:t;a[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var fH=class extends pl{constructor(e,t){super(e),this._faceFeatureExtractor=t}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error(`${this._name} - load model before inference`);return G(()=>{let n=e instanceof Tv?this.faceFeatureExtractor.forwardInput(e):e;return YI(n.as2D(n.shape[0],-1),t.fc)})}dispose(e=!0){this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:n}=this.extractClassifierParams(e);this._params=t,this._paramMappings=n}extractClassifierParams(e){return h4e(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:n}=hH(e);return this.faceFeatureExtractor.loadFromWeightMap(t),f4e(n)}extractParams(e){let t=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*t+n,a=e.slice(0,e.length-r),i=e.slice(e.length-r);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(i)}},eM=["neutral","happy","sad","angry","fearful","disgusted","surprised"],BE=class{constructor(e){if(this.neutral=0,this.happy=0,this.sad=0,this.angry=0,this.fearful=0,this.disgusted=0,this.surprised=0,e.length!==7)throw new Error(`FaceExpressions.constructor - expected probabilities.length to be 7, have: ${e.length}`);eM.forEach((t,n)=>{this[t]=e[n]})}asSortedArray(){return eM.map(e=>({expression:e,probability:this[e]})).sort((e,t)=>t.probability-e.probability)}},m4e=class extends fH{constructor(e=new pH){super("FaceExpressionNet",e)}forwardInput(e){return G(()=>sl(this.runNet(e)))}async forward(e){return this.forwardInput(await Er(e))}async predictExpressions(e){let t=await Er(e),n=await this.forwardInput(t),r=await Promise.all(dn(n).map(async i=>{let s=i.dataSync();return i.dispose(),s}));n.dispose();let a=r.map(i=>new BE(i));return t.isBatchInput?a:a[0]}getDefaultModelName(){return"face_expression_model"}getClassifierChannelsIn(){return 256}getClassifierChannelsOut(){return 7}};function g4e(e){return e.expressions instanceof BE}function y4e(e,t){return{...e,expressions:t}}function b4e(e,t,n=.1,r){(Array.isArray(t)?t:[t]).forEach(a=>{let i=a instanceof BE?a:g4e(a)?a.expressions:void 0;if(!i)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");let s=i.asSortedArray().filter(l=>l.probability>n),o=Cv(a)?a.detection.box.bottomLeft:r||new mt(0,0);new ew(s.map(l=>`${l.expression} (${$E(l.probability)})`),o).draw(e)})}function mH(e){return Cv(e)&&e.landmarks instanceof Iv&&e.unshiftedLandmarks instanceof Iv&&e.alignedRect instanceof ai}function v4e(e){let t=l=>l*180/Math.PI,n=(l,c)=>Math.sqrt((l._x-c._x)**2+(l._y-c._y)**2),r={roll:void 0,pitch:void 0,yaw:void 0},a=(l,c,u)=>{let d=Math.floor(l._x-c._x),p=Math.floor(c._x-u._x);return d-p},i=(l,c)=>{let u=Math.hypot(c._x-l._x,c._y-l._y),d=c._y-l._y,p=Math.asin(d/u),h=t(p),f=Math.floor(90-h),m=c._x-l._x<0?-1:1;return f*m},s=(l,c,u)=>{let d=n(l,u),p={_x:(l._x+u._x)/2,_y:(l._y+u._y)/2},h=n(c,p),f=Math.atan(h/d),m=Math.floor(t(f)),g=p._y-c._y<0?-1:1;return m*g};if(!e||!e._positions||e._positions.length!==68)return r;let o=e._positions;return r.roll=i(o[27],o[66]),r.pitch=s(o[14],o[30],o[2]),r.yaw=a(o[14],o[33],o[2]),r}function x4e(e,t){let{box:n}=e.detection,r=t.shiftBy(n.x,n.y),a=r.align(),{imageDims:i}=e.detection,s=new ai(e.detection.score,a.rescale(i.reverse()),i),o=v4e(t);return{...e,landmarks:r,unshiftedLandmarks:t,alignedRect:s,angle:o}}var gH=class{constructor(e={}){let{drawLines:t=!0,drawPoints:n=!0,lineWidth:r,lineColor:a,pointSize:i,pointColor:s}=e;this.drawLines=t,this.drawPoints=n,this.lineWidth=r||1,this.pointSize=i||2,this.lineColor=a||"rgba(0, 255, 255, 1)",this.pointColor=s||"rgba(255, 0, 255, 1)"}},yH=class{constructor(e,t={}){this.faceLandmarks=e,this.options=new gH(t)}draw(e){let t=qo(e),{drawLines:n,drawPoints:r,lineWidth:a,lineColor:i,pointSize:s,pointColor:o}=this.options;if(n&&this.faceLandmarks instanceof qj&&(t.strokeStyle=i,t.lineWidth=a,eo(t,this.faceLandmarks.getJawOutline()),eo(t,this.faceLandmarks.getLeftEyeBrow()),eo(t,this.faceLandmarks.getRightEyeBrow()),eo(t,this.faceLandmarks.getNose()),eo(t,this.faceLandmarks.getLeftEye(),!0),eo(t,this.faceLandmarks.getRightEye(),!0),eo(t,this.faceLandmarks.getMouth(),!0)),r){t.strokeStyle=o,t.fillStyle=o;let l=c=>{t.beginPath(),t.arc(c.x,c.y,s,0,2*Math.PI),t.fill()};this.faceLandmarks.positions.forEach(l)}}};function w4e(e,t){(Array.isArray(t)?t:[t]).forEach(n=>{let r=n instanceof Iv?n:mH(n)?n.landmarks:void 0;if(!r)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new yH(r).draw(e)})}function k4e(e,t){let n=PE(e,t),r=zE(e,t);function a(s,o,l){let c=r(s,o,`${l}/separable_conv0`),u=r(o,o,`${l}/separable_conv1`),d=n(s,o,1,`${l}/expansion_conv`);return{separable_conv0:c,separable_conv1:u,expansion_conv:d}}function i(s,o){let l=r(s,s,`${o}/separable_conv0`),c=r(s,s,`${o}/separable_conv1`),u=r(s,s,`${o}/separable_conv2`);return{separable_conv0:l,separable_conv1:c,separable_conv2:u}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:a,extractMainBlockParams:i}}function S4e(e,t){let n=[],{extractWeights:r,getRemainingWeights:a}=fl(e),{extractConvParams:i,extractSeparableConvParams:s,extractReductionBlockParams:o,extractMainBlockParams:l}=k4e(r,n),c=i(3,32,3,"entry_flow/conv_in"),u=o(32,64,"entry_flow/reduction_block_0"),d=o(64,128,"entry_flow/reduction_block_1"),p={conv_in:c,reduction_block_0:u,reduction_block_1:d},h={};_p(t,0,1).forEach(y=>{h[`main_block_${y}`]=l(128,`middle_flow/main_block_${y}`)});let f=o(128,256,"exit_flow/reduction_block"),m=s(256,512,"exit_flow/separable_conv"),g={reduction_block:f,separable_conv:m};if(a().length!==0)throw new Error(`weights remaing after extract: ${a().length}`);return{paramMappings:n,params:{entry_flow:p,middle_flow:h,exit_flow:g}}}function I4e(e,t){let n=sd(e,t),r=cH(n),a=LE(n);function i(o){let l=a(`${o}/separable_conv0`),c=a(`${o}/separable_conv1`),u=r(`${o}/expansion_conv`);return{separable_conv0:l,separable_conv1:c,expansion_conv:u}}function s(o){let l=a(`${o}/separable_conv0`),c=a(`${o}/separable_conv1`),u=a(`${o}/separable_conv2`);return{separable_conv0:l,separable_conv1:c,separable_conv2:u}}return{extractConvParams:r,extractSeparableConvParams:a,extractReductionBlockParams:i,extractMainBlockParams:s}}function C4e(e,t){let n=[],{extractConvParams:r,extractSeparableConvParams:a,extractReductionBlockParams:i,extractMainBlockParams:s}=I4e(e,n),o=r("entry_flow/conv_in"),l=i("entry_flow/reduction_block_0"),c=i("entry_flow/reduction_block_1"),u={conv_in:o,reduction_block_0:l,reduction_block_1:c},d={};_p(t,0,1).forEach(m=>{d[`main_block_${m}`]=s(`middle_flow/main_block_${m}`)});let p=i("exit_flow/reduction_block"),h=a("exit_flow/separable_conv"),f={reduction_block:p,separable_conv:h};return hl(e,n),{params:{entry_flow:u,middle_flow:d,exit_flow:f},paramMappings:n}}function bH(e,t,n){return re(_r(e,t.filters,n,"same"),t.bias)}function kk(e,t,n=!0){let r=n?Ct(e):e;return r=Ta(r,t.separable_conv0,[1,1]),r=Ta(Ct(r),t.separable_conv1,[1,1]),r=Ln(r,[3,3],[2,2],"same"),r=re(r,bH(e,t.expansion_conv,[2,2])),r}function _4e(e,t){let n=Ta(Ct(e),t.separable_conv0,[1,1]);return n=Ta(Ct(n),t.separable_conv1,[1,1]),n=Ta(Ct(n),t.separable_conv2,[1,1]),n=re(n,e),n}var T4e=class extends pl{constructor(e){super("TinyXception"),this._numMainBlocks=e}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyXception - load model before inference");return G(()=>{let n=he(e.toBatchTensor(112,!0),"float32"),r=xy(n,[122.782,117.001,104.298]).div(255),a=Ct(bH(r,t.entry_flow.conv_in,[2,2]));return a=kk(a,t.entry_flow.reduction_block_0,!1),a=kk(a,t.entry_flow.reduction_block_1),_p(this._numMainBlocks,0,1).forEach(i=>{a=_4e(a,t.middle_flow[`main_block_${i}`])}),a=kk(a,t.exit_flow.reduction_block),a=Ct(Ta(a,t.exit_flow.separable_conv,[1,1])),a})}async forward(e){return this.forwardInput(await Er(e))}getDefaultModelName(){return"tiny_xception_model"}extractParamsFromWeightMap(e){return C4e(e,this._numMainBlocks)}extractParams(e){return S4e(e,this._numMainBlocks)}};function N4e(e){let t=[],{extractWeights:n,getRemainingWeights:r}=fl(e),a=oH(n,t),i=a(512,1,"fc/age"),s=a(512,2,"fc/gender");if(r().length!==0)throw new Error(`weights remaing after extract: ${r().length}`);return{paramMappings:t,params:{fc:{age:i,gender:s}}}}function E4e(e){let t=[],n=sd(e,t);function r(i){let s=n(`${i}/weights`,2),o=n(`${i}/bias`,1);return{weights:s,bias:o}}let a={fc:{age:r("fc/age"),gender:r("fc/gender")}};return hl(e,t),{params:a,paramMappings:t}}var $4e=(e=>(e.FEMALE="female",e.MALE="male",e))($4e||{}),A4e=class extends pl{constructor(e=new T4e(2)){super("AgeGenderNet"),this._faceFeatureExtractor=e}get faceFeatureExtractor(){return this._faceFeatureExtractor}runNet(e){let{params:t}=this;if(!t)throw new Error(`${this._name} - load model before inference`);return G(()=>{let n=e instanceof Tv?this.faceFeatureExtractor.forwardInput(e):e,r=Vs(n,[7,7],[2,2],"valid").as2D(n.shape[0],-1),a=YI(r,t.fc.age).as1D(),i=YI(r,t.fc.gender);return{age:a,gender:i}})}forwardInput(e){return G(()=>{let{age:t,gender:n}=this.runNet(e);return{age:t,gender:sl(n)}})}async forward(e){return this.forwardInput(await Er(e))}async predictAgeAndGender(e){let t=await Er(e),n=await this.forwardInput(t),r=dn(n.age),a=dn(n.gender),i=r.map((o,l)=>({ageTensor:o,genderTensor:a[l]})),s=await Promise.all(i.map(async({ageTensor:o,genderTensor:l})=>{let c=o.dataSync()[0],u=l.dataSync()[0],d=u>.5,p=d?"male":"female",h=d?u:1-u;return o.dispose(),l.dispose(),{age:c,gender:p,genderProbability:h}}));return n.age.dispose(),n.gender.dispose(),t.isBatchInput?s:s[0]}getDefaultModelName(){return"age_gender_model"}dispose(e=!0){this.faceFeatureExtractor.dispose(e),super.dispose(e)}loadClassifierParams(e){let{params:t,paramMappings:n}=this.extractClassifierParams(e);this._params=t,this._paramMappings=n}extractClassifierParams(e){return N4e(e)}extractParamsFromWeightMap(e){let{featureExtractorMap:t,classifierMap:n}=hH(e);return this.faceFeatureExtractor.loadFromWeightMap(t),E4e(n)}extractParams(e){let t=e.slice(0,e.length-1539),n=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(t),this.extractClassifierParams(n)}},vH=class extends fH{postProcess(e,t,n){let r=n.map(({width:i,height:s})=>{let o=t/Math.max(s,i);return{width:i*o,height:s*o}}),a=r.length;return G(()=>{let i=(c,u)=>Fn([ua([68],c,"float32"),ua([68],u,"float32")],1).as2D(1,136).as1D(),s=(c,u)=>{let{width:d,height:p}=r[c];return u(d,p)?Math.abs(d-p)/2:0},o=c=>s(c,(u,d)=>u<d),l=c=>s(c,(u,d)=>d<u);return e.mul(ua([a,136],t,"float32")).sub(Fn(Array.from(Array(a),(c,u)=>i(o(u),l(u))))).div(Fn(Array.from(Array(a),(c,u)=>i(r[u].width,r[u].height))))})}forwardInput(e){return G(()=>{let t=this.runNet(e);return this.postProcess(t,e.inputSize,e.inputDimensions.map(([n,r])=>({height:n,width:r})))})}async forward(e){return this.forwardInput(await Er(e))}async detectLandmarks(e){let t=await Er(e),n=G(()=>dn(this.forwardInput(t))),r=await Promise.all(n.map(async(a,i)=>{let s=Array.from(a.dataSync()),o=s.filter((c,u)=>qI(u)),l=s.filter((c,u)=>!qI(u));return new qj(Array(68).fill(0).map((c,u)=>new mt(o[u],l[u])),{height:t.getInputHeight(i),width:t.getInputWidth(i)})}));return n.forEach(a=>a.dispose()),t.isBatchInput?r:r[0]}getClassifierChannelsOut(){return 136}},R4e=class extends vH{constructor(e=new pH){super("FaceLandmark68Net",e)}getDefaultModelName(){return"face_landmark_68_model"}getClassifierChannelsIn(){return 256}};function F4e(e){let t=[],{extractDenseBlock3Params:n}=dH(e,t),r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return hl(e,t),{params:r,paramMappings:t}}function D4e(e){let t=[],{extractWeights:n,getRemainingWeights:r}=fl(e),{extractDenseBlock3Params:a}=uH(n,t),i=a(3,32,"dense0",!0),s=a(32,64,"dense1"),o=a(64,128,"dense2");if(r().length!==0)throw new Error(`weights remaing after extract: ${r().length}`);return{paramMappings:t,params:{dense0:i,dense1:s,dense2:o}}}var M4e=class extends pl{constructor(){super("TinyFaceFeatureExtractor")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return G(()=>{let n=he(e.toBatchTensor(112,!0),"float32"),r=xy(n,[122.782,117.001,104.298]).div(255),a=wk(r,t.dense0,!0);return a=wk(a,t.dense1),a=wk(a,t.dense2),a=Vs(a,[14,14],[2,2],"valid"),a})}async forward(e){return this.forwardInput(await Er(e))}getDefaultModelName(){return"face_feature_extractor_tiny_model"}extractParamsFromWeightMap(e){return F4e(e)}extractParams(e){return D4e(e)}},O4e=class extends vH{constructor(e=new M4e){super("FaceLandmark68TinyNet",e)}getDefaultModelName(){return"face_landmark_68_tiny_model"}getClassifierChannelsIn(){return 128}};function P4e(e,t){return re(j(e,t.weights),t.biases)}function WE(e,t,n,r,a="same"){let{filters:i,bias:s}=t.conv,o=_r(e,i,n,a);return o=re(o,s),o=P4e(o,t.scale),r?Ct(o):o}function z4e(e,t){return WE(e,t,[1,1],!0)}function xH(e,t){return WE(e,t,[1,1],!1)}function wH(e,t){return WE(e,t,[2,2],!0,"valid")}function L4e(e,t){function n(o,l,c){let u=e(o),d=u.length/(l*c*c);if(Uj(d))throw new Error(`depth has to be an integer: ${d}, weights.length: ${u.length}, numFilters: ${l}, filterSize: ${c}`);return G(()=>Je(Bo(u,[l,d,c,c]),[2,3,1,0]))}function r(o,l,c,u){let d=n(o,l,c),p=It(e(l));return t.push({paramPath:`${u}/filters`},{paramPath:`${u}/bias`}),{filters:d,bias:p}}function a(o,l){let c=It(e(o)),u=It(e(o));return t.push({paramPath:`${l}/weights`},{paramPath:`${l}/biases`}),{weights:c,biases:u}}function i(o,l,c,u){let d=r(o,l,c,`${u}/conv`),p=a(l,`${u}/scale`);return{conv:d,scale:p}}function s(o,l,c,u,d=!1){let p=i((d?.5:1)*o,l,c,`${u}/conv1`),h=i(o,l,c,`${u}/conv2`);return{conv1:p,conv2:h}}return{extractConvLayerParams:i,extractResidualLayerParams:s}}function B4e(e){let{extractWeights:t,getRemainingWeights:n}=fl(e),r=[],{extractConvLayerParams:a,extractResidualLayerParams:i}=L4e(t,r),s=a(4704,32,7,"conv32_down"),o=i(9216,32,3,"conv32_1"),l=i(9216,32,3,"conv32_2"),c=i(9216,32,3,"conv32_3"),u=i(36864,64,3,"conv64_down",!0),d=i(36864,64,3,"conv64_1"),p=i(36864,64,3,"conv64_2"),h=i(36864,64,3,"conv64_3"),f=i(147456,128,3,"conv128_down",!0),m=i(147456,128,3,"conv128_1"),g=i(147456,128,3,"conv128_2"),y=i(589824,256,3,"conv256_down",!0),b=i(589824,256,3,"conv256_1"),v=i(589824,256,3,"conv256_2"),x=i(589824,256,3,"conv256_down_out"),w=G(()=>Je(Xi(t(256*128),[128,256]),[1,0]));if(r.push({paramPath:"fc"}),n().length!==0)throw new Error(`weights remaing after extract: ${n().length}`);return{params:{conv32_down:s,conv32_1:o,conv32_2:l,conv32_3:c,conv64_down:u,conv64_1:d,conv64_2:p,conv64_3:h,conv128_down:f,conv128_1:m,conv128_2:g,conv256_down:y,conv256_1:b,conv256_2:v,conv256_down_out:x,fc:w},paramMappings:r}}function W4e(e,t){let n=sd(e,t);function r(s){let o=n(`${s}/scale/weights`,1),l=n(`${s}/scale/biases`,1);return{weights:o,biases:l}}function a(s){let o=n(`${s}/conv/filters`,4),l=n(`${s}/conv/bias`,1),c=r(s);return{conv:{filters:o,bias:l},scale:c}}function i(s){return{conv1:a(`${s}/conv1`),conv2:a(`${s}/conv2`)}}return{extractConvLayerParams:a,extractResidualLayerParams:i}}function V4e(e){let t=[],{extractConvLayerParams:n,extractResidualLayerParams:r}=W4e(e,t),a=n("conv32_down"),i=r("conv32_1"),s=r("conv32_2"),o=r("conv32_3"),l=r("conv64_down"),c=r("conv64_1"),u=r("conv64_2"),d=r("conv64_3"),p=r("conv128_down"),h=r("conv128_1"),f=r("conv128_2"),m=r("conv256_down"),g=r("conv256_1"),y=r("conv256_2"),b=r("conv256_down_out"),{fc:v}=e;if(t.push({originalPath:"fc",paramPath:"fc"}),!Vj(v))throw new Error(`expected weightMap[fc] to be a Tensor2D, instead have ${v}`);let x={conv32_down:a,conv32_1:i,conv32_2:s,conv32_3:o,conv64_down:l,conv64_1:c,conv64_2:u,conv64_3:d,conv128_down:p,conv128_1:h,conv128_2:f,conv256_down:m,conv256_1:g,conv256_2:y,conv256_down_out:b,fc:v};return hl(e,t),{params:x,paramMappings:t}}function $i(e,t){let n=z4e(e,t.conv1);return n=xH(n,t.conv2),n=re(n,e),n=Ct(n),n}function T0(e,t){let n=wH(e,t.conv1);n=xH(n,t.conv2);let r=Vs(e,2,2,"valid"),a=en(r.shape),i=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){let s=[...n.shape];s[1]=1;let o=en(s);n=Et([n,o],1);let l=[...n.shape];l[2]=1;let c=en(l);n=Et([n,c],2)}return r=i?Et([r,a],3):r,n=re(r,n),n=Ct(n),n}var U4e=class extends pl{constructor(){super("FaceRecognitionNet")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return G(()=>{let n=he(e.toBatchTensor(150,!0),"float32"),r=xy(n,[122.782,117.001,104.298]).div(255),a=wH(r,t.conv32_down);a=Ln(a,3,2,"valid"),a=$i(a,t.conv32_1),a=$i(a,t.conv32_2),a=$i(a,t.conv32_3),a=T0(a,t.conv64_down),a=$i(a,t.conv64_1),a=$i(a,t.conv64_2),a=$i(a,t.conv64_3),a=T0(a,t.conv128_down),a=$i(a,t.conv128_1),a=$i(a,t.conv128_2),a=T0(a,t.conv256_down),a=$i(a,t.conv256_1),a=$i(a,t.conv256_2),a=T0(a,t.conv256_down_out);let i=a.mean([1,2]);return Ye(i,t.fc)})}async forward(e){return this.forwardInput(await Er(e))}async computeFaceDescriptor(e){var t;if((t=e==null?void 0:e.shape)!=null&&t.some(i=>i<=0))return new Float32Array(128);let n=await Er(e),r=G(()=>dn(this.forwardInput(n))),a=await Promise.all(r.map(i=>i.data()));return r.forEach(i=>i.dispose()),n.isBatchInput?a:a[0]}getDefaultModelName(){return"face_recognition_model"}extractParamsFromWeightMap(e){return V4e(e)}extractParams(e){return B4e(e)}};function j4e(e,t){return{...e,descriptor:t}}function H4e(e,t){return{...e,age:t}}function G4e(e,t,n){return{...e,gender:t,genderProbability:n}}function q4e(e,t){function n(l,c){let u=Bo(e(9*l),[3,3,l,1]),d=It(e(l)),p=It(e(l)),h=It(e(l)),f=It(e(l));return t.push({paramPath:`${c}/filters`},{paramPath:`${c}/batch_norm_scale`},{paramPath:`${c}/batch_norm_offset`},{paramPath:`${c}/batch_norm_mean`},{paramPath:`${c}/batch_norm_variance`}),{filters:u,batch_norm_scale:d,batch_norm_offset:p,batch_norm_mean:h,batch_norm_variance:f}}function r(l,c,u,d,p){let h=Bo(e(l*c*u*u),[u,u,l,c]),f=It(e(c));return t.push({paramPath:`${d}/filters`},{paramPath:`${d}/${p?"batch_norm_offset":"bias"}`}),{filters:h,bias:f}}function a(l,c,u,d){let{filters:p,bias:h}=r(l,c,u,d,!0);return{filters:p,batch_norm_offset:h}}function i(l,c,u){let d=n(l,`${u}/depthwise_conv`),p=a(l,c,1,`${u}/pointwise_conv`);return{depthwise_conv:d,pointwise_conv:p}}function s(){let l=a(3,32,3,"mobilenetv1/conv_0"),c=i(32,64,"mobilenetv1/conv_1"),u=i(64,128,"mobilenetv1/conv_2"),d=i(128,128,"mobilenetv1/conv_3"),p=i(128,256,"mobilenetv1/conv_4"),h=i(256,256,"mobilenetv1/conv_5"),f=i(256,512,"mobilenetv1/conv_6"),m=i(512,512,"mobilenetv1/conv_7"),g=i(512,512,"mobilenetv1/conv_8"),y=i(512,512,"mobilenetv1/conv_9"),b=i(512,512,"mobilenetv1/conv_10"),v=i(512,512,"mobilenetv1/conv_11"),x=i(512,1024,"mobilenetv1/conv_12"),w=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:l,conv_1:c,conv_2:u,conv_3:d,conv_4:p,conv_5:h,conv_6:f,conv_7:m,conv_8:g,conv_9:y,conv_10:b,conv_11:v,conv_12:x,conv_13:w}}function o(){let l=a(1024,256,1,"prediction_layer/conv_0"),c=a(256,512,3,"prediction_layer/conv_1"),u=a(512,128,1,"prediction_layer/conv_2"),d=a(128,256,3,"prediction_layer/conv_3"),p=a(256,128,1,"prediction_layer/conv_4"),h=a(128,256,3,"prediction_layer/conv_5"),f=a(256,64,1,"prediction_layer/conv_6"),m=a(64,128,3,"prediction_layer/conv_7"),g=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),y=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),b=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),v=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),x=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),w=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),S=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),C=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),T=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),E=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),R=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),$=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor");return{conv_0:l,conv_1:c,conv_2:u,conv_3:d,conv_4:p,conv_5:h,conv_6:f,conv_7:m,box_predictor_0:{box_encoding_predictor:g,class_predictor:y},box_predictor_1:{box_encoding_predictor:b,class_predictor:v},box_predictor_2:{box_encoding_predictor:x,class_predictor:w},box_predictor_3:{box_encoding_predictor:S,class_predictor:C},box_predictor_4:{box_encoding_predictor:T,class_predictor:E},box_predictor_5:{box_encoding_predictor:R,class_predictor:$}}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:o}}function K4e(e){let t=[],{extractWeights:n,getRemainingWeights:r}=fl(e),{extractMobilenetV1Params:a,extractPredictionLayerParams:i}=q4e(n,t),s=a(),o=i(),l={extra_dim:g1(n(5118*4),[1,5118,4])};if(t.push({paramPath:"output_layer/extra_dim"}),r().length!==0)throw new Error(`weights remaing after extract: ${r().length}`);return{params:{mobilenetv1:s,prediction_layer:o,output_layer:l},paramMappings:t}}function X4e(e,t){let n=sd(e,t);function r(c,u,d){let p=n(`${c}/Conv2d_${u}_pointwise/weights`,4,`${d}/filters`),h=n(`${c}/Conv2d_${u}_pointwise/convolution_bn_offset`,1,`${d}/batch_norm_offset`);return{filters:p,batch_norm_offset:h}}function a(c){let u=`mobilenetv1/conv_${c}`,d=`MobilenetV1/Conv2d_${c}_depthwise`,p=`${u}/depthwise_conv`,h=`${u}/pointwise_conv`,f=n(`${d}/depthwise_weights`,4,`${p}/filters`),m=n(`${d}/BatchNorm/gamma`,1,`${p}/batch_norm_scale`),g=n(`${d}/BatchNorm/beta`,1,`${p}/batch_norm_offset`),y=n(`${d}/BatchNorm/moving_mean`,1,`${p}/batch_norm_mean`),b=n(`${d}/BatchNorm/moving_variance`,1,`${p}/batch_norm_variance`);return{depthwise_conv:{filters:f,batch_norm_scale:m,batch_norm_offset:g,batch_norm_mean:y,batch_norm_variance:b},pointwise_conv:r("MobilenetV1",c,h)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}}function s(c,u){let d=n(`${c}/weights`,4,`${u}/filters`),p=n(`${c}/biases`,1,`${u}/bias`);return{filters:d,bias:p}}function o(c){let u=s(`Prediction/BoxPredictor_${c}/BoxEncodingPredictor`,`prediction_layer/box_predictor_${c}/box_encoding_predictor`),d=s(`Prediction/BoxPredictor_${c}/ClassPredictor`,`prediction_layer/box_predictor_${c}/class_predictor`);return{box_encoding_predictor:u,class_predictor:d}}function l(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:o(0),box_predictor_1:o(1),box_predictor_2:o(2),box_predictor_3:o(3),box_predictor_4:o(4),box_predictor_5:o(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:l}}function Y4e(e){let t=[],{extractMobilenetV1Params:n,extractPredictionLayerParams:r}=X4e(e,t),a=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!vy(a))throw new Error(`expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have ${a}`);let i={mobilenetv1:n(),prediction_layer:r(),output_layer:{extra_dim:a}};return hl(e,t),{params:i,paramMappings:t}}function Mi(e,t,n){return G(()=>{let r=_r(e,t.filters,n,"same");return r=re(r,t.batch_norm_offset),hr(r,0,6)})}var Z4e=.0010000000474974513;function Q4e(e,t,n){return G(()=>{let r=Yc(e,t.filters,n,"same");return r=Xc(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,Z4e),hr(r,0,6)})}function J4e(e){return[2,4,6,12].some(t=>t===e)?[2,2]:[1,1]}function eBe(e,t){return G(()=>{let n,r=Mi(e,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach((a,i)=>{let s=i+1,o=J4e(s);r=Q4e(r,a.depthwise_conv,o),r=Mi(r,a.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function tBe(e,t,n){let r=e.arraySync(),a=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),s=Math.max(r[t][0],r[t][2]),o=Math.max(r[t][1],r[t][3]),l=Math.min(r[n][0],r[n][2]),c=Math.min(r[n][1],r[n][3]),u=Math.max(r[n][0],r[n][2]),d=Math.max(r[n][1],r[n][3]),p=(s-a)*(o-i),h=(u-l)*(d-c);if(p<=0||h<=0)return 0;let f=Math.max(a,l),m=Math.max(i,c),g=Math.min(s,u),y=Math.min(o,d),b=Math.max(g-f,0)*Math.max(y-m,0);return b/(p+h-b)}function nBe(e,t,n,r,a){let i=e.shape[0],s=Math.min(n,i),o=t.map((u,d)=>({score:u,boxIndex:d})).filter(u=>u.score>a).sort((u,d)=>d.score-u.score),l=u=>u<=r?1:0,c=[];return o.forEach(u=>{if(c.length>=s)return;let d=u.score;for(let p=c.length-1;p>=0;--p){let h=tBe(e,u.boxIndex,c[p]);if(h!==0&&(u.score*=l(h),u.score<=a))break}d===u.score&&c.push(u.boxIndex)}),c}function rBe(e){let t=dn(Je(e,[1,0])),n=[we(t[2],t[0]),we(t[3],t[1])],r=[re(t[0],Ie(n[0],2)),re(t[1],Ie(n[1],2))];return{sizes:n,centers:r}}function aBe(e,t){let{sizes:n,centers:r}=rBe(e),a=dn(Je(t,[1,0])),i=Ie(j(Tr(Ie(a[2],5)),n[0]),2),s=re(j(Ie(a[0],10),n[0]),r[0]),o=Ie(j(Tr(Ie(a[3],5)),n[1]),2),l=re(j(Ie(a[1],10),n[1]),r[1]);return Je(Fn([we(s,i),we(l,o),re(s,i),re(l,o)]),[1,0])}function iBe(e,t,n){return G(()=>{let r=e.shape[0],a=aBe(H(aa(n.extra_dim,[r,1,1]),[-1,4]),H(e,[-1,4]));a=H(a,[r,a.shape[0]/r,4]);let i=ei(it(t,[0,0,1],[-1,-1,-1])),s=it(i,[0,0,0],[-1,-1,1]);s=H(s,[r,s.shape[1]]);let o=dn(a),l=dn(s);return{boxes:o,scores:l}})}function yd(e,t){return G(()=>{let n=e.shape[0],r=H(lm(e,t.box_encoding_predictor),[n,-1,1,4]),a=H(lm(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:a}})}function sBe(e,t,n){return G(()=>{let r=Mi(e,n.conv_0,[1,1]),a=Mi(r,n.conv_1,[2,2]),i=Mi(a,n.conv_2,[1,1]),s=Mi(i,n.conv_3,[2,2]),o=Mi(s,n.conv_4,[1,1]),l=Mi(o,n.conv_5,[2,2]),c=Mi(l,n.conv_6,[1,1]),u=Mi(c,n.conv_7,[2,2]),d=yd(t,n.box_predictor_0),p=yd(e,n.box_predictor_1),h=yd(a,n.box_predictor_2),f=yd(s,n.box_predictor_3),m=yd(l,n.box_predictor_4),g=yd(u,n.box_predictor_5),y=Et([d.boxPredictionEncoding,p.boxPredictionEncoding,h.boxPredictionEncoding,f.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),b=Et([d.classPrediction,p.classPrediction,h.classPrediction,f.classPrediction,m.classPrediction,g.classPrediction],1);return{boxPredictions:y,classPredictions:b}})}var tw=class{constructor({minConfidence:e,maxResults:t}={}){if(this._name="SsdMobilenetv1Options",this._minConfidence=e||.5,this._maxResults=t||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(`${this._name} - expected minConfidence to be a number between 0 and 1`);if(typeof this._maxResults!="number")throw new Error(`${this._name} - expected maxResults to be a number`)}get minConfidence(){return this._minConfidence}get maxResults(){return this._maxResults}},oBe=class extends pl{constructor(){super("SsdMobilenetv1")}forwardInput(e){let{params:t}=this;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return G(()=>{let n=he(e.toBatchTensor(512,!1),"float32"),r=we(Ie(n,127.5),1),a=eBe(r,t.mobilenetv1),{boxPredictions:i,classPredictions:s}=sBe(a.out,a.conv11,t.prediction_layer);return iBe(i,s,t.output_layer)})}async forward(e){return this.forwardInput(await Er(e))}async locateFaces(e,t={}){let{maxResults:n,minConfidence:r}=new tw(t),a=await Er(e),{boxes:i,scores:s}=this.forwardInput(a),o=i[0],l=s[0];for(let y=1;y<i.length;y++)i[y].dispose(),s[y].dispose();let c=Array.from(l.dataSync()),u=nBe(o,c,n,.5,r),d=a.getReshapedInputDimensions(0),p=a.inputSize,h=p/d.width,f=p/d.height,m=o.arraySync(),g=u.map(y=>{let[b,v]=[Math.max(0,m[y][0]),Math.min(1,m[y][2])].map(S=>S*f),[x,w]=[Math.max(0,m[y][1]),Math.min(1,m[y][3])].map(S=>S*h);return new ai(c[y],new Gj(x,b,w-x,v-b),{height:a.getInputHeight(0),width:a.getInputWidth(0)})});return o.dispose(),l.dispose(),g}getDefaultModelName(){return"ssd_mobilenetv1_model"}extractParamsFromWeightMap(e){return Y4e(e)}extractParams(e){return K4e(e)}},lBe=.4,uBe=[new mt(.738768,.874946),new mt(2.42204,2.65704),new mt(4.30971,7.04493),new mt(10.246,4.59428),new mt(12.6868,11.8741)],cBe=[new mt(1.603231,2.094468),new mt(6.041143,7.080126),new mt(2.882459,3.518061),new mt(4.266906,5.178857),new mt(9.041765,10.66308)],dBe=[117.001,114.697,97.404],pBe="tiny_yolov2_model",hBe="tiny_yolov2_separable_conv_model",N0=e=>typeof e=="number";function fBe(e){if(!e)throw new Error(`invalid config: ${e}`);if(typeof e.withSeparableConvs!="boolean")throw new Error(`config.withSeparableConvs has to be a boolean, have: ${e.withSeparableConvs}`);if(!N0(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error(`config.iouThreshold has to be a number between [0, 1], have: ${e.iouThreshold}`);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(t=>typeof t=="string"))throw new Error(`config.classes has to be an array class names: string[], have: ${JSON.stringify(e.classes)}`);if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(t=>t||{}).every(t=>N0(t.x)&&N0(t.y)))throw new Error(`config.anchors has to be an array of { x: number, y: number }, have: ${JSON.stringify(e.anchors)}`);if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(N0)))throw new Error(`config.meanRgb has to be an array of shape [number, number, number], have: ${JSON.stringify(e.meanRgb)}`)}function VE(e){return G(()=>{let t=j(e,Re(.10000000149011612));return re(Ct(we(e,t)),t)})}function Ys(e,t){return G(()=>{let n=Ti(e,[[0,0],[1,1],[1,1],[0,0]]);return n=_r(n,t.conv.filters,[1,1],"valid"),n=we(n,t.bn.sub),n=j(n,t.bn.truediv),n=re(n,t.conv.bias),VE(n)})}function Zs(e,t){return G(()=>{let n=Ti(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Vh(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=re(n,t.bias),VE(n)})}function mBe(e,t){let n=PE(e,t);function r(s,o){let l=It(e(s)),c=It(e(s));return t.push({paramPath:`${o}/sub`},{paramPath:`${o}/truediv`}),{sub:l,truediv:c}}function a(s,o,l){let c=n(s,o,3,`${l}/conv`),u=r(o,`${l}/bn`);return{conv:c,bn:u}}let i=zE(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:a,extractSeparableConvParams:i}}function gBe(e,t,n,r){let{extractWeights:a,getRemainingWeights:i}=fl(e),s=[],{extractConvParams:o,extractConvWithBatchNormParams:l,extractSeparableConvParams:c}=mBe(a,s),u;if(t.withSeparableConvs){let[d,p,h,f,m,g,y,b,v]=r,x=t.isFirstLayerConv2d?o(d,p,3,"conv0"):c(d,p,"conv0"),w=c(p,h,"conv1"),S=c(h,f,"conv2"),C=c(f,m,"conv3"),T=c(m,g,"conv4"),E=c(g,y,"conv5"),R=b?c(y,b,"conv6"):void 0,$=v?c(b,v,"conv7"):void 0,_=o(v||b||y,5*n,1,"conv8");u={conv0:x,conv1:w,conv2:S,conv3:C,conv4:T,conv5:E,conv6:R,conv7:$,conv8:_}}else{let[d,p,h,f,m,g,y,b,v]=r,x=l(d,p,"conv0"),w=l(p,h,"conv1"),S=l(h,f,"conv2"),C=l(f,m,"conv3"),T=l(m,g,"conv4"),E=l(g,y,"conv5"),R=l(y,b,"conv6"),$=l(b,v,"conv7"),_=o(v,5*n,1,"conv8");u={conv0:x,conv1:w,conv2:S,conv3:C,conv4:T,conv5:E,conv6:R,conv7:$,conv8:_}}if(i().length!==0)throw new Error(`weights remaing after extract: ${i().length}`);return{params:u,paramMappings:s}}function yBe(e,t){let n=sd(e,t);function r(o){let l=n(`${o}/sub`,1),c=n(`${o}/truediv`,1);return{sub:l,truediv:c}}function a(o){let l=n(`${o}/filters`,4),c=n(`${o}/bias`,1);return{filters:l,bias:c}}function i(o){let l=a(`${o}/conv`),c=r(`${o}/bn`);return{conv:l,bn:c}}let s=LE(n);return{extractConvParams:a,extractConvWithBatchNormParams:i,extractSeparableConvParams:s}}function bBe(e,t){let n=[],{extractConvParams:r,extractConvWithBatchNormParams:a,extractSeparableConvParams:i}=yBe(e,n),s;if(t.withSeparableConvs){let o=t.filterSizes&&t.filterSizes.length||9;s={conv0:t.isFirstLayerConv2d?r("conv0"):i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:o>7?i("conv6"):void 0,conv7:o>8?i("conv7"):void 0,conv8:r("conv8")}}else s={conv0:a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:a("conv6"),conv7:a("conv7"),conv8:r("conv8")};return hl(e,n),{params:s,paramMappings:n}}var UE=class{constructor({inputSize:e,scoreThreshold:t}={}){if(this._name="TinyYolov2Options",this._inputSize=e||416,this._scoreThreshold=t||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(`${this._name} - expected inputSize to be a number divisible by 32`);if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(`${this._name} - expected scoreThreshold to be a number between 0 and 1`)}get inputSize(){return this._inputSize}get scoreThreshold(){return this._scoreThreshold}},kH=class extends pl{constructor(e){super("TinyYolov2"),fBe(e),this._config=e}get config(){return this._config}get withClassScores(){return this.config.withClassScores||this.config.classes.length>1}get boxEncodingSize(){return 5+(this.withClassScores?this.config.classes.length:0)}runTinyYolov2(e,t){let n=Ys(e,t.conv0);return n=Ln(n,[2,2],[2,2],"same"),n=Ys(n,t.conv1),n=Ln(n,[2,2],[2,2],"same"),n=Ys(n,t.conv2),n=Ln(n,[2,2],[2,2],"same"),n=Ys(n,t.conv3),n=Ln(n,[2,2],[2,2],"same"),n=Ys(n,t.conv4),n=Ln(n,[2,2],[2,2],"same"),n=Ys(n,t.conv5),n=Ln(n,[2,2],[1,1],"same"),n=Ys(n,t.conv6),n=Ys(n,t.conv7),lm(n,t.conv8,"valid",!1)}runMobilenet(e,t){let n=this.config.isFirstLayerConv2d?VE(lm(e,t.conv0,"valid",!1)):Zs(e,t.conv0);return n=Ln(n,[2,2],[2,2],"same"),n=Zs(n,t.conv1),n=Ln(n,[2,2],[2,2],"same"),n=Zs(n,t.conv2),n=Ln(n,[2,2],[2,2],"same"),n=Zs(n,t.conv3),n=Ln(n,[2,2],[2,2],"same"),n=Zs(n,t.conv4),n=Ln(n,[2,2],[2,2],"same"),n=Zs(n,t.conv5),n=Ln(n,[2,2],[1,1],"same"),n=t.conv6?Zs(n,t.conv6):n,n=t.conv7?Zs(n,t.conv7):n,lm(n,t.conv8,"valid",!1)}forwardInput(e,t){let{params:n}=this;if(!n)throw new Error("TinyYolov2 - load model before inference");return G(()=>{let r=he(e.toBatchTensor(t,!1),"float32");return r=this.config.meanRgb?xy(r,this.config.meanRgb):r,r=r.div(255),this.config.withSeparableConvs?this.runMobilenet(r,n):this.runTinyYolov2(r,n)})}async forward(e,t){return this.forwardInput(await Er(e),t)}async detect(e,t={}){let{inputSize:n,scoreThreshold:r}=new UE(t),a=await Er(e),i=await this.forwardInput(a,n),s=G(()=>dn(i)[0].expandDims()),o={width:a.getInputWidth(0),height:a.getInputHeight(0)},l=await this.extractBoxes(s,a.getReshapedInputDimensions(0),r);i.dispose(),s.dispose();let c=l.map(h=>h.box),u=l.map(h=>h.score),d=l.map(h=>h.classScore),p=l.map(h=>this.config.classes[h.label]);return YLe(c.map(h=>h.rescale(n)),u,this.config.iouThreshold,!0).map(h=>new RE(u[h],d[h],p[h],c[h],o))}getDefaultModelName(){return""}extractParamsFromWeightMap(e){return bBe(e,this.config)}extractParams(e){let t=this.config.filterSizes||kH.DEFAULT_FILTER_SIZES,n=t?t.length:void 0;if(n!==7&&n!==8&&n!==9)throw new Error(`TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found ${n} filterSizes in config`);return gBe(e,this.config,this.boxEncodingSize,t)}async extractBoxes(e,t,n){let{width:r,height:a}=t,i=Math.max(r,a),s=i/r,o=i/a,l=e.shape[1],c=this.config.anchors.length,[u,d,p]=G(()=>{let g=e.reshape([l,l,c,this.boxEncodingSize]),y=g.slice([0,0,0,0],[l,l,c,4]),b=g.slice([0,0,0,4],[l,l,c,1]),v=this.withClassScores?sl(g.slice([0,0,0,5],[l,l,c,this.config.classes.length]),3):Re(0);return[y,b,v]}),h=[],f=await d.array(),m=await u.array();for(let g=0;g<l;g++)for(let y=0;y<l;y++)for(let b=0;b<c;b++){let v=xk(f[g][y][b][0]);if(!n||v>n){let x=(y+xk(m[g][y][b][0]))/l*s,w=(g+xk(m[g][y][b][1]))/l*o,S=Math.exp(m[g][y][b][2])*this.config.anchors[b].x/l*s,C=Math.exp(m[g][y][b][3])*this.config.anchors[b].y/l*o,T=x-S/2,E=w-C/2,R={row:g,col:y,anchor:b},{classScore:$,label:_}=this.withClassScores?await this.extractPredictedClass(p,R):{classScore:1,label:0};h.push({box:new Hj(T,E,T+S,E+C),score:v,classScore:v*$,label:_,...R})}}return u.dispose(),d.dispose(),p.dispose(),h}async extractPredictedClass(e,t){let{row:n,col:r,anchor:a}=t,i=await e.array();return Array(this.config.classes.length).fill(0).map((s,o)=>i[n][r][a][o]).map((s,o)=>({classScore:s,label:o})).reduce((s,o)=>s.classScore>o.classScore?s:o)}},jE=kH;jE.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024];var vBe=class extends jE{constructor(e=!0){let t={withSeparableConvs:e,iouThreshold:lBe,classes:["face"],...e?{anchors:cBe,meanRgb:dBe}:{anchors:uBe,withClassScores:!0}};super(t)}get withSeparableConvs(){return this.config.withSeparableConvs}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map(n=>new ai(n.score,n.relativeBox,{width:n.imageWidth,height:n.imageHeight}))}getDefaultModelName(){return this.withSeparableConvs?hBe:pBe}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}},xBe=class extends UE{constructor(){super(...arguments),this._name="TinyFaceDetectorOptions"}},wy=class{async then(e){return e(await this.run())}async run(){throw new Error("ComposableTask - run is not implemented")}};async function HE(e,t,n,r,a=({alignedRect:i})=>i){let i=e.map(l=>mH(l)?a(l):l.detection),s=r||(t instanceof Ze?await iH(t,i):await aH(t,i)),o=await n(s);return s.forEach(l=>l instanceof Ze&&l.dispose()),o}var wBe=.4,kBe=[new mt(1.603231,2.094468),new mt(6.041143,7.080126),new mt(2.882459,3.518061),new mt(4.266906,5.178857),new mt(9.041765,10.66308)],SBe=[117.001,114.697,97.404],IBe=class extends jE{constructor(){let e={withSeparableConvs:!0,iouThreshold:wBe,classes:["face"],anchors:kBe,meanRgb:SBe,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};super(e)}get anchors(){return this.config.anchors}async locateFaces(e,t){return(await this.detect(e,t)).map(n=>new ai(n.score,n.relativeBox,{width:n.imageWidth,height:n.imageHeight}))}getDefaultModelName(){return"tiny_face_detector_model"}extractParamsFromWeightMap(e){return super.extractParamsFromWeightMap(e)}},$s={ssdMobilenetv1:new oBe,tinyFaceDetector:new IBe,tinyYolov2:new vBe,faceLandmark68Net:new R4e,faceLandmark68TinyNet:new O4e,faceRecognitionNet:new U4e,faceExpressionNet:new m4e,ageGenderNet:new A4e},CBe=class extends wy{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.extractedFaces=n}},GE=class extends CBe{async run(){let e=await this.parentTask,t=await HE(e,this.input,async n=>Promise.all(n.map(r=>$s.faceExpressionNet.predictExpressions(r))),this.extractedFaces);return e.map((n,r)=>y4e(n,t[r]))}withAgeAndGender(){return new KE(this,this.input)}},qE=class extends GE{withAgeAndGender(){return new XE(this,this.input)}withFaceDescriptors(){return new YE(this,this.input)}},_Be=class extends wy{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.extractedFaces=n}},KE=class extends _Be{async run(){let e=await this.parentTask,t=await HE(e,this.input,async n=>Promise.all(n.map(r=>$s.ageGenderNet.predictAgeAndGender(r))),this.extractedFaces);return e.map((n,r)=>{let{age:a,gender:i,genderProbability:s}=t[r];return H4e(G4e(n,i,s),a)})}withFaceExpressions(){return new GE(this,this.input)}},XE=class extends KE{withFaceExpressions(){return new qE(this,this.input)}withFaceDescriptors(){return new YE(this,this.input)}},TBe=class extends wy{constructor(e,t){super(),this.parentTask=e,this.input=t}},YE=class extends TBe{async run(){let e=await this.parentTask;return(await HE(e,this.input,t=>Promise.all(t.map(n=>$s.faceRecognitionNet.computeFaceDescriptor(n))),null,t=>t.landmarks.align(null,{useDlibAlignment:!0}))).map((t,n)=>j4e(e[n],t))}withFaceExpressions(){return new qE(this,this.input)}withAgeAndGender(){return new XE(this,this.input)}},NBe=class extends wy{constructor(e,t,n){super(),this.parentTask=e,this.input=t,this.useTinyLandmarkNet=n}get landmarkNet(){return this.useTinyLandmarkNet?$s.faceLandmark68TinyNet:$s.faceLandmark68Net}},EBe=class extends NBe{async run(){let e=await this.parentTask,t=e.map(a=>a.detection),n=this.input instanceof Ze?await iH(this.input,t):await aH(this.input,t),r=await Promise.all(n.map(a=>this.landmarkNet.detectLandmarks(a)));return n.forEach(a=>a instanceof Ze&&a.dispose()),e.filter((a,i)=>r[i]).map((a,i)=>x4e(a,r[i]))}withFaceExpressions(){return new qE(this,this.input)}withAgeAndGender(){return new XE(this,this.input)}withFaceDescriptors(){return new YE(this,this.input)}},$Be=class extends wy{constructor(e,t=new tw){super(),this.input=e,this.options=t}},ABe=class extends $Be{async run(){let{input:e,options:t}=this,n;if(t instanceof xBe)n=$s.tinyFaceDetector.locateFaces(e,t);else if(t instanceof tw)n=$s.ssdMobilenetv1.locateFaces(e,t);else if(t instanceof UE)n=$s.tinyYolov2.locateFaces(e,t);else throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | TinyYolov2Options");return n}runAndExtendWithFaceDetections(){return new Promise((e,t)=>{this.run().then(n=>e(n.map(r=>t4e({},r)))).catch(n=>t(n))})}withFaceLandmarks(e=!1){return new EBe(this.runAndExtendWithFaceDetections(),this.input,e)}withFaceExpressions(){return new GE(this.runAndExtendWithFaceDetections(),this.input)}withAgeAndGender(){return new KE(this.runAndExtendWithFaceDetections(),this.input)}};function RBe(e,t=new tw){return new ABe(e,t)}function FBe(e,t,n,r,a){return r+(a-r)*((e-t)/(n-t))}function ZE(e){return typeof e=="number"}function tM(e){return typeof e=="string"}function ZI(e){return Object.prototype.toString.call(e)==="[object Object]"}function DBe(e){return Array.isArray(e)}function nM(e){return ZI(e)||DBe(e)}function fn(e){return Math.abs(e)}function QE(e){return e?e/fn(e):0}function Bf(e,t){return fn(e-t)}function MBe(e,t){if(e===0||t===0||fn(e)<=fn(t))return 0;var n=Bf(fn(e),fn(t));return fn(n/e)}function OBe(e){var t=Math.pow(10,e);return function(n){return Math.round(n*t)/t}}function rg(e){return Yl(e).map(Number)}function As(e){return e[nw(e)]}function nw(e){return Math.max(0,e.length-1)}function Yl(e){return Object.keys(e)}function SH(e,t){return[e,t].reduce(function(n,r){return Yl(r).forEach(function(a){var i=n[a],s=r[a],o=ZI(i)&&ZI(s);n[a]=o?SH(i,s):s}),n},{})}function IH(e,t){var n=Yl(e),r=Yl(t);return n.length!==r.length?!1:n.every(function(a){var i=e[a],s=t[a];return typeof i=="function"?"".concat(i)==="".concat(s):!nM(i)||!nM(s)?i===s:IH(i,s)})}function PBe(e,t){var n={start:r,center:a,end:i};function r(){return 0}function a(c){return i(c)/2}function i(c){return t-c}function s(){return t*Number(e)}function o(c){return ZE(e)?s():n[e](c)}var l={measure:o};return l}function zBe(e){var t=0;function n(s,o){return function(){s===!!t&&o()}}function r(){t=window.requestAnimationFrame(e)}function a(){window.cancelAnimationFrame(t),t=0}var i={proceed:n(!0,r),start:n(!1,r),stop:n(!0,a)};return i}function LBe(e,t){var n=e==="y"?"y":"x",r=e==="y"?"x":"y",a=o(),i=l();function s(u){var d=u.width,p=u.height;return n==="x"?d:p}function o(){return n==="y"?"top":t==="rtl"?"right":"left"}function l(){return n==="y"?"bottom":t==="rtl"?"left":"right"}var c={scroll:n,cross:r,startEdge:a,endEdge:i,measureSize:s};return c}function Tp(e,t){var n=fn(e-t);function r(c){return c<e}function a(c){return c>t}function i(c){return r(c)||a(c)}function s(c){return i(c)?r(c)?e:t:c}function o(c){return n?c-n*Math.ceil((c-t)/n):c}var l={length:n,max:t,min:e,constrain:s,reachedAny:i,reachedMax:a,reachedMin:r,removeOffset:o};return l}function CH(e,t,n){var r=Tp(0,e),a=r.min,i=r.constrain,s=e+1,o=l(t);function l(f){return n?fn((s+f)%s):i(f)}function c(){return o}function u(f){return o=l(f),h}function d(f){return u(c()+f)}function p(){return CH(e,c(),n)}var h={add:d,clone:p,get:c,set:u,min:a,max:e};return h}function BBe(e){var t=e==="rtl"?-1:1;function n(a){return a*t}var r={apply:n};return r}function Nv(){var e=[];function t(a,i,s,o){return o===void 0&&(o={passive:!0}),a.addEventListener(i,s,o),e.push(function(){return a.removeEventListener(i,s,o)}),r}function n(){return e=e.filter(function(a){return a()}),r}var r={add:t,removeAll:n};return r}function No(e){var t=e;function n(){return t}function r(d){return t=c(d),u}function a(d){return t+=c(d),u}function i(d){return t-=c(d),u}function s(d){return t*=d,u}function o(d){return t/=d,u}function l(){return t!==0&&o(t),u}function c(d){return ZE(d)?d:d.get()}var u={add:a,divide:o,get:n,multiply:s,normalize:l,set:r,subtract:i};return u}function WBe(e,t,n,r,a,i,s,o,l,c,u,d,p,h,f,m){var g=e.cross,y=["INPUT","SELECT","TEXTAREA"],b={passive:!1},v=No(0),x=Nv(),w=Nv(),S=p.measure(20),C={mouse:300,touch:400},T={mouse:500,touch:600},E=f?5:16,R=1,$=0,_=0,D=!1,P=!1,B=!1,W=!1;function Y(){var de=n;x.add(de,"dragstart",function(Ce){return Ce.preventDefault()},b).add(de,"touchmove",function(){},b).add(de,"touchend",function(){}).add(de,"touchstart",te).add(de,"mousedown",te).add(de,"touchcancel",oe).add(de,"contextmenu",oe).add(de,"click",fe,!0)}function O(){var de=W?document:n;w.add(de,"touchmove",se,b).add(de,"touchend",oe).add(de,"mousemove",se,b).add(de,"mouseup",oe)}function q(){x.removeAll(),w.removeAll()}function Z(de){var Ce=de.nodeName||"";return y.indexOf(Ce)>-1}function X(){var de=f?T:C,Ce=W?"mouse":"touch";return de[Ce]}function ne(de,Ce){var Ae=u.clone().add(QE(de)*-1),Me=Ae.get()===u.min||Ae.get()===u.max,Fe=c.byDistance(de,!f).distance;return f||fn(de)<S?Fe:!h&&Me?Fe*.4:m&&Ce?Fe*.5:c.byIndex(Ae.get(),0).distance}function te(de){if(W=!a.isTouchEvent(de),!(W&&de.button!==0)&&!Z(de.target)){var Ce=Bf(r.get(),i.get())>=2,Ae=W||!Ce;D=!0,a.pointerDown(de),v.set(r),r.set(i),l.useBaseMass().useSpeed(80),O(),$=a.readPoint(de),_=a.readPoint(de,g),d.emit("pointerDown"),Ae&&(B=!1)}}function se(de){if(!P&&!W){if(!de.cancelable)return oe(de);var Ce=a.readPoint(de),Ae=a.readPoint(de,g),Me=Bf(Ce,$),Fe=Bf(Ae,_);if(P=Me>Fe,!P&&!B)return oe(de)}var Ge=a.pointerMove(de);!B&&Ge&&(B=!0),s.start(),r.add(t.apply(Ge)),de.preventDefault()}function oe(de){var Ce=c.byDistance(0,!1),Ae=Ce.index!==u.get(),Me=a.pointerUp(de)*X(),Fe=ne(t.apply(Me),Ae),Ge=MBe(Me,Fe),ze=Bf(r.get(),v.get())>=.5,nt=Ae&&Ge>.75,vt=fn(Me)<S,Kn=nt?10:E,Mt=nt?R+2.5*Ge:R;ze&&!W&&(B=!0),P=!1,D=!1,w.removeAll(),l.useSpeed(vt?9:Kn).useMass(Mt),o.distance(Fe,!f),W=!1,d.emit("pointerUp")}function fe(de){B&&(de.stopPropagation(),de.preventDefault())}function ce(){return!B}function ue(){return D}var ye={addActivationEvents:Y,clickAllowed:ce,pointerDown:ue,removeAllEvents:q};return ye}function VBe(e){var t=170,n,r;function a(d){return typeof TouchEvent<"u"&&d instanceof TouchEvent}function i(d){return d.timeStamp}function s(d,p){var h=p||e.scroll,f="client".concat(h==="x"?"X":"Y");return(a(d)?d.touches[0]:d)[f]}function o(d){return n=d,r=d,s(d)}function l(d){var p=s(d)-s(r),h=i(d)-i(n)>t;return r=d,h&&(n=d),p}function c(d){if(!n||!r)return 0;var p=s(r)-s(n),h=i(d)-i(n),f=i(d)-i(r)>t,m=p/h,g=h&&!f&&fn(m)>.1;return g?m:0}var u={isTouchEvent:a,pointerDown:o,pointerMove:l,pointerUp:c,readPoint:s};return u}function UBe(e){function t(r){return e*(r/100)}var n={measure:t};return n}function jBe(e,t,n){var r=OBe(2),a=No(0),i=No(0),s=No(0),o=0,l=t,c=n;function u(){a.add(i),e.add(a),i.multiply(0)}function d(x){x.divide(c),i.add(x)}function p(x){s.set(x).subtract(e);var w=FBe(s.get(),0,100,0,l);return o=QE(s.get()),s.normalize().multiply(w).subtract(a),d(s),v}function h(x){var w=x.get()-e.get(),S=!r(w);return S&&e.set(x),S}function f(){return o}function m(){return y(t)}function g(){return b(n)}function y(x){return l=x,v}function b(x){return c=x,v}var v={direction:f,seek:p,settle:h,update:u,useBaseMass:g,useBaseSpeed:m,useMass:b,useSpeed:y};return v}function HBe(e,t,n,r,a){var i=a.measure(10),s=a.measure(50),o=.85,l=!1;function c(){return!(l||!e.reachedAny(n.get())||!e.reachedAny(t.get()))}function u(h){if(c()){var f=e.reachedMin(t.get())?"min":"max",m=fn(e[f]-t.get()),g=n.get()-t.get(),y=Math.min(m/s,o);n.subtract(g*y),!h&&fn(g)<i&&(n.set(e.constrain(n.get())),r.useSpeed(10).useMass(3))}}function d(h){l=!h}var p={constrain:u,toggleActive:d};return p}function GBe(e,t,n,r){var a=Tp(-t+e,n[0]),i=n.map(a.constrain),s=l();function o(){var u=i[0],d=As(i),p=i.lastIndexOf(u),h=i.indexOf(d)+1;return Tp(p,h)}function l(){if(t<=e)return[a.max];if(r==="keepSnaps")return i;var u=o(),d=u.min,p=u.max;return i.slice(d,p)}var c={snapsContained:s};return c}function qBe(e,t,n){var r=a();function a(){var s=t[0],o=As(t),l=n?s-e:o,c=s;return Tp(l,c)}var i={limit:r};return i}function KBe(e,t,n,r){var a=.1,i=t.min+a,s=t.max+a,o=Tp(i,s),l=o.reachedMin,c=o.reachedMax;function u(h){return h===1?c(n.get()):h===-1?l(n.get()):!1}function d(h){if(u(h)){var f=e*(h*-1);r.forEach(function(m){return m.add(f)})}}var p={loop:d};return p}function XBe(e){var t=e.max,n=e.length;function r(i){var s=i-t;return s/-n}var a={get:r};return a}function YBe(e,t,n,r,a,i,s){var o=e.startEdge,l=e.endEdge,c=i.groupSlides,u=h().map(t.measure),d=f(),p=m();function h(){return c(r).map(function(y){return As(y)[l]-y[0][o]}).map(fn)}function f(){return r.map(function(y){return n[o]-y[o]}).map(function(y){return-fn(y)})}function m(){var y=0,b=As(d)-As(a);return c(d).map(function(v){return v[0]}).map(function(v,x,w){var S=!x,C=x===nw(w);return s&&S?y:s&&C?b:v+u[x]})}var g={snaps:d,snapsAligned:p};return g}function ZBe(e,t,n,r,a){var i=r.reachedAny,s=r.removeOffset,o=r.constrain;function l(f){return f.concat().sort(function(m,g){return fn(m)-fn(g)})[0]}function c(f){var m=e?s(f):o(f),g=t.map(function(b){return b-m}).map(function(b){return u(b,0)}).map(function(b,v){return{diff:b,index:v}}).sort(function(b,v){return fn(b.diff)-fn(v.diff)}),y=g[0].index;return{index:y,distance:m}}function u(f,m){var g=[f,f+n,f-n];if(!e)return g[0];if(!m)return l(g);var y=g.filter(function(b){return QE(b)===m});return l(y)}function d(f,m){var g=t[f]-a.get(),y=u(g,m);return{index:f,distance:y}}function p(f,m){var g=a.get()+f,y=c(g),b=y.index,v=y.distance,x=!e&&i(g);if(!m||x)return{index:b,distance:f};var w=t[b]-v,S=f+u(w,0);return{index:b,distance:S}}var h={byDistance:p,byIndex:d,shortcut:u};return h}function QBe(e,t,n,r,a,i){function s(u){var d=u.distance,p=u.index!==t.get();d&&(e.start(),a.add(d)),p&&(n.set(t.get()),t.set(u.index),i.emit("select"))}function o(u,d){var p=r.byDistance(u,d);s(p)}function l(u,d){var p=t.clone().set(u),h=r.byIndex(p.get(),d);s(h)}var c={distance:o,index:l};return c}function _H(e,t,n){var r=e.scroll==="x"?s:o,a=n.style,i=!1;function s(p){return"translate3d(".concat(p,"px,0px,0px)")}function o(p){return"translate3d(0px,".concat(p,"px,0px)")}function l(p){i||(a.transform=r(t.apply(p.get())))}function c(p){i=!p}function u(){i||(a.transform="",n.getAttribute("style")||n.removeAttribute("style"))}var d={clear:u,to:l,toggleActive:c};return d}function JBe(e,t,n,r,a,i,s,o,l){var c=rg(a),u=rg(a).reverse(),d=m().concat(g());function p(w,S){return w.reduce(function(C,T){return C-a[T]},S)}function h(w,S){return w.reduce(function(C,T){var E=p(C,S);return E>0?C.concat([T]):C},[])}function f(w,S){var C=S==="start",T=C?-r:r,E=s.findSlideBounds([T]);return w.map(function(R){var $=C?0:-r,_=C?r:0,D=E.filter(function(q){return q.index===R})[0],P=D[C?"end":"start"],B=No(-1),W=No(-1),Y=_H(e,t,l[R]),O=function(){return B.set(o.get()>P?$:_)};return{index:R,location:W,translate:Y,target:O}})}function m(){var w=i[0]-1,S=h(u,w);return f(S,"end")}function g(){var w=n-i[0]-1,S=h(c,w);return f(S,"start")}function y(){return d.every(function(w){var S=w.index,C=c.filter(function(T){return T!==S});return p(C,n)<=.1})}function b(){d.forEach(function(w){var S=w.target,C=w.translate,T=w.location,E=S();E.get()!==T.get()&&(E.get()===0?C.clear():C.to(E),T.set(E))})}function v(){d.forEach(function(w){return w.translate.clear()})}var x={canLoop:y,clear:v,loop:b,loopPoints:d};return x}function eWe(e,t,n,r,a,i,s){var o=a.removeOffset,l=a.constrain,c=.5,u=i?[0,t,-t]:[0],d=h(u,s);function p(g){var y=g||0;return n.map(function(b){var v=Tp(c,b-c);return v.constrain(b*y)})}function h(g,y){var b=g||u,v=p(y);return b.reduce(function(x,w){var S=r.map(function(C,T){return{start:C-n[T]+v[T]+w,end:C+e-v[T]+w,index:T}});return x.concat(S)},[])}function f(g,y){var b=i?o(g):l(g),v=y||d;return v.reduce(function(x,w){var S=w.index,C=w.start,T=w.end,E=x.indexOf(S)!==-1,R=C<b&&T>b;return!E&&R?x.concat([S]):x},[])}var m={check:f,findSlideBounds:h};return m}function tWe(e,t,n,r,a){var i=e.measureSize,s=e.startEdge,o=e.endEdge,l=n[0]&&a,c=h(),u=f(),d=n.map(i),p=m();function h(){if(!l)return 0;var y=n[0];return fn(t[s]-y[s])}function f(){if(!l)return 0;var y=window.getComputedStyle(As(r));return parseFloat(y.getPropertyValue("margin-".concat(o)))}function m(){return n.map(function(y,b,v){var x=!b,w=b===nw(v);return x?d[b]+c:w?d[b]+u:v[b+1][s]-y[s]}).map(fn)}var g={slideSizes:d,slideSizesWithGaps:p};return g}function nWe(e,t,n){var r=ZE(n);function a(l,c){return rg(l).filter(function(u){return u%c===0}).map(function(u){return l.slice(u,u+c)})}function i(l){return rg(l).reduce(function(c,u){var d=t.slice(As(c),u+1),p=d.reduce(function(h,f){return h+f},0);return!u||p>e?c.concat(u):c},[]).map(function(c,u,d){return l.slice(c,d[u+1])})}function s(l){return r?a(l,n):i(l)}var o={groupSlides:s};return o}function rWe(e,t,n,r,a){var i=r.align,s=r.axis,o=r.direction,l=r.startIndex,c=r.inViewThreshold,u=r.loop,d=r.speed,p=r.dragFree,h=r.slidesToScroll,f=r.skipSnaps,m=r.containScroll,g=t.getBoundingClientRect(),y=n.map(function(Fe){return Fe.getBoundingClientRect()}),b=BBe(o),v=LBe(s,o),x=v.measureSize(g),w=UBe(x),S=PBe(i,x),C=!u&&m!=="",T=u||m!=="",E=tWe(v,g,y,n,T),R=E.slideSizes,$=E.slideSizesWithGaps,_=nWe(x,$,h),D=YBe(v,S,g,y,$,_,C),P=D.snaps,B=D.snapsAligned,W=-As(P)+As($),Y=GBe(x,W,B,m).snapsContained,O=C?Y:B,q=qBe(W,O,u).limit,Z=CH(nw(O),l,u),X=Z.clone(),ne=rg(n),te=function(){u||Me.scrollBounds.constrain(Me.dragHandler.pointerDown()),Me.scrollBody.seek(ce).update();var Fe=Me.scrollBody.settle(ce);Fe&&!Me.dragHandler.pointerDown()&&(Me.animation.stop(),a.emit("settle")),Fe||a.emit("scroll"),u&&(Me.scrollLooper.loop(Me.scrollBody.direction()),Me.slideLooper.loop()),Me.translate.to(fe),Me.animation.proceed()},se=zBe(te),oe=O[Z.get()],fe=No(oe),ce=No(oe),ue=jBe(fe,d,1),ye=ZBe(u,O,W,q,ce),de=QBe(se,Z,X,ye,ce,a),Ce=eWe(x,W,R,P,q,u,c),Ae=WBe(v,b,e,ce,VBe(v),fe,se,de,ue,ye,Z,a,w,u,p,f),Me={containerRect:g,slideRects:y,animation:se,axis:v,direction:b,dragHandler:Ae,eventStore:Nv(),percentOfView:w,index:Z,indexPrevious:X,limit:q,location:fe,options:r,scrollBody:ue,scrollBounds:HBe(q,fe,ce,ue,w),scrollLooper:KBe(W,q,fe,[fe,ce]),scrollProgress:XBe(q),scrollSnaps:O,scrollTarget:ye,scrollTo:de,slideLooper:JBe(v,b,x,W,$,O,Ce,fe,n),slidesToScroll:_,slidesInView:Ce,slideIndexes:ne,target:ce,translate:_H(v,b,t)};return Me}function aWe(){var e={};function t(s){return e[s]||[]}function n(s){return t(s).forEach(function(o){return o(s)}),i}function r(s,o){return e[s]=t(s).concat([o]),i}function a(s,o){return e[s]=t(s).filter(function(l){return l!==o}),i}var i={emit:n,off:a,on:r};return i}var iWe={align:"center",axis:"x",container:null,slides:null,containScroll:"",direction:"ltr",slidesToScroll:1,breakpoints:{},dragFree:!1,draggable:!0,inViewThreshold:0,loop:!1,skipSnaps:!1,speed:10,startIndex:0,active:!0};function JE(){function e(a,i){return SH(a,i||{})}function t(a,i){var s=JSON.stringify(Yl(a.breakpoints||{})),o=JSON.stringify(Yl(i.breakpoints||{}));return s!==o?!1:IH(a,i)}function n(a){var i=a.breakpoints||{},s=Yl(i).filter(function(o){return window.matchMedia(o).matches}).map(function(o){return i[o]}).reduce(function(o,l){return e(o,l)},{});return e(a,s)}var r={merge:e,areEqual:t,atMedia:n};return r}function sWe(){var e=JE(),t=e.atMedia,n=e.areEqual,r=[],a=[];function i(){return a.some(function(u){return u()})}function s(u){var d=t(u.options);return function(){return!n(d,t(u.options))}}function o(u,d){return a=u.map(s),r=u.filter(function(p){return t(p.options).active}),r.forEach(function(p){return p.init(d)}),u.reduce(function(p,h){var f;return Object.assign(p,(f={},f[h.name]=h,f))},{})}function l(){r=r.filter(function(u){return u.destroy()})}var c={init:o,destroy:l,haveChanged:i};return c}function Zl(e,t,n){var r=Nv(),a=JE(),i=sWe(),s=aWe(),o=s.on,l=s.off,c=w,u=!1,d,p=a.merge(iWe,Zl.globalOptions),h=a.merge(p),f=[],m,g=0,y,b;function v(){var ce=h.container,ue=h.slides,ye=tM(ce)?e.querySelector(ce):ce;y=ye||e.children[0];var de=tM(ue)?y.querySelectorAll(ue):ue;b=[].slice.call(de||y.children)}function x(ce,ue){if(!u){if(p=a.merge(p,ce),h=a.atMedia(p),v(),d=rWe(e,y,b,h,s),g=d.axis.measureSize(e.getBoundingClientRect()),!h.active)return S();if(d.translate.to(d.location),f=ue||f,m=i.init(f,fe),h.loop){if(!d.slideLooper.canLoop()){S(),x({loop:!1},ue),p=a.merge(p,{loop:!0});return}d.slideLooper.loop()}h.draggable&&y.offsetParent&&b.length&&d.dragHandler.addActivationEvents()}}function w(ce,ue){var ye=O();S(),x(a.merge({startIndex:ye},ce),ue),s.emit("reInit")}function S(){d.dragHandler.removeAllEvents(),d.animation.stop(),d.eventStore.removeAll(),d.translate.clear(),d.slideLooper.clear(),i.destroy()}function C(){u||(u=!0,r.removeAll(),S(),s.emit("destroy"))}function T(){var ce=a.atMedia(p),ue=!a.areEqual(ce,h),ye=d.axis.measureSize(e.getBoundingClientRect()),de=g!==ye,Ce=i.haveChanged();(de||ue||Ce)&&w(),s.emit("resize")}function E(ce){var ue=d[ce?"target":"location"].get(),ye=h.loop?"removeOffset":"constrain";return d.slidesInView.check(d.limit[ye](ue))}function R(ce){var ue=E(ce);return d.slideIndexes.filter(function(ye){return ue.indexOf(ye)===-1})}function $(ce,ue,ye){!h.active||u||(d.scrollBody.useBaseMass().useSpeed(ue?100:h.speed),d.scrollTo.index(ce,ye||0))}function _(ce){var ue=d.index.clone().add(1);$(ue.get(),ce===!0,-1)}function D(ce){var ue=d.index.clone().add(-1);$(ue.get(),ce===!0,1)}function P(){var ce=d.index.clone().add(1);return ce.get()!==O()}function B(){var ce=d.index.clone().add(-1);return ce.get()!==O()}function W(){return d.scrollSnaps.map(d.scrollProgress.get)}function Y(){return d.scrollProgress.get(d.location.get())}function O(){return d.index.get()}function q(){return d.indexPrevious.get()}function Z(){return d.dragHandler.clickAllowed()}function X(){return m}function ne(){return d}function te(){return e}function se(){return y}function oe(){return b}var fe={canScrollNext:P,canScrollPrev:B,clickAllowed:Z,containerNode:se,internalEngine:ne,destroy:C,off:l,on:o,plugins:X,previousScrollSnap:q,reInit:c,rootNode:te,scrollNext:_,scrollPrev:D,scrollProgress:Y,scrollSnapList:W,scrollTo:$,selectedScrollSnap:O,slideNodes:oe,slidesInView:E,slidesNotInView:R};return x(t,n),r.add(window,"resize",T),setTimeout(function(){return s.emit("init")},0),fe}Zl.globalOptions=void 0;Zl.optionsHandler=JE;function oWe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function rM(e){return e.concat().sort(function(t,n){return t.name>n.name?1:-1}).map(function(t){return t.options})}function lWe(e,t){if(e.length!==t.length)return!1;var n=Zl.optionsHandler().areEqual,r=rM(e),a=rM(t);return r.every(function(i,s){var o=a[s];return n(i,o)})}function e$(e,t){e===void 0&&(e={}),t===void 0&&(t=[]);var n=M.useRef(Zl.optionsHandler()),r=M.useRef(e),a=M.useRef(t),i=M.useState(),s=i[0],o=i[1],l=M.useState(),c=l[0],u=l[1],d=M.useCallback(function(){s&&s.reInit(r.current,a.current)},[s]);return M.useEffect(function(){if(oWe()&&c){Zl.globalOptions=e$.globalOptions;var p=Zl(c,r.current,a.current);return o(p),function(){return p.destroy()}}else o(void 0)},[c,o]),M.useEffect(function(){n.current.areEqual(r.current,e)||(r.current=e,d())},[e,d]),M.useEffect(function(){lWe(a.current,t)||(a.current=t,d())},[t,d]),[u,s]}e$.globalOptions=void 0;var[uWe,ss]=Iu({name:"CarouselContext",errorMessage:`useCarouselContext returned is 'undefined'. Seems you forgot to wrap the components in "<Carousel />"`}),cWe=({index:e,defaultIndex:t=0,onChange:n,align:r="center",orientation:a="horizontal",autoplay:i=!1,stopMouseEnterAutoplay:s=!0,loop:o=!0,speed:l=10,delay:c=4e3,gap:u="md",slidesToScroll:d=1,draggable:p=!0,dragFree:h=!1,inViewThreshold:f=0,skipSnaps:m=!1,containScroll:g="",slideSize:y="100%",includeGapInSize:b=!0,onScrollProgress:v,children:x,...w})=>{const S=i8(w,j9),[C,T]=Ete({value:e,defaultValue:t,onChange:n}),E=a==="vertical",[R,$]=e$({axis:E?"y":"x",startIndex:t,loop:o,align:r,slidesToScroll:d,draggable:p,dragFree:h,speed:l,inViewThreshold:f,skipSnaps:m,containScroll:g}),[_,D]=M.useState([]),[P,B]=M.useState(!1),W=M.useRef(void 0),Y=M.useCallback(()=>{if(!$)return;const X=Math.round(Math.max(0,Math.min(1,$.scrollProgress()))*100);v==null||v(X)},[$,v]),O=M.useCallback(()=>{if(!$)return;const X=$.selectedScrollSnap();T(X)},[$,T]);M.useEffect(()=>{const X=P&&s,ne=!($!=null&&$.canScrollNext());return $&&i&&!X&&!ne?W.current=setInterval(()=>{$.scrollNext()},c):(W.current&&clearInterval(W.current),W.current=void 0),()=>{W.current&&clearInterval(W.current)}},[i,c,s,$,P,o,C]),Pd(()=>{if(!$)return;$.reInit();const ne=$.scrollSnapList().map((te,se)=>se);D(ne)},[M.Children.toArray(x).length,r,a,o,l,u,d,p,h,f,m,g,y,b]),Pd(()=>{if(!$)return;const ne=$.scrollSnapList().map((te,se)=>se);D(ne)},[$]),Pd(()=>{if($)return $.on("select",O),$.on("scroll",Y),Y(),()=>{$.off("select",O),$.off("scroll",Y)}},[$,Y]);const q=M.useCallback((X={},ne=null)=>({...S[0],...X,ref:ne,onMouseEnter:$o(X.onMouseEnter,()=>{B(!0)}),onMouseLeave:$o(X.onMouseLeave,()=>{B(!1)})}),[S]),Z=M.useCallback((X={})=>({...S[1],...X,ref:R}),[S,R]);return{carousel:$,children:x,indexes:_,selectedIndex:C,orientation:a,slideSize:y,gap:u,slidesToScroll:d,includeGapInSize:b,getContainerProps:q,getSlidesProps:Z}},dWe=({index:e})=>{const{selectedIndex:t,slidesToScroll:n}=ss();e=Math.floor((e??0)/(n??1));const r=e===t;return{getSlideProps:M.useCallback((i={})=>({...i,role:"carousel-slide","data-index":e,"data-selected":ka(r)}),[r,e])}},TH=({operation:e,...t})=>{var n,r;const{carousel:a}=ss(),i=e==="prev",s=(r=(n=t.disabled)!=null?n:t.isDisabled)!=null?r:i?!(a!=null&&a.canScrollPrev()):!(a!=null&&a.canScrollNext()),o=M.useCallback(()=>{a&&(i?a.scrollPrev():a.scrollNext())},[a,i]);return{getControlProps:M.useCallback((c={},u=null)=>({...c,ref:u,disabled:s,role:"carousel-control",onClick:$o(c.onClick,o)}),[s,o])}},pWe=()=>{const{selectedIndex:e,carousel:t,indexes:n}=ss(),r=M.useCallback((i,s)=>{t&&(i.stopPropagation(),t.scrollTo(s))},[t]),a=M.useCallback(({index:i,...s}={})=>({...s,key:i,role:"carousel-indicator","data-index":i,"data-selected":ka(i===e),onClick:$o(s.onClick,l=>r(l,i))}),[r,e]);return{indexes:n,getIndicatorProps:a}},Sk=dt(({className:e,...t},n)=>{const{orientation:r}=ss(),{getControlProps:a}=TH({operation:"prev"});return z.jsx(NH,{operation:"prev",className:ut("ui-carousel__control--prev",e),icon:z.jsx(iO,{__css:{fontSize:"1.5em",transform:r==="vertical"?"rotate(180deg)":"rotate(90deg)"}}),...a(t,n)})}),Ik=dt(({className:e,...t},n)=>{const{orientation:r}=ss(),{getControlProps:a}=TH({operation:"next"});return z.jsx(NH,{operation:"next",className:ut("ui-carousel__control--next",e),icon:z.jsx(iO,{__css:{fontSize:"1.5em",transform:r==="vertical"?"rotate(0deg)":"rotate(-90deg)"}}),...a(t,n)})}),NH=dt(({className:e,operation:t,...n},r)=>{const{styles:a}=ss(),i=nO("whiteAlpha","blackAlpha"),s={position:"absolute",zIndex:"kurillin",...a.control,...a[t]};return z.jsx(Ote,{ref:r,className:ut("ui-carousel__control",e),colorScheme:i,isRounded:!0,__css:s,...n})}),ob=dt(({className:e,component:t,...n},r)=>{const{selectedIndex:a,orientation:i,styles:s}=ss(),{indexes:o,getIndicatorProps:l}=pWe(),c={position:"absolute",zIndex:"kurillin",display:"flex",justifyContent:"center",...s.indicators,...i==="vertical"?{flexDirection:"column"}:{flexDirection:"row"}};return z.jsx(at.div,{ref:r,className:ut("ui-carousel__indicators",e),__css:c,...n,children:o.map(u=>{const d=u===a;if(typeof t=="function"){const p=t({index:u,isSelected:d});if(!p)return null;const h=l({...p.props,index:u});return M.cloneElement(p,h)}else{const{key:p,...h}=l({index:u});return z.jsx(hWe,{...h},p)}})})}),hWe=({className:e,...t})=>{const{styles:n}=ss(),r={...n.indicator};return z.jsx(at.button,{type:"button",tabIndex:-1,className:ut("ui-carousel__indicators__indicator",e),__css:r,...t})},QI=dt(({className:e,size:t,...n},r)=>{const{slideSize:a,includeGapInSize:i,orientation:s,gap:o}=ss(),{getSlideProps:l}=dWe(n);t??(t=a);const c={position:"relative",flex:`0 0 ${t}`,...i?{[s==="vertical"?"pb":"pr"]:o}:{[s==="vertical"?"mb":"mr"]:o}};return z.jsx(at.div,{className:ut("ui-carousel__slide",e),__css:c,...l({}),children:z.jsx(fWe,{ref:r,...n})})}),fWe=dt(({...e},t)=>z.jsx(at.div,{ref:t,className:"ui-carousel__slide__inner",w:"100%",h:"100%",...e})),mWe=dt(({h:e,height:t,minH:n,minHeight:r,...a},i)=>{var s,o;const l=pn(a.orientation),c=pn(a.align),u=pn(a.autoplay),d=pn(a.stopMouseEnterAutoplay),p=pn(a.loop),h=pn(a.speed),f=pn(a.delay),m=pn(a.slidesToScroll),g=pn(a.draggable),y=pn(a.dragFree),b=pn(a.inViewThreshold),v=pn(a.skipSnaps),x=pn(a.containScroll),w=pn(a.includeGapInSize),S=(s=gm("spaces",pn(a.gap)))!=null?s:pn(a.gap),C=(o=gm("sizes",pn(a.slideSize)))!=null?o:pn(a.slideSize),[T,E]=Zv("Carousel",{...a,orientation:l,align:c,autoplay:u,stopMouseEnterAutoplay:d,loop:p,speed:h,delay:f,slidesToScroll:m,draggable:g,dragFree:y,inViewThreshold:b,skipSnaps:v,containScroll:x,includeGapInSize:w,gap:S,slideSize:C}),{className:R,innerProps:$,withControls:_=!0,controlProps:D,controlPrevProps:P,controlNextProps:B,withIndicators:W=!0,indicatorsProps:Y,...O}=Ls(E),q=pn(_),Z=pn(W),{getContainerProps:X,getSlidesProps:ne,children:te,...se}=cWe({...O}),oe=TM(te),[fe]=Od(oe,Sk),[ce]=Od(oe,Ik),[ue]=Od(oe,ob),ye=GG(oe,QI),de=HG(oe,Sk,Ik,ob,QI),Ce=ye.map((Ae,Me)=>M.cloneElement(Ae,{index:Me}));return e??(e=t),n??(n=r),z.jsx(uWe,{value:{styles:T,...se},children:z.jsxs(at.div,{className:ut("ui-carousel",R),__css:{position:"relative",h:"fit-content",...T.container},...X({},i),children:[fe??(q?z.jsx(Sk,{...D,...P}):null),ce??(q?z.jsx(Ik,{...D,...B}):null),z.jsx(gWe,{...ne({...Mv({h:e,minH:n}),...$}),children:Ce}),ue??(Z?z.jsx(ob,{...Y}):null),de]})})}),gWe=dt(({...e},t)=>{const n={w:"100%",h:"fit-content",overflow:"hidden"};return z.jsx(at.div,{ref:t,className:"ui-carousel__sliders",__css:n,children:z.jsx(yWe,{...e})})}),yWe=({...e})=>{const{orientation:t,includeGapInSize:n,gap:r,styles:a}=ss(),i={display:"flex",flexDirection:t==="vertical"?"column":"row",...a.inner,...n?{[t==="vertical"?"mb":"mr"]:`-${r}`}:{}};return z.jsx(at.div,{className:"ui-carousel__sliders__inner",__css:i,...e})};const bWe=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function ky(e,t){const n=vWe(e);if(typeof n.path!="string"){const{webkitRelativePath:r}=e;Object.defineProperty(n,"path",{value:typeof t=="string"?t:typeof r=="string"&&r.length>0?r:e.name,writable:!1,configurable:!1,enumerable:!0})}return n}function vWe(e){const{name:t}=e;if(t&&t.lastIndexOf(".")!==-1&&!e.type){const r=t.split(".").pop().toLowerCase(),a=bWe.get(r);a&&Object.defineProperty(e,"type",{value:a,writable:!1,configurable:!1,enumerable:!0})}return e}var af=(e,t,n)=>new Promise((r,a)=>{var i=l=>{try{o(n.next(l))}catch(c){a(c)}},s=l=>{try{o(n.throw(l))}catch(c){a(c)}},o=l=>l.done?r(l.value):Promise.resolve(l.value).then(i,s);o((n=n.apply(e,t)).next())});const xWe=[".DS_Store","Thumbs.db"];function wWe(e){return af(this,null,function*(){return Ev(e)&&kWe(e.dataTransfer)?_We(e.dataTransfer,e.type):SWe(e)?IWe(e):Array.isArray(e)&&e.every(t=>"getFile"in t&&typeof t.getFile=="function")?CWe(e):[]})}function kWe(e){return Ev(e)}function SWe(e){return Ev(e)&&Ev(e.target)}function Ev(e){return typeof e=="object"&&e!==null}function IWe(e){return JI(e.target.files).map(t=>ky(t))}function CWe(e){return af(this,null,function*(){return(yield Promise.all(e.map(n=>n.getFile()))).map(n=>ky(n))})}function _We(e,t){return af(this,null,function*(){if(e.items){const n=JI(e.items).filter(a=>a.kind==="file");if(t!=="drop")return n;const r=yield Promise.all(n.map(TWe));return aM(EH(r))}return aM(JI(e.files).map(n=>ky(n)))})}function aM(e){return e.filter(t=>xWe.indexOf(t.name)===-1)}function JI(e){if(e===null)return[];const t=[];for(let n=0;n<e.length;n++){const r=e[n];t.push(r)}return t}function TWe(e){if(typeof e.webkitGetAsEntry!="function")return iM(e);const t=e.webkitGetAsEntry();return t&&t.isDirectory?$H(t):iM(e)}function EH(e){return e.reduce((t,n)=>[...t,...Array.isArray(n)?EH(n):[n]],[])}function iM(e){const t=e.getAsFile();if(!t)return Promise.reject(`${e} is not a File`);const n=ky(t);return Promise.resolve(n)}function NWe(e){return af(this,null,function*(){return e.isDirectory?$H(e):EWe(e)})}function $H(e){const t=e.createReader();return new Promise((n,r)=>{const a=[];function i(){t.readEntries(s=>af(this,null,function*(){if(s.length){const o=Promise.all(s.map(NWe));a.push(o),i()}else try{const o=yield Promise.all(a);n(o)}catch(o){r(o)}}),s=>{r(s)})}i()})}function EWe(e){return af(this,null,function*(){return new Promise((t,n)=>{e.file(r=>{const a=ky(r,e.fullPath);t(a)},r=>{n(r)})})})}function $We(e,t){if(e&&t){const n=Array.isArray(t)?t:t.split(","),r=e.name||"",a=(e.type||"").toLowerCase(),i=a.replace(/\/.*$/,"");return n.some(s=>{const o=s.trim().toLowerCase();return o.charAt(0)==="."?r.toLowerCase().endsWith(o):o.endsWith("/*")?i===o.replace(/\/.*$/,""):a===o})}return!0}var AWe=Object.defineProperty,RWe=Object.defineProperties,FWe=Object.getOwnPropertyDescriptors,sM=Object.getOwnPropertySymbols,DWe=Object.prototype.hasOwnProperty,MWe=Object.prototype.propertyIsEnumerable,oM=(e,t,n)=>t in e?AWe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,OWe=(e,t)=>{for(var n in t||(t={}))DWe.call(t,n)&&oM(e,n,t[n]);if(sM)for(var n of sM(t))MWe.call(t,n)&&oM(e,n,t[n]);return e},PWe=(e,t)=>RWe(e,FWe(t));const zWe="file-invalid-type",LWe="file-too-large",BWe="file-too-small",WWe="too-many-files",VWe=e=>{e=Array.isArray(e)&&e.length===1?e[0]:e;const t=Array.isArray(e)?`one of ${e.join(", ")}`:e;return{code:zWe,message:`File type must be ${t}`}},lM=e=>({code:LWe,message:`File is larger than ${e} ${e===1?"byte":"bytes"}`}),uM=e=>({code:BWe,message:`File is smaller than ${e} ${e===1?"byte":"bytes"}`}),UWe={code:WWe,message:"Too many files"};function AH(e,t){const n=e.type==="application/x-moz-file"||$We(e,t);return[n,n?null:VWe(t)]}function RH(e,t,n){if(Dl(e.size))if(Dl(t)&&Dl(n)){if(e.size>n)return[!1,lM(n)];if(e.size<t)return[!1,uM(t)]}else{if(Dl(t)&&e.size<t)return[!1,uM(t)];if(Dl(n)&&e.size>n)return[!1,lM(n)]}return[!0,null]}function Dl(e){return e!=null}function jWe({files:e,accept:t,minSize:n,maxSize:r,multiple:a,maxFiles:i,validator:s}){return!a&&e.length>1||a&&i>=1&&e.length>i?!1:e.every(o=>{const[l]=AH(o,t),[c]=RH(o,n,r),u=s?s(o):null;return l&&c&&!u})}function $v(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function E0(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,t=>t==="Files"||t==="application/x-moz-file"):!!e.target&&!!e.target.files}function cM(e){e.preventDefault()}function HWe(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function GWe(e){return e.indexOf("Edge/")!==-1}function qWe(e=window.navigator.userAgent){return HWe(e)||GWe(e)}function Ai(...e){return(t,...n)=>e.some(r=>(!$v(t)&&r&&r(t,...n),$v(t)))}function KWe(){return"showOpenFilePicker"in window}function XWe(e){return Dl(e)?[{description:"Files",accept:Object.entries(e).filter(([n,r])=>{let a=!0;return FH(n)||(console.warn(`Skipped "${n}" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.`),a=!1),(!Array.isArray(r)||!r.every(DH))&&(console.warn(`Skipped "${n}" because an invalid file extension was provided.`),a=!1),a}).reduce((n,[r,a])=>PWe(OWe({},n),{[r]:a}),{})}]:e}function YWe(e){if(Dl(e))return Object.entries(e).reduce((t,[n,r])=>[...t,n,...r],[]).filter(t=>FH(t)||DH(t)).join(",")}function ZWe(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function QWe(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function FH(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function DH(e){return/^.*\.[\w]+$/.test(e)}var JWe=Object.defineProperty,eVe=Object.defineProperties,tVe=Object.getOwnPropertyDescriptors,Av=Object.getOwnPropertySymbols,MH=Object.prototype.hasOwnProperty,OH=Object.prototype.propertyIsEnumerable,dM=(e,t,n)=>t in e?JWe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,zr=(e,t)=>{for(var n in t||(t={}))MH.call(t,n)&&dM(e,n,t[n]);if(Av)for(var n of Av(t))OH.call(t,n)&&dM(e,n,t[n]);return e},io=(e,t)=>eVe(e,tVe(t)),Rv=(e,t)=>{var n={};for(var r in e)MH.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Av)for(var r of Av(e))t.indexOf(r)<0&&OH.call(e,r)&&(n[r]=e[r]);return n};const t$=M.forwardRef((e,t)=>{var n=e,{children:r}=n,a=Rv(n,["children"]);const i=zH(a),{open:s}=i,o=Rv(i,["open"]);return M.useImperativeHandle(t,()=>({open:s}),[s]),Za.createElement(M.Fragment,null,r(io(zr({},o),{open:s})))});t$.displayName="Dropzone";const PH={disabled:!1,getFilesFromEvent:wWe,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};t$.defaultProps=PH;t$.propTypes={children:Pt.func,accept:Pt.objectOf(Pt.arrayOf(Pt.string)),multiple:Pt.bool,preventDropOnDocument:Pt.bool,noClick:Pt.bool,noKeyboard:Pt.bool,noDrag:Pt.bool,noDragEventsBubbling:Pt.bool,minSize:Pt.number,maxSize:Pt.number,maxFiles:Pt.number,disabled:Pt.bool,getFilesFromEvent:Pt.func,onFileDialogCancel:Pt.func,onFileDialogOpen:Pt.func,useFsAccessApi:Pt.bool,autoFocus:Pt.bool,onDragEnter:Pt.func,onDragLeave:Pt.func,onDragOver:Pt.func,onDrop:Pt.func,onDropAccepted:Pt.func,onDropRejected:Pt.func,onError:Pt.func,validator:Pt.func};const e2={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function zH(e={}){const{accept:t,disabled:n,getFilesFromEvent:r,maxSize:a,minSize:i,multiple:s,maxFiles:o,onDragEnter:l,onDragLeave:c,onDragOver:u,onDrop:d,onDropAccepted:p,onDropRejected:h,onFileDialogCancel:f,onFileDialogOpen:m,useFsAccessApi:g,autoFocus:y,preventDropOnDocument:b,noClick:v,noKeyboard:x,noDrag:w,noDragEventsBubbling:S,onError:C,validator:T}=zr(zr({},PH),e),E=M.useMemo(()=>YWe(t),[t]),R=M.useMemo(()=>XWe(t),[t]),$=M.useMemo(()=>typeof m=="function"?m:pM,[m]),_=M.useMemo(()=>typeof f=="function"?f:pM,[f]),D=M.useRef(null),P=M.useRef(null),[B,W]=M.useReducer(nVe,e2),{isFocused:Y,isFileDialogActive:O}=B,q=M.useRef(typeof window<"u"&&window.isSecureContext&&g&&KWe()),Z=()=>{!q.current&&O&&setTimeout(()=>{if(P.current){const{files:ve}=P.current;ve.length||(W({type:"closeDialog"}),_())}},300)};M.useEffect(()=>(window.addEventListener("focus",Z,!1),()=>{window.removeEventListener("focus",Z,!1)}),[P,O,_,q]);const X=M.useRef([]),ne=ve=>{D.current&&D.current.contains(ve.target)||(ve.preventDefault(),X.current=[])};M.useEffect(()=>(b&&(document.addEventListener("dragover",cM,!1),document.addEventListener("drop",ne,!1)),()=>{b&&(document.removeEventListener("dragover",cM),document.removeEventListener("drop",ne))}),[D,b]),M.useEffect(()=>(!n&&y&&D.current&&D.current.focus(),()=>{}),[D,y,n]);const te=M.useCallback(ve=>{C?C(ve):console.error(ve)},[C]),se=M.useCallback(ve=>{ve.preventDefault(),ve.persist(),nt(ve),X.current=[...X.current,ve.target],E0(ve)&&Promise.resolve(r(ve)).then(Pe=>{if($v(ve)&&!S)return;const ot=Pe.length,St=ot>0&&jWe({files:Pe,accept:E,minSize:i,maxSize:a,multiple:s,maxFiles:o,validator:T}),Ft=ot>0&&!St;W({isDragAccept:St,isDragReject:Ft,isDragActive:!0,type:"setDraggedFiles"}),l&&l(ve)}).catch(Pe=>te(Pe))},[r,l,te,S,E,i,a,s,o,T]),oe=M.useCallback(ve=>{ve.preventDefault(),ve.persist(),nt(ve);const Pe=E0(ve);if(Pe&&ve.dataTransfer)try{ve.dataTransfer.dropEffect="copy"}catch{}return Pe&&u&&u(ve),!1},[u,S]),fe=M.useCallback(ve=>{ve.preventDefault(),ve.persist(),nt(ve);const Pe=X.current.filter(St=>D.current&&D.current.contains(St)),ot=Pe.indexOf(ve.target);ot!==-1&&Pe.splice(ot,1),X.current=Pe,!(Pe.length>0)&&(W({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),E0(ve)&&c&&c(ve))},[D,c,S]),ce=M.useCallback((ve,Pe)=>{const ot=[],St=[];ve.forEach(Ft=>{const[yn,Yt]=AH(Ft,E),[or,La]=RH(Ft,i,a),ui=T?T(Ft):null;if(yn&&or&&!ui)ot.push(Ft);else{let Dr=[Yt,La];ui&&(Dr=Dr.concat(ui)),St.push({file:Ft,errors:Dr.filter(os=>os)})}}),(!s&&ot.length>1||s&&o>=1&&ot.length>o)&&(ot.forEach(Ft=>{St.push({file:Ft,errors:[UWe]})}),ot.splice(0)),W({acceptedFiles:ot,fileRejections:St,type:"setFiles"}),d&&d(ot,St,Pe),St.length>0&&h&&h(St,Pe),ot.length>0&&p&&p(ot,Pe)},[W,s,E,i,a,o,d,p,h,T]),ue=M.useCallback(ve=>{ve.preventDefault(),ve.persist(),nt(ve),X.current=[],E0(ve)&&Promise.resolve(r(ve)).then(Pe=>{$v(ve)&&!S||ce(Pe,ve)}).catch(Pe=>te(Pe)),W({type:"reset"})},[r,ce,te,S]),ye=M.useCallback(()=>{if(q.current){W({type:"openDialog"}),$();const ve={multiple:s,types:R};window.showOpenFilePicker(ve).then(Pe=>r(Pe)).then(Pe=>{ce(Pe,null),W({type:"closeDialog"})}).catch(Pe=>{ZWe(Pe)?(_(Pe),W({type:"closeDialog"})):QWe(Pe)?(q.current=!1,P.current?(P.current.value=null,P.current.click()):te(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):te(Pe)});return}P.current&&(W({type:"openDialog"}),$(),P.current.value=null,P.current.click())},[W,$,_,g,ce,te,R,s]),de=M.useCallback(ve=>{!D.current||!D.current.isEqualNode(ve.target)||(ve.key===" "||ve.key==="Enter"||ve.keyCode===32||ve.keyCode===13)&&(ve.preventDefault(),ye())},[D,ye]),Ce=M.useCallback(()=>{W({type:"focus"})},[]),Ae=M.useCallback(()=>{W({type:"blur"})},[]),Me=M.useCallback(()=>{v||(qWe()?setTimeout(ye,0):ye())},[v,ye]),Fe=ve=>n?null:ve,Ge=ve=>x?null:Fe(ve),ze=ve=>w?null:Fe(ve),nt=ve=>{S&&ve.stopPropagation()},vt=M.useMemo(()=>(ve={})=>{var Pe=ve,{refKey:ot="ref",role:St,onKeyDown:Ft,onFocus:yn,onBlur:Yt,onClick:or,onDragEnter:La,onDragOver:ui,onDragLeave:Dr,onDrop:os}=Pe,Ba=Rv(Pe,["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"]);return zr(zr({onKeyDown:Ge(Ai(Ft,de)),onFocus:Ge(Ai(yn,Ce)),onBlur:Ge(Ai(Yt,Ae)),onClick:Fe(Ai(or,Me)),onDragEnter:ze(Ai(La,se)),onDragOver:ze(Ai(ui,oe)),onDragLeave:ze(Ai(Dr,fe)),onDrop:ze(Ai(os,ue)),role:typeof St=="string"&&St!==""?St:"presentation",[ot]:D},!n&&!x?{tabIndex:0}:{}),Ba)},[D,de,Ce,Ae,Me,se,oe,fe,ue,x,w,n]),Kn=M.useCallback(ve=>{ve.stopPropagation()},[]),Mt=M.useMemo(()=>(ve={})=>{var Pe=ve,{refKey:ot="ref",onChange:St,onClick:Ft}=Pe,yn=Rv(Pe,["refKey","onChange","onClick"]);const Yt={accept:E,multiple:s,type:"file",style:{display:"none"},onChange:Fe(Ai(St,ue)),onClick:Fe(Ai(Ft,Kn)),tabIndex:-1,[ot]:P};return zr(zr({},Yt),yn)},[P,t,s,ue,n]);return io(zr({},B),{isFocused:Y&&!n,getRootProps:vt,getInputProps:Mt,rootRef:D,inputRef:P,open:Fe(ye)})}function nVe(e,t){switch(t.type){case"focus":return io(zr({},e),{isFocused:!0});case"blur":return io(zr({},e),{isFocused:!1});case"openDialog":return io(zr({},e2),{isFileDialogActive:!0});case"closeDialog":return io(zr({},e),{isFileDialogActive:!1});case"setDraggedFiles":return io(zr({},e),{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case"setFiles":return io(zr({},e),{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections});case"reset":return zr({},e2);default:return e}}function pM(){}var[rVe,aVe]=Iu({name:"DropzoneContext",errorMessage:`useDropzoneContext returned is 'undefined'. Seems you forgot to wrap the components in "<Dropzone />"`}),iVe=dt((e,t)=>{const[n,r]=Zv("Dropzone",e),{id:a,name:i,className:s,isLoading:o,overlayProps:l,loadingProps:c,openRef:u,accept:d,onDrop:p,onDropAccepted:h,onDropRejected:f,multiple:m,maxSize:g,maxFiles:y,autoFocus:b,noClick:v,noDrag:x,noDragEventsBubbling:w,noKeyboard:S,onDragEnter:C,onDragLeave:T,onDragOver:E,onFileDialogCancel:R,onFileDialogOpen:$,preventDropOnDocument:_,useFsAccessApi:D,children:P,...B}=Lte(Ls(r)),W=o||B.disabled||B.readOnly,Y=ub(B,Bte),{getRootProps:O,getInputProps:q,isDragAccept:Z,isDragReject:X,open:ne}=zH({disabled:W,accept:lt(d)?d.reduce((oe,fe)=>({...oe,[fe]:[]}),{}):d,onDrop:p,onDropAccepted:h,onDropRejected:f,multiple:m,maxSize:g,maxFiles:y,autoFocus:b,noClick:v,noDrag:x,noDragEventsBubbling:w,noKeyboard:S,onDragEnter:C,onDragLeave:T,onDragOver:E,onFileDialogCancel:R,onFileDialogOpen:$,preventDropOnDocument:_,useFsAccessApi:D});Tl(u,ne);const te=!Z&&!X,se={position:"relative",display:"flex",justifyContent:"center",alignItems:"center",...n.container};return z.jsx(rVe,{value:{isLoading:o,isDragAccept:Z,isDragReject:X,isDragIdle:te,styles:n},children:z.jsxs(at.div,{className:ut("ui-dropzone",s),__css:se,...B,...O(),"data-accept":ka(Z),"data-reject":ka(X),"data-idle":ka(te),"data-loading":ka(o),children:[z.jsx(sVe,{loadingProps:c,...l}),z.jsx(at.input,{ref:t,id:a,name:i,...Y,...q()}),P]})})}),sVe=({loadingProps:e,...t})=>{const{isLoading:n,styles:r}=aVe(),a={position:"absolute",top:0,left:0,w:"100%",h:"100%",display:"flex",justifyContent:"center",alignItems:"center",...r.overlay};return z.jsx(Rte,{isOpen:n,unmountOnExit:!0,className:"ui-dropzone__overlay",__css:a,...t,children:z.jsx(Jl,{className:"ui-dropzone__overlay__loading",size:"4xl",...e})})},LH={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},hM=Za.createContext&&Za.createContext(LH),Eo=globalThis&&globalThis.__assign||function(){return Eo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Eo.apply(this,arguments)},oVe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n};function BH(e){return e&&e.map(function(t,n){return Za.createElement(t.tag,Eo({key:n},t.attr),BH(t.child))})}function lVe(e){return function(t){return Za.createElement(uVe,Eo({attr:Eo({},e.attr)},t),BH(e.child))}}function uVe(e){var t=function(n){var r=e.attr,a=e.size,i=e.title,s=oVe(e,["attr","size","title"]),o=a||n.size||"1em",l;return n.className&&(l=n.className),e.className&&(l=(l?l+" ":"")+e.className),Za.createElement("svg",Eo({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,s,{className:l,style:Eo(Eo({color:e.color||n.color},n.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),i&&Za.createElement("title",null,i),e.children)};return hM!==void 0?Za.createElement(hM.Consumer,null,function(n){return t(n)}):t(LH)}function cVe(e){return lVe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M416 199.5h-91.4V64H187.4v135.5H96l160 158.1 160-158.1zM96 402.8V448h320v-45.2H96z"}}]})(e)}const dVe=["beaming_face_with_smiling_eyes-64.png","face_with_tears_of_joy-64.png","grinning_face_with_big_eyes-64.png","grinning_face_with_smiling_eyes-64.png","grinning_face-64.png","grinning_squinting_face-64.png","rolling_on_the_floor_laughing-64.png","smiling_face_with_halo-64.png","smiling_face_with_hearts-64.png","smiling_face_with_smiling_eyes-64.png","winking_face-64.png"];function pVe(){const e=M.useRef(null),[t,n]=M.useState([]),[r,a]=M.useState(!1),[i,s]=M.useState(!1),[o,l]=M.useState([]),c=h=>h.current,u=h=>h.current.getContext("2d"),d=async()=>{i||(await $s.ssdMobilenetv1.loadFromUri("/face-stamp-app-prototype/model"),l(dVe.map(h=>{const f=new Image;return f.src=`/face-stamp-app-prototype/icons/${h}`,f})),s(!0))},p=async h=>{a(!0);const f=[];for(let m=0;m<h.length;m++){const g=h[m],y=new Image;y.src=URL.createObjectURL(g);const b=await RBe(y),v=c(e),x=u(e);v.width=y.width,v.height=y.height,x.drawImage(y,0,0,y.width,y.height);for(const S of b){const C=o[Math.floor(Math.random()*o.length)];x.drawImage(C,S.box.x,S.box.y,S.box.width,S.box.height)}const w=v.toDataURL("image/jpeg");f.push({name:g.name,url:w})}n(f),a(!1)};return M.useEffect(()=>{d()},[]),z.jsxs(Ute,{children:[z.jsx(Xte,{textAlign:"center",children:"Face Masking App"}),z.jsx("canvas",{ref:e,style:{display:"none"}}),z.jsx(iVe,{multiple:!0,accept:{"image/*":[]},isLoading:r||!i,onDropAccepted:p,children:z.jsx(Yte,{children:"顔が写った画像をドラックアンドドロップ"})}),!!t.length&&z.jsxs(mWe,{slideSize:"50%",align:"center",controlProps:{background:"blackAlpha.500"},children:[t.map((h,f)=>z.jsxs(QI,{as:Vte,position:"relative",justifyContent:"center",alignContent:"center",background:"blackAlpha.100",children:[z.jsx(Jte,{src:h.url,w:"full"}),z.jsx(Xz,{as:"a",position:"absolute",margin:"auto",w:"fit-content",href:h.url,download:h.name,bottom:10,left:0,right:0,variant:"solid",colorScheme:"primary",rightIcon:z.jsx(cVe,{}),children:"ダウンロード"})]},f)),z.jsx(ob,{sx:{"& > *":{_selected:{background:"blackAlpha.950"},background:"blackAlpha.500"}}})]})]})}KS.createRoot(document.getElementById("root")).render(z.jsx(Za.StrictMode,{children:z.jsx(Nte,{children:z.jsx(pVe,{})})}));
